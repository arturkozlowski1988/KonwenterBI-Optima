<ReportsList xmlns="http://schemas.datacontract.org/2004/07/Comarch.Msp.ReportsBook.BusinessLogic" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
    <Reports xmlns:a="http://schemas.datacontract.org/2004/07/Comarch.Msp.ReportsBook.BusinessInterface.Entities">
        <a:Report i:type="a:MdxSqlDevXpressReport">
            <a:catalogName>CDN_Ulex_2018_temp</a:catalogName>
            <a:createdOn>2025-10-28T19:20:44.766</a:createdOn>
            <a:cubeName/>
            <a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
                <b:KeyValueOfReportDataTypeReportDataBrNSYbaE>
                    <b:Key>MdxQuery</b:Key>
                    <b:Value>
                        <a:binaryData/>
                        <a:textData>/*&#xD;
* Raport Stanów Magazynowych na Dzień&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), &#x27;&#x27;) as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N&#x27;\&#x27; + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N&#x27;&#x27;&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N&#x27;ALTER TABLE #tmpTwrGr ADD Poziom&#x27; + CAST(@poziom AS nvarchar) + N&#x27; nvarchar(50), ONr&#x27; + CAST(@poziom AS nvarchar) + N&#x27; nvarchar(50)&#x27;&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N&#x27;UPDATE #tmpTwrGr&#xD;
				SET ONr&#x27; + CAST(@poziom AS nvarchar) +  &#x27;= grONumer &#x27;&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N&#x27;UPDATE #tmpTwrGr&#xD;
				SET Poziom&#x27; + CAST(@poziom AS nvarchar) + &#x27; = kod&#x27;&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N&#x27;UPDATE c&#xD;
				SET c.Poziom&#x27; + CAST(@poziom AS nvarchar) + N&#x27; = (&#xD;
					CASE WHEN c.poziom &lt;=&#x27; + CAST(@poziom AS nvarchar) + N&#x27; THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr&#x27; + CAST(@poziom + 1 AS nvarchar) + &#x27;= p.gidNumer &#x27;&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N&#x27;UPDATE c&#xD;
				SET c.ONr&#x27; + CAST(@poziom AS nvarchar) + N&#x27; = (&#xD;
					CASE WHEN c.poziom &lt;=&#x27; + CAST(@poziom AS nvarchar) + N&#x27; THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr&#x27; + CAST(@poziom + 1 AS nvarchar) + &#x27;= p.gidNumer &#x27;&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = &#x27;&#x27;&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + &#x27;,&quot;Produkt Grupa Poziom &#x27; + LTRIM(@i) + &#x27;&quot; = CASE WHEN Poz.Poziom&#x27; +LTRIM(@i) + &#x27; IS NULL THEN &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27; ELSE Poz.Poziom&#x27; + LTRIM(@i) + &#x27; END&#x27;&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
&#x27;DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, &#x27;&#x27;]&#x27;&#x27;, &#x27;&#x27;_&#x27;&#x27;), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5&#x27;&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + &#x27; AND DeA_AnalizyBI = 1;&#x27;&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = &#x27;&#x27;&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + &#x27; (K)&#x27; END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + &#x27; (D)&#x27; END&#xD;
	SET @sqlA = N&#x27;ALTER TABLE #tmpTwrAtr ADD [&#x27; + CAST(@atrybut_kod AS nvarchar) + N&#x27;] nvarchar(max)&#x27;&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N&#x27;UPDATE #tmpTwrAtr&#xD;
		SET [&#x27; + CAST(@atrybut_kod AS nvarchar) +  &#x27;] = CASE WHEN &#x27; + convert(varchar,@atrybut_format) + &#x27; = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,&#x27;&#x27;28-12-1800&#x27;&#x27;,105)), 111), &#x27;&#x27;/&#x27;&#x27;, &#x27;&#x27;-&#x27;&#x27;) ELSE ATR.TwA_WartoscTxt END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = &#x27; + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N&#x27;, ISNULL(TwrAtr.[&#x27; +  CAST(@atrybut_kod AS nvarchar) + &#x27;], &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) AS [Produkt Atrybut &#x27; + CAST(@atrybut_kod AS nvarchar) + &#x27;]&#x27;         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Liczenie ostatniej daty w bazie&#xD;
SELECT TwI_TwrId [TwI_TId], ISNULL(TwI_MagId,0) [TwI_MId], MAX(TwI_Data) [TwI_OstatniaData] INTO #TwrIlosci&#xD;
FROM CDN.TwrIlosci&#xD;
WHERE TwI_Data &lt;= @DATA&#xD;
GROUP BY TwI_TwrId, TwI_MagId&#xD;
&#xD;
--Liczenie korekty braków&#xD;
SELECT TwI_TwrId [TwI_TId], SUM((CASE WHEN TwI_MagId IS NULL THEN 1 ELSE -1 END)*TwI_Braki) [Braki] INTO #TwrBraki&#xD;
FROM CDN.TwrIlosci&#xD;
JOIN #TwrIlosci TI ON TI.TwI_TId = TwI_TwrId AND TI.TwI_MId=ISNULL(TwI_MagId,0) AND TI.TwI_OstatniaData = TwI_Data&#xD;
GROUP BY TwI_TwrId&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe = @Data&#xD;
GROUP BY TrE_MagId, TrE_TwrId	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select =&#xD;
&#x27;SELECT DB_NAME() [Baza Firmowa], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,&#x27;&#x27;&#x27;&#x27;), &#x27;&#x27;(BRAK)&#x27;&#x27;) [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN &#x27;&#x27;Usługa Prosta&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN &#x27;&#x27;Towar Prosty&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN &#x27;&#x27;Usługa Złożona&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN &#x27;&#x27;Towar Złożony&#x27;&#x27;&#xD;
		ELSE &#x27;&#x27;(NIEOKREŚLONY)&#x27;&#x27;&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) [Produkt Producent], ISNULL(Mrk_Nazwa, &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, &#x27;&#x27;(PUSTA)&#x27;&#x27;) [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, &#x27;&#x27;(PUSTA)&#x27;&#x27;) [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END  [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TwI_Wartosc, 0) [Wartość Netto], ISNULL(TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	&#x27; + @kolumny + @atrybutyTwr + &#x27;&#xD;
FROM CDN.TwrIlosci&#xD;
	LEFT OUTER JOIN CDN.Magazyny ON Mag_MagId = TwI_MagId&#xD;
	JOIN CDN.Towary ON TwI_TwrId = Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	JOIN #TwrIlosci ON TwI_TId = TwI_TwrId AND TwI_OstatniaData = TwI_Data AND TwI_MId = TwI_MagId&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwI_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TwI_MagId = TrE_MagId AND TwI_TwrId = TrE_TwrId&#x27;&#xD;
&#xD;
IF @ZEROWE = &#x27;NIE&#x27; SET @select = @select + &#x27; WHERE ISNULL(TwI_Ilosc, 0) &lt;&gt; 0&#x27;&#xD;
&#xD;
SET @select = @select + &#x27;&#xD;
&#xD;
UNION ALL&#xD;
&#xD;
SELECT DB_NAME() [Baza Firmowa], &#xD;
	&#xD;
	Twr_Kod [Produkt Kod],&#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa],&#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,&#x27;&#x27;&#x27;&#x27;), &#x27;&#x27;(BRAK)&#x27;&#x27;) [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	&#x27;&#x27;(Korekta Braków)&#x27;&#x27; [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], 1 [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN &#x27;&#x27;Usługa Prosta&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN &#x27;&#x27;Towar Prosty&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN &#x27;&#x27;Usługa Złożona&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN &#x27;&#x27;Towar Złożony&#x27;&#x27;&#xD;
		ELSE &#x27;&#x27;(NIEOKREŚLONY)&#x27;&#x27;&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) [Produkt Producent], ISNULL(Mrk_Nazwa, &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, &#x27;&#x27;(PUSTA)&#x27;&#x27;) [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, &#x27;&#x27;(PUSTA)&#x27;&#x27;) [Produkt Kategoria Ogólna], &#xD;
	NULL [Ilość], &#xD;
	NULL [Ilość Jednostka Pomocnicza], &#xD;
	NULL [Rezerwacje], &#xD;
	NULL  [Rezerwacje Jednostka Pomocnicza], &#xD;
	Braki [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	NULL[Zamówienia], &#xD;
	NULL [Zamówienia Jednostka Pomocnicza],&#xD;
	NULL [Wartość Netto], NULL [Wartość Brutto],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	NULL [Sprzedaż Wartość Netto], NULL [Sprzedaż Ilość]&#xD;
	&#x27; + @kolumny + @atrybutyTwr + &#x27;&#xD;
FROM CDN.Towary&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	JOIN #TwrBraki ON TwI_TId = Twr_TwrId AND Braki &lt;&gt; 0&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON Twr_TwrId  = TwrAtr.TwA_TwrId&#x27;&#xD;
&#xD;
--IF @ZEROWE = &#x27;NIE&#x27; SET @select = @select + &#x27; WHERE ISNULL(TwI_Ilosc, 0) &lt;&gt; 0&#x27;&#xD;
	&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #TwrIlosci&#xD;
DROP TABLE #TwrBraki&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSprzedaz&#xD;
&#xD;
</a:textData>
                        <a:timestamp/>
                        <a:type>MdxQuery</a:type>
                    </b:Value>
                </b:KeyValueOfReportDataTypeReportDataBrNSYbaE>
                <b:KeyValueOfReportDataTypeReportDataBrNSYbaE>
                    <b:Key>SubCube</b:Key>
                    <b:Value>
                        <a:binaryData/>
                        <a:textData/>
                        <a:timestamp/>
                        <a:type>SubCube</a:type>
                    </b:Value>
                </b:KeyValueOfReportDataTypeReportDataBrNSYbaE>
            </a:definitions>
            <a:description></a:description>
            <a:id>5397</a:id>
            <a:isPredefinedReport>false</a:isPredefinedReport>
            <a:language>pl-PL</a:language>
            <a:mainLinkName>Stanów Magazynowych na Dzień</a:mainLinkName>
            <a:modifiedOn>2025-10-28T19:20:44.766</a:modifiedOn>
            <a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
                <b:string>Raporty Zaimportowane</b:string>
            </a:path>
            <a:predefinedReport i:nil="true"/>
            <a:serverName>SERWEROPTIMA\SUL02</a:serverName>
            <a:sourceDbType>Main</a:sourceDbType>
            <a:standardReportHash i:nil="true"/>
            <a:standardReportId i:nil="true"/>
            <a:standardReportVersion i:nil="true"/>
            <a:type>DevXpressMdxSql</a:type>
            <a:useDefaultConnection>false</a:useDefaultConnection>
            <a:useInMemory>true</a:useInMemory>
            <a:viewType i:nil="true"/>
            <a:webServicePort>80</a:webServicePort>
            <a:contexts/>
      <a:connections>
                <a:ReportConnection>
                    <a:biType>0</a:biType>
                    <a:connectionType>MSSQL_User</a:connectionType>
                    <a:database>CDN_Ulex_2018_temp</a:database>
                    <a:isDefault>true</a:isDefault>
                    <a:isDelated>false</a:isDelated>
                    <a:name>Ulex_2018_temp</a:name>
                    <a:openTimeout>-1</a:openTimeout>
                    <a:password>Sek33MacesM=</a:password>
                    <a:port>-1</a:port>
                    <a:queryTimeout>-1</a:queryTimeout>
                    <a:server>SERWEROPTIMA\SUL02</a:server>
                    <a:userId/>
                </a:ReportConnection>
            </a:connections>
        </a:Report>
        <a:Report i:type="a:MdxSqlDevXpressReport">
            <a:catalogName>CDN_Ulex_2018_temp</a:catalogName>
            <a:createdOn>2025-10-28T19:20:44.768</a:createdOn>
            <a:cubeName/>
            <a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
                <b:KeyValueOfReportDataTypeReportDataBrNSYbaE>
                    <b:Key>MdxQuery</b:Key>
                    <b:Value>
                        <a:binaryData/>
                        <a:textData>/*&#xD;
* Raport Stanów Magazynowych na Dzień&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), &#x27;&#x27;) as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N&#x27;\&#x27; + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N&#x27;&#x27;&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N&#x27;ALTER TABLE #tmpTwrGr ADD Poziom&#x27; + CAST(@poziom AS nvarchar) + N&#x27; nvarchar(50), ONr&#x27; + CAST(@poziom AS nvarchar) + N&#x27; nvarchar(50)&#x27;&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N&#x27;UPDATE #tmpTwrGr&#xD;
				SET ONr&#x27; + CAST(@poziom AS nvarchar) +  &#x27;= grONumer &#x27;&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N&#x27;UPDATE #tmpTwrGr&#xD;
				SET Poziom&#x27; + CAST(@poziom AS nvarchar) + &#x27; = kod&#x27;&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N&#x27;UPDATE c&#xD;
				SET c.Poziom&#x27; + CAST(@poziom AS nvarchar) + N&#x27; = (&#xD;
					CASE WHEN c.poziom &lt;=&#x27; + CAST(@poziom AS nvarchar) + N&#x27; THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr&#x27; + CAST(@poziom + 1 AS nvarchar) + &#x27;= p.gidNumer &#x27;&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N&#x27;UPDATE c&#xD;
				SET c.ONr&#x27; + CAST(@poziom AS nvarchar) + N&#x27; = (&#xD;
					CASE WHEN c.poziom &lt;=&#x27; + CAST(@poziom AS nvarchar) + N&#x27; THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr&#x27; + CAST(@poziom + 1 AS nvarchar) + &#x27;= p.gidNumer &#x27;&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = &#x27;&#x27;&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + &#x27;,&quot;Produkt Grupa Poziom &#x27; + LTRIM(@i) + &#x27;&quot; = CASE WHEN Poz.Poziom&#x27; +LTRIM(@i) + &#x27; IS NULL THEN &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27; ELSE Poz.Poziom&#x27; + LTRIM(@i) + &#x27; END&#x27;&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
&#x27;DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, &#x27;&#x27;]&#x27;&#x27;, &#x27;&#x27;_&#x27;&#x27;), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5&#x27;&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + &#x27; AND DeA_AnalizyBI = 1;&#x27;&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = &#x27;&#x27;&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + &#x27; (K)&#x27; END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + &#x27; (D)&#x27; END&#xD;
	SET @sqlA = N&#x27;ALTER TABLE #tmpTwrAtr ADD [&#x27; + CAST(@atrybut_kod AS nvarchar) + N&#x27;] nvarchar(max)&#x27;&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N&#x27;UPDATE #tmpTwrAtr&#xD;
		SET [&#x27; + CAST(@atrybut_kod AS nvarchar) +  &#x27;] = CASE WHEN &#x27; + convert(varchar,@atrybut_format) + &#x27; = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,&#x27;&#x27;28-12-1800&#x27;&#x27;,105)), 111), &#x27;&#x27;/&#x27;&#x27;, &#x27;&#x27;-&#x27;&#x27;) ELSE ATR.TwA_WartoscTxt END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = &#x27; + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N&#x27;, ISNULL(TwrAtr.[&#x27; +  CAST(@atrybut_kod AS nvarchar) + &#x27;], &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) AS [Produkt Atrybut &#x27; + CAST(@atrybut_kod AS nvarchar) + &#x27;]&#x27;         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Liczenie ostatniej daty w bazie&#xD;
SELECT TwI_TwrId [TwI_TId], ISNULL(TwI_MagId,0) [TwI_MId], MAX(TwI_Data) [TwI_OstatniaData] INTO #TwrIlosci&#xD;
FROM CDN.TwrIlosci&#xD;
WHERE TwI_Data &lt;= @DATA&#xD;
GROUP BY TwI_TwrId, TwI_MagId&#xD;
&#xD;
--Liczenie korekty braków&#xD;
SELECT TwI_TwrId [TwI_TId], SUM((CASE WHEN TwI_MagId IS NULL THEN 1 ELSE -1 END)*TwI_Braki) [Braki] INTO #TwrBraki&#xD;
FROM CDN.TwrIlosci&#xD;
JOIN #TwrIlosci TI ON TI.TwI_TId = TwI_TwrId AND TI.TwI_MId=ISNULL(TwI_MagId,0) AND TI.TwI_OstatniaData = TwI_Data&#xD;
GROUP BY TwI_TwrId&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe = @Data&#xD;
GROUP BY TrE_MagId, TrE_TwrId	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select =&#xD;
&#x27;SELECT DB_NAME() [Baza Firmowa], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,&#x27;&#x27;&#x27;&#x27;), &#x27;&#x27;(BRAK)&#x27;&#x27;) [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN &#x27;&#x27;Usługa Prosta&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN &#x27;&#x27;Towar Prosty&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN &#x27;&#x27;Usługa Złożona&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN &#x27;&#x27;Towar Złożony&#x27;&#x27;&#xD;
		ELSE &#x27;&#x27;(NIEOKREŚLONY)&#x27;&#x27;&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) [Produkt Producent], ISNULL(Mrk_Nazwa, &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, &#x27;&#x27;(PUSTA)&#x27;&#x27;) [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, &#x27;&#x27;(PUSTA)&#x27;&#x27;) [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END  [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TwI_Wartosc, 0) [Wartość Netto], ISNULL(TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	&#x27; + @kolumny + @atrybutyTwr + &#x27;&#xD;
FROM CDN.TwrIlosci&#xD;
	LEFT OUTER JOIN CDN.Magazyny ON Mag_MagId = TwI_MagId&#xD;
	JOIN CDN.Towary ON TwI_TwrId = Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	JOIN #TwrIlosci ON TwI_TId = TwI_TwrId AND TwI_OstatniaData = TwI_Data AND TwI_MId = TwI_MagId&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwI_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TwI_MagId = TrE_MagId AND TwI_TwrId = TrE_TwrId&#x27;&#xD;
&#xD;
IF @ZEROWE = &#x27;NIE&#x27; SET @select = @select + &#x27; WHERE ISNULL(TwI_Ilosc, 0) &lt;&gt; 0&#x27;&#xD;
&#xD;
SET @select = @select + &#x27;&#xD;
&#xD;
UNION ALL&#xD;
&#xD;
SELECT DB_NAME() [Baza Firmowa], &#xD;
	&#xD;
	Twr_Kod [Produkt Kod],&#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa],&#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,&#x27;&#x27;&#x27;&#x27;), &#x27;&#x27;(BRAK)&#x27;&#x27;) [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	&#x27;&#x27;(Korekta Braków)&#x27;&#x27; [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], 1 [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN &#x27;&#x27;Usługa Prosta&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN &#x27;&#x27;Towar Prosty&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN &#x27;&#x27;Usługa Złożona&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN &#x27;&#x27;Towar Złożony&#x27;&#x27;&#xD;
		ELSE &#x27;&#x27;(NIEOKREŚLONY)&#x27;&#x27;&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) [Produkt Producent], ISNULL(Mrk_Nazwa, &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, &#x27;&#x27;(PUSTA)&#x27;&#x27;) [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, &#x27;&#x27;(PUSTA)&#x27;&#x27;) [Produkt Kategoria Ogólna], &#xD;
	NULL [Ilość], &#xD;
	NULL [Ilość Jednostka Pomocnicza], &#xD;
	NULL [Rezerwacje], &#xD;
	NULL  [Rezerwacje Jednostka Pomocnicza], &#xD;
	Braki [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	NULL[Zamówienia], &#xD;
	NULL [Zamówienia Jednostka Pomocnicza],&#xD;
	NULL [Wartość Netto], NULL [Wartość Brutto],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	NULL [Sprzedaż Wartość Netto], NULL [Sprzedaż Ilość]&#xD;
	&#x27; + @kolumny + @atrybutyTwr + &#x27;&#xD;
FROM CDN.Towary&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	JOIN #TwrBraki ON TwI_TId = Twr_TwrId AND Braki &lt;&gt; 0&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON Twr_TwrId  = TwrAtr.TwA_TwrId&#x27;&#xD;
&#xD;
--IF @ZEROWE = &#x27;NIE&#x27; SET @select = @select + &#x27; WHERE ISNULL(TwI_Ilosc, 0) &lt;&gt; 0&#x27;&#xD;
	&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #TwrIlosci&#xD;
DROP TABLE #TwrBraki&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSprzedaz&#xD;
&#xD;
</a:textData>
                        <a:timestamp/>
                        <a:type>MdxQuery</a:type>
                    </b:Value>
                </b:KeyValueOfReportDataTypeReportDataBrNSYbaE>
                <b:KeyValueOfReportDataTypeReportDataBrNSYbaE>
                    <b:Key>SubCube</b:Key>
                    <b:Value>
                        <a:binaryData/>
                        <a:textData/>
                        <a:timestamp/>
                        <a:type>SubCube</a:type>
                    </b:Value>
                </b:KeyValueOfReportDataTypeReportDataBrNSYbaE>
            </a:definitions>
            <a:description></a:description>
            <a:id>7400</a:id>
            <a:isPredefinedReport>false</a:isPredefinedReport>
            <a:language>pl-PL</a:language>
            <a:mainLinkName>Stanów Magazynowych na Dzień</a:mainLinkName>
            <a:modifiedOn>2025-10-28T19:20:44.768</a:modifiedOn>
            <a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
                <b:string>Raporty Zaimportowane</b:string>
            </a:path>
            <a:predefinedReport i:nil="true"/>
            <a:serverName>SERWEROPTIMA\SUL02</a:serverName>
            <a:sourceDbType>Main</a:sourceDbType>
            <a:standardReportHash i:nil="true"/>
            <a:standardReportId i:nil="true"/>
            <a:standardReportVersion i:nil="true"/>
            <a:type>DevXpressMdxSql</a:type>
            <a:useDefaultConnection>false</a:useDefaultConnection>
            <a:useInMemory>true</a:useInMemory>
            <a:viewType i:nil="true"/>
            <a:webServicePort>80</a:webServicePort>
            <a:contexts/>
      <a:connections>
                <a:ReportConnection>
                    <a:biType>0</a:biType>
                    <a:connectionType>MSSQL_User</a:connectionType>
                    <a:database>CDN_Ulex_2018_temp</a:database>
                    <a:isDefault>true</a:isDefault>
                    <a:isDelated>false</a:isDelated>
                    <a:name>Ulex_2018_temp</a:name>
                    <a:openTimeout>-1</a:openTimeout>
                    <a:password>Sek33MacesM=</a:password>
                    <a:port>-1</a:port>
                    <a:queryTimeout>-1</a:queryTimeout>
                    <a:server>SERWEROPTIMA\SUL02</a:server>
                    <a:userId/>
                </a:ReportConnection>
            </a:connections>
        </a:Report>
        <a:Report i:type="a:MdxSqlDevXpressReport">
            <a:catalogName>CDN_Ulex_2018_temp</a:catalogName>
            <a:createdOn>2025-10-28T19:20:44.770</a:createdOn>
            <a:cubeName/>
            <a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
                <b:KeyValueOfReportDataTypeReportDataBrNSYbaE>
                    <b:Key>MdxQuery</b:Key>
                    <b:Value>
                        <a:binaryData/>
                        <a:textData>/*&#xD;
* Raport Stanów Magazynowych na Dzień&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), &#x27;&#x27;) as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N&#x27;\&#x27; + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N&#x27;&#x27;&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N&#x27;ALTER TABLE #tmpTwrGr ADD Poziom&#x27; + CAST(@poziom AS nvarchar) + N&#x27; nvarchar(50), ONr&#x27; + CAST(@poziom AS nvarchar) + N&#x27; nvarchar(50)&#x27;&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N&#x27;UPDATE #tmpTwrGr&#xD;
				SET ONr&#x27; + CAST(@poziom AS nvarchar) +  &#x27;= grONumer &#x27;&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N&#x27;UPDATE #tmpTwrGr&#xD;
				SET Poziom&#x27; + CAST(@poziom AS nvarchar) + &#x27; = kod&#x27;&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N&#x27;UPDATE c&#xD;
				SET c.Poziom&#x27; + CAST(@poziom AS nvarchar) + N&#x27; = (&#xD;
					CASE WHEN c.poziom &lt;=&#x27; + CAST(@poziom AS nvarchar) + N&#x27; THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr&#x27; + CAST(@poziom + 1 AS nvarchar) + &#x27;= p.gidNumer &#x27;&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N&#x27;UPDATE c&#xD;
				SET c.ONr&#x27; + CAST(@poziom AS nvarchar) + N&#x27; = (&#xD;
					CASE WHEN c.poziom &lt;=&#x27; + CAST(@poziom AS nvarchar) + N&#x27; THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr&#x27; + CAST(@poziom + 1 AS nvarchar) + &#x27;= p.gidNumer &#x27;&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = &#x27;&#x27;&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + &#x27;,&quot;Produkt Grupa Poziom &#x27; + LTRIM(@i) + &#x27;&quot; = CASE WHEN Poz.Poziom&#x27; +LTRIM(@i) + &#x27; IS NULL THEN &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27; ELSE Poz.Poziom&#x27; + LTRIM(@i) + &#x27; END&#x27;&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
&#x27;DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, &#x27;&#x27;]&#x27;&#x27;, &#x27;&#x27;_&#x27;&#x27;), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5&#x27;&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + &#x27; AND DeA_AnalizyBI = 1;&#x27;&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = &#x27;&#x27;&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + &#x27; (K)&#x27; END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + &#x27; (D)&#x27; END&#xD;
	SET @sqlA = N&#x27;ALTER TABLE #tmpTwrAtr ADD [&#x27; + CAST(@atrybut_kod AS nvarchar) + N&#x27;] nvarchar(max)&#x27;&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N&#x27;UPDATE #tmpTwrAtr&#xD;
		SET [&#x27; + CAST(@atrybut_kod AS nvarchar) +  &#x27;] = CASE WHEN &#x27; + convert(varchar,@atrybut_format) + &#x27; = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,&#x27;&#x27;28-12-1800&#x27;&#x27;,105)), 111), &#x27;&#x27;/&#x27;&#x27;, &#x27;&#x27;-&#x27;&#x27;) ELSE ATR.TwA_WartoscTxt END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = &#x27; + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N&#x27;, ISNULL(TwrAtr.[&#x27; +  CAST(@atrybut_kod AS nvarchar) + &#x27;], &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) AS [Produkt Atrybut &#x27; + CAST(@atrybut_kod AS nvarchar) + &#x27;]&#x27;         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Liczenie ostatniej daty w bazie&#xD;
SELECT TwI_TwrId [TwI_TId], ISNULL(TwI_MagId,0) [TwI_MId], MAX(TwI_Data) [TwI_OstatniaData] INTO #TwrIlosci&#xD;
FROM CDN.TwrIlosci&#xD;
WHERE TwI_Data &lt;= @DATA&#xD;
GROUP BY TwI_TwrId, TwI_MagId&#xD;
&#xD;
--Liczenie korekty braków&#xD;
SELECT TwI_TwrId [TwI_TId], SUM((CASE WHEN TwI_MagId IS NULL THEN 1 ELSE -1 END)*TwI_Braki) [Braki] INTO #TwrBraki&#xD;
FROM CDN.TwrIlosci&#xD;
JOIN #TwrIlosci TI ON TI.TwI_TId = TwI_TwrId AND TI.TwI_MId=ISNULL(TwI_MagId,0) AND TI.TwI_OstatniaData = TwI_Data&#xD;
GROUP BY TwI_TwrId&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe = @Data&#xD;
GROUP BY TrE_MagId, TrE_TwrId	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select =&#xD;
&#x27;SELECT DB_NAME() [Baza Firmowa], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,&#x27;&#x27;&#x27;&#x27;), &#x27;&#x27;(BRAK)&#x27;&#x27;) [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN &#x27;&#x27;Usługa Prosta&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN &#x27;&#x27;Towar Prosty&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN &#x27;&#x27;Usługa Złożona&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN &#x27;&#x27;Towar Złożony&#x27;&#x27;&#xD;
		ELSE &#x27;&#x27;(NIEOKREŚLONY)&#x27;&#x27;&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) [Produkt Producent], ISNULL(Mrk_Nazwa, &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, &#x27;&#x27;(PUSTA)&#x27;&#x27;) [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, &#x27;&#x27;(PUSTA)&#x27;&#x27;) [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END  [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TwI_Wartosc, 0) [Wartość Netto], ISNULL(TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	&#x27; + @kolumny + @atrybutyTwr + &#x27;&#xD;
FROM CDN.TwrIlosci&#xD;
	LEFT OUTER JOIN CDN.Magazyny ON Mag_MagId = TwI_MagId&#xD;
	JOIN CDN.Towary ON TwI_TwrId = Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	JOIN #TwrIlosci ON TwI_TId = TwI_TwrId AND TwI_OstatniaData = TwI_Data AND TwI_MId = TwI_MagId&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwI_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TwI_MagId = TrE_MagId AND TwI_TwrId = TrE_TwrId&#x27;&#xD;
&#xD;
IF @ZEROWE = &#x27;NIE&#x27; SET @select = @select + &#x27; WHERE ISNULL(TwI_Ilosc, 0) &lt;&gt; 0&#x27;&#xD;
&#xD;
SET @select = @select + &#x27;&#xD;
&#xD;
UNION ALL&#xD;
&#xD;
SELECT DB_NAME() [Baza Firmowa], &#xD;
	&#xD;
	Twr_Kod [Produkt Kod],&#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa],&#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,&#x27;&#x27;&#x27;&#x27;), &#x27;&#x27;(BRAK)&#x27;&#x27;) [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	&#x27;&#x27;(Korekta Braków)&#x27;&#x27; [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], 1 [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN &#x27;&#x27;Usługa Prosta&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN &#x27;&#x27;Towar Prosty&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN &#x27;&#x27;Usługa Złożona&#x27;&#x27;&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN &#x27;&#x27;Towar Złożony&#x27;&#x27;&#xD;
		ELSE &#x27;&#x27;(NIEOKREŚLONY)&#x27;&#x27;&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) [Produkt Producent], ISNULL(Mrk_Nazwa, &#x27;&#x27;(NIEPRZYPISANE)&#x27;&#x27;) [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, &#x27;&#x27;(PUSTA)&#x27;&#x27;) [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, &#x27;&#x27;(PUSTA)&#x27;&#x27;) [Produkt Kategoria Ogólna], &#xD;
	NULL [Ilość], &#xD;
	NULL [Ilość Jednostka Pomocnicza], &#xD;
	NULL [Rezerwacje], &#xD;
	NULL  [Rezerwacje Jednostka Pomocnicza], &#xD;
	Braki [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	NULL[Zamówienia], &#xD;
	NULL [Zamówienia Jednostka Pomocnicza],&#xD;
	NULL [Wartość Netto], NULL [Wartość Brutto],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	NULL [Sprzedaż Wartość Netto], NULL [Sprzedaż Ilość]&#xD;
	&#x27; + @kolumny + @atrybutyTwr + &#x27;&#xD;
FROM CDN.Towary&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	JOIN #TwrBraki ON TwI_TId = Twr_TwrId AND Braki &lt;&gt; 0&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON Twr_TwrId  = TwrAtr.TwA_TwrId&#x27;&#xD;
&#xD;
--IF @ZEROWE = &#x27;NIE&#x27; SET @select = @select + &#x27; WHERE ISNULL(TwI_Ilosc, 0) &lt;&gt; 0&#x27;&#xD;
	&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #TwrIlosci&#xD;
DROP TABLE #TwrBraki&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSprzedaz&#xD;
&#xD;
</a:textData>
                        <a:timestamp/>
                        <a:type>MdxQuery</a:type>
                    </b:Value>
                </b:KeyValueOfReportDataTypeReportDataBrNSYbaE>
                <b:KeyValueOfReportDataTypeReportDataBrNSYbaE>
                    <b:Key>SubCube</b:Key>
                    <b:Value>
                        <a:binaryData/>
                        <a:textData/>
                        <a:timestamp/>
                        <a:type>SubCube</a:type>
                    </b:Value>
                </b:KeyValueOfReportDataTypeReportDataBrNSYbaE>
            </a:definitions>
            <a:description></a:description>
            <a:id>7346</a:id>
            <a:isPredefinedReport>false</a:isPredefinedReport>
            <a:language>pl-PL</a:language>
            <a:mainLinkName>Stanów Magazynowych na Dzień</a:mainLinkName>
            <a:modifiedOn>2025-10-28T19:20:44.770</a:modifiedOn>
            <a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
                <b:string>Raporty Zaimportowane</b:string>
            </a:path>
            <a:predefinedReport i:nil="true"/>
            <a:serverName>SERWEROPTIMA\SUL02</a:serverName>
            <a:sourceDbType>Main</a:sourceDbType>
            <a:standardReportHash i:nil="true"/>
            <a:standardReportId i:nil="true"/>
            <a:standardReportVersion i:nil="true"/>
            <a:type>DevXpressMdxSql</a:type>
            <a:useDefaultConnection>false</a:useDefaultConnection>
            <a:useInMemory>true</a:useInMemory>
            <a:viewType i:nil="true"/>
            <a:webServicePort>80</a:webServicePort>
            <a:contexts/>
      <a:connections>
                <a:ReportConnection>
                    <a:biType>0</a:biType>
                    <a:connectionType>MSSQL_User</a:connectionType>
                    <a:database>CDN_Ulex_2018_temp</a:database>
                    <a:isDefault>true</a:isDefault>
                    <a:isDelated>false</a:isDelated>
                    <a:name>Ulex_2018_temp</a:name>
                    <a:openTimeout>-1</a:openTimeout>
                    <a:password>Sek33MacesM=</a:password>
                    <a:port>-1</a:port>
                    <a:queryTimeout>-1</a:queryTimeout>
                    <a:server>SERWEROPTIMA\SUL02</a:server>
                    <a:userId/>
                </a:ReportConnection>
            </a:connections>
        </a:Report>
    </Reports>
    <UsePasswordsEncryption>true</UsePasswordsEncryption>
</ReportsList>