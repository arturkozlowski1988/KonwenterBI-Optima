<ReportsList xmlns="http://schemas.datacontract.org/2004/07/Comarch.Msp.ReportsBook.BusinessLogic" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><Reports xmlns:a="http://schemas.datacontract.org/2004/07/Comarch.Msp.ReportsBook.BusinessInterface.Entities"><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T13:38:41.743</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych na Dzień&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Liczenie ostatniej daty w bazie&#xD;
SELECT TwI_TwrId [TwI_TId], ISNULL(TwI_MagId,0) [TwI_MId], MAX(TwI_Data) [TwI_OstatniaData] INTO #TwrIlosci&#xD;
FROM CDN.TwrIlosci&#xD;
WHERE TwI_Data &lt;= @DATA&#xD;
GROUP BY TwI_TwrId, TwI_MagId&#xD;
&#xD;
--Liczenie korekty braków&#xD;
SELECT TwI_TwrId [TwI_TId], SUM((CASE WHEN TwI_MagId IS NULL THEN 1 ELSE -1 END)*TwI_Braki) [Braki] INTO #TwrBraki&#xD;
FROM CDN.TwrIlosci&#xD;
JOIN #TwrIlosci TI ON TI.TwI_TId = TwI_TwrId AND TI.TwI_MId=ISNULL(TwI_MagId,0) AND TI.TwI_OstatniaData = TwI_Data&#xD;
GROUP BY TwI_TwrId&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe = @Data&#xD;
GROUP BY TrE_MagId, TrE_TwrId	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select =&#xD;
'SELECT DB_NAME() [Baza Firmowa], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END  [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TwI_Wartosc, 0) [Wartość Netto], ISNULL(TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '&#xD;
FROM CDN.TwrIlosci&#xD;
	LEFT OUTER JOIN CDN.Magazyny ON Mag_MagId = TwI_MagId&#xD;
	JOIN CDN.Towary ON TwI_TwrId = Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	JOIN #TwrIlosci ON TwI_TId = TwI_TwrId AND TwI_OstatniaData = TwI_Data AND TwI_MId = TwI_MagId&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwI_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TwI_MagId = TrE_MagId AND TwI_TwrId = TrE_TwrId'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' WHERE ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
&#xD;
SET @select = @select + '&#xD;
&#xD;
UNION ALL&#xD;
&#xD;
SELECT DB_NAME() [Baza Firmowa], &#xD;
	&#xD;
	Twr_Kod [Produkt Kod],&#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa],&#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	''(Korekta Braków)'' [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], 1 [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	NULL [Ilość], &#xD;
	NULL [Ilość Jednostka Pomocnicza], &#xD;
	NULL [Rezerwacje], &#xD;
	NULL  [Rezerwacje Jednostka Pomocnicza], &#xD;
	Braki [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	NULL[Zamówienia], &#xD;
	NULL [Zamówienia Jednostka Pomocnicza],&#xD;
	NULL [Wartość Netto], NULL [Wartość Brutto],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	NULL [Sprzedaż Wartość Netto], NULL [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '&#xD;
FROM CDN.Towary&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	JOIN #TwrBraki ON TwI_TId = Twr_TwrId AND Braki &lt;&gt; 0&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON Twr_TwrId  = TwrAtr.TwA_TwrId'&#xD;
&#xD;
--IF @ZEROWE = 'NIE' SET @select = @select + ' WHERE ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
	&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #TwrIlosci&#xD;
DROP TABLE #TwrBraki&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSprzedaz&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+R9xVUaSNnhw1ovX8kGyRfvi+FPVVwm8BXQToPM2XXd7Cy6m9BIS7z9lwrvvY0Khd6hd0Sj9dT8I/uQ6hIayZsVOTbgzKuFABJeZ87Utb4FrEr6T2Xuz+BsdX3zD1RNXVk+DXKJ4j2c6+Z2UkvrwJPDOo7sR/9EytID4RSlETuDM7Qm07p1slxG</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="" aggregate="Max" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[8e707a04-4bc8-4d29-aed2-bf24728889d8]" caption="Wskaźnik Wartość" type="measure" formatString="n4" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[3f4a04bb-805c-479e-bad1-459095d518ab]" caption="Wskaźnik Ilość" type="measure" formatString="n4" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATA&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stan magazynów na dzień:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data, dla której zostanie wykonana analiza.&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-08-02&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAMAAAAAAAAA/////wEAAAAHAhdbTWFnYXp5biBLb2RdLltNQUdBWllOXQ==</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&#xD;
  &lt;whatifMeasures&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[8e707a04-4bc8-4d29-aed2-bf24728889d8]" caption="Wskaźnik Wartość" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto/Wartość Netto&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[3f4a04bb-805c-479e-bad1-459095d518ab]" caption="Wskaźnik Ilość" formula="IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Ilość/Ilość&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
  &lt;/whatifMeasures&gt;&#xD;
  &lt;sparklines /&gt;&#xD;
  &lt;customMeasures /&gt;&#xD;
  &lt;formatOptions&gt;&#xD;
    &lt;format ref="Produkt Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="130" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Magazyn Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Cena Domyślna"&gt;&#xD;
      &lt;cells fontName="Segoe UI" fontSize="8" format="c2" /&gt;&#xD;
      &lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&#xD;
      &lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Ilość"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Rezerwacje"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Braki"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="81" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Zamówienia"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Wartość Netto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Wartość Brutto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Grupa Poziom 1"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
  &lt;/formatOptions&gt;&#xD;
  &lt;formatRules /&gt;&#xD;
  &lt;dataFields&gt;&#xD;
    &lt;data fieldName="Cena Domyślna" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Ilość" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Rezerwacje" index="2" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Braki" index="3" expanded="True" sortMode="default" order="ascending" width="81" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Zamówienia" index="4" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Wartość Netto" index="5" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Wartość Brutto" index="6" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
  &lt;/dataFields&gt;&#xD;
  &lt;rowFields&gt;&#xD;
    &lt;row fieldName="Produkt Kod" index="1" expanded="True" sortMode="default" order="ascending" width="130" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters filetrMask="" isAllChecked="True" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/row&gt;&#xD;
    &lt;row fieldName="Magazyn Kod" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/row&gt;&#xD;
  &lt;/rowFields&gt;&#xD;
  &lt;columnFields /&gt;&#xD;
  &lt;filterFields&gt;&#xD;
    &lt;filter fieldName="Produkt Grupa Poziom 1" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
  &lt;/filterFields&gt;&#xD;
&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje ilościowe i wartościowe stany towarów na magazynach na zadany dzień. Datę analizy należy podać podczas uruchomienia raportu.</a:description><a:id>241</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.01 Stan magazynów na dzień</a:mainLinkName><a:modifiedOn>2014-06-02T18:47:14.94</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>12</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T13:46:46.873</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych na Dzień&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Liczenie ostatniej daty w bazie&#xD;
SELECT TwI_TwrId [TwI_TId], ISNULL(TwI_MagId,0) [TwI_MId], MAX(TwI_Data) [TwI_OstatniaData] INTO #TwrIlosci&#xD;
FROM CDN.TwrIlosci&#xD;
WHERE TwI_Data &lt;= @DATA&#xD;
GROUP BY TwI_TwrId, TwI_MagId&#xD;
&#xD;
--Liczenie korekty braków&#xD;
SELECT TwI_TwrId [TwI_TId], SUM((CASE WHEN TwI_MagId IS NULL THEN 1 ELSE -1 END)*TwI_Braki) [Braki] INTO #TwrBraki&#xD;
FROM CDN.TwrIlosci&#xD;
JOIN #TwrIlosci TI ON TI.TwI_TId = TwI_TwrId AND TI.TwI_MId=ISNULL(TwI_MagId,0) AND TI.TwI_OstatniaData = TwI_Data&#xD;
GROUP BY TwI_TwrId&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe = @Data&#xD;
GROUP BY TrE_MagId, TrE_TwrId	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select =&#xD;
'SELECT DB_NAME() [Baza Firmowa], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END  [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TwI_Wartosc, 0) [Wartość Netto], ISNULL(TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '&#xD;
FROM CDN.TwrIlosci&#xD;
	LEFT OUTER JOIN CDN.Magazyny ON Mag_MagId = TwI_MagId&#xD;
	JOIN CDN.Towary ON TwI_TwrId = Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	JOIN #TwrIlosci ON TwI_TId = TwI_TwrId AND TwI_OstatniaData = TwI_Data AND TwI_MId = TwI_MagId&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwI_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TwI_MagId = TrE_MagId AND TwI_TwrId = TrE_TwrId'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' WHERE ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
&#xD;
SET @select = @select + '&#xD;
&#xD;
UNION ALL&#xD;
&#xD;
SELECT DB_NAME() [Baza Firmowa], &#xD;
	&#xD;
	Twr_Kod [Produkt Kod],&#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa],&#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	''(Korekta Braków)'' [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], 1 [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	NULL [Ilość], &#xD;
	NULL [Ilość Jednostka Pomocnicza], &#xD;
	NULL [Rezerwacje], &#xD;
	NULL  [Rezerwacje Jednostka Pomocnicza], &#xD;
	Braki [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	NULL[Zamówienia], &#xD;
	NULL [Zamówienia Jednostka Pomocnicza],&#xD;
	NULL [Wartość Netto], NULL [Wartość Brutto],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	NULL [Sprzedaż Wartość Netto], NULL [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '&#xD;
FROM CDN.Towary&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	JOIN #TwrBraki ON TwI_TId = Twr_TwrId AND Braki &lt;&gt; 0&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON Twr_TwrId  = TwrAtr.TwA_TwrId'&#xD;
&#xD;
--IF @ZEROWE = 'NIE' SET @select = @select + ' WHERE ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
	&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #TwrIlosci&#xD;
DROP TABLE #TwrBraki&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSprzedaz&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RbVWbtiiR5a1y8r/v6+U6FL5ZTTF5waQY6SdZe8UjQFTtGtxZN/1iKDhSAWKi1n1vIC6aYs3D/90/mh8ToH17VguNlqUK5BA5GNn+AmEyuQ8h/4w64ELevu9NzW6YwRfqeSkr1leW+5RABV/t7MQzsJU7vawcEyKBXJVrmS8SVFBoXUGYfY3JUhka0xwvR182Utbo9GUVp7IJr6zTyE/D7</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="" aggregate="Max" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[8e707a04-4bc8-4d29-aed2-bf24728889d8]" caption="Wskaźnik Wartość" type="measure" formatString="n4" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[3f4a04bb-805c-479e-bad1-459095d518ab]" caption="Wskaźnik Ilość" type="measure" formatString="n4" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATA&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stan magazynów na dzień:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data, dla której zostanie wykonana analiza.&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-08-02&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showMeasuresOnRows="False"&gt;&lt;whatifMeasures&gt;&lt;whatifMeasure uniqueName="[Measures].[8e707a04-4bc8-4d29-aed2-bf24728889d8]" caption="Wskaźnik Wartość" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto/Wartość Netto&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&lt;whatifMeasure uniqueName="[Measures].[3f4a04bb-805c-479e-bad1-459095d518ab]" caption="Wskaźnik Ilość" formula="IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Ilość/Ilość&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&lt;/whatifMeasures&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="130" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Magazyn Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Grupa Poziom 1"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Ilość" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Produkt Kod" index="0" expanded="True" width="130" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields&gt;&lt;column fieldName="Magazyn Kod" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/column&gt;&lt;/columnFields&gt;&lt;filterFields&gt;&lt;filter fieldName="Produkt Grupa Poziom 1" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje ilościowe stany towarów w rozbiciu na magazyny na zadany dzień. Datę analizy należy podać podczas uruchomienia raportu.</a:description><a:id>242</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language i:nil="true"/><a:mainLinkName>7.02 Stan magazynów na dzień ilościowo</a:mainLinkName><a:modifiedOn>2014-06-02T18:47:29.567</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>12</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T13:47:05.463</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych na Dzień&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Liczenie ostatniej daty w bazie&#xD;
SELECT TwI_TwrId [TwI_TId], ISNULL(TwI_MagId,0) [TwI_MId], MAX(TwI_Data) [TwI_OstatniaData] INTO #TwrIlosci&#xD;
FROM CDN.TwrIlosci&#xD;
WHERE TwI_Data &lt;= @DATA&#xD;
GROUP BY TwI_TwrId, TwI_MagId&#xD;
&#xD;
--Liczenie korekty braków&#xD;
SELECT TwI_TwrId [TwI_TId], SUM((CASE WHEN TwI_MagId IS NULL THEN 1 ELSE -1 END)*TwI_Braki) [Braki] INTO #TwrBraki&#xD;
FROM CDN.TwrIlosci&#xD;
JOIN #TwrIlosci TI ON TI.TwI_TId = TwI_TwrId AND TI.TwI_MId=ISNULL(TwI_MagId,0) AND TI.TwI_OstatniaData = TwI_Data&#xD;
GROUP BY TwI_TwrId&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe = @Data&#xD;
GROUP BY TrE_MagId, TrE_TwrId	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select =&#xD;
'SELECT DB_NAME() [Baza Firmowa], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END  [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TwI_Wartosc, 0) [Wartość Netto], ISNULL(TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '&#xD;
FROM CDN.TwrIlosci&#xD;
	LEFT OUTER JOIN CDN.Magazyny ON Mag_MagId = TwI_MagId&#xD;
	JOIN CDN.Towary ON TwI_TwrId = Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	JOIN #TwrIlosci ON TwI_TId = TwI_TwrId AND TwI_OstatniaData = TwI_Data AND TwI_MId = TwI_MagId&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwI_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TwI_MagId = TrE_MagId AND TwI_TwrId = TrE_TwrId'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' WHERE ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
&#xD;
SET @select = @select + '&#xD;
&#xD;
UNION ALL&#xD;
&#xD;
SELECT DB_NAME() [Baza Firmowa], &#xD;
	&#xD;
	Twr_Kod [Produkt Kod],&#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa],&#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	''(Korekta Braków)'' [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], 1 [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	NULL [Ilość], &#xD;
	NULL [Ilość Jednostka Pomocnicza], &#xD;
	NULL [Rezerwacje], &#xD;
	NULL  [Rezerwacje Jednostka Pomocnicza], &#xD;
	Braki [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	NULL[Zamówienia], &#xD;
	NULL [Zamówienia Jednostka Pomocnicza],&#xD;
	NULL [Wartość Netto], NULL [Wartość Brutto],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	NULL [Sprzedaż Wartość Netto], NULL [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '&#xD;
FROM CDN.Towary&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	JOIN #TwrBraki ON TwI_TId = Twr_TwrId AND Braki &lt;&gt; 0&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON Twr_TwrId  = TwrAtr.TwA_TwrId'&#xD;
&#xD;
--IF @ZEROWE = 'NIE' SET @select = @select + ' WHERE ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
	&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #TwrIlosci&#xD;
DROP TABLE #TwrBraki&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSprzedaz&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RbVWbtiiR5a1y8r/v6+U6FL5ZTTF5waQY6SdZe8UjQFTtGtxZN/1iKDhSAWKi1n1vIC6aYs3D/90/mh8ToH17VguNlqUK5BA5GNn+AmEyuQ8h/4w64ELevu9NzW6YwRfqeSkr1leW+5RABV/t7MQzsJU7vawcEyKBXJVrmS8SVFBoXUGYfY3JUhka0xwvR182Utbo9GUVp7IJr6zTyE/D7</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="" aggregate="Max" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[8e707a04-4bc8-4d29-aed2-bf24728889d8]" caption="Wskaźnik Wartość" type="measure" formatString="n4" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[3f4a04bb-805c-479e-bad1-459095d518ab]" caption="Wskaźnik Ilość" type="measure" formatString="n4" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATA&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stan magazynów na dzień:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data, dla której zostanie wykonana analiza.&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-08-02&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="False" showEmptyCells="False" showMeasuresOnRows="False"&gt;&lt;whatifMeasures&gt;&lt;whatifMeasure uniqueName="[Measures].[8e707a04-4bc8-4d29-aed2-bf24728889d8]" caption="Wskaźnik Wartość" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto/Wartość Netto&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&lt;whatifMeasure uniqueName="[Measures].[3f4a04bb-805c-479e-bad1-459095d518ab]" caption="Wskaźnik Ilość" formula="IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Ilość/Ilość&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&lt;/whatifMeasures&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="130" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Magazyn Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Grupa Poziom 1"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Wartość Netto" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Produkt Kod" index="0" expanded="True" width="130" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields&gt;&lt;column fieldName="Magazyn Kod" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/column&gt;&lt;/columnFields&gt;&lt;filterFields&gt;&lt;filter fieldName="Produkt Grupa Poziom 1" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje wartościowe stany towarów w rozbiciu na magazyny na zadany dzień. Datę analizy należy podać podczas uruchomienia raportu.</a:description><a:id>243</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language i:nil="true"/><a:mainLinkName>7.03 Stan magazynów na dzień wartościowo</a:mainLinkName><a:modifiedOn>2014-06-02T18:47:42.823</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>12</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T13:44:08.56</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych w Zakresie Dat &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END&#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej dat&#xD;
DECLARE @tmpDataOd DATETIME;&#xD;
SET @tmpDataOd = @DataOd&#xD;
CREATE TABLE #TmpDates (Data DATETIME)&#xD;
&#xD;
WHILE @tmpDataOd&lt;=@DataDo&#xD;
BEGIN&#xD;
	INSERT INTO #TmpDates VALUES (@tmpDataOd)&#xD;
	SET @tmpDataOd = @tmpDataOd + 1&#xD;
END					&#xD;
	&#xD;
CREATE UNIQUE CLUSTERED INDEX bu ON #TmpDates ([Data])&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, TrE_DataOpe, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe BETWEEN @DataOd AND @DataDo&#xD;
GROUP BY TrE_MagId, TrE_TwrId, TrE_DataOpe 	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie	&#xD;
set @select =&#xD;
'DECLARE @IloscDni INT; SET @IloscDni = DATEDIFF ( D, ''' + convert(varchar, @DataOd) + ''', ''' + convert(varchar, @DataDo) + ''') + 1;					&#xD;
SELECT DB_NAME() [Baza Firmowa], REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') [Data Dzień], (datepart(DY, datediff(d, 0, twi3.data) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, twi3.data)*/ [Data Tydzień Roku], &#xD;
    MONTH(twi3.data) [Data Miesiąc], DATEPART(quarter, twi3.data) [Data Kwartał], YEAR(twi3.data) [Data Rok], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TWI.TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TWI.TwI_Wartosc, 0) [Wartość Netto], &#xD;
	ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto], @IloscDni [Liczba Dni],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END [Ilość Ostatni Dzień],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '										&#xD;
FROM cdn.TwrIlosci TWI&#xD;
	JOIN (&#xD;
		SELECT MAX(TwI_Data) as MaxData, TwI_MagId, TwI_TwrId, Data &#xD;
		FROM CDN.TwrIlosci TWI2&#xD;
		CROSS JOIN #TmpDates &#xD;
		WHERE TWI2.TwI_MagId IS NOT NULL AND TWI2.TwI_Data &lt;= Data&#xD;
		GROUP BY  TWI2.TwI_MagId, TWI2.TwI_TwrId, data &#xD;
	)TWI3 ON TWI3.TwI_TwrId = TWI.TwI_TwrId	AND TWI3.TwI_MagId = TWI.TwI_MagId AND TWI3.MaxData = TWI.TwI_Data	&#xD;
	JOIN CDN.Towary ON TWI.TwI_TwrId = Twr_TwrId	&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	JOIN CDN.Magazyny ON TWI.TwI_MagId = Mag_MagId	&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TWI.TwI_TwrId  = TwrAtr.TwA_TwrId &#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TWI.TwI_MagId = TrE_MagId AND TWI.TwI_TwrId = TrE_TwrId AND twi3.data = TrE_DataOpe&#xD;
WHERE TWI.TwI_MagId IS NOT NULL'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' AND ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #TmpDates&#xD;
DROP TABLE #tmpSprzedaz&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM3AIWZU/6OpQkKyN+6B1FNMEH/FHa55V/ecPXpX/BUjH5/7weQu7f6jdhBrBNx6P3AiZKzy23BO0YRjAvmevckX3VNkPP0BAvq8v3M+NfZET8BtSe53kLzElbQBKFW8lotLTmURks3tvU72w4S87C9ZOSpMMbKZqZWeyqfvk7BwR</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dzień" caption="Data Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Tydzień Roku" caption="Data Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Miesiąc" caption="Data Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Kwartał" caption="Data Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Rok" caption="Data Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba Dni" caption="Liczba Dni" type="measure" formatString="n0" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="n2" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Ostatni Dzień" caption="Ilość Ostatni Dzień" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" caption="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROZMIAR" caption="Produkt Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów od:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data początkowa, od której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE() - 30&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-07-03&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów do:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data końcowa, do której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-08-02&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="False" type="Bar" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False" rotated="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Top" zeroValues="False" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="TopToBottom" alignmentVertical="Center" alignmentHorizontal="RightOutside" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Stan magazynów w czasie ilościowo" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX visible="True" beginText="" endText="" angle="90" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="[Data Dzień].[2012-04-22]" rangeMax="[Data Dzień].[2012-05-22]" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisX&gt;&#xD;
    &lt;axisY visible="True" beginText="" endText="" angle="0" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="0" rangeMax="12597,2" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisY&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&#xD;
  &lt;whatifMeasures&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" formula="IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Ilość/Ilość&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto/Wartość Netto&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto*Liczba Dni/Wartość Netto)&amp;#xD;&amp;#xA;" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" formula="IIF(Sprzedaż Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Wartość Netto/Sprzedaż Wartość Netto)" description="" summaryType="Default" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" formula="IIF(Sprzedaż Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Ilość Ostatni Dzień*Liczba Dni/Sprzedaż Ilość)" description="" summaryType="Default" /&gt;&#xD;
  &lt;/whatifMeasures&gt;&#xD;
  &lt;sparklines /&gt;&#xD;
  &lt;customMeasures /&gt;&#xD;
  &lt;formatOptions&gt;&#xD;
    &lt;format ref="Data Dzień"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Magazyn Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Ilość"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Grupa Poziom 1"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
  &lt;/formatOptions&gt;&#xD;
  &lt;formatRules /&gt;&#xD;
  &lt;dataFields&gt;&#xD;
    &lt;data fieldName="Ilość" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
  &lt;/dataFields&gt;&#xD;
  &lt;rowFields&gt;&#xD;
    &lt;row fieldName="Data Dzień" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/row&gt;&#xD;
  &lt;/rowFields&gt;&#xD;
  &lt;columnFields&gt;&#xD;
    &lt;column fieldName="Magazyn Kod" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/column&gt;&#xD;
  &lt;/columnFields&gt;&#xD;
  &lt;filterFields&gt;&#xD;
    &lt;filter fieldName="Produkt Kod" index="1" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
    &lt;filter fieldName="Produkt Grupa Poziom 1" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
  &lt;/filterFields&gt;&#xD;
&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje ilościowe stany magazynów w zadanym okresie czasu. Zakres dat analizy należy podać podczas uruchomienia raportu.</a:description><a:id>244</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.04 Stan magazynów w czasie ilościowo</a:mainLinkName><a:modifiedOn>2014-06-02T18:47:56.2</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>13</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T14:41:05.81</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych w Zakresie Dat &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END&#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej dat&#xD;
DECLARE @tmpDataOd DATETIME;&#xD;
SET @tmpDataOd = @DataOd&#xD;
CREATE TABLE #TmpDates (Data DATETIME)&#xD;
&#xD;
WHILE @tmpDataOd&lt;=@DataDo&#xD;
BEGIN&#xD;
	INSERT INTO #TmpDates VALUES (@tmpDataOd)&#xD;
	SET @tmpDataOd = @tmpDataOd + 1&#xD;
END					&#xD;
	&#xD;
CREATE UNIQUE CLUSTERED INDEX bu ON #TmpDates ([Data])&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, TrE_DataOpe, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe BETWEEN @DataOd AND @DataDo&#xD;
GROUP BY TrE_MagId, TrE_TwrId, TrE_DataOpe 	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie	&#xD;
set @select =&#xD;
'DECLARE @IloscDni INT; SET @IloscDni = DATEDIFF ( D, ''' + convert(varchar, @DataOd) + ''', ''' + convert(varchar, @DataDo) + ''') + 1;					&#xD;
SELECT DB_NAME() [Baza Firmowa], REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') [Data Dzień], (datepart(DY, datediff(d, 0, twi3.data) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, twi3.data)*/ [Data Tydzień Roku], &#xD;
    MONTH(twi3.data) [Data Miesiąc], DATEPART(quarter, twi3.data) [Data Kwartał], YEAR(twi3.data) [Data Rok], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TWI.TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TWI.TwI_Wartosc, 0) [Wartość Netto], &#xD;
	ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto], @IloscDni [Liczba Dni],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END [Ilość Ostatni Dzień],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '										&#xD;
FROM cdn.TwrIlosci TWI&#xD;
	JOIN (&#xD;
		SELECT MAX(TwI_Data) as MaxData, TwI_MagId, TwI_TwrId, Data &#xD;
		FROM CDN.TwrIlosci TWI2&#xD;
		CROSS JOIN #TmpDates &#xD;
		WHERE TWI2.TwI_MagId IS NOT NULL AND TWI2.TwI_Data &lt;= Data&#xD;
		GROUP BY  TWI2.TwI_MagId, TWI2.TwI_TwrId, data &#xD;
	)TWI3 ON TWI3.TwI_TwrId = TWI.TwI_TwrId	AND TWI3.TwI_MagId = TWI.TwI_MagId AND TWI3.MaxData = TWI.TwI_Data	&#xD;
	JOIN CDN.Towary ON TWI.TwI_TwrId = Twr_TwrId	&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	JOIN CDN.Magazyny ON TWI.TwI_MagId = Mag_MagId	&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TWI.TwI_TwrId  = TwrAtr.TwA_TwrId &#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TWI.TwI_MagId = TrE_MagId AND TWI.TwI_TwrId = TrE_TwrId AND twi3.data = TrE_DataOpe&#xD;
WHERE TWI.TwI_MagId IS NOT NULL'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' AND ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #TmpDates&#xD;
DROP TABLE #tmpSprzedaz&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM3AIWZU/6OpQkKyN+6B1FNMEH/FHa55V/ecPXpX/BUjH5/7weQu7f6jdhBrBNx6P3AiZKzy23BO0YRjAvmevckX3VNkPP0BAvq8v3M+NfZET8BtSe53kLzElbQBKFW8lotLTmURks3tvU72w4S87C9ZOSpMMbKZqZWeyqfvk7BwR</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dzień" caption="Data Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Tydzień Roku" caption="Data Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Miesiąc" caption="Data Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Kwartał" caption="Data Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Rok" caption="Data Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba Dni" caption="Liczba Dni" type="measure" formatString="n0" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="n2" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Ostatni Dzień" caption="Ilość Ostatni Dzień" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" caption="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROZMIAR" caption="Produkt Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów od:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data początkowa, od której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE() - 30&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-07-03&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów do:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data końcowa, do której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-08-02&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="False" type="Bar" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False" rotated="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Top" zeroValues="False" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="TopToBottom" alignmentVertical="Center" alignmentHorizontal="RightOutside" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Stan magazynów w czasie wartościowo" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX visible="True" beginText="" endText="" angle="90" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="[Data Dzień].[2012-04-22]" rangeMax="[Data Dzień].[2012-05-22]" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisX&gt;&#xD;
    &lt;axisY visible="True" beginText="" endText="" angle="0" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="0" rangeMax="216741,888" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisY&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&#xD;
  &lt;whatifMeasures&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" formula="IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Ilość/Ilość&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto/Wartość Netto&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto*Liczba Dni/Wartość Netto)&amp;#xD;&amp;#xA;" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" formula="IIF(Sprzedaż Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Wartość Netto/Sprzedaż Wartość Netto)" description="" summaryType="Default" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" formula="IIF(Sprzedaż Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Ilość Ostatni Dzień*Liczba Dni/Sprzedaż Ilość)" description="" summaryType="Default" /&gt;&#xD;
  &lt;/whatifMeasures&gt;&#xD;
  &lt;sparklines /&gt;&#xD;
  &lt;customMeasures /&gt;&#xD;
  &lt;formatOptions&gt;&#xD;
    &lt;format ref="Data Dzień"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Magazyn Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Wartość Netto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Grupa Poziom 1"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
  &lt;/formatOptions&gt;&#xD;
  &lt;formatRules /&gt;&#xD;
  &lt;dataFields&gt;&#xD;
    &lt;data fieldName="Wartość Netto" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
  &lt;/dataFields&gt;&#xD;
  &lt;rowFields&gt;&#xD;
    &lt;row fieldName="Data Dzień" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/row&gt;&#xD;
  &lt;/rowFields&gt;&#xD;
  &lt;columnFields&gt;&#xD;
    &lt;column fieldName="Magazyn Kod" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/column&gt;&#xD;
  &lt;/columnFields&gt;&#xD;
  &lt;filterFields&gt;&#xD;
    &lt;filter fieldName="Produkt Kod" index="1" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
    &lt;filter fieldName="Produkt Grupa Poziom 1" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
  &lt;/filterFields&gt;&#xD;
&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje wartościowe stany magazynów w zadanym okresie czasu. Zakres dat analizy należy podać podczas uruchomienia raportu.</a:description><a:id>245</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.05 Stan magazynów w czasie wartościowo</a:mainLinkName><a:modifiedOn>2014-06-02T18:48:02.44</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>13</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T13:53:14.17</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych w Zakresie Dat &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END&#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej dat&#xD;
DECLARE @tmpDataOd DATETIME;&#xD;
SET @tmpDataOd = @DataOd&#xD;
CREATE TABLE #TmpDates (Data DATETIME)&#xD;
&#xD;
WHILE @tmpDataOd&lt;=@DataDo&#xD;
BEGIN&#xD;
	INSERT INTO #TmpDates VALUES (@tmpDataOd)&#xD;
	SET @tmpDataOd = @tmpDataOd + 1&#xD;
END					&#xD;
	&#xD;
CREATE UNIQUE CLUSTERED INDEX bu ON #TmpDates ([Data])&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, TrE_DataOpe, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe BETWEEN @DataOd AND @DataDo&#xD;
GROUP BY TrE_MagId, TrE_TwrId, TrE_DataOpe 	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie	&#xD;
set @select =&#xD;
'DECLARE @IloscDni INT; SET @IloscDni = DATEDIFF ( D, ''' + convert(varchar, @DataOd) + ''', ''' + convert(varchar, @DataDo) + ''') + 1;					&#xD;
SELECT DB_NAME() [Baza Firmowa], REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') [Data Dzień], (datepart(DY, datediff(d, 0, twi3.data) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, twi3.data)*/ [Data Tydzień Roku], &#xD;
    MONTH(twi3.data) [Data Miesiąc], DATEPART(quarter, twi3.data) [Data Kwartał], YEAR(twi3.data) [Data Rok], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TWI.TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TWI.TwI_Wartosc, 0) [Wartość Netto], &#xD;
	ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto], @IloscDni [Liczba Dni],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END [Ilość Ostatni Dzień],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '										&#xD;
FROM cdn.TwrIlosci TWI&#xD;
	JOIN (&#xD;
		SELECT MAX(TwI_Data) as MaxData, TwI_MagId, TwI_TwrId, Data &#xD;
		FROM CDN.TwrIlosci TWI2&#xD;
		CROSS JOIN #TmpDates &#xD;
		WHERE TWI2.TwI_MagId IS NOT NULL AND TWI2.TwI_Data &lt;= Data&#xD;
		GROUP BY  TWI2.TwI_MagId, TWI2.TwI_TwrId, data &#xD;
	)TWI3 ON TWI3.TwI_TwrId = TWI.TwI_TwrId	AND TWI3.TwI_MagId = TWI.TwI_MagId AND TWI3.MaxData = TWI.TwI_Data	&#xD;
	JOIN CDN.Towary ON TWI.TwI_TwrId = Twr_TwrId	&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	JOIN CDN.Magazyny ON TWI.TwI_MagId = Mag_MagId	&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TWI.TwI_TwrId  = TwrAtr.TwA_TwrId &#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TWI.TwI_MagId = TrE_MagId AND TWI.TwI_TwrId = TrE_TwrId AND twi3.data = TrE_DataOpe&#xD;
WHERE TWI.TwI_MagId IS NOT NULL'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' AND ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #TmpDates&#xD;
DROP TABLE #tmpSprzedaz&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM3AIWZU/6OpQkKyN+6B1FNMEH/FHa55V/ecPXpX/BUjH5/7weQu7f6jdhBrBNx6P3AiZKzy23BO0YRjAvmevckX3VNkPP0BAvq8v3M+NfZET8BtSe53kLzElbQBKFW8lotLTmURks3tvU72w4S87C9ZOSpMMbKZqZWeyqfvk7BwR</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dzień" caption="Data Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Tydzień Roku" caption="Data Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Miesiąc" caption="Data Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Kwartał" caption="Data Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Rok" caption="Data Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba Dni" caption="Liczba Dni" type="measure" formatString="n0" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="n2" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Ostatni Dzień" caption="Ilość Ostatni Dzień" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" caption="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROZMIAR" caption="Produkt Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[b662e23b-484a-422f-914f-ee59cc2e54bb]" caption="Wypadkowa" type="measure" formatString="### ##0.00" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów od:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data początkowa, od której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE() - 30&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-07-03&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów do:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data końcowa, do której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-08-02&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="False" type="Line" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False" rotated="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="" angle="45" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="TopToBottom" alignmentVertical="Center" alignmentHorizontal="RightOutside" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Plan Dostaw" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;points kind="Circle" size="10" starPoints="5" borderVisible="True" borderColor="" visible="True" color=""&gt;&#xD;
    &lt;appearance color="" fillMode="Empty" /&gt;&#xD;
  &lt;/points&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX visible="True" beginText="" endText="" angle="90" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="[Data Dzień].[2012-04-22]" rangeMax="[Data Dzień].[2012-05-22]" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisX&gt;&#xD;
    &lt;axisY visible="True" beginText="" endText="" angle="0" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="-4161,6" rangeMax="15813,6" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisY&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&#xD;
  &lt;whatifMeasures&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" formula="IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Ilość/Ilość&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto/Wartość Netto&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto*Liczba Dni/Wartość Netto)&amp;#xD;&amp;#xA;" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" formula="IIF(Sprzedaż Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Wartość Netto/Sprzedaż Wartość Netto)" description="" summaryType="Default" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" formula="IIF(Sprzedaż Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Ilość Ostatni Dzień*Liczba Dni/Sprzedaż Ilość)" description="" summaryType="Default" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[b662e23b-484a-422f-914f-ee59cc2e54bb]" caption="Wypadkowa" formula="Ilość-Zamówienia" description="" summaryType="Sum" /&gt;&#xD;
  &lt;/whatifMeasures&gt;&#xD;
  &lt;sparklines /&gt;&#xD;
  &lt;customMeasures /&gt;&#xD;
  &lt;formatOptions&gt;&#xD;
    &lt;format ref="Data Dzień"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Magazyn Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Ilość"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Zamówienia"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Wartość Netto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Sprzedaż Wartość Netto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Sprzedaż Ilość"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Grupa Poziom 1"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="[Measures].[b662e23b-484a-422f-914f-ee59cc2e54bb]"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" horzAlignment="Far" format="### ##0.00" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" horzAlignment="Far" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
  &lt;/formatOptions&gt;&#xD;
  &lt;formatRules /&gt;&#xD;
  &lt;dataFields&gt;&#xD;
    &lt;data fieldName="Ilość" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Zamówienia" index="1" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Wartość Netto" index="4" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Sprzedaż Wartość Netto" index="5" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Sprzedaż Ilość" index="3" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="[Measures].[b662e23b-484a-422f-914f-ee59cc2e54bb]" index="2" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Object"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
  &lt;/dataFields&gt;&#xD;
  &lt;rowFields&gt;&#xD;
    &lt;row fieldName="Data Dzień" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/row&gt;&#xD;
  &lt;/rowFields&gt;&#xD;
  &lt;columnFields /&gt;&#xD;
  &lt;filterFields&gt;&#xD;
    &lt;filter fieldName="Produkt Kod" index="2" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
    &lt;filter fieldName="Magazyn Kod" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
    &lt;filter fieldName="Produkt Grupa Poziom 1" index="1" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
  &lt;/filterFields&gt;&#xD;
&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje rozkład w czasie planowanych dostaw towarów. Zakres dat analizy należy podać podczas uruchomienia raportu.</a:description><a:id>246</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.06 Plan dostaw</a:mainLinkName><a:modifiedOn>2014-06-02T18:48:17.593</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>13</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>8</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T14:03:06.2</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych w Zakresie Dat &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END&#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej dat&#xD;
DECLARE @tmpDataOd DATETIME;&#xD;
SET @tmpDataOd = @DataOd&#xD;
CREATE TABLE #TmpDates (Data DATETIME)&#xD;
&#xD;
WHILE @tmpDataOd&lt;=@DataDo&#xD;
BEGIN&#xD;
	INSERT INTO #TmpDates VALUES (@tmpDataOd)&#xD;
	SET @tmpDataOd = @tmpDataOd + 1&#xD;
END					&#xD;
	&#xD;
CREATE UNIQUE CLUSTERED INDEX bu ON #TmpDates ([Data])&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, TrE_DataOpe, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe BETWEEN @DataOd AND @DataDo&#xD;
GROUP BY TrE_MagId, TrE_TwrId, TrE_DataOpe 	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie	&#xD;
set @select =&#xD;
'DECLARE @IloscDni INT; SET @IloscDni = DATEDIFF ( D, ''' + convert(varchar, @DataOd) + ''', ''' + convert(varchar, @DataDo) + ''') + 1;					&#xD;
SELECT DB_NAME() [Baza Firmowa], REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') [Data Dzień], (datepart(DY, datediff(d, 0, twi3.data) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, twi3.data)*/ [Data Tydzień Roku], &#xD;
    MONTH(twi3.data) [Data Miesiąc], DATEPART(quarter, twi3.data) [Data Kwartał], YEAR(twi3.data) [Data Rok], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TWI.TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TWI.TwI_Wartosc, 0) [Wartość Netto], &#xD;
	ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto], @IloscDni [Liczba Dni],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END [Ilość Ostatni Dzień],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '										&#xD;
FROM cdn.TwrIlosci TWI&#xD;
	JOIN (&#xD;
		SELECT MAX(TwI_Data) as MaxData, TwI_MagId, TwI_TwrId, Data &#xD;
		FROM CDN.TwrIlosci TWI2&#xD;
		CROSS JOIN #TmpDates &#xD;
		WHERE TWI2.TwI_MagId IS NOT NULL AND TWI2.TwI_Data &lt;= Data&#xD;
		GROUP BY  TWI2.TwI_MagId, TWI2.TwI_TwrId, data &#xD;
	)TWI3 ON TWI3.TwI_TwrId = TWI.TwI_TwrId	AND TWI3.TwI_MagId = TWI.TwI_MagId AND TWI3.MaxData = TWI.TwI_Data	&#xD;
	JOIN CDN.Towary ON TWI.TwI_TwrId = Twr_TwrId	&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	JOIN CDN.Magazyny ON TWI.TwI_MagId = Mag_MagId	&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TWI.TwI_TwrId  = TwrAtr.TwA_TwrId &#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TWI.TwI_MagId = TrE_MagId AND TWI.TwI_TwrId = TrE_TwrId AND twi3.data = TrE_DataOpe&#xD;
WHERE TWI.TwI_MagId IS NOT NULL'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' AND ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #TmpDates&#xD;
DROP TABLE #tmpSprzedaz&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM3AIWZU/6OpQkKyN+6B1FNMEH/FHa55V/ecPXpX/BUjH5/7weQu7f6jdhBrBNx6P3AiZKzy23BO0YRjAvmevckX3VNkPP0BAvq8v3M+NfZET8BtSe53kLzElbQBKFW8lotLTmURks3tvU72w4S87C9ZOSpMMbKZqZWeyqfvk7BwR</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dzień" caption="Data Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Tydzień Roku" caption="Data Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Miesiąc" caption="Data Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Kwartał" caption="Data Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Rok" caption="Data Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba Dni" caption="Liczba Dni" type="measure" formatString="n0" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="n2" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Ostatni Dzień" caption="Ilość Ostatni Dzień" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" caption="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROZMIAR" caption="Produkt Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" type="measure" formatString="n4" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów od:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data początkowa, od której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE() - 30&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-07-03&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów do:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data końcowa, do której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-08-02&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="False" type="Bar" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False" rotated="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Top" zeroValues="False" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="TopToBottom" alignmentVertical="Center" alignmentHorizontal="RightOutside" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Wskaźniki magazynowe ilościowo" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX visible="True" beginText="" endText="" angle="90" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="[Produkt Kod].[GRABIE_LIŚCIE]" rangeMax="[Produkt Kod].[ZIEMIA_5]" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisX&gt;&#xD;
    &lt;axisY visible="True" beginText="" endText="" angle="0" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="0" rangeMax="1099999999,99989" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisY&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&#xD;
  &lt;whatifMeasures&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" formula="IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Ilość/Ilość&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto/Wartość Netto&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto*Liczba Dni/Wartość Netto)&amp;#xD;&amp;#xA;" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" formula="IIF(Sprzedaż Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Wartość Netto/Sprzedaż Wartość Netto)" description="" summaryType="Default" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" formula="IIF(Sprzedaż Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Ilość Ostatni Dzień*Liczba Dni/Sprzedaż Ilość)" description="" summaryType="Default" /&gt;&#xD;
  &lt;/whatifMeasures&gt;&#xD;
  &lt;sparklines /&gt;&#xD;
  &lt;customMeasures /&gt;&#xD;
  &lt;formatOptions&gt;&#xD;
    &lt;format ref="Produkt Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="130" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Ilość"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Sprzedaż Ilość"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Grupa Poziom 1"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n4" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
  &lt;/formatOptions&gt;&#xD;
  &lt;formatRules /&gt;&#xD;
  &lt;dataFields&gt;&#xD;
    &lt;data fieldName="Ilość" index="1" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Sprzedaż Ilość" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" index="2" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Object"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
  &lt;/dataFields&gt;&#xD;
  &lt;rowFields&gt;&#xD;
    &lt;row fieldName="Produkt Kod" index="0" expanded="True" sortMode="default" order="ascending" width="130" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/row&gt;&#xD;
  &lt;/rowFields&gt;&#xD;
  &lt;columnFields /&gt;&#xD;
  &lt;filterFields&gt;&#xD;
    &lt;filter fieldName="Produkt Grupa Poziom 1" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
  &lt;/filterFields&gt;&#xD;
&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje ilościowe wskaźniki magazynowe dla towarów. Wskaźnik liczony jest jako: Średnia Sprzedaż Ilość/Średnia Ilość na Magazynie w zadanym okresie. W przypadku jeśli ilość na magazynie wynosi 0 wartość wskaźnika wynosi 999999999.9999</a:description><a:id>247</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.07 Wskaźniki magazynowe ilościowo</a:mainLinkName><a:modifiedOn>2014-06-02T18:48:32.773</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>13</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T14:03:50.79</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych w Zakresie Dat &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END&#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej dat&#xD;
DECLARE @tmpDataOd DATETIME;&#xD;
SET @tmpDataOd = @DataOd&#xD;
CREATE TABLE #TmpDates (Data DATETIME)&#xD;
&#xD;
WHILE @tmpDataOd&lt;=@DataDo&#xD;
BEGIN&#xD;
	INSERT INTO #TmpDates VALUES (@tmpDataOd)&#xD;
	SET @tmpDataOd = @tmpDataOd + 1&#xD;
END					&#xD;
	&#xD;
CREATE UNIQUE CLUSTERED INDEX bu ON #TmpDates ([Data])&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, TrE_DataOpe, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe BETWEEN @DataOd AND @DataDo&#xD;
GROUP BY TrE_MagId, TrE_TwrId, TrE_DataOpe 	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie	&#xD;
set @select =&#xD;
'DECLARE @IloscDni INT; SET @IloscDni = DATEDIFF ( D, ''' + convert(varchar, @DataOd) + ''', ''' + convert(varchar, @DataDo) + ''') + 1;					&#xD;
SELECT DB_NAME() [Baza Firmowa], REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') [Data Dzień], (datepart(DY, datediff(d, 0, twi3.data) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, twi3.data)*/ [Data Tydzień Roku], &#xD;
    MONTH(twi3.data) [Data Miesiąc], DATEPART(quarter, twi3.data) [Data Kwartał], YEAR(twi3.data) [Data Rok], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TWI.TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TWI.TwI_Wartosc, 0) [Wartość Netto], &#xD;
	ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto], @IloscDni [Liczba Dni],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END [Ilość Ostatni Dzień],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '										&#xD;
FROM cdn.TwrIlosci TWI&#xD;
	JOIN (&#xD;
		SELECT MAX(TwI_Data) as MaxData, TwI_MagId, TwI_TwrId, Data &#xD;
		FROM CDN.TwrIlosci TWI2&#xD;
		CROSS JOIN #TmpDates &#xD;
		WHERE TWI2.TwI_MagId IS NOT NULL AND TWI2.TwI_Data &lt;= Data&#xD;
		GROUP BY  TWI2.TwI_MagId, TWI2.TwI_TwrId, data &#xD;
	)TWI3 ON TWI3.TwI_TwrId = TWI.TwI_TwrId	AND TWI3.TwI_MagId = TWI.TwI_MagId AND TWI3.MaxData = TWI.TwI_Data	&#xD;
	JOIN CDN.Towary ON TWI.TwI_TwrId = Twr_TwrId	&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	JOIN CDN.Magazyny ON TWI.TwI_MagId = Mag_MagId	&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TWI.TwI_TwrId  = TwrAtr.TwA_TwrId &#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TWI.TwI_MagId = TrE_MagId AND TWI.TwI_TwrId = TrE_TwrId AND twi3.data = TrE_DataOpe&#xD;
WHERE TWI.TwI_MagId IS NOT NULL'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' AND ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #TmpDates&#xD;
DROP TABLE #tmpSprzedaz&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM3AIWZU/6OpQkKyN+6B1FNMEH/FHa55V/ecPXpX/BUjH5/7weQu7f6jdhBrBNx6P3AiZKzy23BO0YRjAvmevckX3VNkPP0BAvq8v3M+NfZET8BtSe53kLzElbQBKFW8lotLTmURks3tvU72w4S87C9ZOSpMMbKZqZWeyqfvk7BwR</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dzień" caption="Data Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Tydzień Roku" caption="Data Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Miesiąc" caption="Data Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Kwartał" caption="Data Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Rok" caption="Data Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba Dni" caption="Liczba Dni" type="measure" formatString="n0" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="n2" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Ostatni Dzień" caption="Ilość Ostatni Dzień" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" caption="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROZMIAR" caption="Produkt Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" type="measure" formatString="n4" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów od:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data początkowa, od której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE() - 30&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-07-03&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów do:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data końcowa, do której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-08-02&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="False" type="Bar" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False" rotated="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Top" zeroValues="False" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="TopToBottom" alignmentVertical="Center" alignmentHorizontal="RightOutside" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Wskaźniki magazynowe wartościowo" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX visible="True" beginText="" endText="" angle="90" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="[Produkt Kod].[GRABIE_LIŚCIE]" rangeMax="[Produkt Kod].[ZIEMIA_5]" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisX&gt;&#xD;
    &lt;axisY visible="True" beginText="" endText="" angle="0" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="0" rangeMax="1099999999,99989" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisY&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="False" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&#xD;
  &lt;whatifMeasures&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" formula="IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Ilość/Ilość&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto/Wartość Netto&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto*Liczba Dni/Wartość Netto)&amp;#xD;&amp;#xA;" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" formula="IIF(Sprzedaż Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Wartość Netto/Sprzedaż Wartość Netto)" description="" summaryType="Default" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" formula="IIF(Sprzedaż Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Ilość Ostatni Dzień*Liczba Dni/Sprzedaż Ilość)" description="" summaryType="Default" /&gt;&#xD;
  &lt;/whatifMeasures&gt;&#xD;
  &lt;sparklines /&gt;&#xD;
  &lt;customMeasures /&gt;&#xD;
  &lt;formatOptions&gt;&#xD;
    &lt;format ref="Produkt Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="130" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Wartość Netto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Sprzedaż Wartość Netto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="129" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Grupa Poziom 1"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n4" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
  &lt;/formatOptions&gt;&#xD;
  &lt;formatRules /&gt;&#xD;
  &lt;dataFields&gt;&#xD;
    &lt;data fieldName="Wartość Netto" index="1" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Sprzedaż Wartość Netto" index="0" expanded="True" sortMode="default" order="ascending" width="129" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" index="2" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Object"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
  &lt;/dataFields&gt;&#xD;
  &lt;rowFields&gt;&#xD;
    &lt;row fieldName="Produkt Kod" index="0" expanded="True" sortMode="default" order="ascending" width="130" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/row&gt;&#xD;
  &lt;/rowFields&gt;&#xD;
  &lt;columnFields /&gt;&#xD;
  &lt;filterFields&gt;&#xD;
    &lt;filter fieldName="Produkt Grupa Poziom 1" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
  &lt;/filterFields&gt;&#xD;
&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje wartościowe wskaźniki magazynowe dla towarów. Wskaźnik liczony jest jako: Średnia Sprzedaż Wartość/Średnia Wartość na Magazynie w zadanym okresie. W przypadku jeśli wartość na magazynie wynosi 0 wartość wskaźnika wynosi 999999999.9999</a:description><a:id>248</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.08 Wskaźniki magazynowe wartościowo</a:mainLinkName><a:modifiedOn>2014-06-02T18:48:40.037</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>13</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-05-16T15:05:58.25</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych w Zakresie Dat &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END&#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej dat&#xD;
DECLARE @tmpDataOd DATETIME;&#xD;
SET @tmpDataOd = @DataOd&#xD;
CREATE TABLE #TmpDates (Data DATETIME)&#xD;
&#xD;
WHILE @tmpDataOd&lt;=@DataDo&#xD;
BEGIN&#xD;
	INSERT INTO #TmpDates VALUES (@tmpDataOd)&#xD;
	SET @tmpDataOd = @tmpDataOd + 1&#xD;
END					&#xD;
	&#xD;
CREATE UNIQUE CLUSTERED INDEX bu ON #TmpDates ([Data])&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, TrE_DataOpe, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe BETWEEN @DataOd AND @DataDo&#xD;
GROUP BY TrE_MagId, TrE_TwrId, TrE_DataOpe 	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie	&#xD;
set @select =&#xD;
'DECLARE @IloscDni INT; SET @IloscDni = DATEDIFF ( D, ''' + convert(varchar, @DataOd) + ''', ''' + convert(varchar, @DataDo) + ''') + 1;					&#xD;
SELECT DB_NAME() [Baza Firmowa], REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') [Data Dzień], (datepart(DY, datediff(d, 0, twi3.data) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, twi3.data)*/ [Data Tydzień Roku], &#xD;
    MONTH(twi3.data) [Data Miesiąc], DATEPART(quarter, twi3.data) [Data Kwartał], YEAR(twi3.data) [Data Rok], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TWI.TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TWI.TwI_Wartosc, 0) [Wartość Netto], &#xD;
	ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto], @IloscDni [Liczba Dni],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END [Ilość Ostatni Dzień],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '										&#xD;
FROM cdn.TwrIlosci TWI&#xD;
	JOIN (&#xD;
		SELECT MAX(TwI_Data) as MaxData, TwI_MagId, TwI_TwrId, Data &#xD;
		FROM CDN.TwrIlosci TWI2&#xD;
		CROSS JOIN #TmpDates &#xD;
		WHERE TWI2.TwI_MagId IS NOT NULL AND TWI2.TwI_Data &lt;= Data&#xD;
		GROUP BY  TWI2.TwI_MagId, TWI2.TwI_TwrId, data &#xD;
	)TWI3 ON TWI3.TwI_TwrId = TWI.TwI_TwrId	AND TWI3.TwI_MagId = TWI.TwI_MagId AND TWI3.MaxData = TWI.TwI_Data	&#xD;
	JOIN CDN.Towary ON TWI.TwI_TwrId = Twr_TwrId	&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	JOIN CDN.Magazyny ON TWI.TwI_MagId = Mag_MagId	&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TWI.TwI_TwrId  = TwrAtr.TwA_TwrId &#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TWI.TwI_MagId = TrE_MagId AND TWI.TwI_TwrId = TrE_TwrId AND twi3.data = TrE_DataOpe&#xD;
WHERE TWI.TwI_MagId IS NOT NULL'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' AND ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #TmpDates&#xD;
DROP TABLE #tmpSprzedaz&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM3AIWZU/6OpQkKyN+6B1FNMEH/FHa55V/ecPXpX/BUjHY54g8jq1HppDj0dffzI+lnwe/MhccaIK40ZJucpEjlxRBKY5xwhONPk/2LrER9zGAEIirCQbmHR3u6WW1dBzkysz2DRyg9UJ563CZP1mCha0J1t+onT6VKEiyOKtBiZx</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dzień" caption="Data Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Tydzień Roku" caption="Data Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Miesiąc" caption="Data Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Kwartał" caption="Data Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Rok" caption="Data Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba Dni" caption="Liczba Dni" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="n2" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Ostatni Dzień" caption="Ilość Ostatni Dzień" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" caption="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR FS" caption="Produkt Atrybut NR FS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut WILGOTNOSC" caption="Produkt Atrybut WILGOTNOSC" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów od:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data początkowa, od której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE() - 30&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-07-03&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów do:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data końcowa, do której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-08-02&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="False" type="Bar" palette="In A Fog" paletteBaseColor="0" style="In A Fog" grandTotals="False" subTotals="False" onlySelected="False" showSeriesInSeparatePanes="False" fieldVisible="False" rotated="False" dataVertical="True" showParametersValues="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Top" zeroValues="False" textIndent="2" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1" textOrientation="Horizontal"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="Black" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="TopToBottom" alignmentVertical="Center" alignmentHorizontal="RightOutside" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100" location="{X=1319,Y=427}" isCustomLocation="False"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="Black" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Rotacja w razach" visible="True" dock="Top" alignment="Center" indent="5" location="{X=723,Y=5}" isCustomLocation="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="Black" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;pointOptions pointView="Values" pattern="{V}"&gt;&#xD;
    &lt;valueNumericOptions numericFormat="General" numericPrecision="2" /&gt;&#xD;
    &lt;valueDateTimeOptions dateTimeFormat="ShortDate" dateTimeFormatString="" /&gt;&#xD;
    &lt;argumentNumericOptions numericFormat="General" numericPrecision="2" /&gt;&#xD;
    &lt;argumentDateTimeOptions dateTimeFormat="ShortDate" dateTimeFormatString="" /&gt;&#xD;
  &lt;/pointOptions&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX visible="True" beginText="" endText="" angle="90" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="Black" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="[Produkt Kod].[AAA]" rangeMax="[Produkt Kod].[ZIEMIA_5]" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisX&gt;&#xD;
    &lt;axisY visible="True" beginText="" endText="" angle="0" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="Black" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="0" rangeMax="1" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisY&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&#xD;
  &lt;whatifMeasures&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" formula="IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Ilość/Ilość&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto/Wartość Netto&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto*Liczba Dni/Wartość Netto)&amp;#xD;&amp;#xA;" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" formula="IIF(Sprzedaż Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Wartość Netto/Sprzedaż Wartość Netto)" description="" summaryType="Default" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" formula="IIF(Sprzedaż Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Ilość Ostatni Dzień*Liczba Dni/Sprzedaż Ilość)" description="" summaryType="Default" /&gt;&#xD;
  &lt;/whatifMeasures&gt;&#xD;
  &lt;sparklines /&gt;&#xD;
  &lt;customMeasures /&gt;&#xD;
  &lt;formatOptions&gt;&#xD;
    &lt;format ref="Produkt Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Wartość Netto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" horzAlignment="Near" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" horzAlignment="Far" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Liczba Dni"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" horzAlignment="Near" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" horzAlignment="Far" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Sprzedaż Wartość Netto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" horzAlignment="Near" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" horzAlignment="Far" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Grupa Poziom 1"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]"&gt;&#xD;
      &lt;cells fontName="Segoe UI" fontSize="8.25" horzAlignment="Far" format="n2" /&gt;&#xD;
      &lt;header fontName="Segoe UI" fontSize="8" horzAlignment="Near" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&#xD;
      &lt;totals fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&#xD;
      &lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" horzAlignment="Near" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" horzAlignment="Far" /&gt;&#xD;
    &lt;/format&gt;&#xD;
  &lt;/formatOptions&gt;&#xD;
  &lt;formatRules /&gt;&#xD;
  &lt;dataFields&gt;&#xD;
    &lt;data fieldName="Wartość Netto" index="1" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Liczba Dni" index="2" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="True" showBlanks="True" type="System.Int32"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Sprzedaż Wartość Netto" index="3" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="True" showBlanks="True" type="System.Object"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
  &lt;/dataFields&gt;&#xD;
  &lt;rowFields&gt;&#xD;
    &lt;row fieldName="Produkt Kod" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/row&gt;&#xD;
  &lt;/rowFields&gt;&#xD;
  &lt;columnFields /&gt;&#xD;
  &lt;filterFields&gt;&#xD;
    &lt;filter fieldName="Produkt Grupa Poziom 1" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
  &lt;/filterFields&gt;&#xD;
&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje wartość wskaźnika rotacji w razach dla towarów. Informuje on ile razy nastąpiła całkowita wymiana towaru na magazynie w zadanym okresie.&#xD;
Rotacja w razach liczona jest jako: Sprzedaż Wartość w zadanym okresie/Średnia Wartość na magazynie w zadanym okresie. Jeśli średnia wartość wynosi 0 wskaźnik przyjmuje wartość 999999999.9999</a:description><a:id>249</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.09 Rotacja w razach</a:mainLinkName><a:modifiedOn>2014-06-02T18:49:28.033</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>13</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-05-16T15:37:04.287</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych w Zakresie Dat &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END&#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej dat&#xD;
DECLARE @tmpDataOd DATETIME;&#xD;
SET @tmpDataOd = @DataOd&#xD;
CREATE TABLE #TmpDates (Data DATETIME)&#xD;
&#xD;
WHILE @tmpDataOd&lt;=@DataDo&#xD;
BEGIN&#xD;
	INSERT INTO #TmpDates VALUES (@tmpDataOd)&#xD;
	SET @tmpDataOd = @tmpDataOd + 1&#xD;
END					&#xD;
	&#xD;
CREATE UNIQUE CLUSTERED INDEX bu ON #TmpDates ([Data])&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, TrE_DataOpe, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe BETWEEN @DataOd AND @DataDo&#xD;
GROUP BY TrE_MagId, TrE_TwrId, TrE_DataOpe 	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie	&#xD;
set @select =&#xD;
'DECLARE @IloscDni INT; SET @IloscDni = DATEDIFF ( D, ''' + convert(varchar, @DataOd) + ''', ''' + convert(varchar, @DataDo) + ''') + 1;					&#xD;
SELECT DB_NAME() [Baza Firmowa], REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') [Data Dzień], (datepart(DY, datediff(d, 0, twi3.data) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, twi3.data)*/ [Data Tydzień Roku], &#xD;
    MONTH(twi3.data) [Data Miesiąc], DATEPART(quarter, twi3.data) [Data Kwartał], YEAR(twi3.data) [Data Rok], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TWI.TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TWI.TwI_Wartosc, 0) [Wartość Netto], &#xD;
	ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto], @IloscDni [Liczba Dni],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END [Ilość Ostatni Dzień],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '										&#xD;
FROM cdn.TwrIlosci TWI&#xD;
	JOIN (&#xD;
		SELECT MAX(TwI_Data) as MaxData, TwI_MagId, TwI_TwrId, Data &#xD;
		FROM CDN.TwrIlosci TWI2&#xD;
		CROSS JOIN #TmpDates &#xD;
		WHERE TWI2.TwI_MagId IS NOT NULL AND TWI2.TwI_Data &lt;= Data&#xD;
		GROUP BY  TWI2.TwI_MagId, TWI2.TwI_TwrId, data &#xD;
	)TWI3 ON TWI3.TwI_TwrId = TWI.TwI_TwrId	AND TWI3.TwI_MagId = TWI.TwI_MagId AND TWI3.MaxData = TWI.TwI_Data	&#xD;
	JOIN CDN.Towary ON TWI.TwI_TwrId = Twr_TwrId	&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	JOIN CDN.Magazyny ON TWI.TwI_MagId = Mag_MagId	&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TWI.TwI_TwrId  = TwrAtr.TwA_TwrId &#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TWI.TwI_MagId = TrE_MagId AND TWI.TwI_TwrId = TrE_TwrId AND twi3.data = TrE_DataOpe&#xD;
WHERE TWI.TwI_MagId IS NOT NULL'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' AND ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #TmpDates&#xD;
DROP TABLE #tmpSprzedaz&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM3AIWZU/6OpQkKyN+6B1FNMEH/FHa55V/ecPXpX/BUjHY54g8jq1HppDj0dffzI+lnwe/MhccaIK40ZJucpEjlxRBKY5xwhONPk/2LrER9zGAEIirCQbmHR3u6WW1dBzkysz2DRyg9UJ563CZP1mCha0J1t+onT6VKEiyOKtBiZx</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dzień" caption="Data Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Tydzień Roku" caption="Data Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Miesiąc" caption="Data Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Kwartał" caption="Data Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Rok" caption="Data Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba Dni" caption="Liczba Dni" type="measure" formatString="n0" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="n2" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Ostatni Dzień" caption="Ilość Ostatni Dzień" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" caption="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR FS" caption="Produkt Atrybut NR FS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut WILGOTNOSC" caption="Produkt Atrybut WILGOTNOSC" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów od:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data początkowa, od której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE() - 30&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-07-03&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów do:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data końcowa, do której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-08-02&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="False" type="Bar" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False" rotated="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Top" zeroValues="False" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="TopToBottom" alignmentVertical="Center" alignmentHorizontal="RightOutside" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Rotacja w dniach" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX visible="True" beginText="" endText="" angle="90" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="[Produkt Kod].[GRABIE_LIŚCIE]" rangeMax="[Produkt Kod].[ZIEMIA_5]" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisX&gt;&#xD;
    &lt;axisY visible="True" beginText="" endText="" angle="0" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="0" rangeMax="1099999999,989" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisY&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&#xD;
  &lt;whatifMeasures&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" formula="IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Ilość/Ilość&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto/Wartość Netto&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto*Liczba Dni/Wartość Netto)&amp;#xD;&amp;#xA;" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" formula="IIF(Sprzedaż Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Wartość Netto/Sprzedaż Wartość Netto)" description="" summaryType="Default" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" formula="IIF(Sprzedaż Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Ilość Ostatni Dzień*Liczba Dni/Sprzedaż Ilość)" description="" summaryType="Default" /&gt;&#xD;
  &lt;/whatifMeasures&gt;&#xD;
  &lt;sparklines /&gt;&#xD;
  &lt;customMeasures /&gt;&#xD;
  &lt;formatOptions&gt;&#xD;
    &lt;format ref="Produkt Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Wartość Netto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Sprzedaż Wartość Netto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Grupa Poziom 1"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="[Measures].[48297393-873c-490e-9506-55cc4454cba4]"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
  &lt;/formatOptions&gt;&#xD;
  &lt;formatRules /&gt;&#xD;
  &lt;dataFields&gt;&#xD;
    &lt;data fieldName="Wartość Netto" index="2" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Sprzedaż Wartość Netto" index="1" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Object"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
  &lt;/dataFields&gt;&#xD;
  &lt;rowFields&gt;&#xD;
    &lt;row fieldName="Produkt Kod" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/row&gt;&#xD;
  &lt;/rowFields&gt;&#xD;
  &lt;columnFields /&gt;&#xD;
  &lt;filterFields&gt;&#xD;
    &lt;filter fieldName="Produkt Grupa Poziom 1" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
  &lt;/filterFields&gt;&#xD;
&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje wartość wskaźnika rotacji w dniach dla towarów. Informuje on co ile dni średnio nastąpiła całkowita wymiana towaru na magazynie w zadanym okresie.&#xD;
Rotacja w dniach liczona jest jako: Średnia Wartość na magazynie w zadanym okresie / Sprzedaż Wartość w zadanym okresie * Liczba dni w okresie. Jeśli wartość sprzedaży wynosi 0 wskaźnik przyjmuje wartość 999999999.9999</a:description><a:id>250</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.10 Rotacja w dniach</a:mainLinkName><a:modifiedOn>2014-06-02T18:49:31.113</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>13</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-05-16T15:37:50.077</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych w Zakresie Dat &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END&#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej dat&#xD;
DECLARE @tmpDataOd DATETIME;&#xD;
SET @tmpDataOd = @DataOd&#xD;
CREATE TABLE #TmpDates (Data DATETIME)&#xD;
&#xD;
WHILE @tmpDataOd&lt;=@DataDo&#xD;
BEGIN&#xD;
	INSERT INTO #TmpDates VALUES (@tmpDataOd)&#xD;
	SET @tmpDataOd = @tmpDataOd + 1&#xD;
END					&#xD;
	&#xD;
CREATE UNIQUE CLUSTERED INDEX bu ON #TmpDates ([Data])&#xD;
&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, TrE_DataOpe, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
	AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
	AND TrE_DataOpe BETWEEN @DataOd AND @DataDo&#xD;
GROUP BY TrE_MagId, TrE_TwrId, TrE_DataOpe 	&#xD;
&#xD;
&#xD;
--Właściwe zapytanie	&#xD;
set @select =&#xD;
'DECLARE @IloscDni INT; SET @IloscDni = DATEDIFF ( D, ''' + convert(varchar, @DataOd) + ''', ''' + convert(varchar, @DataDo) + ''') + 1;					&#xD;
SELECT DB_NAME() [Baza Firmowa], REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') [Data Dzień], (datepart(DY, datediff(d, 0, twi3.data) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, twi3.data)*/ [Data Tydzień Roku], &#xD;
    MONTH(twi3.data) [Data Miesiąc], DATEPART(quarter, twi3.data) [Data Kwartał], YEAR(twi3.data) [Data Rok], &#xD;
&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
	&#xD;
	Mag_Symbol [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
	ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
	ISNULL(TWI.TwI_Ilosc, 0) [Ilość], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Rezerwacje Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Braki, 0) [Braki], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
	ISNULL(TWI.TwI_Zamowienia, 0) [Zamówienia], &#xD;
	CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN ISNULL(TWI.TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
	ISNULL(TWI.TwI_Wartosc, 0) [Wartość Netto], &#xD;
	ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto], @IloscDni [Liczba Dni],&#xD;
	NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
	CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END [Ilość Ostatni Dzień],&#xD;
	SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
	' + @kolumny + @atrybutyTwr + '										&#xD;
FROM cdn.TwrIlosci TWI&#xD;
	JOIN (&#xD;
		SELECT MAX(TwI_Data) as MaxData, TwI_MagId, TwI_TwrId, Data &#xD;
		FROM CDN.TwrIlosci TWI2&#xD;
		CROSS JOIN #TmpDates &#xD;
		WHERE TWI2.TwI_MagId IS NOT NULL AND TWI2.TwI_Data &lt;= Data&#xD;
		GROUP BY  TWI2.TwI_MagId, TWI2.TwI_TwrId, data &#xD;
	)TWI3 ON TWI3.TwI_TwrId = TWI.TwI_TwrId	AND TWI3.TwI_MagId = TWI.TwI_MagId AND TWI3.MaxData = TWI.TwI_Data	&#xD;
	JOIN CDN.Towary ON TWI.TwI_TwrId = Twr_TwrId	&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
	LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
	JOIN CDN.Magazyny ON TWI.TwI_MagId = Mag_MagId	&#xD;
	LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
	LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TWI.TwI_TwrId  = TwrAtr.TwA_TwrId &#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TWI.TwI_MagId = TrE_MagId AND TWI.TwI_TwrId = TrE_TwrId AND twi3.data = TrE_DataOpe&#xD;
WHERE TWI.TwI_MagId IS NOT NULL'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' AND ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #TmpDates&#xD;
DROP TABLE #tmpSprzedaz&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM3AIWZU/6OpQkKyN+6B1FNMEH/FHa55V/ecPXpX/BUjHY54g8jq1HppDj0dffzI+lnwe/MhccaIK40ZJucpEjlxRBKY5xwhONPk/2LrER9zGAEIirCQbmHR3u6WW1dBzkysz2DRyg9UJ563CZP1mCha0J1t+onT6VKEiyOKtBiZx</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dzień" caption="Data Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Tydzień Roku" caption="Data Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Miesiąc" caption="Data Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Kwartał" caption="Data Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Rok" caption="Data Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba Dni" caption="Liczba Dni" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="n2" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Ostatni Dzień" caption="Ilość Ostatni Dzień" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" caption="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR FS" caption="Produkt Atrybut NR FS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut WILGOTNOSC" caption="Produkt Atrybut WILGOTNOSC" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów od:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data początkowa, od której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE() - 30&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-07-03&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów do:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data końcowa, do której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2012-08-02&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="False" type="Bar" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False" rotated="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Top" zeroValues="False" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="TopToBottom" alignmentVertical="Center" alignmentHorizontal="RightOutside" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Days of Sales" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX visible="True" beginText="" endText="" angle="90" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="[Produkt Kod].[GRABIE_LIŚCIE]" rangeMax="[Produkt Kod].[ZIEMIA_5]" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisX&gt;&#xD;
    &lt;axisY visible="True" beginText="" endText="" angle="0" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="0" rangeMax="1099999999,989" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisY&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&#xD;
  &lt;whatifMeasures&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" formula="IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Ilość/Ilość&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto/Wartość Netto&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto*Liczba Dni/Wartość Netto)&amp;#xD;&amp;#xA;" description="" summaryType="Sum" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" formula="IIF(Sprzedaż Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Wartość Netto/Sprzedaż Wartość Netto)" description="" summaryType="Default" /&gt;&#xD;
    &lt;whatifMeasure uniqueName="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" formula="IIF(Sprzedaż Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Ilość Ostatni Dzień*Liczba Dni/Sprzedaż Ilość)" description="" summaryType="Default" /&gt;&#xD;
  &lt;/whatifMeasures&gt;&#xD;
  &lt;sparklines /&gt;&#xD;
  &lt;customMeasures /&gt;&#xD;
  &lt;formatOptions&gt;&#xD;
    &lt;format ref="Produkt Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Liczba Dni"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Ilość Ostatni Dzień"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Sprzedaż Ilość"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Grupa Poziom 1"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
  &lt;/formatOptions&gt;&#xD;
  &lt;formatRules /&gt;&#xD;
  &lt;dataFields&gt;&#xD;
    &lt;data fieldName="Liczba Dni" index="3" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Int32"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Ilość Ostatni Dzień" index="2" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Sprzedaż Ilość" index="1" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Object"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
  &lt;/dataFields&gt;&#xD;
  &lt;rowFields&gt;&#xD;
    &lt;row fieldName="Produkt Kod" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/row&gt;&#xD;
  &lt;/rowFields&gt;&#xD;
  &lt;columnFields /&gt;&#xD;
  &lt;filterFields&gt;&#xD;
    &lt;filter fieldName="Produkt Grupa Poziom 1" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
  &lt;/filterFields&gt;&#xD;
&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje wartość wskaźnika Days of Sales dla towarów. Informuje on o tym na ile dni wystarczy zapasów magazynowych z ostatniego dnia okresu analizy przy zachowaniu średniego poziomu sprzedaży z tego okresu. &#xD;
Wskaźnik liczony jako: Ilość w Ostatnim Dniu Okresu/Średnia Sprzedaż Dzienna w Zadanym Okresie. Jeśli średnia sprzedaż wynosi zero wskaźnik przyjmuje wartość 999999999.99</a:description><a:id>251</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.11 Days of Sales</a:mainLinkName><a:modifiedOn>2014-06-02T18:49:36.273</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>13</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T14:11:43.25</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Dokumentów Magazynowych &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.KnA_WartoscTxt END  &#xD;
		FROM CDN.KntAtrybuty ATR &#xD;
		JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
		WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.DAt_WartoscTxt END  &#xD;
		FROM CDN.DokAtrybuty ATR &#xD;
		JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
		WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_Typ = 1&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_format;&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', &#xD;
	CASE &#xD;
		WHEN TrE_Atr1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr1_Wartosc END &#xD;
		WHEN TrE_Atr2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr2_Wartosc END &#xD;
		WHEN TrE_Atr3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr3_Wartosc END  &#xD;
		WHEN TrE_Atr4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr4_Wartosc END  &#xD;
		WHEN TrE_Atr5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr5_Wartosc END  &#xD;
		ELSE ''(NIEPRZYPISANE)''&#xD;
	END AS [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
SELECT DB_NAME() [Baza Firmowa], &#xD;
&#xD;
	TrN_NumerPelny [Dokument Numer], &#xD;
	CASE								&#xD;
		WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
		WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
		WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
		WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
		WHEN TrN_TypDokumentu = 304 THEN 25030&#xD;
		WHEN TrN_TypDokumentu = 318 THEN 25046&#xD;
		WHEN TrN_TypDokumentu = 306 THEN 25022&#xD;
		WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
		WHEN TrN_TypDokumentu = 314 THEN 25078&#xD;
	END [Dokument Numer __PROCID__WZ__], TrN_TrNId [Dokument Numer __ORGID__],&#xD;
&#xD;
&#xD;
ISNULL(NULLIF(TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
	CASE								&#xD;
		WHEN TrN_TypDokumentu = 312 THEN ''MM''&#xD;
		WHEN TrN_TypDokumentu = 303 THEN ''PW''&#xD;
		WHEN TrN_TypDokumentu = 317 THEN ''PWP''&#xD;
		WHEN TrN_TypDokumentu = 307 THEN ''PZ''&#xD;
		WHEN TrN_TypDokumentu = 304 THEN ''RW''&#xD;
		WHEN TrN_TypDokumentu = 318 THEN ''RWS''&#xD;
		WHEN TrN_TypDokumentu = 306 THEN ''WZ''&#xD;
		WHEN TrN_TypDokumentu = 313 THEN ''PKA''&#xD;
		WHEN TrN_TypDokumentu = 314 THEN ''WKA''&#xD;
	ELSE ''(NIEPRZYPISANY)'' END [Dokument Typ],&#xD;
	&#xD;
	pod1.Pod_Nazwa1 [Kontrahent Nazwa],&#xD;
	20201 [Kontrahent Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Nazwa __ORGID__],&#xD;
	&#xD;
	pod1.Pod_Kod [Kontrahent Kod],&#xD;
	20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod1.Pod_PodId [Kontrahent Kod __ORGID__],&#xD;
	&#xD;
	 ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
	ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Miasto], ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa], &#xD;
    CASE &#xD;
		WHEN Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
		WHEN Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
	ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Opiekun],&#xD;
	zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
	ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
	ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu],&#xD;
    &#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	poz.sciezka [Produkt Pełna Nazwa Grupy], Twr_Jm [Jednostka Miary], &#xD;
	&#xD;
	ISNULL(Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna],&#xD;
    REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataOpe)*/ [Data Operacji Tydzień Roku], &#xD;
    MONTH(TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TrN_DataOpe) [Data Operacji Kwartał], YEAR(TrN_DataOpe) [Data Operacji Rok], &#xD;
    TR.TrE_WartoscNetto [Wartość Netto], TR.TrE_WartoscBrutto [Wartość Brutto], TR.TrE_WartoscNettoWal [Wartość Waluta], TR.TrE_Ilosc [Ilość], &#xD;
    TR.TrE_WartoscNetto - (ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi) [Marża], ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi [Koszt Zakupu] '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
       &#xD;
set @select2 = &#xD;
' FROM cdn.TraNag &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID &#xD;
     LEFT OUTER JOIN CDN.Kontrahenci ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny ON TrE_MagId=Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
	 LEFT JOIN ' + @Operatorzy + ' zal ON TrN_OpeZalID = zal.Ope_OpeId&#xD;
	 LEFT JOIN ' + @Operatorzy + ' mod ON TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN ( &#xD;
			SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
			FROM CDN.TraElem TRE&#xD;
			JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
				   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 )&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
	)KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
WHERE&#xD;
TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
AND TrN_Bufor&lt;&gt;-1&#xD;
AND TrE_Aktywny&lt;&gt;0'&#xD;
&#xD;
exec (@select + @select2)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM3AIWZU/6OpQkKyN+6B1FNMEH/FHa55V/ecPXpX/BUjH5/7weQu7f6jdhBrBNx6P3AiZKzy23BO0YRjAvmevckX3VNkPP0BAvq8v3M+NfZET8BtSe53kLzElbQBKFW8lotLTmURks3tvU72w4S87C9ZOSpMMbKZqZWeyqfvk7BwR</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Symbol" caption="Dokument Symbol" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Opis" caption="Dokument Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Waluta" caption="Waluta" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Seria" caption="Dokument Seria" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Nazwa" caption="Kontrahent Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kod" caption="Kontrahent Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Województwo" caption="Kontrahent Pierwotny Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Powiat" caption="Kontrahent Pierwotny Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Miasto" caption="Kontrahent Pierwotny Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kraj" caption="Kontrahent Pierwotny Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny NIP" caption="Kontrahent Pierwotny NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Grupa" caption="Kontrahent Pierwotny Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Opiekun" caption="Kontrahent Pierwotny Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Powiat" caption="Kontrahent Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kraj" caption="Kontrahent Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent NIP" caption="Kontrahent NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Nazwa" caption="Odbiorca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kod" caption="Odbiorca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Województwo" caption="Odbiorca Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Powiat" caption="Odbiorca Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Miasto" caption="Odbiorca Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kraj" caption="Odbiorca Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca NIP" caption="Odbiorca NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Grupa" caption="Odbiorca Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Wprowadzający" caption="Operator Wprowadzający" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Modyfikujący" caption="Operator Modyfikujący" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Magazyn Docelowy Kod" caption="Magazyn Docelowy Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Marża" caption="Marża" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Koszt Zakupu" caption="Koszt Zakupu" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut KLUCZOWY" caption="Kontrahent Pierwotny Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut KLUCZOWY" caption="Kontrahent Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut PROJEKTY PARKI" caption="Kontrahent Pierwotny Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut PROJEKTY PARKI" caption="Kontrahent Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut STATUS" caption="Kontrahent Pierwotny Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut STATUS" caption="Kontrahent Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut PROJEKTY PARKI (K)" caption="Dokument Atrybut PROJEKTY PARKI (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS (K)" caption="Dokument Atrybut STATUS (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROZMIAR" caption="Produkt Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut PIELĘGNACJA" caption="Pozycja Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut KOLOR" caption="Pozycja Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut DATA WAŻNOŚCI" caption="Pozycja Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut NR SERYJNY" caption="Pozycja Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut ATRYBUTZASOBU" caption="Pozycja Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut ROZMIAR" caption="Pozycja Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="False" type="Bar" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False" rotated="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Top" zeroValues="False" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="LeftToRight" equallySpaces="False" alignmentVertical="BottomOutside" alignmentHorizontal="Center" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Analiza dokumentów wg towarów" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX visible="True" beginText="" endText="" angle="90" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="[Produkt Kod].[TUJE_3L]" rangeMax="[Produkt Kod].[SADZONKI]" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisX&gt;&#xD;
    &lt;axisY visible="True" beginText="" endText="" angle="0" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="0" rangeMax="168326,576" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisY&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAMAAAAHAAAABwIeW1Byb2R1a3QgS29kXS5bVE9XQVJURVNURkFGWjJdBwITW1Byb2R1a3QgS29kXS5bQUFBXQcCHVtQcm9kdWt0IEtvZF0uW1RPV0FSVEVTRkFGWjNdBwIdW1Byb2R1a3QgS29kXS5bVE9XQVJURVNURkFGWl0HAhRbUHJvZHVrdCBLb2RdLltaRFBaXQcCGltQcm9kdWt0IEtvZF0uW1BST0pfQVJDSEldBwIcW1Byb2R1a3QgS29kXS5bUElFTMSYR05BQ0pBXf////8YAAAABwIXW1Byb2R1a3QgS29kXS5bVFVKRV8zTF0HAhlbUHJvZHVrdCBLb2RdLltOT1dZVE9XQVJdBwIZW1Byb2R1a3QgS29kXS5bUsOTxbtBX1BOXQcCGFtQcm9kdWt0IEtvZF0uW0tPUkFfUzgwXQcCHltQcm9kdWt0IEtvZF0uW0dSQUJJRV9MScWaQ0lFXQcCH1tQcm9kdWt0IEtvZF0uW1BJxYFBX1NQQUxJTk9XQV0HAhdbUHJvZHVrdCBLb2RdLltTWlBBREVMXQcCG1tQcm9kdWt0IEtvZF0uW05PxbtZQ0VfRUwuXQcCGVtQcm9kdWt0IEtvZF0uW0pBQsWBT05JRV0HAhxbUHJvZHVrdCBLb2RdLltQScWBQV9FTEVLVFJdBwIgW1Byb2R1a3QgS29kXS5bSUdMQUtJX0pBxYFPV0lFQ10HAhpbUHJvZHVrdCBLb2RdLltHUkFCSUVfT0dSXQcCF1tQcm9kdWt0IEtvZF0uW1NFS0FUT1JdBwIaW1Byb2R1a3QgS29kXS5bT0RLX0xJxZpDSV0HAhxbUHJvZHVrdCBLb2RdLltST1pEUkFCTklBQ1pdBwIdW1Byb2R1a3QgS29kXS5bSUdMQUtJX0NZUFJZU10HAhhbUHJvZHVrdCBLb2RdLltaSUVNSUFfNV0HAhZbUHJvZHVrdCBLb2RdLltTVE9KQUtdBwIYW1Byb2R1a3QgS29kXS5bU0tSWllOS0FdBwIaW1Byb2R1a3QgS29kXS5bWkVTVEFXX09HUl0HAhZbUHJvZHVrdCBLb2RdLltQQUxFVEFdBwIiW1Byb2R1a3QgS29kXS5bxYFBxYNDVUNIIERPIFBJxYFZXQcCGltQcm9kdWt0IEtvZF0uW1RFU1RLT1JFS1RdBwIYW1Byb2R1a3QgS29kXS5bU0FEWk9OS0ld</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="False" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&#xD;
  &lt;sparklines /&gt;&#xD;
  &lt;customMeasures /&gt;&#xD;
  &lt;formatOptions&gt;&#xD;
    &lt;format ref="Dokument Typ"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Nazwa"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="173" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Kod"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="105" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Data Operacji Dzień"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Data Operacji Miesiąc"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Data Operacji Rok"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Wartość Netto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Wartość Brutto"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Ilość"&gt;&#xD;
      &lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
    &lt;format ref="Produkt Grupa Poziom 1"&gt;&#xD;
      &lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&#xD;
      &lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
      &lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&#xD;
    &lt;/format&gt;&#xD;
  &lt;/formatOptions&gt;&#xD;
  &lt;formatRules /&gt;&#xD;
  &lt;dataFields&gt;&#xD;
    &lt;data fieldName="Wartość Netto" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Wartość Brutto" index="1" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
    &lt;data fieldName="Ilość" index="2" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/data&gt;&#xD;
  &lt;/dataFields&gt;&#xD;
  &lt;rowFields&gt;&#xD;
    &lt;row fieldName="Produkt Nazwa" index="1" expanded="True" sortMode="default" order="ascending" width="173" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/row&gt;&#xD;
    &lt;row fieldName="Produkt Kod" index="0" expanded="True" sortMode="displayText" order="descending" width="105" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&#xD;
      &lt;sortBy dataFieldName="Wartość Netto" /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/row&gt;&#xD;
  &lt;/rowFields&gt;&#xD;
  &lt;columnFields /&gt;&#xD;
  &lt;filterFields&gt;&#xD;
    &lt;filter fieldName="Dokument Typ" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
    &lt;filter fieldName="Data Operacji Dzień" index="4" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
    &lt;filter fieldName="Data Operacji Miesiąc" index="3" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Int32"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
    &lt;filter fieldName="Data Operacji Rok" index="2" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.Int32"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
    &lt;filter fieldName="Produkt Grupa Poziom 1" index="1" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&#xD;
      &lt;sortBy /&gt;&#xD;
      &lt;orderedMembers /&gt;&#xD;
      &lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&#xD;
        &lt;excluded /&gt;&#xD;
      &lt;/filters&gt;&#xD;
      &lt;measuresFilter /&gt;&#xD;
    &lt;/filter&gt;&#xD;
  &lt;/filterFields&gt;&#xD;
&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje informacje o ilości i wartości towarów na podstawie dokumentów magazynowych. Do poprawnej analizy należy wybrać typ dokumentu, który ma być analizowany.</a:description><a:id>252</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.12 Analiza dokumentów wg towarów</a:mainLinkName><a:modifiedOn>2014-06-02T18:49:51.103</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>11</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T14:19:01.573</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Dokumentów Magazynowych &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.KnA_WartoscTxt END  &#xD;
		FROM CDN.KntAtrybuty ATR &#xD;
		JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
		WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.DAt_WartoscTxt END  &#xD;
		FROM CDN.DokAtrybuty ATR &#xD;
		JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
		WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_Typ = 1&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_format;&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', &#xD;
	CASE &#xD;
		WHEN TrE_Atr1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr1_Wartosc END &#xD;
		WHEN TrE_Atr2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr2_Wartosc END &#xD;
		WHEN TrE_Atr3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr3_Wartosc END  &#xD;
		WHEN TrE_Atr4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr4_Wartosc END  &#xD;
		WHEN TrE_Atr5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr5_Wartosc END  &#xD;
		ELSE ''(NIEPRZYPISANE)''&#xD;
	END AS [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
SELECT DB_NAME() [Baza Firmowa], &#xD;
&#xD;
	TrN_NumerPelny [Dokument Numer], &#xD;
	CASE								&#xD;
		WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
		WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
		WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
		WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
		WHEN TrN_TypDokumentu = 304 THEN 25030&#xD;
		WHEN TrN_TypDokumentu = 318 THEN 25046&#xD;
		WHEN TrN_TypDokumentu = 306 THEN 25022&#xD;
		WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
		WHEN TrN_TypDokumentu = 314 THEN 25078&#xD;
	END [Dokument Numer __PROCID__WZ__], TrN_TrNId [Dokument Numer __ORGID__],&#xD;
&#xD;
&#xD;
ISNULL(NULLIF(TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
	CASE								&#xD;
		WHEN TrN_TypDokumentu = 312 THEN ''MM''&#xD;
		WHEN TrN_TypDokumentu = 303 THEN ''PW''&#xD;
		WHEN TrN_TypDokumentu = 317 THEN ''PWP''&#xD;
		WHEN TrN_TypDokumentu = 307 THEN ''PZ''&#xD;
		WHEN TrN_TypDokumentu = 304 THEN ''RW''&#xD;
		WHEN TrN_TypDokumentu = 318 THEN ''RWS''&#xD;
		WHEN TrN_TypDokumentu = 306 THEN ''WZ''&#xD;
		WHEN TrN_TypDokumentu = 313 THEN ''PKA''&#xD;
		WHEN TrN_TypDokumentu = 314 THEN ''WKA''&#xD;
	ELSE ''(NIEPRZYPISANY)'' END [Dokument Typ],&#xD;
	&#xD;
	pod1.Pod_Nazwa1 [Kontrahent Nazwa],&#xD;
	20201 [Kontrahent Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Nazwa __ORGID__],&#xD;
	&#xD;
	pod1.Pod_Kod [Kontrahent Kod],&#xD;
	20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod1.Pod_PodId [Kontrahent Kod __ORGID__],&#xD;
	&#xD;
	 ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
	ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Miasto], ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa], &#xD;
    CASE &#xD;
		WHEN Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
		WHEN Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
	ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Opiekun],&#xD;
	zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
	ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
	ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu],&#xD;
    &#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	poz.sciezka [Produkt Pełna Nazwa Grupy], Twr_Jm [Jednostka Miary], &#xD;
	&#xD;
	ISNULL(Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna],&#xD;
    REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataOpe)*/ [Data Operacji Tydzień Roku], &#xD;
    MONTH(TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TrN_DataOpe) [Data Operacji Kwartał], YEAR(TrN_DataOpe) [Data Operacji Rok], &#xD;
    TR.TrE_WartoscNetto [Wartość Netto], TR.TrE_WartoscBrutto [Wartość Brutto], TR.TrE_WartoscNettoWal [Wartość Waluta], TR.TrE_Ilosc [Ilość], &#xD;
    TR.TrE_WartoscNetto - (ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi) [Marża], ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi [Koszt Zakupu] '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
       &#xD;
set @select2 = &#xD;
' FROM cdn.TraNag &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID &#xD;
     LEFT OUTER JOIN CDN.Kontrahenci ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny ON TrE_MagId=Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
	 LEFT JOIN ' + @Operatorzy + ' zal ON TrN_OpeZalID = zal.Ope_OpeId&#xD;
	 LEFT JOIN ' + @Operatorzy + ' mod ON TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN ( &#xD;
			SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
			FROM CDN.TraElem TRE&#xD;
			JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
				   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 )&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
	)KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
WHERE&#xD;
TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
AND TrN_Bufor&lt;&gt;-1&#xD;
AND TrE_Aktywny&lt;&gt;0'&#xD;
&#xD;
exec (@select + @select2)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RbVWbtiiR5a1y8r/v6+U6FL5ZTTF5waQY6SdZe8UjQFTtGtxZN/1iKDhSAWKi1n1vIC6aYs3D/90/mh8ToH17VguNlqUK5BA5GNn+AmEyuQ8h/4w64ELevu9NzW6YwRfqeSkr1leW+5RABV/t7MQzsJU7vawcEyKBXJVrmS8SVFBoXUGYfY3JUhka0xwvR182Utbo9GUVp7IJr6zTyE/D7</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Waluta" caption="Waluta" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Marża" caption="Marża" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Koszt Zakupu" caption="Koszt Zakupu" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut KLUCZOWY" caption="Kontrahent Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut PROJEKTY PARKI" caption="Kontrahent Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut STATUS" caption="Kontrahent Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut &amp;quot;ASD&amp;quot;" caption="Kontrahent Atrybut &amp;quot;ASD&amp;quot;" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut ~!@#$%^&amp;amp;*()_+-=&amp;lt;&amp;gt;,./" caption="Kontrahent Atrybut ~!@#$%^&amp;amp;*()_+-=&amp;lt;&amp;gt;,./" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut ['&amp;quot;;:{}[[[_--" caption="Kontrahent Atrybut ['&amp;quot;;:{}[[[_--" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut PROJEKTY PARKI (K)" caption="Dokument Atrybut PROJEKTY PARKI (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS" caption="Dokument Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS (K)" caption="Dokument Atrybut STATUS (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut &amp;quot;ASD&amp;quot; (K)" caption="Dokument Atrybut &amp;quot;ASD&amp;quot; (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DAWKA SZKODLIWA /MG/" caption="Produkt Atrybut DAWKA SZKODLIWA /MG/" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROŚLINA ŚWIATŁOLUBNA" caption="Produkt Atrybut ROŚLINA ŚWIATŁOLUBNA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut WYSOKOŚĆ" caption="Produkt Atrybut WYSOKOŚĆ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut REZLIZACJA" caption="Produkt Atrybut REZLIZACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="True" type="Pie" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Outside" columnIndent="0" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="LeftToRight" equallySpaces="False" alignmentVertical="BottomOutside" alignmentHorizontal="Center" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Analiza dokumentów wg grup" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX /&gt;&#xD;
    &lt;axisY /&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="False" showEmptyCells="False" showMeasuresOnRows="False"&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument Typ"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Dzień"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Miesiąc"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Rok"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Brutto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Grupa Poziom 1"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="161" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Wartość Netto" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Wartość Brutto" index="1" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Ilość" index="2" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Produkt Grupa Poziom 1" index="0" expanded="True" order="descending" width="161" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy dataFieldName="Wartość Netto" /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Dokument Typ" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Dzień" index="3" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Miesiąc" index="2" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Rok" index="1" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje informacje o ilości i wartości towarów na podstawie dokumentów magazynowych w podziale na grupy. Do poprawnej analizy należy wybrać typ dokumentu, który ma być analizowany.</a:description><a:id>253</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language i:nil="true"/><a:mainLinkName>7.13 Analiza dokumentów wg grup</a:mainLinkName><a:modifiedOn>2014-06-02T18:50:01.103</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>11</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T14:24:01.72</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Dokumentów Magazynowych &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.KnA_WartoscTxt END  &#xD;
		FROM CDN.KntAtrybuty ATR &#xD;
		JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
		WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.DAt_WartoscTxt END  &#xD;
		FROM CDN.DokAtrybuty ATR &#xD;
		JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
		WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_Typ = 1&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_format;&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', &#xD;
	CASE &#xD;
		WHEN TrE_Atr1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr1_Wartosc END &#xD;
		WHEN TrE_Atr2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr2_Wartosc END &#xD;
		WHEN TrE_Atr3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr3_Wartosc END  &#xD;
		WHEN TrE_Atr4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr4_Wartosc END  &#xD;
		WHEN TrE_Atr5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr5_Wartosc END  &#xD;
		ELSE ''(NIEPRZYPISANE)''&#xD;
	END AS [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
SELECT DB_NAME() [Baza Firmowa], &#xD;
&#xD;
	TrN_NumerPelny [Dokument Numer], &#xD;
	CASE								&#xD;
		WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
		WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
		WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
		WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
		WHEN TrN_TypDokumentu = 304 THEN 25030&#xD;
		WHEN TrN_TypDokumentu = 318 THEN 25046&#xD;
		WHEN TrN_TypDokumentu = 306 THEN 25022&#xD;
		WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
		WHEN TrN_TypDokumentu = 314 THEN 25078&#xD;
	END [Dokument Numer __PROCID__WZ__], TrN_TrNId [Dokument Numer __ORGID__],&#xD;
&#xD;
&#xD;
ISNULL(NULLIF(TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
	CASE								&#xD;
		WHEN TrN_TypDokumentu = 312 THEN ''MM''&#xD;
		WHEN TrN_TypDokumentu = 303 THEN ''PW''&#xD;
		WHEN TrN_TypDokumentu = 317 THEN ''PWP''&#xD;
		WHEN TrN_TypDokumentu = 307 THEN ''PZ''&#xD;
		WHEN TrN_TypDokumentu = 304 THEN ''RW''&#xD;
		WHEN TrN_TypDokumentu = 318 THEN ''RWS''&#xD;
		WHEN TrN_TypDokumentu = 306 THEN ''WZ''&#xD;
		WHEN TrN_TypDokumentu = 313 THEN ''PKA''&#xD;
		WHEN TrN_TypDokumentu = 314 THEN ''WKA''&#xD;
	ELSE ''(NIEPRZYPISANY)'' END [Dokument Typ],&#xD;
	&#xD;
	pod1.Pod_Nazwa1 [Kontrahent Nazwa],&#xD;
	20201 [Kontrahent Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Nazwa __ORGID__],&#xD;
	&#xD;
	pod1.Pod_Kod [Kontrahent Kod],&#xD;
	20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod1.Pod_PodId [Kontrahent Kod __ORGID__],&#xD;
	&#xD;
	 ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
	ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Miasto], ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa], &#xD;
    CASE &#xD;
		WHEN Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
		WHEN Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
	ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Opiekun],&#xD;
	zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
	ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
	ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu],&#xD;
    &#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	poz.sciezka [Produkt Pełna Nazwa Grupy], Twr_Jm [Jednostka Miary], &#xD;
	&#xD;
	ISNULL(Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna],&#xD;
    REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataOpe)*/ [Data Operacji Tydzień Roku], &#xD;
    MONTH(TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TrN_DataOpe) [Data Operacji Kwartał], YEAR(TrN_DataOpe) [Data Operacji Rok], &#xD;
    TR.TrE_WartoscNetto [Wartość Netto], TR.TrE_WartoscBrutto [Wartość Brutto], TR.TrE_WartoscNettoWal [Wartość Waluta], TR.TrE_Ilosc [Ilość], &#xD;
    TR.TrE_WartoscNetto - (ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi) [Marża], ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi [Koszt Zakupu] '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
       &#xD;
set @select2 = &#xD;
' FROM cdn.TraNag &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID &#xD;
     LEFT OUTER JOIN CDN.Kontrahenci ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny ON TrE_MagId=Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
	 LEFT JOIN ' + @Operatorzy + ' zal ON TrN_OpeZalID = zal.Ope_OpeId&#xD;
	 LEFT JOIN ' + @Operatorzy + ' mod ON TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN ( &#xD;
			SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
			FROM CDN.TraElem TRE&#xD;
			JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
				   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 )&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
	)KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
WHERE&#xD;
TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
AND TrN_Bufor&lt;&gt;-1&#xD;
AND TrE_Aktywny&lt;&gt;0'&#xD;
&#xD;
exec (@select + @select2)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RbVWbtiiR5a1y8r/v6+U6FL5ZTTF5waQY6SdZe8UjQFTtGtxZN/1iKDhSAWKi1n1vIC6aYs3D/90/mh8ToH17VguNlqUK5BA5GNn+AmEyuQ8h/4w64ELevu9NzW6YwRfqeSkr1leW+5RABV/t7MQzsJU7vawcEyKBXJVrmS8SVFBoXUGYfY3JUhka0xwvR182Utbo9GUVp7IJr6zTyE/D7</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Waluta" caption="Waluta" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Marża" caption="Marża" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Koszt Zakupu" caption="Koszt Zakupu" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut KLUCZOWY" caption="Kontrahent Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut PROJEKTY PARKI" caption="Kontrahent Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut STATUS" caption="Kontrahent Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut &amp;quot;ASD&amp;quot;" caption="Kontrahent Atrybut &amp;quot;ASD&amp;quot;" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut ~!@#$%^&amp;amp;*()_+-=&amp;lt;&amp;gt;,./" caption="Kontrahent Atrybut ~!@#$%^&amp;amp;*()_+-=&amp;lt;&amp;gt;,./" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut ['&amp;quot;;:{}[[[_--" caption="Kontrahent Atrybut ['&amp;quot;;:{}[[[_--" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut PROJEKTY PARKI (K)" caption="Dokument Atrybut PROJEKTY PARKI (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS" caption="Dokument Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS (K)" caption="Dokument Atrybut STATUS (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut &amp;quot;ASD&amp;quot; (K)" caption="Dokument Atrybut &amp;quot;ASD&amp;quot; (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DAWKA SZKODLIWA /MG/" caption="Produkt Atrybut DAWKA SZKODLIWA /MG/" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROŚLINA ŚWIATŁOLUBNA" caption="Produkt Atrybut ROŚLINA ŚWIATŁOLUBNA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut WYSOKOŚĆ" caption="Produkt Atrybut WYSOKOŚĆ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut REZLIZACJA" caption="Produkt Atrybut REZLIZACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="True" type="Pie" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Outside" columnIndent="0" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="LeftToRight" equallySpaces="False" alignmentVertical="BottomOutside" alignmentHorizontal="Center" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Analiza dokumentów wg kategorii dokumentu" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX /&gt;&#xD;
    &lt;axisY /&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="False" showEmptyCells="False" showMeasuresOnRows="False"&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument Typ"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Kategoria Szczegółowa z Nagłówka"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="203" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Dzień"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Miesiąc"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Rok"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Brutto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Wartość Netto" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Wartość Brutto" index="1" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Ilość" index="2" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Kategoria Szczegółowa z Nagłówka" index="0" expanded="True" width="203" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Dokument Typ" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Dzień" index="3" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Miesiąc" index="2" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Rok" index="1" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje informacje o ilości i wartości towarów na podstawie dokumentów magazynowych w podziale na kategorie tych dokumentów. Do poprawnej analizy należy wybrać typ dokumentu, który ma być analizowany.</a:description><a:id>254</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language i:nil="true"/><a:mainLinkName>7.14 Analiza dokumentów wg kategorii dokumentu</a:mainLinkName><a:modifiedOn>2014-06-02T18:50:27.673</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>11</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T14:24:46.39</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Dokumentów Magazynowych &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.KnA_WartoscTxt END  &#xD;
		FROM CDN.KntAtrybuty ATR &#xD;
		JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
		WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.DAt_WartoscTxt END  &#xD;
		FROM CDN.DokAtrybuty ATR &#xD;
		JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
		WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_Typ = 1&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_format;&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', &#xD;
	CASE &#xD;
		WHEN TrE_Atr1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr1_Wartosc END &#xD;
		WHEN TrE_Atr2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr2_Wartosc END &#xD;
		WHEN TrE_Atr3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr3_Wartosc END  &#xD;
		WHEN TrE_Atr4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr4_Wartosc END  &#xD;
		WHEN TrE_Atr5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr5_Wartosc END  &#xD;
		ELSE ''(NIEPRZYPISANE)''&#xD;
	END AS [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
SELECT DB_NAME() [Baza Firmowa], &#xD;
&#xD;
	TrN_NumerPelny [Dokument Numer], &#xD;
	CASE								&#xD;
		WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
		WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
		WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
		WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
		WHEN TrN_TypDokumentu = 304 THEN 25030&#xD;
		WHEN TrN_TypDokumentu = 318 THEN 25046&#xD;
		WHEN TrN_TypDokumentu = 306 THEN 25022&#xD;
		WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
		WHEN TrN_TypDokumentu = 314 THEN 25078&#xD;
	END [Dokument Numer __PROCID__WZ__], TrN_TrNId [Dokument Numer __ORGID__],&#xD;
&#xD;
&#xD;
ISNULL(NULLIF(TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
	CASE								&#xD;
		WHEN TrN_TypDokumentu = 312 THEN ''MM''&#xD;
		WHEN TrN_TypDokumentu = 303 THEN ''PW''&#xD;
		WHEN TrN_TypDokumentu = 317 THEN ''PWP''&#xD;
		WHEN TrN_TypDokumentu = 307 THEN ''PZ''&#xD;
		WHEN TrN_TypDokumentu = 304 THEN ''RW''&#xD;
		WHEN TrN_TypDokumentu = 318 THEN ''RWS''&#xD;
		WHEN TrN_TypDokumentu = 306 THEN ''WZ''&#xD;
		WHEN TrN_TypDokumentu = 313 THEN ''PKA''&#xD;
		WHEN TrN_TypDokumentu = 314 THEN ''WKA''&#xD;
	ELSE ''(NIEPRZYPISANY)'' END [Dokument Typ],&#xD;
	&#xD;
	pod1.Pod_Nazwa1 [Kontrahent Nazwa],&#xD;
	20201 [Kontrahent Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Nazwa __ORGID__],&#xD;
	&#xD;
	pod1.Pod_Kod [Kontrahent Kod],&#xD;
	20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod1.Pod_PodId [Kontrahent Kod __ORGID__],&#xD;
	&#xD;
	 ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
	ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Miasto], ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa], &#xD;
    CASE &#xD;
		WHEN Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
		WHEN Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
	ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Opiekun],&#xD;
	zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
	ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
	ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu],&#xD;
    &#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	poz.sciezka [Produkt Pełna Nazwa Grupy], Twr_Jm [Jednostka Miary], &#xD;
	&#xD;
	ISNULL(Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna],&#xD;
    REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataOpe)*/ [Data Operacji Tydzień Roku], &#xD;
    MONTH(TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TrN_DataOpe) [Data Operacji Kwartał], YEAR(TrN_DataOpe) [Data Operacji Rok], &#xD;
    TR.TrE_WartoscNetto [Wartość Netto], TR.TrE_WartoscBrutto [Wartość Brutto], TR.TrE_WartoscNettoWal [Wartość Waluta], TR.TrE_Ilosc [Ilość], &#xD;
    TR.TrE_WartoscNetto - (ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi) [Marża], ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi [Koszt Zakupu] '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
       &#xD;
set @select2 = &#xD;
' FROM cdn.TraNag &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID &#xD;
     LEFT OUTER JOIN CDN.Kontrahenci ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny ON TrE_MagId=Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
	 LEFT JOIN ' + @Operatorzy + ' zal ON TrN_OpeZalID = zal.Ope_OpeId&#xD;
	 LEFT JOIN ' + @Operatorzy + ' mod ON TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN ( &#xD;
			SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
			FROM CDN.TraElem TRE&#xD;
			JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
				   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 )&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
	)KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
WHERE&#xD;
TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
AND TrN_Bufor&lt;&gt;-1&#xD;
AND TrE_Aktywny&lt;&gt;0'&#xD;
&#xD;
exec (@select + @select2)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RbVWbtiiR5a1y8r/v6+U6FL5ZTTF5waQY6SdZe8UjQFTtGtxZN/1iKDhSAWKi1n1vIC6aYs3D/90/mh8ToH17VguNlqUK5BA5GNn+AmEyuQ8h/4w64ELevu9NzW6YwRfqeSkr1leW+5RABV/t7MQzsJU7vawcEyKBXJVrmS8SVFBoXUGYfY3JUhka0xwvR182Utbo9GUVp7IJr6zTyE/D7</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Waluta" caption="Waluta" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Marża" caption="Marża" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Koszt Zakupu" caption="Koszt Zakupu" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut KLUCZOWY" caption="Kontrahent Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut PROJEKTY PARKI" caption="Kontrahent Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut STATUS" caption="Kontrahent Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut &amp;quot;ASD&amp;quot;" caption="Kontrahent Atrybut &amp;quot;ASD&amp;quot;" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut ~!@#$%^&amp;amp;*()_+-=&amp;lt;&amp;gt;,./" caption="Kontrahent Atrybut ~!@#$%^&amp;amp;*()_+-=&amp;lt;&amp;gt;,./" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut ['&amp;quot;;:{}[[[_--" caption="Kontrahent Atrybut ['&amp;quot;;:{}[[[_--" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut PROJEKTY PARKI (K)" caption="Dokument Atrybut PROJEKTY PARKI (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS" caption="Dokument Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS (K)" caption="Dokument Atrybut STATUS (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut &amp;quot;ASD&amp;quot; (K)" caption="Dokument Atrybut &amp;quot;ASD&amp;quot; (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DAWKA SZKODLIWA /MG/" caption="Produkt Atrybut DAWKA SZKODLIWA /MG/" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROŚLINA ŚWIATŁOLUBNA" caption="Produkt Atrybut ROŚLINA ŚWIATŁOLUBNA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut WYSOKOŚĆ" caption="Produkt Atrybut WYSOKOŚĆ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut REZLIZACJA" caption="Produkt Atrybut REZLIZACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="True" type="Pie" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Outside" columnIndent="0" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="LeftToRight" equallySpaces="False" alignmentVertical="BottomOutside" alignmentHorizontal="Center" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Analiza dokumentów wg kategorii produktu" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX /&gt;&#xD;
    &lt;axisY /&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="False" showEmptyCells="False" showMeasuresOnRows="False"&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument Typ"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Kategoria Szczegółowa z Elementu"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="200" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Dzień"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Miesiąc"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Rok"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Brutto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Wartość Netto" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Wartość Brutto" index="1" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Ilość" index="2" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Kategoria Szczegółowa z Elementu" index="0" expanded="True" width="200" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Dokument Typ" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Dzień" index="3" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Miesiąc" index="2" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Rok" index="1" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje informacje o ilości i wartości towarów na podstawie dokumentów magazynowych w podziale na kategorie produktów. Do poprawnej analizy należy wybrać typ dokumentu, który ma być analizowany.</a:description><a:id>255</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language i:nil="true"/><a:mainLinkName>7.15 Analiza dokumentów wg kategorii produktu</a:mainLinkName><a:modifiedOn>2014-06-02T18:50:33.45</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>11</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T14:34:34.97</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Dokumentów Magazynowych &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.KnA_WartoscTxt END  &#xD;
		FROM CDN.KntAtrybuty ATR &#xD;
		JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
		WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.DAt_WartoscTxt END  &#xD;
		FROM CDN.DokAtrybuty ATR &#xD;
		JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
		WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_Typ = 1&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_format;&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', &#xD;
	CASE &#xD;
		WHEN TrE_Atr1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr1_Wartosc END &#xD;
		WHEN TrE_Atr2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr2_Wartosc END &#xD;
		WHEN TrE_Atr3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr3_Wartosc END  &#xD;
		WHEN TrE_Atr4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr4_Wartosc END  &#xD;
		WHEN TrE_Atr5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr5_Wartosc END  &#xD;
		ELSE ''(NIEPRZYPISANE)''&#xD;
	END AS [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
SELECT DB_NAME() [Baza Firmowa], &#xD;
&#xD;
	TrN_NumerPelny [Dokument Numer], &#xD;
	CASE								&#xD;
		WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
		WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
		WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
		WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
		WHEN TrN_TypDokumentu = 304 THEN 25030&#xD;
		WHEN TrN_TypDokumentu = 318 THEN 25046&#xD;
		WHEN TrN_TypDokumentu = 306 THEN 25022&#xD;
		WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
		WHEN TrN_TypDokumentu = 314 THEN 25078&#xD;
	END [Dokument Numer __PROCID__WZ__], TrN_TrNId [Dokument Numer __ORGID__],&#xD;
&#xD;
&#xD;
ISNULL(NULLIF(TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
	CASE								&#xD;
		WHEN TrN_TypDokumentu = 312 THEN ''MM''&#xD;
		WHEN TrN_TypDokumentu = 303 THEN ''PW''&#xD;
		WHEN TrN_TypDokumentu = 317 THEN ''PWP''&#xD;
		WHEN TrN_TypDokumentu = 307 THEN ''PZ''&#xD;
		WHEN TrN_TypDokumentu = 304 THEN ''RW''&#xD;
		WHEN TrN_TypDokumentu = 318 THEN ''RWS''&#xD;
		WHEN TrN_TypDokumentu = 306 THEN ''WZ''&#xD;
		WHEN TrN_TypDokumentu = 313 THEN ''PKA''&#xD;
		WHEN TrN_TypDokumentu = 314 THEN ''WKA''&#xD;
	ELSE ''(NIEPRZYPISANY)'' END [Dokument Typ],&#xD;
	&#xD;
	pod1.Pod_Nazwa1 [Kontrahent Nazwa],&#xD;
	20201 [Kontrahent Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Nazwa __ORGID__],&#xD;
	&#xD;
	pod1.Pod_Kod [Kontrahent Kod],&#xD;
	20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod1.Pod_PodId [Kontrahent Kod __ORGID__],&#xD;
	&#xD;
	 ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
	ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Miasto], ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa], &#xD;
    CASE &#xD;
		WHEN Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
		WHEN Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
	ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Opiekun],&#xD;
	zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
	ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
	ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu],&#xD;
    &#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	poz.sciezka [Produkt Pełna Nazwa Grupy], Twr_Jm [Jednostka Miary], &#xD;
	&#xD;
	ISNULL(Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna],&#xD;
    REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataOpe)*/ [Data Operacji Tydzień Roku], &#xD;
    MONTH(TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TrN_DataOpe) [Data Operacji Kwartał], YEAR(TrN_DataOpe) [Data Operacji Rok], &#xD;
    TR.TrE_WartoscNetto [Wartość Netto], TR.TrE_WartoscBrutto [Wartość Brutto], TR.TrE_WartoscNettoWal [Wartość Waluta], TR.TrE_Ilosc [Ilość], &#xD;
    TR.TrE_WartoscNetto - (ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi) [Marża], ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi [Koszt Zakupu] '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
       &#xD;
set @select2 = &#xD;
' FROM cdn.TraNag &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID &#xD;
     LEFT OUTER JOIN CDN.Kontrahenci ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny ON TrE_MagId=Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
	 LEFT JOIN ' + @Operatorzy + ' zal ON TrN_OpeZalID = zal.Ope_OpeId&#xD;
	 LEFT JOIN ' + @Operatorzy + ' mod ON TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN ( &#xD;
			SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
			FROM CDN.TraElem TRE&#xD;
			JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
				   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 )&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
	)KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
WHERE&#xD;
TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
AND TrN_Bufor&lt;&gt;-1&#xD;
AND TrE_Aktywny&lt;&gt;0'&#xD;
&#xD;
exec (@select + @select2)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RbVWbtiiR5a1y8r/v6+U6FL5ZTTF5waQY6SdZe8UjQFTtGtxZN/1iKDhSAWKi1n1vIC6aYs3D/90/mh8ToH17VguNlqUK5BA5GNn+AmEyuQ8h/4w64ELevu9NzW6YwRfqeSkr1leW+5RABV/t7MQzsJU7vawcEyKBXJVrmS8SVFBoXUGYfY3JUhka0xwvR182Utbo9GUVp7IJr6zTyE/D7</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Waluta" caption="Waluta" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Marża" caption="Marża" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Koszt Zakupu" caption="Koszt Zakupu" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut KLUCZOWY" caption="Kontrahent Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut PROJEKTY PARKI" caption="Kontrahent Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut STATUS" caption="Kontrahent Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut &amp;quot;ASD&amp;quot;" caption="Kontrahent Atrybut &amp;quot;ASD&amp;quot;" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut ~!@#$%^&amp;amp;*()_+-=&amp;lt;&amp;gt;,./" caption="Kontrahent Atrybut ~!@#$%^&amp;amp;*()_+-=&amp;lt;&amp;gt;,./" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut ['&amp;quot;;:{}[[[_--" caption="Kontrahent Atrybut ['&amp;quot;;:{}[[[_--" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut PROJEKTY PARKI (K)" caption="Dokument Atrybut PROJEKTY PARKI (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS" caption="Dokument Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS (K)" caption="Dokument Atrybut STATUS (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut &amp;quot;ASD&amp;quot; (K)" caption="Dokument Atrybut &amp;quot;ASD&amp;quot; (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DAWKA SZKODLIWA /MG/" caption="Produkt Atrybut DAWKA SZKODLIWA /MG/" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROŚLINA ŚWIATŁOLUBNA" caption="Produkt Atrybut ROŚLINA ŚWIATŁOLUBNA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut WYSOKOŚĆ" caption="Produkt Atrybut WYSOKOŚĆ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut REZLIZACJA" caption="Produkt Atrybut REZLIZACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="True" type="Bar" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False" rotated="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Top" zeroValues="False" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="LeftToRight" equallySpaces="False" alignmentVertical="BottomOutside" alignmentHorizontal="Center" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Analiza dokumentów wg kontrahentów" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX visible="True" beginText="" endText="" angle="90" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="[Kontrahent Kod].[LAS]|[Kontrahent Nazwa].[Szkółka leśna LAS]" rangeMax="[Kontrahent Kod].[AL_KOMP_GLIWICE]|[Kontrahent Nazwa].[AL-KOMP sp.z o.o. Oddział w Gliwicach]" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisX&gt;&#xD;
    &lt;axisY visible="True" beginText="" endText="" angle="0" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="0" rangeMax="219404,867" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisY&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAMAAAAVAAAABwIWW0tvbnRyYWhlbnQgS29kXS5bTEFTXQcCGVtLb250cmFoZW50IEtvZF0uW01BUktVU10HAhpbS29udHJhaGVudCBLb2RdLltBTF9LT01QXQcCGFtLb250cmFoZW50IEtvZF0uW0FMT1pBXQcCFltLb250cmFoZW50IEtvZF0uW0NQTl0HAhhbS29udHJhaGVudCBLb2RdLltURVJSQV0HAh5bS29udHJhaGVudCBLb2RdLltUV8OTSk9HUsOTRF0HAhlbS29udHJhaGVudCBLb2RdLltNQVJJWkFdBwIWW0tvbnRyYWhlbnQgS29kXS5bQURNXQcCG1tLb250cmFoZW50IEtvZF0uW1NPRlRMQU5EXQcCGFtLb250cmFoZW50IEtvZF0uW0JMRUlNXQcCGFtLb250cmFoZW50IEtvZF0uW1NUSUxMXQcCHltLb250cmFoZW50IEtvZF0uW0VMRUtUUk9XTklBXQcCIltLb250cmFoZW50IEtvZF0uWyFOSUVPS1JFxZpMT05ZIV0HAhlbS29udHJhaGVudCBLb2RdLltCSUdHVU5dBwIcW0tvbnRyYWhlbnQgS29kXS5bQklVUk9XSUVDXQcCGVtLb250cmFoZW50IEtvZF0uW0tPTEFTQV0HAhxbS29udHJhaGVudCBLb2RdLltNQVJTWkFMSUtdBwIbW0tvbnRyYWhlbnQgS29kXS5bS09XQUxTS0ldBwImW0tvbnRyYWhlbnQgS29kXS5bQklVUk9XSUVDX1dJRUxJQ1pLQV0HAiJbS29udHJhaGVudCBLb2RdLltBTF9LT01QX0dMSVdJQ0Vd/////wAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="False" showEmptyCells="False" showMeasuresOnRows="False"&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument Typ"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Kontrahent Nazwa"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="202" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Kontrahent Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="147" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Dzień"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Miesiąc"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Rok"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Brutto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Grupa Poziom 1"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Wartość Netto" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Wartość Brutto" index="1" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Ilość" index="2" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Kontrahent Nazwa" index="1" expanded="True" order="descending" width="202" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy dataFieldName="Wartość Netto" /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;row fieldName="Kontrahent Kod" index="0" expanded="True" order="descending" width="147" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy dataFieldName="Wartość Netto" /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Dokument Typ" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Dzień" index="4" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Miesiąc" index="3" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Rok" index="2" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Produkt Grupa Poziom 1" index="1" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje informacje o ilości i wartości towarów dla kontrahentów na podstawie dokumentów magazynowych. Do poprawnej analizy należy wybrać typ dokumentu, który ma być analizowany.</a:description><a:id>256</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language i:nil="true"/><a:mainLinkName>7.16 Analiza dokumentów wg kontrahentów</a:mainLinkName><a:modifiedOn>2014-06-02T18:50:44.137</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>11</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>1</a:id></a:Context><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T14:36:35.523</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Dokumentów Magazynowych &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.KnA_WartoscTxt END  &#xD;
		FROM CDN.KntAtrybuty ATR &#xD;
		JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
		WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.DAt_WartoscTxt END  &#xD;
		FROM CDN.DokAtrybuty ATR &#xD;
		JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
		WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE ATR.TwA_WartoscTxt END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_Typ = 1&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_format;&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', &#xD;
	CASE &#xD;
		WHEN TrE_Atr1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr1_Wartosc END &#xD;
		WHEN TrE_Atr2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr2_Wartosc END &#xD;
		WHEN TrE_Atr3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr3_Wartosc END  &#xD;
		WHEN TrE_Atr4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr4_Wartosc END  &#xD;
		WHEN TrE_Atr5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,TrE_Atr5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') ELSE TrE_Atr5_Wartosc END  &#xD;
		ELSE ''(NIEPRZYPISANE)''&#xD;
	END AS [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
SELECT DB_NAME() [Baza Firmowa], &#xD;
&#xD;
	TrN_NumerPelny [Dokument Numer], &#xD;
	CASE								&#xD;
		WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
		WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
		WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
		WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
		WHEN TrN_TypDokumentu = 304 THEN 25030&#xD;
		WHEN TrN_TypDokumentu = 318 THEN 25046&#xD;
		WHEN TrN_TypDokumentu = 306 THEN 25022&#xD;
		WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
		WHEN TrN_TypDokumentu = 314 THEN 25078&#xD;
	END [Dokument Numer __PROCID__WZ__], TrN_TrNId [Dokument Numer __ORGID__],&#xD;
&#xD;
&#xD;
ISNULL(NULLIF(TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
	CASE								&#xD;
		WHEN TrN_TypDokumentu = 312 THEN ''MM''&#xD;
		WHEN TrN_TypDokumentu = 303 THEN ''PW''&#xD;
		WHEN TrN_TypDokumentu = 317 THEN ''PWP''&#xD;
		WHEN TrN_TypDokumentu = 307 THEN ''PZ''&#xD;
		WHEN TrN_TypDokumentu = 304 THEN ''RW''&#xD;
		WHEN TrN_TypDokumentu = 318 THEN ''RWS''&#xD;
		WHEN TrN_TypDokumentu = 306 THEN ''WZ''&#xD;
		WHEN TrN_TypDokumentu = 313 THEN ''PKA''&#xD;
		WHEN TrN_TypDokumentu = 314 THEN ''WKA''&#xD;
	ELSE ''(NIEPRZYPISANY)'' END [Dokument Typ],&#xD;
	&#xD;
	pod1.Pod_Nazwa1 [Kontrahent Nazwa],&#xD;
	20201 [Kontrahent Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Nazwa __ORGID__],&#xD;
	&#xD;
	pod1.Pod_Kod [Kontrahent Kod],&#xD;
	20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod1.Pod_PodId [Kontrahent Kod __ORGID__],&#xD;
	&#xD;
	 ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
	ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Miasto], ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa], &#xD;
    CASE &#xD;
		WHEN Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
		WHEN Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
	ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Opiekun],&#xD;
	zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
	ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
	ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu],&#xD;
    &#xD;
	Twr_Nazwa [Produkt Nazwa], &#xD;
	25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],&#xD;
	&#xD;
	Twr_Kod [Produkt Kod], &#xD;
	25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],&#xD;
	&#xD;
	poz.sciezka [Produkt Pełna Nazwa Grupy], Twr_Jm [Jednostka Miary], &#xD;
	&#xD;
	ISNULL(Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
	29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],&#xD;
&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna],&#xD;
    REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataOpe)*/ [Data Operacji Tydzień Roku], &#xD;
    MONTH(TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TrN_DataOpe) [Data Operacji Kwartał], YEAR(TrN_DataOpe) [Data Operacji Rok], &#xD;
    TR.TrE_WartoscNetto [Wartość Netto], TR.TrE_WartoscBrutto [Wartość Brutto], TR.TrE_WartoscNettoWal [Wartość Waluta], TR.TrE_Ilosc [Ilość], &#xD;
    TR.TrE_WartoscNetto - (ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi) [Marża], ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi [Koszt Zakupu] '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
       &#xD;
set @select2 = &#xD;
' FROM cdn.TraNag &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID &#xD;
     LEFT OUTER JOIN CDN.Kontrahenci ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny ON TrE_MagId=Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
	 LEFT JOIN ' + @Operatorzy + ' zal ON TrN_OpeZalID = zal.Ope_OpeId&#xD;
	 LEFT JOIN ' + @Operatorzy + ' mod ON TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN ( &#xD;
			SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
			FROM CDN.TraElem TRE&#xD;
			JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
				   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 )&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
	)KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
WHERE&#xD;
TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
AND TrN_Bufor&lt;&gt;-1&#xD;
AND TrE_Aktywny&lt;&gt;0'&#xD;
&#xD;
exec (@select + @select2)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RbVWbtiiR5a1y8r/v6+U6FL5ZTTF5waQY6SdZe8UjQFTtGtxZN/1iKDhSAWKi1n1vIC6aYs3D/90/mh8ToH17VguNlqUK5BA5GNn+AmEyuQ8h/4w64ELevu9NzW6YwRfqeSkr1leW+5RABV/t7MQzsJU7vawcEyKBXJVrmS8SVFBoXUGYfY3JUhka0xwvR182Utbo9GUVp7IJr6zTyE/D7</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Waluta" caption="Waluta" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Marża" caption="Marża" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Koszt Zakupu" caption="Koszt Zakupu" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut KLUCZOWY" caption="Kontrahent Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut PROJEKTY PARKI" caption="Kontrahent Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut STATUS" caption="Kontrahent Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut &amp;quot;ASD&amp;quot;" caption="Kontrahent Atrybut &amp;quot;ASD&amp;quot;" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut ~!@#$%^&amp;amp;*()_+-=&amp;lt;&amp;gt;,./" caption="Kontrahent Atrybut ~!@#$%^&amp;amp;*()_+-=&amp;lt;&amp;gt;,./" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut ['&amp;quot;;:{}[[[_--" caption="Kontrahent Atrybut ['&amp;quot;;:{}[[[_--" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut PROJEKTY PARKI (K)" caption="Dokument Atrybut PROJEKTY PARKI (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS" caption="Dokument Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS (K)" caption="Dokument Atrybut STATUS (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut &amp;quot;ASD&amp;quot; (K)" caption="Dokument Atrybut &amp;quot;ASD&amp;quot; (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DAWKA SZKODLIWA /MG/" caption="Produkt Atrybut DAWKA SZKODLIWA /MG/" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROŚLINA ŚWIATŁOLUBNA" caption="Produkt Atrybut ROŚLINA ŚWIATŁOLUBNA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut WYSOKOŚĆ" caption="Produkt Atrybut WYSOKOŚĆ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut REZLIZACJA" caption="Produkt Atrybut REZLIZACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="False" type="Bar" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False" rotated="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Top" zeroValues="False" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="LeftToRight" equallySpaces="False" alignmentVertical="BottomOutside" alignmentHorizontal="Center" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="7.08 Analiza dokumentów wg kontrahentów" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX visible="True" beginText="" endText="" angle="90" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="[Kontrahent Kod].[LAS]|[Kontrahent Nazwa].[Szkółka leśna LAS]" rangeMax="[Kontrahent Kod].[AL_KOMP_GLIWICE]|[Kontrahent Nazwa].[AL-KOMP sp.z o.o. Oddział w Gliwicach]" zeroLevel="True" margins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisX&gt;&#xD;
    &lt;axisY visible="True" beginText="" endText="" angle="0" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="0" rangeMax="219404,867" zeroLevel="True" margins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisY&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAMAAAAVAAAABwIWW0tvbnRyYWhlbnQgS29kXS5bTEFTXQcCGVtLb250cmFoZW50IEtvZF0uW01BUktVU10HAhpbS29udHJhaGVudCBLb2RdLltBTF9LT01QXQcCGFtLb250cmFoZW50IEtvZF0uW0FMT1pBXQcCFltLb250cmFoZW50IEtvZF0uW0NQTl0HAhhbS29udHJhaGVudCBLb2RdLltURVJSQV0HAh5bS29udHJhaGVudCBLb2RdLltUV8OTSk9HUsOTRF0HAhlbS29udHJhaGVudCBLb2RdLltNQVJJWkFdBwIWW0tvbnRyYWhlbnQgS29kXS5bQURNXQcCG1tLb250cmFoZW50IEtvZF0uW1NPRlRMQU5EXQcCGFtLb250cmFoZW50IEtvZF0uW0JMRUlNXQcCGFtLb250cmFoZW50IEtvZF0uW1NUSUxMXQcCHltLb250cmFoZW50IEtvZF0uW0VMRUtUUk9XTklBXQcCIltLb250cmFoZW50IEtvZF0uWyFOSUVPS1JFxZpMT05ZIV0HAhlbS29udHJhaGVudCBLb2RdLltCSUdHVU5dBwIcW0tvbnRyYWhlbnQgS29kXS5bQklVUk9XSUVDXQcCGVtLb250cmFoZW50IEtvZF0uW0tPTEFTQV0HAhxbS29udHJhaGVudCBLb2RdLltNQVJTWkFMSUtdBwIbW0tvbnRyYWhlbnQgS29kXS5bS09XQUxTS0ldBwImW0tvbnRyYWhlbnQgS29kXS5bQklVUk9XSUVDX1dJRUxJQ1pLQV0HAiJbS29udHJhaGVudCBLb2RdLltBTF9LT01QX0dMSVdJQ0Vd/////wAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="False" showEmptyCells="False" showMeasuresOnRows="False"&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument Typ"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Kontrahent Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="147" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="105" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Dzień"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Miesiąc"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Rok"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Brutto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Grupa Poziom 1"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Wartość Netto" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Wartość Brutto" index="1" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Ilość" index="2" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Kontrahent Kod" index="0" expanded="True" order="descending" width="147" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy dataFieldName="Wartość Netto" /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;row fieldName="Produkt Kod" index="1" expanded="True" order="descending" width="105" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy dataFieldName="Wartość Netto" /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Dokument Typ" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Dzień" index="4" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Miesiąc" index="3" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Rok" index="2" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;filter fieldName="Produkt Grupa Poziom 1" index="1" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje informacje o ilości i wartości towarów na podstawie dokumentów magazynowych w podziale na kontrahentów. Do poprawnej analizy należy wybrać typ dokumentu, który ma być analizowany.</a:description><a:id>257</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language i:nil="true"/><a:mainLinkName>7.17 Analiza dokumentów wg kontrahentów i produktów</a:mainLinkName><a:modifiedOn>2014-06-02T18:50:53.14</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>11</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>false</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-04-05T16:30:41.157</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Produktów z dostaw&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Zasobów&#xD;
DECLARE @atrybutyZas varchar(max);&#xD;
DECLARE @atrybutyZas2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in &#xD;
(&#xD;
SELECT DISTINCT TsC_Cecha1_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha2_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha3_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha4_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha5_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha6_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha7_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha8_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha9_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha10_DeAId FROM CDN.TraSElemCechy&#xD;
)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TsC_TrSID INTO #tmpZasAtr FROM CDN.TraSElemCechy&#xD;
&#xD;
SET @atrybutyZas = ''&#xD;
SET @atrybutyZas2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
       IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
       IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
       SET @sqlA = N'ALTER TABLE #tmpZasAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
       SET @sqlA = N'UPDATE #tmpZasAtr&#xD;
             SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = &#xD;
             CASE&#xD;
                WHEN ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha1_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha1_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha2_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha2_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha3_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha3_Wartosc END END &#xD;
                WHEN ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha4_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha4_Wartosc END END &#xD;
                WHEN ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha5_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha5_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha6_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha6_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha6_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha7_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha7_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha7_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha8_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha8_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha8_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha9_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha9_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha9_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha10_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha10_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha10_Wartosc END END&#xD;
             ELSE ''(NIEPRZYPISANE)'' END&#xD;
             FROM CDN.TraSElemCechy ATR &#xD;
             JOIN #tmpZasAtr TM ON ATR.TsC_TrSID = TM.TsC_TrSID&#xD;
             WHERE ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
       EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyZas = @atrybutyZas + N', ISNULL(ZasAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Zasoby Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
&#xD;
       FETCH NEXT FROM atrybut_cursor&#xD;
       INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
    WHEN DDf_Numeracja like '@rejestr%' THEN 5&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'SELECT BAZ.Baz_Nazwa [Baza Firmowa],&#xD;
    TrN_NumerPelny [Dokument Dostawy Numer], &#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TrN_NumerPelny,0,CHARINDEX(''/'',TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TrN_NumerPelny,CHARINDEX(''/'',TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],&#xD;
    Twr_Kod [Produkt Kod], &#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],     &#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    ISNULL(knt.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Kod],  &#xD;
    ISNULL(knt.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Nazwa], &#xD;
    ISNULL(knt3.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Kod],   &#xD;
    ISNULL(knt3.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Nazwa], &#xD;
    TwZ_Ilosc [Ilość], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),TwZ_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
    TrE_Ilosc [Ilość w Dostawie],&#xD;
    Twr_IloscMin [Ilość Minimalna], Twr_IloscMax [Ilość Maksymalna],&#xD;
    TwZ_Wartosc [Wartość Netto], TwZ_Wartosc * (1 + Twr_Stawka/100) [Wartość Brutto], TwZ_Cena [Cena Zakupu] &#xD;
    ,DATEDIFF(day, TwZ_Data, GETDATE()) AS [Liczba dni zalegania]&#xD;
&#xD;
    ,CASE WHEN (MONTH(TwZ_Data) = MONTH(GETDATE())) AND (YEAR(TwZ_Data) = YEAR(GETDATE())) THEN ''TAK'' ELSE ''NIE'' END [Czas Aktualny Miesiąc],&#xD;
    CASE &#xD;
        WHEN (MONTH(TwZ_Data) = MONTH(GETDATE())-1) AND (YEAR(TwZ_Data) = YEAR(GETDATE())) THEN ''TAK'' &#xD;
        WHEN ((MONTH(TwZ_Data) = 12) AND (MONTH(GETDATE()) = 1)) AND (YEAR(TwZ_Data) = YEAR(GETDATE()) - 1) THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Aktualny Miesiąc Poprzedni]&#xD;
/*&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TwZ_Data, 111), ''/'', ''-'') [Data Dostawy]&#xD;
*/&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TwZ_Data, 111), ''/'', ''-'') [Data Dostawy Dzień], (datepart(DY, datediff(d, 0, TwZ_Data) / 7 * 7 + 3)+6) / 7 [Data Dostawy Tydzień Roku] &#xD;
    ,MONTH(TwZ_Data) [Data Dostawy Miesiąc],    DATEPART(quarter, TwZ_Data) [Data Dostawy Kwartał], YEAR(TwZ_Data) [Data Dostawy Rok]   &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
                        ,CASE                               &#xD;
        WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
        WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
        WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
        WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
        WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
    END [Dokument Dostawy Numer __PROCID__PZ__], TrN_TrNId [Dokument Dostawy Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Dostawy Numer __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Kod __PROCID__Kontrahenci__], knt.Knt_KntId [Dostawca Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Nazwa __PROCID__], knt.Knt_KntId [Dostawca Pierwotny Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Dostawca Kod __PROCID__Kontrahenci__], knt3.Knt_KntId [Dostawca Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Nazwa __PROCID__], knt3.Knt_KntId [Dostawca Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Nazwa __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + @atrybutyZas + '&#xD;
 FROM CDN.TwrZasoby&#xD;
    JOIN CDN.Towary ON TwZ_TwrId = Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    JOIN CDN.Magazyny ON TwZ_MagId = Mag_MagId&#xD;
    JOIN CDN.TraSElem ON TwZ_TrSIdDost = TrS_TrSID and TwZ_MagId = TrS_MagId&#xD;
    JOIN CDN.TraElem ON TrS_TrEId = TrE_TrEID&#xD;
    JOIN CDN.TraNag ON TrE_TrNId = TrN_TrNID&#xD;
LEFT JOIN #tmpSeria ser ON TrN_DDfId = DDf_DDfID&#xD;
    LEFT JOIN CDN.Kontrahenci knt ON TrN_PodId = KnT_KnTId AND TrN_PodmiotTyp = 1&#xD;
    LEFT JOIN CDN.Kontrahenci knt3 ON knt.Knt_GlID=knt3.Knt_KntId&#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwR_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT JOIN #tmpZasAtr ZasAtr ON Trs_TrSId = ZasAtr.TsC_TrSID&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0 ' &#xD;
exec (@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpZasAtr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+QLNy8SvsWvjndP4rYWmIrmw65/eZ7QPiim3cKUThrJOp91uo2s2QytZVCI0ahIBHPzdhq77ZDLGS8LuZiEj0zYsIgS5K2HrbyaqCJT/6WDiznZVF9elSOhzVl2dH/e0c9PnG3YSMpcSF3Y8x5vWCkpLScwlLQEW3Qqe7R0u8VkZs9N9mOdplX8Q/6cokntZkj4+ymM9XCT/A==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Dzień" caption="Data Dostawy Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Tydzień Roku" caption="Data Dostawy Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Miesiąc" caption="Data Dostawy Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Kwartał" caption="Data Dostawy Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Rok" caption="Data Dostawy Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Dostawy Numer" caption="Dokument Dostawy Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="n2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Kod" caption="Dostawca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Nazwa" caption="Dostawca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość w Dostawie" caption="Ilość w Dostawie" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="" aggregate="Max" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Cena Zakupu" caption="Cena Zakupu" type="measure" formatString="n2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAMAAAAhAAAABwIlW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQS0EvMS8yMDA4XQcCJVtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzMvMjAwOF0HAiVbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BLQS80LzIwMDhdBwIkW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8yLzIwMDhdBwIlW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMi8yMDA4XQcCJFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMS8yMDExXQcCJFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMS8yMDEyXQcCJFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMS8yMDEzXQcCJVtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMTgvMjAwOF0HAiVbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzE5LzIwMDhdBwIkW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8yLzIwMTFdBwIkW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8yLzIwMTJdBwIlW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8yMC8yMDA4XQcCJVtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMjEvMjAwOF0HAiVbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzIyLzIwMDhdBwIlW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8yMy8yMDA4XQcCJVtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMjQvMjAwOF0HAiVbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzI2LzIwMDhdBwIlW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8yNy8yMDA4XQcCJVtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMjgvMjAwOF0HAiVbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzI5LzIwMDhdBwIkW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8zLzIwMTFdBwIkW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8zLzIwMTJdBwIlW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8zMS8yMDA4XQcCJVtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMzMvMjAwOF0HAiVbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzM0LzIwMDhdBwIlW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8zNS8yMDA4XQcCJVtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMzYvMjAwOF0HAiVbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzM3LzIwMDhdBwIkW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi80LzIwMTFdBwIkW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi81LzIwMTJdBwIkW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi82LzIwMTJdBwIkW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi83LzIwMTJd/////wAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showMeasuresOnRows="False"&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument Dostawy Numer"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="161" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="104" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość w Dostawie"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Ilość" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Ilość w Dostawie" index="1" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Wartość Netto" index="2" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Dokument Dostawy Numer" index="0" expanded="True" width="161" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;row fieldName="Produkt Kod" index="1" expanded="True" width="104" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje aktualne zasoby magazynowe w podziale na dostawy, w których zostały przyjęte.&#xD;
&#xD;
Raport nie będzie działał poprawnie jeśli ewidencjujemy magazyny metodą AVCO</a:description><a:id>258</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.18 Produkty z dostaw</a:mainLinkName><a:modifiedOn>2025-01-29T16:39:33.087</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>8</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-04-05T16:33:21.95</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Ranking produktów zalegających&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Zasobów&#xD;
DECLARE @atrybutyZas varchar(max);&#xD;
DECLARE @atrybutyZas2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in &#xD;
(&#xD;
SELECT DISTINCT TsC_Cecha1_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha2_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha3_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha4_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha5_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha6_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha7_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha8_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha9_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha10_DeAId FROM CDN.TraSElemCechy&#xD;
)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TsC_TrSID INTO #tmpZasAtr FROM CDN.TraSElemCechy&#xD;
&#xD;
SET @atrybutyZas = ''&#xD;
SET @atrybutyZas2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
       IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
       IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
       SET @sqlA = N'ALTER TABLE #tmpZasAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
       SET @sqlA = N'UPDATE #tmpZasAtr&#xD;
             SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = &#xD;
             CASE&#xD;
                WHEN ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    else  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha1_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha1_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha2_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha2_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha3_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha3_Wartosc END END &#xD;
                WHEN ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha4_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha4_Wartosc END END &#xD;
                WHEN ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha5_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha5_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha6_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha6_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha6_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha7_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha7_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha7_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha8_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha8_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha8_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha9_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha9_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha9_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha10_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha10_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha10_Wartosc END END&#xD;
             ELSE ''(NIEPRZYPISANE)'' END&#xD;
             FROM CDN.TraSElemCechy ATR &#xD;
             JOIN #tmpZasAtr TM ON ATR.TsC_TrSID = TM.TsC_TrSID&#xD;
             WHERE ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
       EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyZas = @atrybutyZas + N', ISNULL(ZasAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Zasoby Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
&#xD;
       FETCH NEXT FROM atrybut_cursor&#xD;
       INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
    WHEN DDf_Numeracja like '@rejestr%' THEN 5&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'SELECT BAZ.Baz_Nazwa [Baza Firmowa],&#xD;
    TrN_NumerPelny [Dokument Dostawy Numer], &#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TrN_NumerPelny,0,CHARINDEX(''/'',TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TrN_NumerPelny,CHARINDEX(''/'',TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],&#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    Twr_Nazwa [Produkt Nazwa], &#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],     &#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    ISNULL(knt.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Kod],  &#xD;
    ISNULL(knt.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Nazwa], &#xD;
    ISNULL(knt3.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Kod],   &#xD;
    ISNULL(knt3.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Nazwa], &#xD;
    Twr_KodDostawcy as [Produkt Kod u Dostawcy],&#xD;
    TwZ_Ilosc [Ilość], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),TwZ_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
    TrE_Ilosc [Ilość w Dostawie],&#xD;
    Twr_IloscMin [Ilość Minimalna], Twr_IloscMax [Ilość Maksymalna],&#xD;
    TwZ_Wartosc [Wartość Netto], TwZ_Wartosc * (1 + Twr_Stawka/100) [Wartość Brutto], TwZ_Cena [Cena Zakupu] &#xD;
    ,DATEDIFF(day, TwZ_Data, GETDATE()) AS [Liczba dni zalegania]&#xD;
/*&#xD;
    ----------DATY POINT&#xD;
    ,CAST(REPLACE(CONVERT(VARCHAR(10), TwZ_Data, 111), ''/'', '''') AS INT) [Data Dostawy]&#xD;
*/&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TwZ_Data, 111), ''/'', ''-'') [Data Dostawy Dzień], (datepart(DY, datediff(d, 0, TwZ_Data) / 7 * 7 + 3)+6) / 7 [Data Dostawy Tydzień Roku]&#xD;
    ,MONTH(TwZ_Data) [Data Dostawy Miesiąc],    DATEPART(quarter, TwZ_Data) [Data Dostawy Kwartał], YEAR(TwZ_Data) [Data Dostawy Rok]   &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
                                ,CASE                               &#xD;
        WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
        WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
        WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
        WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
        WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
    END [Dokument Dostawy Numer __PROCID__PZ__], TrN_TrNId [Dokument Dostawy Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Dostawy Numer __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Kod __PROCID__Kontrahenci__], knt.Knt_KntId [Dostawca Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Nazwa __PROCID__], knt.Knt_KntId [Dostawca Pierwotny Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Dostawca Kod __PROCID__Kontrahenci__], knt3.Knt_KntId [Dostawca Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Nazwa __PROCID__], knt3.Knt_KntId [Dostawca Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Nazwa __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + @atrybutyZas + '&#xD;
 FROM CDN.TwrZasoby&#xD;
    JOIN CDN.Towary ON TwZ_TwrId = Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    JOIN CDN.Magazyny ON TwZ_MagId = Mag_MagId&#xD;
    JOIN CDN.TraSElem ON TwZ_TrSIdDost = TrS_TrSID&#xD;
    JOIN CDN.TraElem ON TrS_TrEId = TrE_TrEID&#xD;
    JOIN CDN.TraNag ON TrE_TrNId = TrN_TrNID&#xD;
LEFT JOIN #tmpSeria ser ON TrN_DDfId = DDf_DDfID&#xD;
    LEFT JOIN CDN.Kontrahenci knt ON TrN_PodId = KnT_KnTId AND TrN_PodmiotTyp = 1&#xD;
    LEFT JOIN CDN.Kontrahenci knt3 ON knt.Knt_GlID=knt3.Knt_KntId&#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwR_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT JOIN #tmpZasAtr ZasAtr ON Trs_TrSId = ZasAtr.TsC_TrSID&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0'&#xD;
&#xD;
exec (@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpZasAtr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+QLNy8SvsWvjndP4rYWmIrmw65/eZ7QPiim3cKUThrJOp91uo2s2QytZVCI0ahIBHPzdhq77ZDLGS8LuZiEj0zYsIgS5K2HrbyaqCJT/6WDiznZVF9elSOhzVl2dH/e0c9PnG3YSMpcSF3Y8x5vWCkpLScwlLQEW3Qqe7R0u8VkZs9N9mOdplX8Q/6cokntZkj4+ymM9XCT/A==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Dzień" caption="Data Dostawy Dzień" type="measure" formatString="" aggregate="Min" /&gt;&#xD;
    &lt;column name="Data Dostawy Tydzień Roku" caption="Data Dostawy Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Miesiąc" caption="Data Dostawy Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Kwartał" caption="Data Dostawy Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Rok" caption="Data Dostawy Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Dostawy Numer" caption="Dokument Dostawy Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Kod" caption="Dostawca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Nazwa" caption="Dostawca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość w Dostawie" caption="Ilość w Dostawie" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="" aggregate="Max" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Cena Zakupu" caption="Cena Zakupu" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAMAAAADAAAABwIdW1Byb2R1a3QgS29kXS5bVE9XQVJURVNGQUZaM10HAh5bUHJvZHVrdCBLb2RdLltUT1dBUlRFU1RGQUZaMl0HAh1bUHJvZHVrdCBLb2RdLltUT1dBUlRFU1RGQUZaXf////8YAAAABwIWW1Byb2R1a3QgS29kXS5bUEFMRVRBXQcCGFtQcm9kdWt0IEtvZF0uW1NLUlpZTktBXQcCGltQcm9kdWt0IEtvZF0uW09ES19MScWaQ0ldBwIeW1Byb2R1a3QgS29kXS5bR1JBQklFX0xJxZpDSUVdBwIaW1Byb2R1a3QgS29kXS5bR1JBQklFX09HUl0HAhlbUHJvZHVrdCBLb2RdLltSw5PFu0FfUE5dBwIYW1Byb2R1a3QgS29kXS5bS09SQV9TODBdBwIWW1Byb2R1a3QgS29kXS5bU1RPSkFLXQcCGFtQcm9kdWt0IEtvZF0uW1pJRU1JQV81XQcCGFtQcm9kdWt0IEtvZF0uW1NBRFpPTktJXQcCF1tQcm9kdWt0IEtvZF0uW1RVSkVfM0xdBwIcW1Byb2R1a3QgS29kXS5bUEnFgUFfRUxFS1RSXQcCH1tQcm9kdWt0IEtvZF0uW1BJxYFBX1NQQUxJTk9XQV0HAh1bUHJvZHVrdCBLb2RdLltJR0xBS0lfQ1lQUllTXQcCIFtQcm9kdWt0IEtvZF0uW0lHTEFLSV9KQcWBT1dJRUNdBwIcW1Byb2R1a3QgS29kXS5bUk9aRFJBQk5JQUNaXQcCF1tQcm9kdWt0IEtvZF0uW1NFS0FUT1JdBwIZW1Byb2R1a3QgS29kXS5bSkFCxYFPTklFXQcCF1tQcm9kdWt0IEtvZF0uW1NaUEFERUxdBwIaW1Byb2R1a3QgS29kXS5bWkVTVEFXX09HUl0HAhtbUHJvZHVrdCBLb2RdLltOT8W7WUNFX0VMLl0HAiJbUHJvZHVrdCBLb2RdLlvFgUHFg0NVQ0ggRE8gUEnFgVldBwIZW1Byb2R1a3QgS29kXS5bTk9XWVRPV0FSXQcCGltQcm9kdWt0IEtvZF0uW1RFU1RLT1JFS1Rd</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showMeasuresOnRows="False"&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Data Dostawy Dzień"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="118" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Dokument Dostawy Numer"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="174" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="105" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość w Dostawie"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" horzAlignment="Far" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" horzAlignment="Near" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Data Dostawy Dzień" index="2" expanded="True" width="118" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Ilość" index="0" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Ilość w Dostawie" index="1" expanded="True" width="100" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Dokument Dostawy Numer" index="1" expanded="True" order="ascending" width="174" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy dataFieldName="Data Dostawy Dzień" /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;row fieldName="Produkt Kod" index="0" expanded="True" order="ascending" width="105" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy dataFieldName="Data Dostawy Dzień" /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje ranking towarów, które najdłużej zalegają na magazynie. Stan aktualny. Ilości pogrupowane po towarze. Jeśli towar zalega z kilku dostaw pokazywana jest najwcześniejsza data.&#xD;
&#xD;
Raport nie będzie działał poprawnie jeśli ewidencjujemy magazyny metodą AVCO</a:description><a:id>259</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.19 Ranking produktów zalegających</a:mainLinkName><a:modifiedOn>2024-09-20T12:23:09.13</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-05-16T16:04:58.903</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Zasobów Magazynowych z Dostaw&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Zasobów&#xD;
DECLARE @atrybutyZas varchar(max);&#xD;
DECLARE @atrybutyZas2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in &#xD;
(&#xD;
SELECT DISTINCT TsC_Cecha1_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha2_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha3_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha4_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha5_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha6_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha7_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha8_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha9_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha10_DeAId FROM CDN.TraSElemCechy&#xD;
)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TsC_TrSID INTO #tmpZasAtr FROM CDN.TraSElemCechy&#xD;
&#xD;
SET @atrybutyZas = ''&#xD;
SET @atrybutyZas2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
       IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
       IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
       SET @sqlA = N'ALTER TABLE #tmpZasAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
       SET @sqlA = N'UPDATE #tmpZasAtr&#xD;
             SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = &#xD;
             CASE&#xD;
             WHEN ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha1_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha1_Wartosc END END&#xD;
             WHEN ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha2_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha2_Wartosc END END&#xD;
             WHEN ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha3_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha3_Wartosc END END &#xD;
             WHEN ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha4_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha4_Wartosc END END &#xD;
             WHEN ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha5_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha5_Wartosc END END&#xD;
             WHEN ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha6_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha6_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha6_Wartosc END END&#xD;
             WHEN ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha7_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha7_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha7_Wartosc END END&#xD;
             WHEN ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha8_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha8_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha8_Wartosc END END&#xD;
             WHEN ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha9_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha9_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha9_Wartosc END END&#xD;
             WHEN ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha10_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha10_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha10_Wartosc END END&#xD;
             ELSE ''(NIEPRZYPISANE)'' END&#xD;
             FROM CDN.TraSElemCechy ATR &#xD;
             JOIN #tmpZasAtr TM ON ATR.TsC_TrSID = TM.TsC_TrSID&#xD;
             WHERE ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
       EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyZas = @atrybutyZas + N', ISNULL(ZasAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Zasoby Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
&#xD;
       FETCH NEXT FROM atrybut_cursor&#xD;
       INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE&#xD;
    WHEN DDf_Numeracja like '@rejestr%' THEN 5 &#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    TrN_NumerPelny [Dokument Dostawy Numer], &#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TrN_NumerPelny,0,CHARINDEX(''/'',TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TrN_NumerPelny,CHARINDEX(''/'',TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],&#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca], &#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],&#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ],&#xD;
    CASE&#xD;
        WHEN DATEDIFF(day, TwZ_Data, GETDATE()) &lt; 0 THEN ''1. Poniżej 0 dni''&#xD;
        WHEN DATEDIFF(day, TwZ_Data, GETDATE()) BETWEEN 0 AND ' + CONVERT(VARCHAR,@PRZEDZIAL1) + ' THEN ''2. Do ' + CONVERT(VARCHAR,@PRZEDZIAL1) + ' dni''&#xD;
        WHEN DATEDIFF(day, TwZ_Data, GETDATE()) BETWEEN ' + CONVERT(VARCHAR,@PRZEDZIAL1) + ' + 1 AND ' + CONVERT(VARCHAR,@PRZEDZIAL2) + ' THEN ''3. Od ' + CONVERT(VARCHAR,@PRZEDZIAL1) + ' do ' + CONVERT(VARCHAR,@PRZEDZIAL2) + ' dni''&#xD;
        WHEN DATEDIFF(day, TwZ_Data, GETDATE()) BETWEEN ' + CONVERT(VARCHAR,@PRZEDZIAL2) + ' + 1 AND ' + CONVERT(VARCHAR,@PRZEDZIAL3) + ' THEN ''4. Od ' + CONVERT(VARCHAR,@PRZEDZIAL2) + ' do ' + CONVERT(VARCHAR,@PRZEDZIAL3) + ' dni''&#xD;
        ELSE ''5. Powyżej ' + CONVERT(VARCHAR,@PRZEDZIAL3) + ' dni'' &#xD;
    END [Produkt Zaleganie],&#xD;
    TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    ISNULL(knt.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Kod], &#xD;
    ISNULL(knt.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Nazwa], &#xD;
    ISNULL(knt3.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Kod],   &#xD;
    ISNULL(knt3.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Nazwa], &#xD;
    TwZ_Ilosc [Ilość], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),TwZ_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
    TrE_Ilosc [Ilość w Dostawie],   NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
    TwZ_Wartosc [Wartość Netto], TwZ_Wartosc * (1 + Twr_Stawka/100) [Wartość Brutto], TwZ_Cena [Cena Zakupu],&#xD;
    DATEDIFF(day, TwZ_Data, GETDATE()) AS [Liczba dni zalegania]&#xD;
    ,zal.Ope_Kod [Operator Wprowadzający] &#xD;
    ,mod.Ope_Kod [Operator Modyfikujący]&#xD;
/*&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TwZ_Data, 111), ''/'', ''-'') [Data Dostawy]&#xD;
*/&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TwZ_Data, 111), ''/'', ''-'') [Data Dostawy Dzień], (datepart(DY, datediff(d, 0, TwZ_Data) / 7 * 7 + 3)+6) / 7 [Data Dostawy Tydzień Roku]&#xD;
    ,MONTH(TwZ_Data) [Data Dostawy Miesiąc],    DATEPART(quarter, TwZ_Data) [Data Dostawy Kwartał], YEAR(TwZ_Data) [Data Dostawy Rok]&#xD;
    ,GETDATE() [Data Analizy]&#xD;
    ----------KONTEKSTY&#xD;
    ,CASE                               &#xD;
        WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
        WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
        WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
        WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
        WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
    END [Dokument Dostawy Numer __PROCID__PZ__], TrN_TrNId [Dokument Dostawy Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Dostawy Numer __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Kod __PROCID__Kontrahenci__], knt.Knt_KntId [Dostawca Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Nazwa __PROCID__], knt.Knt_KntId [Dostawca Pierwotny Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Dostawca Kod __PROCID__Kontrahenci__], knt3.Knt_KntId [Dostawca Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Nazwa __PROCID__], knt3.Knt_KntId [Dostawca Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Nazwa __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + @atrybutyZas + '&#xD;
 FROM CDN.TwrZasoby&#xD;
    JOIN CDN.Towary ON TwZ_TwrId = Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    JOIN CDN.Magazyny ON TwZ_MagId = Mag_MagId&#xD;
    JOIN CDN.TraSElem ON TwZ_TrSIdDost = TrS_TrSID&#xD;
    JOIN CDN.TraElem ON TrS_TrEId = TrE_TrEID&#xD;
    JOIN CDN.TraNag ON TrE_TrNId = TrN_TrNID&#xD;
LEFT JOIN #tmpSeria ser ON TrN_DDfId = DDf_DDfID&#xD;
    LEFT JOIN CDN.Kontrahenci knt ON TrN_PodId = KnT_KnTId AND TrN_PodmiotTyp = 1&#xD;
    LEFT JOIN CDN.Kontrahenci knt3 ON knt.Knt_GlID=knt3.Knt_KntId &#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwR_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT JOIN #tmpZasAtr ZasAtr ON Trs_TrSId = ZasAtr.TsC_TrSID&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
    LEFT JOIN ' + @Operatorzy + ' zal ON Twr_OpeZalID = zal.Ope_OpeId&#xD;
    LEFT JOIN ' + @Operatorzy + ' mod ON Twr_OpeModID = mod.Ope_OpeId&#xD;
'&#xD;
&#xD;
exec (@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpZasAtr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+QLNy8SvsWvjndP4rYWmIrmw65/eZ7QPiim3cKUThrJOp91uo2s2QytZVCI0ahIBHPzdhq77ZDLGV416eqisuhRvsBchYe/0nZ1nxm0MvuxGuMSkybFYJKikIyc3Jy8uSmQ13fU8LlOUnG1yBgPjtNfudwNqxTra3BFd8CawZLzfbHViM3udhwwi65LCa8cKtSBlCg2ZSO0nA==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Dzień" caption="Data Dostawy Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Tydzień Roku" caption="Data Dostawy Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Miesiąc" caption="Data Dostawy Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Kwartał" caption="Data Dostawy Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Rok" caption="Data Dostawy Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Dostawy Numer" caption="Dokument Dostawy Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Seria" caption="Dokument Seria" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Zaleganie" caption="Produkt Zaleganie" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Pierwotny Kod" caption="Dostawca Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Pierwotny Nazwa" caption="Dostawca Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Kod" caption="Dostawca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Nazwa" caption="Dostawca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość w Dostawie" caption="Ilość w Dostawie" type="measure" formatString="n2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="n2" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Cena Zakupu" caption="Cena Zakupu" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Liczba dni zalegania" caption="Liczba dni zalegania" type="measure" formatString="" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR FS" caption="Produkt Atrybut NR FS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut WILGOTNOSC" caption="Produkt Atrybut WILGOTNOSC" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ASDSADASDSADSADASD" caption="Produkt Atrybut ASDSADASDSADSADASD" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut TEST ATR ZALEZ OD KO" caption="Produkt Atrybut TEST ATR ZALEZ OD KO" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut SBITEST" caption="Produkt Atrybut SBITEST" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Zasoby Atrybut NR FS" caption="Zasoby Atrybut NR FS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Zasoby Atrybut WILGOTNOSC" caption="Zasoby Atrybut WILGOTNOSC" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;PRZEDZIAL1&lt;/Name&gt;&#xD;
    &lt;Label&gt;1 przedział do (liczba dni):&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Granica pierwszego przedziału zalegania. Do 1 przedziału wpadną towary zalegające od 0 dni do podanej wartości tego parametru&lt;/ToolTip&gt;&#xD;
    &lt;Type&gt;Liczba&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Number&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;1000&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;1&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;30&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;PRZEDZIAL2&lt;/Name&gt;&#xD;
    &lt;Label&gt;2 przedział do (liczba dni):&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Górna granica drugiego przedziału zalegania. Do 2 przedziału wpadną towary zalegające od granicy pierwszego przedziału do podanej wartości tego parametru&lt;/ToolTip&gt;&#xD;
    &lt;Type&gt;Liczba&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Number&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;1000&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;1&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;60&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;PRZEDZIAL3&lt;/Name&gt;&#xD;
    &lt;Label&gt;3 przedział do (liczba dni):&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Górna granica trzeciego przedziału zalegania. Do 3 przedziału wpadną towary zalegające od granicy drugiego przedziału do podanej wartości tego parametru&lt;/ToolTip&gt;&#xD;
    &lt;Type&gt;Liczba&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Number&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;1000&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;1&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;90&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="True" type="Pie" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="True" position="Outside" columnIndent="0" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="TopToBottom" alignmentVertical="Center" alignmentHorizontal="RightOutside" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Zaleganie w przedziałach" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX /&gt;&#xD;
    &lt;axisY /&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAMAAAAAAAAA/////wMAAAAHAihbUHJvZHVrdCBaYWxlZ2FuaWVdLlszLiBPZCAzMCBkbyA2MCBkbmldBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNC4gT2QgNjAgZG8gOTAgZG5pXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showMeasuresOnRows="False"&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Zaleganie"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" horzAlignment="Far" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" horzAlignment="Near" width="150" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Ilość" index="0" expanded="True" width="150" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;data fieldName="Wartość Netto" index="1" expanded="True" width="150" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Produkt Kod" index="1" expanded="True" width="150" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;row fieldName="Produkt Zaleganie" index="0" expanded="True" width="150" top="0" topType="TopAbsolute" dataField="" detailCaptionVisible="False" allowDisplayImages="False"&gt;&lt;sortBy /&gt;&lt;filters showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje zaleganie towarów na magazynie w przedziałach zalegania. Stan aktualny. Granice przedziałów należy podać podczas uruchamiania raportu.&#xD;
&#xD;
Raport nie będzie działał poprawnie jeśli ewidencjujemy magazyny metodą AVCO</a:description><a:id>260</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language i:nil="true"/><a:mainLinkName>7.20 Zaleganie w przedziałach</a:mainLinkName><a:modifiedOn>2024-10-08T13:52:45.89</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>14</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2016-05-19T14:31:48.657</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport produktów z dostaw na dzień&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Zasobów&#xD;
DECLARE @atrybutyZas varchar(max);&#xD;
DECLARE @atrybutyZas2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in &#xD;
(&#xD;
SELECT DISTINCT TsC_Cecha1_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha2_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha3_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha4_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha5_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha6_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha7_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha8_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha9_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha10_DeAId FROM CDN.TraSElemCechy&#xD;
)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TsC_TrSID INTO #tmpZasAtr FROM CDN.TraSElemCechy&#xD;
&#xD;
SET @atrybutyZas = ''&#xD;
SET @atrybutyZas2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
       IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
       IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
       SET @sqlA = N'ALTER TABLE #tmpZasAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
       SET @sqlA = N'UPDATE #tmpZasAtr&#xD;
             SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = &#xD;
             CASE&#xD;
                WHEN ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    else  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha1_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha1_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha2_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha2_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha3_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha3_Wartosc END END &#xD;
                WHEN ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha4_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha4_Wartosc END END &#xD;
                WHEN ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha5_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha5_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha6_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha6_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha6_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha7_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha7_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha7_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha8_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha8_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha8_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha9_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha9_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha9_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha10_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha10_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha10_Wartosc END END&#xD;
             ELSE ''(NIEPRZYPISANE)'' END&#xD;
             FROM CDN.TraSElemCechy ATR &#xD;
             JOIN #tmpZasAtr TM ON ATR.TsC_TrSID = TM.TsC_TrSID&#xD;
             WHERE ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
       EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyZas = @atrybutyZas + N', ISNULL(ZasAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Zasoby Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
&#xD;
       FETCH NEXT FROM atrybut_cursor&#xD;
       INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
    WHEN DDf_Numeracja like '@rejestr%' THEN 5 &#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    TrN_NumerPelny [Dokument Dostawy Numer], &#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TrN_NumerPelny,0,CHARINDEX(''/'',TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TrN_NumerPelny,CHARINDEX(''/'',TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],&#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    Twr_Nazwa [Produkt Nazwa], &#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],     &#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ],&#xD;
    TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    ISNULL(knt.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Kod],  &#xD;
    ISNULL(knt.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Nazwa], &#xD;
    ISNULL(knt3.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Kod],   &#xD;
    ISNULL(knt3.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Nazwa], &#xD;
    TrE_Ilosc [Ilość w Dostawie],&#xD;
    sumy.Ilosc AS [Ilość], &#xD;
    DATEDIFF(day,TS.TrS_DataOpe, ''' + CONVERT(VARCHAR,@Data) + ''') [Liczba dni zalegania],&#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),sumy.Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
    NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
    sumy.Wartosc [Wartość Netto], sumy.Wartosc * (1 + Twr_Stawka/100) [Wartość Brutto], TE.TrE_CenaT [Cena Zakupu] &#xD;
/*&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TS.TrS_DataOpe, 111), ''/'', ''-'') [Data Dostawy]&#xD;
*/&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TS.TrS_DataOpe, 111), ''/'', ''-'') [Data Dostawy Dzień], (datepart(DY, datediff(d, 0, TS.TrS_DataOpe) / 7 * 7 + 3)+6) / 7 [Data Dostawy Tydzień Roku] &#xD;
    ,MONTH(TS.TrS_DataOpe) [Data Dostawy Miesiąc],  DATEPART(quarter, TS.TrS_DataOpe) [Data Dostawy Kwartał], YEAR(TS.TrS_DataOpe) [Data Dostawy Rok]   &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
                                    ,CASE                               &#xD;
        WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
        WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
        WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
        WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
        WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
    END [Dokument Dostawy Numer __PROCID__PZ__], TrN_TrNId [Dokument Dostawy Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Dostawy Numer __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Kod __PROCID__Kontrahenci__], knt.Knt_KntId [Dostawca Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Nazwa __PROCID__], knt.Knt_KntId [Dostawca Pierwotny Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Dostawca Kod __PROCID__Kontrahenci__], knt3.Knt_KntId [Dostawca Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Nazwa __PROCID__], knt3.Knt_KntId [Dostawca Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Nazwa __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + @atrybutyZas + '&#xD;
FROM (SELECT TrS_TrSIdDost, TrS_MagId&#xD;
            ,SUM(CASE TrS_Typ WHEN 2 THEN -1 ELSE 1 END * TrS_Ilosc)  AS [Ilosc]&#xD;
            ,SUM(CASE TrS_Typ WHEN 2 THEN -1 ELSE 1 END * TrS_Wartosc)  AS [Wartosc]    &#xD;
        FROM CDN.TraSElem                       &#xD;
        WHERE TrS_DataOpe &lt;= ''' + CONVERT(VARCHAR,@Data) + ''' and trs_typ in (1,2)&#xD;
        GROUP BY TrS_TrSIdDost, TrS_MagId        &#xD;
        ) sumy &#xD;
INNER JOIN CDN.TraSElem TS ON sumy.TrS_TrSIdDost = TS.TrS_TrSID&#xD;
INNER JOIN CDN.TraElem TE ON TS.TrS_TrEId = TE.TrE_TrEID&#xD;
INNER JOIN CDN.TraNag TN ON TE.TrE_TrNId = TN.TrN_TrNID&#xD;
INNER JOIN CDN.Towary TK ON TE.TrE_TwrId = TK.Twr_TwrId&#xD;
INNER JOIN CDN.Magazyny MG ON MG.Mag_MagId = sumy.TrS_MagId&#xD;
LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
    LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
LEFT JOIN #tmpSeria ser ON TrN_DDfId = DDf_DDfID&#xD;
    LEFT JOIN CDN.Kontrahenci knt ON TrN_PodId = KnT_KnTId AND TrN_PodmiotTyp = 1&#xD;
    LEFT JOIN CDN.Kontrahenci knt3 ON knt.Knt_GlID=knt3.Knt_KntId&#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwR_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT JOIN #tmpZasAtr ZasAtr ON Trs_TrSId = ZasAtr.TsC_TrSID&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
    where (sumy.Wartosc &gt;0 or sumy.Ilosc &gt; 0) '&#xD;
&#xD;
exec (@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpZasAtr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM0zwJratE7ZrmpGGBehZ96iG/ZwwXfP7ZFIn0qVz+tUJ94McTCLWrfkkhybIpA9E6eh7GvxyEO0vrkPmZa9YHPszS+DuDCM+WOXMl2L7JevE0rKpZ3BAb8n4WSMm/1Nvhw5HlbQumS6ia0nUrGzffHU1jteAAptC5o8T+L/eQrlEiND6MiqzlSS/TQFHefppXw==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Dostawy Numer" caption="Dokument Dostawy Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Seria" caption="Dokument Seria" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dostawca Pierwotny Kod" caption="Dostawca Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Pierwotny Nazwa" caption="Dostawca Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Kod" caption="Dostawca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Nazwa" caption="Dostawca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość w Dostawie" caption="Ilość w Dostawie" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba dni zalegania" caption="Liczba dni zalegania" type="measure" formatString="n0" aggregate="Average" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Cena Zakupu" caption="Cena Zakupu" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Dostawy Dzień" caption="Data Dostawy Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Dostawy Tydzień Roku" caption="Data Dostawy Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Miesiąc" caption="Data Dostawy Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Kwartał" caption="Data Dostawy Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Rok" caption="Data Dostawy Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NUMER SERYJNY" caption="Produkt Atrybut NUMER SERYJNY" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATA&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stan magazynów na dzień:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data, dla której zostanie wykonana analiza.&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2018-05-25&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAUAAAAAAAAAAAAAAP////8VAAAABwIeW1Byb2R1a3QgS29kXS5bR1JBQklFX0xJxZpDSUVdBwIaW1Byb2R1a3QgS29kXS5bR1JBQklFX09HUl0HAiBbUHJvZHVrdCBLb2RdLltJR0xBS0lfSkHFgU9XSUVDXQcCGVtQcm9kdWt0IEtvZF0uW0pBQsWBT05JRV0HAhhbUHJvZHVrdCBLb2RdLltLT1JBX1M4MF0HAiJbUHJvZHVrdCBLb2RdLlvFgUHFg0NVQ0ggRE8gUEnFgVldBwIbW1Byb2R1a3QgS29kXS5bTk/Fu1lDRV9FTC5dBwIaW1Byb2R1a3QgS29kXS5bT0RLX0xJxZpDSV0HAhZbUHJvZHVrdCBLb2RdLltQQUxFVEFdBwIcW1Byb2R1a3QgS29kXS5bUEnFgUFfRUxFS1RSXQcCH1tQcm9kdWt0IEtvZF0uW1BJxYFBX1NQQUxJTk9XQV0HAhhbUHJvZHVrdCBLb2RdLltQUk9EVUtUMV0HAhxbUHJvZHVrdCBLb2RdLltST1pEUkFCTklBQ1pdBwIZW1Byb2R1a3QgS29kXS5bUsOTxbtBX1BOXQcCGFtQcm9kdWt0IEtvZF0uW1NBRFpPTktJXQcCF1tQcm9kdWt0IEtvZF0uW1NFS0FUT1JdBwIYW1Byb2R1a3QgS29kXS5bU0tSWllOS0FdBwIWW1Byb2R1a3QgS29kXS5bU1RPSkFLXQcCF1tQcm9kdWt0IEtvZF0uW1NaUEFERUxdBwIXW1Byb2R1a3QgS29kXS5bVFVKRV8zTF0HAhhbUHJvZHVrdCBLb2RdLltaSUVNSUFfNV0AAAAA</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument Dostawy Numer"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="147" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Magazyn Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="91" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Liczba dni zalegania"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" horzAlignment="Far" format="n0" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" horzAlignment="Near" width="107" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" horzAlignment="Far" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" horzAlignment="Near" width="110" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Data Dostawy Dzień"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Ilość" index="0" expanded="True" sortMode="default" order="ascending" width="91" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Liczba dni zalegania" index="2" expanded="True" sortMode="default" order="ascending" width="107" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Wartość Netto" index="1" expanded="True" sortMode="default" order="ascending" width="110" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Dokument Dostawy Numer" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Produkt Kod" index="0" expanded="True" sortMode="default" order="ascending" width="147" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Data Dostawy Dzień" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Magazyn Kod" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje zasoby magazynowe na dzień w podziale na dostawy, w których zostały przyjęte.&#xD;
&#xD;
Raport nie będzie działał poprawnie jeśli ewidencjujemy magazyny metodą AVCO</a:description><a:id>261</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.21 Produkty z dostaw na dzień</a:mainLinkName><a:modifiedOn>2024-09-20T12:26:28.32</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>8</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2017-05-18T11:55:21.55</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych na dzień dla grupy produktowej&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Liczenie ostatniej daty w bazie&#xD;
SELECT TwI_TwrId [TwI_TId], ISNULL(TwI_MagId,0) [TwI_MId], MAX(TwI_Data) [TwI_OstatniaData] INTO #TwrIlosci&#xD;
FROM CDN.TwrIlosci&#xD;
WHERE TwI_Data &lt;= @DATA&#xD;
GROUP BY TwI_TwrId, TwI_MagId&#xD;
&#xD;
--Liczenie korekty braków&#xD;
SELECT TwI_TwrId [TwI_TId], SUM((CASE WHEN TwI_MagId IS NULL THEN 1 ELSE -1 END)*TwI_Braki) [Braki] INTO #TwrBraki&#xD;
FROM CDN.TwrIlosci&#xD;
JOIN #TwrIlosci TI ON TI.TwI_TId = TwI_TwrId AND TI.TwI_MId=ISNULL(TwI_MagId,0) AND TI.TwI_OstatniaData = TwI_Data&#xD;
GROUP BY TwI_TwrId&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
    AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
    AND TrE_DataOpe = @Data&#xD;
GROUP BY TrE_MagId, TrE_TwrId   &#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select =&#xD;
'SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca], &#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],     &#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    ISNULL(TwI_Ilosc, 0) [Ilość], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
    ISNULL(TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END  [Rezerwacje Jednostka Pomocnicza], &#xD;
    ISNULL(TwI_Braki, 0) [Braki], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
    ISNULL(TwI_Zamowienia, 0) [Zamówienia], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
    ISNULL(TwI_Wartosc, 0) [Wartość Netto], ISNULL(TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto],&#xD;
    NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
    SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość]&#xD;
&#xD;
    ----------KONTEKSTY&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + '&#xD;
FROM CDN.TwrIlosci&#xD;
    LEFT OUTER JOIN CDN.Magazyny ON Mag_MagId = TwI_MagId&#xD;
    JOIN CDN.Towary ON TwI_TwrId = Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    JOIN #TwrIlosci ON TwI_TId = TwI_TwrId AND TwI_OstatniaData = TwI_Data AND TwI_MId = TwI_MagId&#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwI_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TwI_MagId = TrE_MagId AND TwI_TwrId = TrE_TwrId&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
    WHERE Poz.gidnumer in ('+ convert(varchar,@GRUPA) +') '&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + 'and ISNULL(TwI_Ilosc, 0) &lt;&gt; 0'&#xD;
&#xD;
SET @select = @select + '&#xD;
&#xD;
UNION ALL&#xD;
&#xD;
SELECT BAZ.Baz_Nazwa [Baza Firmowa],    &#xD;
    Twr_Kod [Produkt Kod],&#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],     &#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    ''(Korekta Braków)'' [Magazyn Kod],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    NULL [Ilość], &#xD;
    NULL [Ilość Jednostka Pomocnicza], &#xD;
    NULL [Rezerwacje], &#xD;
    NULL  [Rezerwacje Jednostka Pomocnicza], &#xD;
    Braki [Braki], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
    NULL[Zamówienia], &#xD;
    NULL [Zamówienia Jednostka Pomocnicza],&#xD;
    NULL [Wartość Netto], NULL [Wartość Brutto],&#xD;
    NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
    NULL [Sprzedaż Wartość Netto], NULL [Sprzedaż Ilość]&#xD;
&#xD;
    ----------KONTEKSTY&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], 1 [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + '&#xD;
FROM CDN.Towary&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    JOIN #TwrBraki ON TwI_TId = Twr_TwrId AND Braki &lt;&gt; 0&#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON Twr_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
    WHERE Poz.gidnumer in ('+ convert(varchar,@GRUPA) +')'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #TwrIlosci&#xD;
DROP TABLE #TwrBraki&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSprzedaz&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+QLNy8SvsWvjndP4rYWmIrmw65/eZ7QPiim3cKUThrJOp91uo2s2QytZVCI0ahIBHPzdhq77ZDLGS8LuZiEj0zYsIgS5K2HrbyaqCJT/6WDiznZVF9elSOhzVl2dH/e0c9PnG3YSMpcSF3Y8x5vWCkpLScwlLQEW3Qqe7R0u8VkZs9N9mOdplX8Q/6cokntZkj4+ymM9XCT/A==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="" aggregate="Max" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 6" caption="Produkt Grupa Poziom 6" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut WAGA BRUTTO" caption="Produkt Atrybut WAGA BRUTTO" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PAPIER/TEKTURA" caption="Produkt Atrybut PAPIER/TEKTURA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut TWORZYWO" caption="Produkt Atrybut TWORZYWO" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DRZEWO" caption="Produkt Atrybut DRZEWO" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut BATERIE" caption="Produkt Atrybut BATERIE" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut WAGA NETTO" caption="Produkt Atrybut WAGA NETTO" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut METAL" caption="Produkt Atrybut METAL" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATA&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stan magazynów na dzień:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data, dla której zostanie wykonana analiza&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2017-05-25&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;GRUPA&lt;/Name&gt;&#xD;
    &lt;Label&gt;Grupa produktowa:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Grupa produktowa, dla której zostaną wyświetlone wyniki analizy&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GIDNumer, Sciezka FROM CDN.fnTwrGrupy() WHERE TwGID &amp;lt;&amp;gt; 0 ORDER BY Sciezka&lt;/Expression&gt;&#xD;
    &lt;Type&gt;SQL&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Sql&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Produkt Nazwa"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Magazyn Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="93" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Rezerwacje"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="109" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Braki"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="98" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Zamówienia"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="121" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="122" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Wartość Brutto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="127" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Ilość" index="0" expanded="True" sortMode="default" order="ascending" width="93" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Rezerwacje" index="1" expanded="True" sortMode="default" order="ascending" width="109" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Braki" index="2" expanded="True" sortMode="default" order="ascending" width="98" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Zamówienia" index="3" expanded="True" sortMode="default" order="ascending" width="121" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Wartość Netto" index="4" expanded="True" sortMode="default" order="ascending" width="122" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Wartość Brutto" index="5" expanded="True" sortMode="default" order="ascending" width="127" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Produkt Nazwa" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Magazyn Kod" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje stany magazynów dla jednej grupy produktowej.</a:description><a:id>262</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.22 Stany magazynów dla grupy produktowej</a:mainLinkName><a:modifiedOn>2024-09-08T14:56:28.017</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2017-05-24T16:25:55.633</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Zalegania Zasobów Magazynowych z Dostaw na dzień w przedziałach&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Zasobów&#xD;
DECLARE @atrybutyZas varchar(max);&#xD;
DECLARE @atrybutyZas2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in &#xD;
(&#xD;
SELECT DISTINCT TsC_Cecha1_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha2_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha3_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha4_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha5_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha6_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha7_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha8_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha9_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha10_DeAId FROM CDN.TraSElemCechy&#xD;
)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TsC_TrSID INTO #tmpZasAtr FROM CDN.TraSElemCechy&#xD;
&#xD;
SET @atrybutyZas = ''&#xD;
SET @atrybutyZas2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
       IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
       IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
       SET @sqlA = N'ALTER TABLE #tmpZasAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
       SET @sqlA = N'UPDATE #tmpZasAtr&#xD;
             SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = &#xD;
             CASE&#xD;
                WHEN ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    else  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha1_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha1_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha2_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha2_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha3_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha3_Wartosc END END &#xD;
                WHEN ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha4_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha4_Wartosc END END &#xD;
                WHEN ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha5_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha5_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha6_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha6_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha6_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha7_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha7_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha7_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha8_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha8_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha8_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha9_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha9_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha9_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha10_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha10_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha10_Wartosc END END&#xD;
             ELSE ''(NIEPRZYPISANE)'' END&#xD;
             FROM CDN.TraSElemCechy ATR &#xD;
             JOIN #tmpZasAtr TM ON ATR.TsC_TrSID = TM.TsC_TrSID&#xD;
             WHERE ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
       EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyZas = @atrybutyZas + N', ISNULL(ZasAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Zasoby Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
&#xD;
       FETCH NEXT FROM atrybut_cursor&#xD;
       INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
    WHEN DDf_Numeracja like '@rejestr%' THEN 5 &#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    TrN_NumerPelny [Dokument Dostawy Numer], &#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TrN_NumerPelny,0,CHARINDEX(''/'',TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TrN_NumerPelny,CHARINDEX(''/'',TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],&#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca], &#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],     &#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ],&#xD;
    TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna],    &#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    ISNULL(knt.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Kod],  &#xD;
    ISNULL(knt.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Nazwa], &#xD;
    ISNULL(knt3.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Kod],   &#xD;
    ISNULL(knt3.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Nazwa], &#xD;
    TrE_Ilosc [Ilość w Dostawie],&#xD;
    sumy.Ilosc AS [Ilość], &#xD;
    DATEDIFF(day,TS.TrS_DataOpe, ''' + CONVERT(VARCHAR,@Data) + ''') [Liczba dni zalegania],&#xD;
&#xD;
    CASE&#xD;
        WHEN DATEDIFF(day, TS.TrS_DataOpe,'''+CONVERT(Varchar,@DATA)+''') &lt; 0 THEN ''1. Poniżej 0 dni''&#xD;
        WHEN DATEDIFF(day, TS.TrS_DataOpe,'''+CONVERT(Varchar,@DATA)+''') BETWEEN 0 AND ' + CONVERT(VARCHAR,@PRZEDZIAL1) + ' THEN ''2. Do ' + CONVERT(VARCHAR,@PRZEDZIAL1) + ' dni''&#xD;
        WHEN DATEDIFF(day, TS.TrS_DataOpe,'''+CONVERT(Varchar,@DATA)+''') BETWEEN ' + CONVERT(VARCHAR,@PRZEDZIAL1) + ' + 1 AND ' + CONVERT(VARCHAR,@PRZEDZIAL2) + ' THEN ''3. Od ' + CONVERT(VARCHAR,@PRZEDZIAL1) + ' do ' + CONVERT(VARCHAR,@PRZEDZIAL2) + ' dni''&#xD;
        WHEN DATEDIFF(day, TS.TrS_DataOpe,'''+CONVERT(Varchar,@DATA)+''') BETWEEN ' + CONVERT(VARCHAR,@PRZEDZIAL2) + ' + 1 AND ' + CONVERT(VARCHAR,@PRZEDZIAL3) + ' THEN ''4. Od ' + CONVERT(VARCHAR,@PRZEDZIAL2) + ' do ' + CONVERT(VARCHAR,@PRZEDZIAL3) + ' dni''&#xD;
        ELSE ''5. Powyżej ' + CONVERT(VARCHAR,@PRZEDZIAL3) + ' dni'' &#xD;
    END [Produkt Zaleganie],&#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),sumy.Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
    NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
    sumy.Wartosc [Wartość Netto], sumy.Wartosc * (1 + Twr_Stawka/100) [Wartość Brutto], TE.TrE_CenaT [Cena Zakupu] &#xD;
/*&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TS.TrS_DataOpe, 111), ''/'', ''-'') [Data Dostawy]&#xD;
*/&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TS.TrS_DataOpe, 111), ''/'', ''-'') [Data Dostawy Dzień], (datepart(DY, datediff(d, 0, TS.TrS_DataOpe) / 7 * 7 + 3)+6) / 7 [Data Dostawy Tydzień Roku]&#xD;
    ,MONTH(TS.TrS_DataOpe) [Data Dostawy Miesiąc],  DATEPART(quarter, TS.TrS_DataOpe) [Data Dostawy Kwartał], YEAR(TS.TrS_DataOpe) [Data Dostawy Rok]   &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
                                    ,CASE                               &#xD;
        WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
        WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
        WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
        WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
        WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
    END [Dokument Dostawy Numer __PROCID__PZ__], TrN_TrNId [Dokument Dostawy Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Dostawy Numer __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Kod __PROCID__Kontrahenci__], knt.Knt_KntId [Dostawca Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Nazwa __PROCID__], knt.Knt_KntId [Dostawca Pierwotny Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Dostawca Kod __PROCID__Kontrahenci__], knt3.Knt_KntId [Dostawca Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Nazwa __PROCID__], knt3.Knt_KntId [Dostawca Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Nazwa __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + @atrybutyZas + '&#xD;
FROM (SELECT TrS_TrSIdDost, TrS_MagId&#xD;
            ,SUM(CASE TrS_Typ WHEN 2 THEN -1 ELSE 1 END * TrS_Ilosc)  AS [Ilosc]&#xD;
            ,SUM(CASE TrS_Typ WHEN 2 THEN -1 ELSE 1 END * TrS_Wartosc)  AS [Wartosc]    &#xD;
        FROM CDN.TraSElem                       &#xD;
        WHERE TrS_DataOpe &lt;= ''' + CONVERT(VARCHAR,@Data) + '''&#xD;
        GROUP BY TrS_TrSIdDost, TrS_MagId&#xD;
        HAVING SUM(CASE TrS_Typ WHEN 1 THEN 1 WHEN 2 THEN -1 END * TrS_Ilosc) &gt; 0  &#xD;
        ) sumy &#xD;
INNER JOIN CDN.TraSElem TS ON sumy.TrS_TrSIdDost = TS.TrS_TrSID&#xD;
INNER JOIN CDN.TraElem TE ON TS.TrS_TrEId = TE.TrE_TrEID&#xD;
INNER JOIN CDN.TraNag TN ON TE.TrE_TrNId = TN.TrN_TrNID&#xD;
INNER JOIN CDN.Towary TK ON TE.TrE_TwrId = TK.Twr_TwrId&#xD;
INNER JOIN CDN.Magazyny MG ON MG.Mag_MagId = sumy.TrS_MagId&#xD;
LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
    LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
LEFT JOIN #tmpSeria ser ON TrN_DDfId = DDf_DDfID&#xD;
    LEFT JOIN CDN.Kontrahenci knt ON TrN_PodId = KnT_KnTId AND TrN_PodmiotTyp = 1&#xD;
    LEFT JOIN CDN.Kontrahenci knt3 ON knt.Knt_GlID=knt3.Knt_KntId&#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwR_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT JOIN #tmpZasAtr ZasAtr ON Trs_TrSId = ZasAtr.TsC_TrSID&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0'&#xD;
&#xD;
exec (@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpZasAtr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+QLNy8SvsWvjndP4rYWmIrmw65/eZ7QPiim3cKUThrJOp91uo2s2QytZVCI0ahIBHPzdhq77ZDLGV416eqisuhRvsBchYe/0nZ1nxm0MvuxGuMSkybFYJKikIyc3Jy8uSmQ13fU8LlOUnG1yBgPjtNfudwNqxTra3BFd8CawZLzfbHViM3udhwwi65LCa8cKtSBlCg2ZSO0nA==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Dzień" caption="Data Dostawy Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Dostawy Tydzień Roku" caption="Data Dostawy Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Miesiąc" caption="Data Dostawy Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Kwartał" caption="Data Dostawy Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Rok" caption="Data Dostawy Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Dostawy Numer" caption="Dokument Dostawy Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Seria" caption="Dokument Seria" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Pierwotny Kod" caption="Dostawca Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Pierwotny Nazwa" caption="Dostawca Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Kod" caption="Dostawca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Nazwa" caption="Dostawca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość w Dostawie" caption="Ilość w Dostawie" type="measure" formatString="" aggregate="Average" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba dni zalegania" caption="Liczba dni zalegania" type="measure" formatString="n2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Zaleganie" caption="Produkt Zaleganie" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Cena Zakupu" caption="Cena Zakupu" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR FS" caption="Produkt Atrybut NR FS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut WILGOTNOSC" caption="Produkt Atrybut WILGOTNOSC" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ASDSADASDSADSADASD" caption="Produkt Atrybut ASDSADASDSADSADASD" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut TEST ATR ZALEZ OD KO" caption="Produkt Atrybut TEST ATR ZALEZ OD KO" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut SBITEST" caption="Produkt Atrybut SBITEST" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Zasoby Atrybut NR FS" caption="Zasoby Atrybut NR FS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Zasoby Atrybut WILGOTNOSC" caption="Zasoby Atrybut WILGOTNOSC" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATA&lt;/Name&gt;&#xD;
    &lt;Label&gt;Zaleganie w przedziałach na dzień:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data, dla której zostanie wykonana analiza.&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2017-05-24&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;PRZEDZIAL1&lt;/Name&gt;&#xD;
    &lt;Label&gt;1 przedział do (liczba dni):&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Granica pierwszego przedziału zalegania. Do 1 przedziału wpadną towary zalegające od 0 dni do podanej wartości tego parametru&lt;/ToolTip&gt;&#xD;
    &lt;Expression /&gt;&#xD;
    &lt;Type&gt;Liczba&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Number&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;10000&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;1&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;30&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;PRZEDZIAL2&lt;/Name&gt;&#xD;
    &lt;Label&gt;2 przedział do (liczba dni):&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Górna granica drugiego przedziału zalegania. Do 2 przedziału wpadną towary zalegające od granicy pierwszego przedziału do podanej wartości tego parametru&lt;/ToolTip&gt;&#xD;
    &lt;Expression /&gt;&#xD;
    &lt;Type&gt;Liczba&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Number&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;10000&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;1&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;60&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;PRZEDZIAL3&lt;/Name&gt;&#xD;
    &lt;Label&gt;3 przedział do (liczba dni):&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Górna granica trzeciego przedziału zalegania. Do 3 przedziału wpadną towary zalegające od granicy drugiego przedziału do podanej wartości tego parametru&lt;/ToolTip&gt;&#xD;
    &lt;Expression /&gt;&#xD;
    &lt;Type&gt;Liczba&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Number&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;10000&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;1&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;90&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="False" type="Pie" palette="In A Fog" paletteBaseColor="0" style="In A Fog" grandTotals="False" subTotals="False" onlySelected="False" showSeriesInSeparatePanes="False" fieldVisible="False" dataVertical="True" showParametersValues="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Outside" columnIndent="0" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1" textOrientation="Horizontal"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="TopToBottom" alignmentVertical="Center" alignmentHorizontal="RightOutside" spacingVertical="2" spacingHorizontal="4" limitsVertical="100" limitsHorizontal="100" location="{X=1126,Y=75}" isCustomLocation="False"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="Black" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="7.23 Zaleganie w przedziałach na dzień" visible="True" dock="Top" alignment="Center" indent="5" location="{X=789,Y=5}" isCustomLocation="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="Black" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;pointOptions pointView="Values" pattern="{V}"&gt;&#xD;
    &lt;valueNumericOptions numericFormat="General" numericPrecision="2" /&gt;&#xD;
    &lt;valueDateTimeOptions dateTimeFormat="ShortDate" dateTimeFormatString="" /&gt;&#xD;
    &lt;argumentNumericOptions numericFormat="General" numericPrecision="2" /&gt;&#xD;
    &lt;argumentDateTimeOptions dateTimeFormat="ShortDate" dateTimeFormatString="" /&gt;&#xD;
    &lt;piePointOptions&gt;&#xD;
      &lt;percentOption valueAsPercent="True" percentageAccuracy="2" /&gt;&#xD;
    &lt;/piePointOptions&gt;&#xD;
    &lt;simplePointOptions&gt;&#xD;
      &lt;percentOption valueAsPercent="True" percentageAccuracy="2" /&gt;&#xD;
    &lt;/simplePointOptions&gt;&#xD;
  &lt;/pointOptions&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX /&gt;&#xD;
    &lt;axisY /&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAcAAAABAAAABwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXcAAAAAHAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQkUvSUtBXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltCRS9JVzYtQlAtRF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQk9ULU1QXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCVFItQVRdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0JUUi1NM10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQlpQLU1QXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltCWlAtVF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bREEvSVc2LUJQLURdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW0RSL0lXNi84LUJFXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh9bUHJvZHVrdCBLb2RdLltEUi9JVzYvOC1CUC1FQ09dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHFtQcm9kdWt0IEtvZF0uW0RSL0lXNi1CUC1ERV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bRFIvSVc2LUJQLUVDT10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bRFIvSVc2LUZMXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltEUi9JVzYtR1BdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW0RSL0lXNi1HUC1OXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLltEUi9JVzYtUEYtREZdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW0RSL1BTNi0xLVctQlAtREVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIVtQcm9kdWt0IEtvZF0uW0RSL1BTNi0yLVctQlAtRUNPXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiFbUHJvZHVrdCBLb2RdLltEUi9QUzgtMi1XLUJQLUVDT10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bR0EvSUtBXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltHQS9JVzYtQlAtRF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bR0EvSVc4LUJQLUVDT10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bR0EvUFM2LTEtTF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIfW1Byb2R1a3QgS29kXS5bR0EvUFM2LTEtVy1CUC1EXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltHTi9JVzYtQlAtRV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bR04vSVc2LUVQMl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bR04vUE02LTEtVy1CUC1ERV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIXW1Byb2R1a3QgS29kXS5bR08vQlJEUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bR1IvSUtBXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltHUi9JVzYtQlAtRF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bR1IvSVc2LUVQMV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bR1IvUFM2LTEtTF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSUtBXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJTUFdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCF1tQcm9kdWt0IEtvZF0uW0lWL0JSRFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGFtQcm9kdWt0IEtvZF0uW0lXNi84LUJFXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltJVzYtQkVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0lXNi1CRl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bSVc2LUJQLUFCXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhhbUHJvZHVrdCBLb2RdLltJVzYtQlAtRF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bSVc2LUJQLUVDT10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bSVc2LUJQLUxJXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltJVzYtQ0FdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGFtQcm9kdWt0IEtvZF0uW0lXNi1FRi1BXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhhbUHJvZHVrdCBLb2RdLltJVzYtRUYtTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bSVc2LUVQXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltJVzYtR1BdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0lXNi1NR10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bSVc2LVJQXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltJVzYtVU1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGFtQcm9kdWt0IEtvZF0uW0lXOC1CUC1EXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltJVzgtQlAtREVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGFtQcm9kdWt0IEtvZF0uW0lXOC1CUC1FXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltJVzgtQlAtRUNPXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltKQS9JVzYtRVAyXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltLQS9JS0FdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHFtQcm9kdWt0IEtvZF0uW0tBL0lXNi1CUC1ERV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bS0EvSVc2LUJQLUVDT10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bS0EvSVc2LUZMXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh5bUHJvZHVrdCBLb2RdLltLQS9QUzYtMS1XLURQRV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bS0EvUFM2LTEtVy1GTF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bS0kvSVc2LUJQLUVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCF1tQcm9kdWt0IEtvZF0uW0tKL0JSRFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW0tPL0lXNi1CUC1FXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLltLVy9JVzYtQlAtREVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHFtQcm9kdWt0IEtvZF0uW0tXL0lXNi1QRi1ERl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bS1cvSVc2LVVNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltLVy9QUzYtMS1XLUJQLURFXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltLVy9QUzYtMS1XLVBGLURGXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLlvFgVUvSVc2LUJQLURdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCF1tQcm9kdWt0IEtvZF0uW09ML0JSRFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW09QIC9JVzYtQlAtREVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW09TL0lLQV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bT1MvSVc2LUJQLUVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCH1tQcm9kdWt0IEtvZF0uW09TL1BTNi0xLVctQlAtRV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIhW1Byb2R1a3QgS29kXS5bT1QvSVc2LzgtQlAtRUNPLVRdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW09UL0lXNi1CUC1FQ09dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW09UL0lXNi1QUk8tQ0FOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltPVC9JVzgtQlAtRUNPXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiFbUHJvZHVrdCBLb2RdLltPVC9QUzYtMi1XLUJQLUVDT10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIhW1Byb2R1a3QgS29kXS5bT1QvUFM4LTItVy1CUC1FQ09dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHFtQcm9kdWt0IEtvZF0uW1BJL0lXNi1CUC1BQl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bUEkvSVc2LUJQLURdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1BJL0lXNi1FUDFdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1BNNi1CUC1FQ09dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGFtQcm9kdWt0IEtvZF0uW1BNOC1MLUEyXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltQUzYtQl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUFM2LUxdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGFtQcm9kdWt0IEtvZF0uW1BTNi1XLUJMXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQUzYtVy1CUC1EXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQUzYtVy1CUC1FXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQUzYtVy1FUy1FXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltQUzYtVy1QRi1ERl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUFM4LUJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1JVL0lLQV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIhW1Byb2R1a3QgS29kXS5bUlUvSVc2LzgtQlAtRUNPLVRdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW1JVL0lXNi84LU5FXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltSVS9JVzYtQkYtVF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIcW1Byb2R1a3QgS29kXS5bUlUvSVc2LUJQLURFXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh5bUHJvZHVrdCBLb2RdLltSVS9JVzYtQlAtREUtVF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bUlUvSVc2LUJQLUVDT10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIeW1Byb2R1a3QgS29kXS5bUlUvSVc2LUJQLUVTLUVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW1JVL0lXNi1CUC1FUy1FLVRdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW1JVL0lXNi1CVV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bUlUvSVc2LUZMXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltSVS9JVzYtRkwtVF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bUlUvSVc2LUdQXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltSVS9JVzYtSEFdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW1JVL0lXNi1JU10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIcW1Byb2R1a3QgS29kXS5bUlUvSVc2LVBGLURHXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLltSVS9JVzYtUEYtRFpdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW1JVL0lXNi1QRi1EWi1UXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltSVS9JVzYtVU0tVF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIcW1Byb2R1a3QgS29kXS5bUlUvSVc4LUJQLURFXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltSVS9JVzgtQlAtRUNPXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh5bUHJvZHVrdCBLb2RdLltSVS9JVzgtQlAtRVMtRV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtQl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtQi1FUy9JS10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtTC9TQ10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtTC1FUy9JS10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERS9EUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERS9JS10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERS9TQ10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIfW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiJbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUUvSUtdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCJFtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRS9JS1dJXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLU5FL0lLXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUZMXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUZML0tBXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUZML1JaXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUdQL0RSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUhBLURFL1NDXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLU5FXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLVBGLURaXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLVBGLVJGL0RSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltSVS9QUzYtMi1CL1NDXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltSVS9QUzgtMS1MLUVTL0lLXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzgtMS1XLUJQLURFL0lLXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiJbUHJvZHVrdCBLb2RdLltSVS9QUzgtMS1XLUVTLUUvSUtdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCJFtQcm9kdWt0IEtvZF0uW1JVL1BTOC0yLVctQlAtRUNPL0RSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltSWi9JS0FdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW1JaL0lXNi1CUC1FXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltSWi9JVzYtQlAtRUNPXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh5bUHJvZHVrdCBLb2RdLltSWi9JVzYtQlAtRVMtRV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bUlovSVc2LUZMXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltSWi9JVzYtR1BdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW1JaL0lXOC1CUC1ERS1UXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltSWi9JVzgtR1AtVF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bUlovUFM2LTEtVy1GTF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bUlovUFM4LTEtVy1HUF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bU0YtQ1pdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGUy1NXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTRlMtUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUy1HQVpdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1NNxbstVF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bU05TXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhRbUHJvZHVrdCBLb2RdLltTLU9OXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTLVBBTF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bU1QvSVc2LUJQLURdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHFtQcm9kdWt0IEtvZF0uW1NUL0lXNi1CUC1ERV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bU1QvSVc2LUhBXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLltTVC9JVzYtUEYtREVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW1NUL0lXOC1CUC1EXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh9bUHJvZHVrdCBLb2RdLltTVC9QUzYtMS1XLUJQLUVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW1NUL1BTNi0xLVctSEFdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW1NURF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bU1RULU1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NUVC1TXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltTVFQtU1ddBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW1NXL0lXNi1CUC1FXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltTVy9QUzYtMS1CXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh9bUHJvZHVrdCBLb2RdLltTVy9QUzYtMS1XLUJQLUVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW1NXNi1CUC1BQl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bU1c2LUJQLURFXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltTVzYtUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1NXNi1VTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bU1ctQkJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLltUTy9JVzYtQlAtREVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW1RPL0lXNi1HUF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bVE8vSVc2LUhBXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhRbUHJvZHVrdCBLb2RdLltUUi1UXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltXRS9JVzgtQlAtRUNPXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltXSS9JVzYtQkZdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW1dJL0lXNi1CUC1FUy1FXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltXSS9JVzYtQlVdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW1dJL1BTNi0xLVctQkZdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1pCL0JSRFIvU0VdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIltQcm9kdWt0IEtvZF0uW1pCL1BTNi0xLVctQlAtRS9LT10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIiW1Byb2R1a3QgS29kXS5bWkIvUFM2LTEtVy1FUy1FL1dJXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltaUy9TxYFdZQMAAAcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCRS9JS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDUvMTEvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bQkUvSVc2LUJQLURdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMTAvMTEvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQk9ULU1QXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA1LzAxLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0JPVC1NUF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA4OC8xMC8yMDE3L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCT1QtTVBdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwODkvMDgvMjAxNy9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQlRSLUFUXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDIwLzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0JUUi1BVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAyMS8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCVFItQVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMjIvMDgvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQlRSLUFUXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU1LzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0JUUi1BVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA1Ni8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCVFItQVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNTgvMDgvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQlRSLUFUXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDYwLzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0JUUi1BVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE1Mi8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCVFItQVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxNTMvMDgvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQlRSLUFUXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTU0LzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0JUUi1BVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE1NS8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCVFItQVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxNTgvMDgvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQlRSLUFUXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTU5LzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0JUUi1BVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE2NC8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCVFItQVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxNjUvMDgvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQlRSLUFUXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTc3LzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0JUUi1BVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE3OC8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCVFItQVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxNzkvMDgvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQlRSLUFUXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTgwLzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0JUUi1BVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE4MS8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCVFItQVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAyOTcvMDcvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQlRSLUFUXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMjk4LzA3LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0JUUi1NM10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwNS8wMS8yMDE3L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCWlAtTVBdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDQvMDEvMjAxNy9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQlpQLU1QXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU1LzA0LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0JaUC1NUF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE3OC8wNC8yMDE3L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCWlAtTVBdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxNzkvMDQvMjAxNy9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQlpQLU1QXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMjI0LzA0LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0JaUC1NUF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDIyNS8wNS8yMDE3L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltCWlAtTVBdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAyMjYvMDUvMjAxNy9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bQlpQLU1QXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMjI3LzA1LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA4LzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDEyLzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDIxLzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI2LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU2LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDYxLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDY4LzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDcwLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDczLzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDc0LzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDgyLzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTA3LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTExLzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTEyLzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTE2LzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTI2LzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTMwLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTMyLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTM1LzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTM4LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQwLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTU0LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTY5LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTY5LzExLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTcwLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTg2LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMjAwLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMjI2LzEwLzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMjQwLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMjQ3LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMjUwLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMjc2LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMzAwLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMzAzLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMzEzLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMzQxLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMzQ1LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMzQ4LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMzUzLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMzYxLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMzg4LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMzkxLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMzkyLzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMzk1LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW0JaUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwNDA2LzA5LzIwMTcvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW0RBL0lXNi1CUC1EXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW0RSL0lXNi84LUJFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCH1tQcm9kdWt0IEtvZF0uW0RSL0lXNi84LUJQLUVDT10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMS8wMy8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLltEUi9JVzYtQlAtREVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMDMvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIcW1Byb2R1a3QgS29kXS5bRFIvSVc2LUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAyLzAyLzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW0RSL0lXNi1CUC1FQ09dBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDMvMDEvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bRFIvSVc2LUZMXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzEyLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW0RSL0lXNi1HUF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8xMS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltEUi9JVzYtR1AtTl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8xMS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLltEUi9JVzYtUEYtREZdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDIvMDIvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bRFIvUFM2LTEtVy1CUC1ERV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8wMS8yMDE4L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltEUi9QUzYtMS1XLUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU4LzAyLzIwMTgvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW0RSL1BTNi0xLVctQlAtREVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNzIvMDIvMjAxOC9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bRFIvUFM2LTEtVy1CUC1ERV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA4NC8wMy8yMDE4L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltEUi9QUzYtMS1XLUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTEzLzEyLzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIVtQcm9kdWt0IEtvZF0uW0RSL1BTNi0yLVctQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQxLzAxLzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIVtQcm9kdWt0IEtvZF0uW0RSL1BTNi0yLVctQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQ2LzAyLzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIVtQcm9kdWt0IEtvZF0uW0RSL1BTNi0yLVctQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDUxLzAzLzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIVtQcm9kdWt0IEtvZF0uW0RSL1BTNi0yLVctQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTEzLzAxLzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIVtQcm9kdWt0IEtvZF0uW0RSL1BTOC0yLVctQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA1LzA1LzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIVtQcm9kdWt0IEtvZF0uW0RSL1BTOC0yLVctQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE2LzAzLzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIVtQcm9kdWt0IEtvZF0uW0RSL1BTOC0yLVctQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQ1LzAzLzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIVtQcm9kdWt0IEtvZF0uW0RSL1BTOC0yLVctQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTI2LzAzLzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0dBL0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNC8wMy8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltHQS9JVzYtQlAtRF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8wOC8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltHQS9JVzYtQlAtRF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMy8wNC8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltHQS9JVzgtQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW0dBL1BTNi0xLUxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDQvMDQvMjAxOC9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIfW1Byb2R1a3QgS29kXS5bR0EvUFM2LTEtVy1CUC1EXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU3LzExLzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCH1tQcm9kdWt0IEtvZF0uW0dBL1BTNi0xLVctQlAtRF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDEwNy8xMi8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltHTi9JVzYtQlAtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNS8wNi8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltHTi9JVzYtRVAyXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW0dOL0lXNi1FUDJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDQvMDEvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bR04vUE02LTEtVy1CUC1ERV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAyNC8wOS8yMDE4L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltHTi9QTTYtMS1XLUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI5LzEyLzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW0dOL1BNNi0xLVctQlAtREVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMzEvMDkvMjAxOC9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bR04vUE02LTEtVy1CUC1ERV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA1Ni8wNi8yMDE4L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltHTi9QTTYtMS1XLUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU2LzA4LzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCF1tQcm9kdWt0IEtvZF0uW0dPL0JSRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxMDAvMDIvMjAxOC9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bR1IvSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA1LzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW0dSL0lXNi1CUC1EXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAzLzAzLzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW0dSL0lXNi1CUC1EXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDEwLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW0dSL0lXNi1FUDFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDEvMDUvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bR1IvUFM2LTEtTF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMi8wOC8yMDE4L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMDMvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAxLzA0LzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMS8wNi8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMDcvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAyLzAzLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMy8wNC8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDQvMDQvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA0LzA4LzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNS8wNC8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDUvMDUvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA1LzA5LzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNi8wOC8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDYvMDkvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA3LzA3LzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwOC8wNS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDgvMDgvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA5LzA1LzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwOS8wOC8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMTAvMTAvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDExLzEwLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAxOC8wOS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMjMvMTAvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI0LzEwLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAyNy8wMi8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMjcvMTAvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU2LzAyLzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2My8wMi8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwOTQvMDEvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSU1BXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAxLzAzLzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lNQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMy8wMi8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJTUFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDMvMDYvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSU1BXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA0LzEwLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lNQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwOC8xMC8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJTUFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDkvMTAvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSU1BXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA5LzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lNQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAxMC8wOS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJTUFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMTQvMDgvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSU1BXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE1LzA4LzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lNQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAxNS8wOS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhNbUHJvZHVrdCBLb2RdLltJTUFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMTkvMTAvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bSU1BXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDIwLzA4LzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW0lNQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAyMS8xMC8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhdbUHJvZHVrdCBLb2RdLltJVi9CUkRSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDk2LzA0LzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGFtQcm9kdWt0IEtvZF0uW0lXNi84LUJFXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDAwMS8wOC8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhhbUHJvZHVrdCBLb2RdLltJVzYvOC1CRV0HAjBbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BLQS8wMDAwMDEvMDkvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bSVc2LUJFXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDA3MS8wMS8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltJVzYtQkZdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMTIvMTAvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bSVc2LUJQLUFCXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDAwMS8wNi8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltJVzYtQlAtQUJdBwIwW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQS0EvMDAwMDAxLzA4LzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW0lXNi1CUC1BQl0HAjBbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BLQS8wMDAwMDEvMDkvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bSVc2LUJQLUFCXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDAxMS8wMy8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltJVzYtQlAtQUJdBwIwW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQS0EvMDAwMDI1LzAzLzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW0lXNi1CUC1BQl0HAjBbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BLQS8wMDAwMjYvMDMvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bSVc2LUJQLUFCXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDA3MS8wMS8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltJVzYtQlAtQUJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDMvMDcvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIYW1Byb2R1a3QgS29kXS5bSVc2LUJQLURdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDIvMTIvMjAxNy9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIYW1Byb2R1a3QgS29kXS5bSVc2LUJQLURdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDcvMTIvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bSVc2LUJQLUVDT10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNi8wOS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltJVzYtQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI0LzEwLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW0lXNi1CUC1FQ09dBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMjUvMTAvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bSVc2LUJQLUxJXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDAwMS8xMi8yMDE2L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltJVzYtQlAtTEldBwIwW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQS0EvMDAwMDAzLzAxLzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW0lXNi1CUC1MSV0HAjBbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BLQS8wMDAwMDQvMDEvMjAxNy9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bSVc2LUJQLUxJXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDAwNS8wMS8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltJVzYtQlAtTEldBwIwW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQS0EvMDAwMDA2LzAxLzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW0lXNi1CUC1MSV0HAjBbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BLQS8wMDAwMDcvMDEvMjAxNy9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bSVc2LUJQLUxJXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDAwOC8wMS8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltJVzYtQlAtTEldBwIwW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQS0EvMDAwMDA5LzAxLzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW0lXNi1CUC1MSV0HAjBbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BLQS8wMDAwMTAvMDEvMjAxNy9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bSVc2LUJQLUxJXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDAxMS8wMS8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltJVzYtQlAtTEldBwIwW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQS0EvMDAwMDEyLzAxLzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW0lXNi1CUC1MSV0HAjBbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BLQS8wMDAwMTMvMDEvMjAxNy9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bSVc2LUJQLUxJXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDAxNC8wNC8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltJVzYtQlAtTEldBwIwW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQS0EvMDAwMDcxLzAxLzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0lXNi1DQV0HAjBbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BLQS8wMDAwNzEvMDEvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIYW1Byb2R1a3QgS29kXS5bSVc2LUVGLUFdBwIwW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQS0EvMDAwMDcxLzAxLzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGFtQcm9kdWt0IEtvZF0uW0lXNi1FRi1NXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDAwMS8xMi8yMDE2L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhhbUHJvZHVrdCBLb2RdLltJVzYtRUYtTV0HAjBbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BLQS8wMDAwNzEvMDEvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bSVc2LUVQXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE4LzEwLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0lXNi1FUF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAyMC8xMC8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltJVzYtR1BdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMTEvMDkvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bSVc2LUdQXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE0LzEwLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0lXNi1NR10HAjBbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BLQS8wMDAwNzEvMDEvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bSVc2LVJQXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDA3MS8wMS8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltJVzYtVU1dBwIwW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQS0EvMDAwMDAxLzA5LzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGFtQcm9kdWt0IEtvZF0uW0lXOC1CUC1EXQcCMFtEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUEtBLzAwMDA3MS8wMS8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltJVzgtQlAtREVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMTEvMDkvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIYW1Byb2R1a3QgS29kXS5bSVc4LUJQLUVdBwIwW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQS0EvMDAwMDcxLzAxLzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW0lXOC1CUC1FQ09dBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMDkvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bSVc4LUJQLUVDT10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNi8wOS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltKQS9JVzYtRVAyXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW0tBL0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8wMS8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltLQS9JS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDIvMDEvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIcW1Byb2R1a3QgS29kXS5bS0EvSVc2LUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzA1LzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW0tBL0lXNi1CUC1FQ09dBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDEvMDIvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bS0EvSVc2LUJQLUVDT10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMi8wMi8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltLQS9JVzYtRkxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDEvMDYvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bS0EvSVc2LUZMXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzA3LzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW0tBL1BTNi0xLVctRFBFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQ2LzA5LzIwMTgvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW0tBL1BTNi0xLVctRkxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMTAvMDIvMjAxOC9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bS0EvUFM2LTEtVy1GTF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA3Ny8wMS8yMDE4L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltLQS9QUzYtMS1XLUZMXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTAxLzAyLzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW0tJL0lXNi1CUC1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCF1tQcm9kdWt0IEtvZF0uW0tKL0JSRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNjgvMDcvMjAxOC9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bS08vSVc2LUJQLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDEvMTEvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIcW1Byb2R1a3QgS29kXS5bS1cvSVc2LUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA0LzA3LzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHFtQcm9kdWt0IEtvZF0uW0tXL0lXNi1CUC1ERV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNS8wNS8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLltLVy9JVzYtUEYtREZdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDEvMTEvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bS1cvSVc2LVVNXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA0LzA2LzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW0tXL1BTNi0xLVctQlAtREVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMjYvMDgvMjAxOC9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bS1cvUFM2LTEtVy1CUC1ERV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA1OS8wNi8yMDE4L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltLVy9QUzYtMS1XLUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDYwLzA2LzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW0tXL1BTNi0xLVctQlAtREVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNjAvMDcvMjAxOC9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bS1cvUFM2LTEtVy1CUC1ERV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2MS8wNy8yMDE4L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltLVy9QUzYtMS1XLUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDYyLzA3LzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW0tXL1BTNi0xLVctQlAtREVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNjMvMDcvMjAxOC9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bS1cvUFM2LTEtVy1QRi1ERl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA0My8wNy8yMDE4L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLlvFgVUvSVc2LUJQLURdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDEvMTEvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIXW1Byb2R1a3QgS29kXS5bT0wvQlJEUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAxNi8wOC8yMDE4L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltPUCAvSVc2LUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW09TL0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8wMy8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltPUy9JS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMDIvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bT1MvSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAzLzAyLzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW09TL0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMy8wMy8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltPUy9JS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDQvMDEvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bT1MvSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA1LzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW09TL0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNi8wNS8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltPUy9JVzYtQlAtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMS8wNi8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltPUy9JVzYtQlAtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMi8wNS8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltPUy9JVzYtQlAtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMy8wNy8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltPUy9JVzYtQlAtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMy8wOC8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh9bUHJvZHVrdCBLb2RdLltPUy9QUzYtMS1XLUJQLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMTIvMDUvMjAxOC9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIfW1Byb2R1a3QgS29kXS5bT1MvUFM2LTEtVy1CUC1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU3LzA1LzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCH1tQcm9kdWt0IEtvZF0uW09TL1BTNi0xLVctQlAtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA1OC8wNi8yMDE4L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh9bUHJvZHVrdCBLb2RdLltPUy9QUzYtMS1XLUJQLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNzIvMDUvMjAxOC9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIhW1Byb2R1a3QgS29kXS5bT1QvSVc2LzgtQlAtRUNPLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMDQvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIhW1Byb2R1a3QgS29kXS5bT1QvSVc2LzgtQlAtRUNPLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDQvMDUvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIhW1Byb2R1a3QgS29kXS5bT1QvSVc2LzgtQlAtRUNPLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDUvMDcvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIhW1Byb2R1a3QgS29kXS5bT1QvSVc2LzgtQlAtRUNPLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDYvMDgvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bT1QvSVc2LUJQLUVDT10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8xMS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh5bUHJvZHVrdCBLb2RdLltPVC9JVzYtUFJPLUNBTl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNC8xMS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltPVC9JVzgtQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIVtQcm9kdWt0IEtvZF0uW09UL1BTNi0yLVctQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU0LzA1LzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIVtQcm9kdWt0IEtvZF0uW09UL1BTNi0yLVctQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDY1LzA3LzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIVtQcm9kdWt0IEtvZF0uW09UL1BTOC0yLVctQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTI5LzAzLzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHFtQcm9kdWt0IEtvZF0uW1BJL0lXNi1CUC1BQl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8xMS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltQSS9JVzYtQlAtRF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8xMi8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltQSS9JVzYtQlAtRF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMy8wMS8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltQSS9JVzYtQlAtRF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwNi8xMS8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQSS9JVzYtRVAxXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1BNNi1CUC1FQ09dBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNTUvMTAvMjAxNy9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUE02LUJQLUVDT10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2OC8xMC8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQTTYtQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDY5LzEwLzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1BNNi1CUC1FQ09dBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNzEvMTAvMjAxNy9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUE02LUJQLUVDT10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA5MC8wOS8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhhbUHJvZHVrdCBLb2RdLltQTTgtTC1BMl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMi8wMS8yMDE3L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltQUzYtQl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwNi8xMC8yMDE3L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltQUzYtQl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA0Mi8xMC8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltQUzYtQl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA0My8xMC8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltQUzYtQl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA3NS8xMC8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltQUzYtTF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwNi8wOS8yMDE3L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltQUzYtTF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA1Ni8xMC8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhhbUHJvZHVrdCBLb2RdLltQUzYtVy1CTF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2My8wNi8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQUzYtVy1CUC1EXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA2LzEwLzIwMTcvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1BTNi1XLUJQLURdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMTgvMDUvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUFM2LVctQlAtRF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAyOC8wNi8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQUzYtVy1CUC1EXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI5LzA2LzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1BTNi1XLUJQLURdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMzAvMDgvMjAxNy9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUFM2LVctQlAtRF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAzMS8wOS8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQUzYtVy1CUC1EXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDMyLzA1LzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1BTNi1XLUJQLURdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMzMvMDUvMjAxNy9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUFM2LVctQlAtRF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA0NC8xMC8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQUzYtVy1CUC1EXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU3LzA4LzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1BTNi1XLUJQLURdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNjQvMTAvMjAxNy9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUFM2LVctQlAtRF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2Ni8wNy8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQUzYtVy1CUC1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAxLzA3LzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1BTNi1XLUJQLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMTAvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUFM2LVctQlAtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwOS8wNS8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQUzYtVy1CUC1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA5LzA5LzIwMTcvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1BTNi1XLUJQLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMTAvMDUvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUFM2LVctQlAtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA0My8wNi8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQUzYtVy1CUC1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQ3LzA0LzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1BTNi1XLUJQLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNjYvMDgvMjAxNy9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUFM2LVctQlAtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2Ni8xMC8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhpbUHJvZHVrdCBLb2RdLltQUzYtVy1CUC1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDg5LzEwLzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGltQcm9kdWt0IEtvZF0uW1BTNi1XLUJQLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwOTIvMTAvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUFM2LVctRVMtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA5MS8xMC8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltQUzYtVy1QRi1ERl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2Mi8wNi8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltQUzgtQl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8wMi8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltSVS9JS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDIvMTIvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bUlUvSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAzLzA1LzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1JVL0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAzOC8wNi8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiFbUHJvZHVrdCBLb2RdLltSVS9JVzYvOC1CUC1FQ08tVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMy8wNi8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiFbUHJvZHVrdCBLb2RdLltSVS9JVzYvOC1CUC1FQ08tVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNS8wNy8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltSVS9JVzYvOC1ORV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMy8xMS8yMDE3L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhtbUHJvZHVrdCBLb2RdLltSVS9JVzYtQkYtVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNS8wNi8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLltSVS9JVzYtQlAtREVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDEvMDQvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIcW1Byb2R1a3QgS29kXS5bUlUvSVc2LUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA1LzAzLzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHFtQcm9kdWt0IEtvZF0uW1JVL0lXNi1CUC1ERV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMS8wMi8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLltSVS9JVzYtQlAtREVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDIvMTIvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIeW1Byb2R1a3QgS29kXS5bUlUvSVc2LUJQLURFLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDIvMDgvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIeW1Byb2R1a3QgS29kXS5bUlUvSVc2LUJQLURFLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDQvMDgvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIeW1Byb2R1a3QgS29kXS5bUlUvSVc2LUJQLURFLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDYvMDgvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bUlUvSVc2LUJQLUVDT10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMi8wNS8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltSVS9JVzYtQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA1LzAzLzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW1JVL0lXNi1CUC1FUy1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW1JVL0lXNi1CUC1FUy1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA1LzAzLzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW1JVL0lXNi1CUC1FUy1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA2LzExLzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW1JVL0lXNi1CUC1FUy1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAzLzAyLzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW1JVL0lXNi1CUC1FUy1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAzLzAzLzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW1JVL0lXNi1CUC1FUy1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA0LzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW1JVL0lXNi1CUC1FUy1FXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA1LzAxLzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW1JVL0lXNi1CUC1FUy1FLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMTEvMDgvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvSVc2LUJQLUVTLUUtVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMi8wOS8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltSVS9JVzYtQlAtRVMtRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA2LzA4LzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW1JVL0lXNi1CVV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA1MC8xMS8yMDE3L0VYXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltSVS9JVzYtRkxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDMvMDEvMjAxOC9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bUlUvSVc2LUZMLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMDgvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bUlUvSVc2LUdQXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAzLzExLzIwMTcvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW1JVL0lXNi1IQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMS8wNy8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltSVS9JVzYtSEFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDIvMDgvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bUlUvSVc2LUlTXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA2LzExLzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHFtQcm9kdWt0IEtvZF0uW1JVL0lXNi1QRi1ER10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMy8xMS8yMDE3L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLltSVS9JVzYtUEYtRFpdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDMvMDIvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIeW1Byb2R1a3QgS29kXS5bUlUvSVc2LVBGLURaLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMDQvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIeW1Byb2R1a3QgS29kXS5bUlUvSVc2LVBGLURaLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDQvMDYvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bUlUvSVc2LVVNLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDIvMDkvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIcW1Byb2R1a3QgS29kXS5bUlUvSVc4LUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAzLzExLzIwMTcvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW1JVL0lXOC1CUC1FQ09dBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDMvMDMvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIeW1Byb2R1a3QgS29kXS5bUlUvSVc4LUJQLUVTLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDMvMTEvMjAxNy9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIeW1Byb2R1a3QgS29kXS5bUlUvSVc4LUJQLUVTLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMTIvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtQl0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8xNjMvMjAxN10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtQl0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zMjMvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtQi1FUy9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8xNzcvMjAxN10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtQi1FUy9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8xNzgvMjAxN10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtQi1FUy9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8xODcvMjAxN10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtQi1FUy9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8xOTAvMjAxN10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtQi1FUy9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8xOTEvMjAxN10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtQi1FUy9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8xOTUvMjAxN10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtTC9TQ10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA3OS8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1MLUVTL0lLXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA0LzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLUwtRVMvSUtdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNTMvMDkvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtTC1FUy9JS10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2NC8xMi8yMDE3L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1MLUVTL0lLXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDcwLzEyLzIwMTcvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLUwtRVMvSUtdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNzQvMTIvMjAxNy9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERV0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zODAvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERV0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zOTEvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERV0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zOTIvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERV0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC80MDEvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERV0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC80MDkvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERV0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC80MTAvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERS9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAxOC8wNy8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUJQLURFL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDIxLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMjUvMDcvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERS9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAyOC8wNy8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUJQLURFL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI5LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMzAvMDYvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERS9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAzMy8wNy8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUJQLURFL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDM4LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNzUvMDcvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERS9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA3Ny8wNy8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUJQLURFL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDkxLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwOTUvMDcvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERS9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDEwNy8wNi8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUJQLURFL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTE1LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxMjUvMDcvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERS9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE3MS8wNy8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUJQLURFL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTczLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxNzQvMDcvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERS9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE3OS8wNi8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUJQLURFL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTgzLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxOTMvMDYvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1CUC1ERS9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE5NC8wNy8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUJQLURFL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTk4LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvSUtdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMTg2LzIwMTddBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzM1LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzM2LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzM3LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzM4LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzM5LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzQwLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzQxLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzU0LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzU1LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzU2LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzk5LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvNDAwLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvNDAxLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvNDA5LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctQlAtREUvU0NdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvNDEwLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCH1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRV0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8xOTYvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIfW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzIwMy8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh9bUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUVdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzM5LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCH1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRV0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zNDAvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIfW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzM1My8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh9bUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUVdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzU0LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCH1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRV0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zNTUvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIfW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzM1Ny8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh9bUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUVdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzcyLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCH1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRV0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zNzcvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIfW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzM4MS8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh9bUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUVdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzg5LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCH1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRV0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zOTAvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIfW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzM5MS8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh9bUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUVdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzk4LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCH1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRV0HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zOTkvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIfW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzQwMC8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiJbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUUvSUtdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzcxLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIltQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRS9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zNzIvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIiW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FL0lLXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzM4MC8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiJbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUUvSUtdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzgxLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIltQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRS9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zODkvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIiW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FL0lLXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzM5MC8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiJbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUUvSUtdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzkxLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIltQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRS9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zOTIvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIiW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FL0lLXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzM5My8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiJbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUUvSUtdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzk0LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIltQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRS9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zOTUvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIiW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FL0lLXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzM5Ni8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiJbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUUvSUtdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMzk3LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIltQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRS9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC8zOTgvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIiW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FL0lLXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzM5OS8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiJbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUUvSUtdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvNDAwLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIltQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRS9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC80MDEvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIiW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1FUy1FL0lLXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzQxMC8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiJbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUVTLUUvSUtdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvNDEyLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCJFtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRS9JS1dJXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDUyLzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCJFtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtRS9JS1dJXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTEzLzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtTkUvSUtdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMTg5LzIwMTddBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRVMtTkUvSUtdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMTkwLzIwMTddBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRkxdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMTkzLzIwMTddBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRkxdBwImW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvNTUvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1GTF0HAiZbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC81Ny8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUZML0tBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDk2LzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctRkwvUlpdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDIvMDQvMjAxOC9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1HUC9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA0MS8wNy8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUdQL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDY3LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctR1AvRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNjgvMDcvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIgW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1HUC9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE5NC8wNy8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLUhBLURFL1NDXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzMzMy8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLU5FXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzE2Ny8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLVBGLURaXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAzLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctUEYtRFpdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMjU4LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctUEYtRFpdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMjYxLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctUEYtRFpdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMjY0LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIFtQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctUEYtRFpdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMjY1LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctUEYtUkYvRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDMvMDkvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1QRi1SRi9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwNC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLVBGLVJGL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDM0LzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctUEYtUkYvRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMzkvMDgvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1QRi1SRi9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA0NS8wOC8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLVBGLVJGL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDUxLzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctUEYtUkYvRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNTIvMDgvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIjW1Byb2R1a3QgS29kXS5bUlUvUFM2LTEtVy1QRi1SRi9EUl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA1NS8wOC8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiNbUHJvZHVrdCBLb2RdLltSVS9QUzYtMS1XLVBGLVJGL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDc2LzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTNi0xLVctUEYtUkYvRFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwODgvMDgvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bUlUvUFM2LTItQi9TQ10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA5NS8wNS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltSVS9QUzYtMi1CL1NDXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTEyLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW1JVL1BTNi0yLUIvU0NdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxNjIvMDUvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bUlUvUFM2LTItQi9TQ10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE5Mi8wNS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiBbUHJvZHVrdCBLb2RdLltSVS9QUzgtMS1MLUVTL0lLXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAyLzExLzIwMTcvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCI1tQcm9kdWt0IEtvZF0uW1JVL1BTOC0xLVctQlAtREUvSUtdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvMTg0LzIwMTddBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCIltQcm9kdWt0IEtvZF0uW1JVL1BTOC0xLVctRVMtRS9JS10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC80MDkvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIiW1Byb2R1a3QgS29kXS5bUlUvUFM4LTEtVy1FUy1FL0lLXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzQxMC8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiJbUHJvZHVrdCBLb2RdLltSVS9QUzgtMS1XLUVTLUUvSUtdBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvNDExLzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCJFtQcm9kdWt0IEtvZF0uW1JVL1BTOC0yLVctQlAtRUNPL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAzLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCJFtQcm9kdWt0IEtvZF0uW1JVL1BTOC0yLVctQlAtRUNPL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA0LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCJFtQcm9kdWt0IEtvZF0uW1JVL1BTOC0yLVctQlAtRUNPL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTA2LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCJFtQcm9kdWt0IEtvZF0uW1JVL1BTOC0yLVctQlAtRUNPL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTY4LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCJFtQcm9kdWt0IEtvZF0uW1JVL1BTOC0yLVctQlAtRUNPL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTgzLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCJFtQcm9kdWt0IEtvZF0uW1JVL1BTOC0yLVctQlAtRUNPL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTg0LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCJFtQcm9kdWt0IEtvZF0uW1JVL1BTOC0yLVctQlAtRUNPL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTkxLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCJFtQcm9kdWt0IEtvZF0uW1JVL1BTOC0yLVctQlAtRUNPL0RSXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTk0LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1JaL0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMS8wMi8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltSWi9JS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMTIvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bUlovSUtBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAyLzEyLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1JaL0lLQV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMy8wMS8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltSWi9JS0FdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDUvMTEvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bUlovSVc2LUJQLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMDIvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bUlovSVc2LUJQLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDQvMDIvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bUlovSVc2LUJQLUVDT10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8xMS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh5bUHJvZHVrdCBLb2RdLltSWi9JVzYtQlAtRVMtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8xMS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltSWi9JVzYtRkxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDMvMDEvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bUlovSVc2LUdQXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHltQcm9kdWt0IEtvZF0uW1JaL0lXOC1CUC1ERS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzA5LzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW1JaL0lXOC1HUC1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAyLzA4LzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW1JaL1BTNi0xLVctRkxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwODYvMTIvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIdW1Byb2R1a3QgS29kXS5bUlovUFM4LTEtVy1HUF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8wOS8yMDE4L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltSWi9QUzgtMS1XLUdQXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDMwLzA5LzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGLUNaXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGLUNaXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA1LzAzLzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGLUNaXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDExLzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGLUNaXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI0LzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGLUNaXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDY1LzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGLUNaXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTA5LzAzLzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGLUNaXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTk2LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGUy1NXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDExLzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGUy1NXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI5LzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGUy1NXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDc4LzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGUy1NXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTIwLzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGUy1SXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAzLzA5LzIwMTcvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGUy1SXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDM0LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGUy1SXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDM3LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NGUy1SXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTIyLzAzLzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1MtR0FaXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDg0LzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1NNxbstVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAxNy8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltTTcW7LVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMzIvMDgvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bU03Fuy1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU0LzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1NNxbstVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA4Mi8wOC8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltTTcW7LVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwODMvMDkvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bU03Fuy1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDk3LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1NNxbstVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDExMS8wOC8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltTTcW7LVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxMzAvMDgvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwITW1Byb2R1a3QgS29kXS5bU05TXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU5LzA0LzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFFtQcm9kdWt0IEtvZF0uW1MtT05dBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDMvMDkvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUy1QQUxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMTEvMDgvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUy1QQUxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDIvMTIvMjAxNy9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUy1QQUxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDQvMTIvMjAxNy9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUy1QQUxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMjQvMDkvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUy1QQUxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNTAvMDkvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUy1QQUxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNTYvMDkvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUy1QQUxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNjAvMDgvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUy1QQUxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwOTUvMDkvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUy1QQUxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxMTQvMDgvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIVW1Byb2R1a3QgS29kXS5bUy1QQUxdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxMTkvMDgvMjAxOC9QUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bU1QvSVc2LUJQLURdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDIvMDYvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bU1QvSVc2LUJQLURdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDMvMDQvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIcW1Byb2R1a3QgS29kXS5bU1QvSVc2LUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHFtQcm9kdWt0IEtvZF0uW1NUL0lXNi1CUC1ERV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNC8wMi8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltTVC9JVzYtSEFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDMvMDYvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIcW1Byb2R1a3QgS29kXS5bU1QvSVc2LVBGLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCG1tQcm9kdWt0IEtvZF0uW1NUL0lXOC1CUC1EXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAzLzA1LzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCH1tQcm9kdWt0IEtvZF0uW1NUL1BTNi0xLVctQlAtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA0My8wMS8yMDE4L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltTVC9QUzYtMS1XLUhBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDY5LzA3LzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCE1tQcm9kdWt0IEtvZF0uW1NURF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAzNS8wNy8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAzMi8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAzNC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAzNS8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAzOC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAzOS8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA0Mi8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2MC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2Mi8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2My8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2Ni8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA3MC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA3Mi8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA3Ny8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA3OC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA4MC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA4Mi8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA4NS8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA4Ny8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA4OC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA5MS8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA5Mi8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA5My8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA5OS8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE4Ni8wNi8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDI2OS8wNy8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtTV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDMxMy8wNS8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNS8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNi8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAxNi8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAyNS8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAzMC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA0MS8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA0Ny8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA1MS8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA1Ny8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA1OC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA1OS8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2My8xMi8yMDE3L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA2OS8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA3My8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA3NC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA5NC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhVbUHJvZHVrdCBLb2RdLltTVFQtU10HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA5OC8wOS8yMDE4L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltTVFQtU1ddBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvNDA0LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1NUVC1TV10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC80MDUvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bU1RULVNXXQcCJ1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFdQLzQwNi8yMDE4XQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltTVFQtU1ddBwInW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQV1AvNDA3LzIwMThdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1NUVC1TV10HAidbRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXUC80MDgvMjAxOF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bU1cvSVc2LUJQLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMDQvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIbW1Byb2R1a3QgS29kXS5bU1cvSVc2LUJQLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDUvMDUvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bU1cvUFM2LTEtQl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDEzNy8xMi8yMDE3L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh9bUHJvZHVrdCBLb2RdLltTVy9QUzYtMS1XLUJQLUVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxMzkvMTIvMjAxNy9LUl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bU1c2LUJQLUFCXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA0LzA5LzIwMTcvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW1NXNi1CUC1ERV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAxMS8xMC8yMDE3L1BSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltTVzYtUFJdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDIvMDkvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bU1c2LVVNXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA0LzA5LzIwMTcvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NXLUJCXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAxLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NXLUJCXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDAzLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NXLUJCXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA0LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NXLUJCXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA1LzAzLzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NXLUJCXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA2LzAzLzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NXLUJCXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE5LzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NXLUJCXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDg0LzAxLzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAxLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAzLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAzLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA0LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA2LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA3LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA3LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA4LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA4LzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA5LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA5LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA5LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE1LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE2LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE3LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE3LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE3LzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE4LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE4LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE5LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDE5LzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDIxLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDIyLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDIzLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI0LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI0LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI0LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI1LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI3LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDI4LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDMxLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDMyLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDMzLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDM0LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDM1LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDM2LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDM3LzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDM4LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDM5LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQwLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQwLzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQxLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQxLzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQyLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQyLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQzLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQ1LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQ3LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQ4LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQ5LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQ5LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQ5LzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDQ5LzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDUwLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDUxLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDUxLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDUzLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU0LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU1LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU3LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDU5LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDYxLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDYyLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDY0LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDY0LzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDY3LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDY3LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDY4LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDcwLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDcxLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDcxLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDczLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDc0LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDc1LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDc1LzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDc2LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDc4LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDc5LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDc5LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDc5LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDgwLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDgxLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDgxLzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDgxLzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDgyLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDgzLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDg0LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDg1LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDg2LzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDg3LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDg4LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDkwLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDkwLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDkxLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDkyLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDkyLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDk0LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDk1LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDk3LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDk3LzA5LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDk4LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDk4LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDk5LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTAxLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTAyLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTAyLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTAzLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTA0LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTA0LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTA1LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTA1LzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTA2LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTA3LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTA3LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTA4LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTEwLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTExLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTExLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTEzLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTEzLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTE0LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTIxLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTIxLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTIxLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTIyLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTIyLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTIzLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTI2LzA4LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTI3LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTI4LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTI5LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTI5LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTMwLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTMwLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTMxLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTMxLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTMyLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTMyLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTMzLzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTM0LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTM0LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTM1LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTM1LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTM2LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTM3LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTM4LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTM5LzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTM5LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQwLzA0LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQwLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQwLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQxLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQxLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQyLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQyLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQ1LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQ2LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQ3LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQ4LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQ4LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTQ5LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTU2LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTU3LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTU4LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTU5LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTYwLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTYxLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTYyLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTYyLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTYzLzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTYzLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTY0LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTY0LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTY1LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTY4LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTc1LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTc4LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTc5LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTgwLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTgxLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTgyLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTgzLzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTg0LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTg1LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTg2LzA1LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTg3LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTk0LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTk1LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTk1LzA3LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTk2LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTk3LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFVtQcm9kdWt0IEtvZF0uW1NaRS1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMjA0LzA2LzIwMTgvUFJdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHFtQcm9kdWt0IEtvZF0uW1RPL0lXNi1CUC1ERV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMS8wNS8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhxbUHJvZHVrdCBLb2RdLltUTy9JVzYtQlAtREVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDIvMDYvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIcW1Byb2R1a3QgS29kXS5bVE8vSVc2LUJQLURFXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAzLzA0LzIwMTgvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW1RPL0lXNi1HUF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMS8xMS8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltUTy9JVzYtSEFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDQvMDYvMjAxOC9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIUW1Byb2R1a3QgS29kXS5bVFItVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAyOS8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhRbUHJvZHVrdCBLb2RdLltUUi1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDY5LzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFFtQcm9kdWt0IEtvZF0uW1RSLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNzIvMDgvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIUW1Byb2R1a3QgS29kXS5bVFItVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDA4MS8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhRbUHJvZHVrdCBLb2RdLltUUi1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDg0LzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFFtQcm9kdWt0IEtvZF0uW1RSLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwODUvMDgvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIUW1Byb2R1a3QgS29kXS5bVFItVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDEyMi8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhRbUHJvZHVrdCBLb2RdLltUUi1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTM1LzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFFtQcm9kdWt0IEtvZF0uW1RSLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxMzYvMDgvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIUW1Byb2R1a3QgS29kXS5bVFItVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE0NC8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhRbUHJvZHVrdCBLb2RdLltUUi1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTU2LzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFFtQcm9kdWt0IEtvZF0uW1RSLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxNjkvMDgvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIUW1Byb2R1a3QgS29kXS5bVFItVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDE3MS8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhRbUHJvZHVrdCBLb2RdLltUUi1UXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTcyLzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFFtQcm9kdWt0IEtvZF0uW1RSLVRdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAxOTkvMDgvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIUW1Byb2R1a3QgS29kXS5bVFItVF0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDIwMS8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh1bUHJvZHVrdCBLb2RdLltXRS9JVzgtQlAtRUNPXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDEwLzExLzIwMTcvSU5dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCGVtQcm9kdWt0IEtvZF0uW1dJL0lXNi1CRl0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMy8xMi8yMDE3L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh5bUHJvZHVrdCBLb2RdLltXSS9JVzYtQlAtRVMtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMS8wNC8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh5bUHJvZHVrdCBLb2RdLltXSS9JVzYtQlAtRVMtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMS8wNS8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh5bUHJvZHVrdCBLb2RdLltXSS9JVzYtQlAtRVMtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMS8wNy8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh5bUHJvZHVrdCBLb2RdLltXSS9JVzYtQlAtRVMtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMS8wOS8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAh5bUHJvZHVrdCBLb2RdLltXSS9JVzYtQlAtRVMtRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMi8wNi8yMDE4L0lOXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhlbUHJvZHVrdCBLb2RdLltXSS9JVzYtQlVdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQVy8wMDAwMDEvMTEvMjAxNy9JTl0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIZW1Byb2R1a3QgS29kXS5bV0kvSVc2LUJVXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDUwLzExLzIwMTcvRVhdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCHVtQcm9kdWt0IEtvZF0uW1dJL1BTNi0xLVctQkZdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMTAvMTEvMjAxNy9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIaW1Byb2R1a3QgS29kXS5bWkIvQlJEUi9TRV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BXLzAwMDAwMi8wNy8yMDE4L0tSXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAiJbUHJvZHVrdCBLb2RdLltaQi9QUzYtMS1XLUJQLUUvS09dBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNTkvMDYvMjAxOC9FWF0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIiW1Byb2R1a3QgS29kXS5bWkIvUFM2LTEtVy1FUy1FL1dJXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFcvMDAwMDA0LzA3LzIwMTgvS1JdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1pTL1PFgV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMS8wOC8yMDE4L1pTXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltaUy9TxYFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDEvMDkvMjAxOC9aU10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bWlMvU8WBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDAyLzA4LzIwMTgvWlNdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1pTL1PFgV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwMy8wOC8yMDE4L1pTXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltaUy9TxYFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDMvMDkvMjAxOC9aU10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bWlMvU8WBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA0LzA4LzIwMTgvWlNdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1pTL1PFgV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNS8wOC8yMDE4L1pTXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltaUy9TxYFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDUvMDkvMjAxOC9aU10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bWlMvU8WBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA2LzA4LzIwMTgvWlNdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1pTL1PFgV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwNi8wOS8yMDE4L1pTXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltaUy9TxYFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDcvMDgvMjAxOC9aU10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bWlMvU8WBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDA3LzA5LzIwMTgvWlNdBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1pTL1PFgV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAwOC8wOC8yMDE4L1pTXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltaUy9TxYFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwMDkvMDgvMjAxOC9aU10HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bWlMvU8WBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMDMyLzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1pTL1PFgV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDAzOS8wOC8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltaUy9TxYFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAwNzEvMDgvMjAxOC9CTV0HAihbUHJvZHVrdCBaYWxlZ2FuaWVdLls1LiBQb3d5xbxlaiA5MCBkbmldBwIWW1Byb2R1a3QgS29kXS5bWlMvU8WBXQcCL1tEb2t1bWVudCBEb3N0YXd5IE51bWVyXS5bUFovMDAwMTU3LzA4LzIwMTgvQk1dBwIoW1Byb2R1a3QgWmFsZWdhbmllXS5bNS4gUG93ecW8ZWogOTAgZG5pXQcCFltQcm9kdWt0IEtvZF0uW1pTL1PFgV0HAi9bRG9rdW1lbnQgRG9zdGF3eSBOdW1lcl0uW1BaLzAwMDMxNS8wNy8yMDE4L0JNXQcCKFtQcm9kdWt0IFphbGVnYW5pZV0uWzUuIFBvd3nFvGVqIDkwIGRuaV0HAhZbUHJvZHVrdCBLb2RdLltaUy9TxYFdBwIvW0Rva3VtZW50IERvc3Rhd3kgTnVtZXJdLltQWi8wMDAzMTYvMDcvMjAxOC9CTV3/////AAAAAAAAAAAAAAAA</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="154" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Data Dostawy Dzień"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Dokument Dostawy Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" subTotal="False" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Produkt Zaleganie"&gt;&lt;header fontName="Segoe UI" fontSize="8" subTotal="False" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Ilość" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Wartość Netto" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Data Dostawy Dzień" index="3" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Dokument Dostawy Numer" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Produkt Kod" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Produkt Zaleganie" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje zaleganie towarów na magazynie w przedziałach zalegania. Stan na zadany dzień. Granice przedziałów należy podać podczas uruchamiania raportu.&#xD;
&#xD;
Raport nie będzie działał poprawnie jeśli ewidencjujemy magazyny metodą AVCO</a:description><a:id>263</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.23 Zaleganie w przedziałach na dzień</a:mainLinkName><a:modifiedOn>2024-09-20T12:40:08.8</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2017-10-23T10:33:39.82</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>&#xD;
&#xD;
/*&#xD;
* Raport Dokumentów Magazynowych z cechami dostaw&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.KnA_WartoscTxt,'','',''.'') ELSE ATR.KnA_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.KntAtrybuty ATR &#xD;
        JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
        WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Pierwotny Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'     &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr1.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'      &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.DAt_WartoscTxt,'','',''.'') ELSE ATR.DAt_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.DokAtrybuty ATR &#xD;
        JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
        WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max), @atrybutyPoz2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TrA_DeAId FROM CDN.TraElemAtr WHERE TrA_TrEId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TrA_TrEId INTO #tmpPozAtr FROM CDN.TraElemAtr&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
SET @atrybutyPoz2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpPozAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpPozAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TrA_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TrA_Wartosc,'','',''.'') ELSE ATR.TrA_Wartosc END &#xD;
        END  &#xD;
        FROM CDN.TraElemAtr ATR &#xD;
        JOIN #tmpPozAtr TM ON ATR.TrA_TrEId = TM.TrA_TrEId&#xD;
        WHERE ATR.TrA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', ISNULL(PozAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyPoz2 = @atrybutyPoz2 + N', ''(NIEPRZYPISANE)'' [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
     WHEN DDf_Numeracja like '@rejestr%' THEN 5&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Zasobów&#xD;
DECLARE @atrybutyZas varchar(max);&#xD;
DECLARE @atrybutyZas2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in &#xD;
(&#xD;
SELECT DISTINCT TsC_Cecha1_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha2_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha3_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha4_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha5_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha6_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha7_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha8_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha9_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha10_DeAId FROM CDN.TraSElemCechy&#xD;
)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TsC_TrSID INTO #tmpZasAtr FROM CDN.TraSElemCechy&#xD;
join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
WHERE &#xD;
Trs1.TrS_DataOpe between convert(datetime,convert(varchar, @DATAOD, 120) , 120) and convert(datetime, convert(varchar, @DATADO, 120) , 120)&#xD;
&#xD;
SET @atrybutyZas = ''&#xD;
SET @atrybutyZas2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
         IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
       IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
       --cechy dla PWP&#xD;
       SET @sqlA = N'ALTER TABLE #tmpZasAtr ADD [' + CAST(@atrybut_kod AS Varchar(50)) + N'] nvarchar(max)'&#xD;
       EXEC(@sqlA)    &#xD;
       --cechy dla PWP&#xD;
&#xD;
DECLARE @sqlB varchar(max), @sqlC Varchar(Max)&#xD;
       SET @sqlA =  CONCAT('UPDATE #tmpZasAtr&#xD;
             SET [' ,@atrybut_kod  ,  '] = &#xD;
             CASE&#xD;
                    WHEN ATR.TsC_Cecha1_DeAId = ' ,@atrybut_id, ' THEN  case WHEN ' ,@atrybut_format ,' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      else  CASE WHEN ' ,@atrybut_format ,' = 2  THEN REPLACE(ATR.TsC_Cecha1_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha1_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha2_DeAId = ' ,@atrybut_id, ' THEN  case WHEN ' ,@atrybut_format ,' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' ,@atrybut_format ,' = 2  THEN REPLACE(ATR.TsC_Cecha2_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha2_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha3_DeAId = ' ,@atrybut_id, ' THEN  case WHEN ' ,@atrybut_format ,' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' ,@atrybut_format ,' = 2  THEN REPLACE(ATR.TsC_Cecha3_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha3_Wartosc END END &#xD;
                    WHEN ATR.TsC_Cecha4_DeAId = ' ,@atrybut_id, ' THEN  case WHEN ' ,@atrybut_format ,' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' ,@atrybut_format ,' = 2  THEN REPLACE(ATR.TsC_Cecha4_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha4_Wartosc END END &#xD;
                    WHEN ATR.TsC_Cecha5_DeAId = ' ,@atrybut_id, ' THEN  case WHEN ' ,@atrybut_format ,' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' ,@atrybut_format ,' = 2  THEN REPLACE(ATR.TsC_Cecha5_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha5_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha6_DeAId = ' ,@atrybut_id, ' THEN  case WHEN ' ,@atrybut_format ,' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha6_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' ,@atrybut_format ,' = 2  THEN REPLACE(ATR.TsC_Cecha6_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha6_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha7_DeAId = ' ,@atrybut_id, ' THEN  case WHEN ' ,@atrybut_format ,' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha7_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' ,@atrybut_format ,' = 2  THEN REPLACE(ATR.TsC_Cecha7_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha7_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha8_DeAId = ' ,@atrybut_id, ' THEN  case WHEN ' ,@atrybut_format ,' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha8_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' ,@atrybut_format ,' = 2  THEN REPLACE(ATR.TsC_Cecha8_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha8_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha9_DeAId = ' ,@atrybut_id, ' THEN  case WHEN ' ,@atrybut_format ,' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha9_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' ,@atrybut_format ,' = 2  THEN REPLACE(ATR.TsC_Cecha9_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha9_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha10_DeAId = ' ,@atrybut_id, ' THEN  case WHEN ' ,@atrybut_format ,' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha10_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' ,@atrybut_format ,' = 2  THEN REPLACE(ATR.TsC_Cecha10_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha10_Wartosc END END&#xD;
             ELSE ''(NIEPRZYPISANE)'' END')&#xD;
           SET @sqlB =  CONCAT(   ' FROM CDN.TraSElemCechy ATR &#xD;
             JOIN #tmpZasAtr TM ON ATR.TsC_TrSID = TM.TsC_TrSID&#xD;
             WHERE ATR.TsC_Cecha1_DeAId = ' ,@atrybut_id, ' OR &#xD;
             ATR.TsC_Cecha2_DeAId = ' ,@atrybut_id, ' OR &#xD;
             ATR.TsC_Cecha3_DeAId = ' ,@atrybut_id, ' OR &#xD;
             ATR.TsC_Cecha4_DeAId = ' ,@atrybut_id, ' OR &#xD;
             ATR.TsC_Cecha5_DeAId = ' ,@atrybut_id, ' OR &#xD;
             ATR.TsC_Cecha6_DeAId = ' ,@atrybut_id, ' OR &#xD;
             ATR.TsC_Cecha7_DeAId = ' ,@atrybut_id, ' OR &#xD;
             ATR.TsC_Cecha8_DeAId = ' ,@atrybut_id, ' OR ')&#xD;
             SET @sqlC =  CONCAT( 'ATR.TsC_Cecha9_DeAId = ', @atrybut_id, ' OR &#xD;
             ATR.TsC_Cecha10_DeAId = ' ,@atrybut_id&#xD;
       ) &#xD;
&#xD;
EXEC(@sqlA+@sqlB+@sqlC)&#xD;
    &#xD;
    SET @atrybutyZas = @atrybutyZas + N', ISNULL(ZasAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Zasoby Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
&#xD;
       FETCH NEXT FROM atrybut_cursor&#xD;
       INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
SELECT DISTINCT TrE_TrEID TREID,&#xD;
(select count(*) from Cdn.TraSelem TrS2 where trS2.TrS_TrEId = TrE_TrEID) TRSCount&#xD;
 INTO #tmpTrSCount&#xD;
FROM CDN.TraSElem Trs1 &#xD;
join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
&#xD;
WHERE &#xD;
TrS_DataOpe between convert(datetime,convert(varchar, @DATAOD, 120) , 120) and convert(datetime, convert(varchar, @DATADO, 120) , 120)&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    TrN_NumerPelny [Dokument Numer],&#xD;
    dd.DDf_Symbol [Dokument Symbol],&#xD;
    ISNULL(NULLIF(TrN_Opis,''''),''(BRAK)'') [Dokument Opis],&#xD;
ISNULL(NULLIF(TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
    CASE                                &#xD;
        WHEN TrN_TypDokumentu = 312 THEN ''MM''&#xD;
        WHEN TrN_TypDokumentu = 303 THEN ''PW''&#xD;
        WHEN TrN_TypDokumentu = 317 THEN ''PWP''&#xD;
        WHEN TrN_TypDokumentu = 307 THEN ''PZ''&#xD;
        WHEN TrN_TypDokumentu = 304 THEN ''RW''&#xD;
        WHEN TrN_TypDokumentu = 318 THEN ''RWS''&#xD;
        WHEN TrN_TypDokumentu = 306 THEN ''WZ''&#xD;
        WHEN TrN_TypDokumentu = 313 THEN ''PKA''&#xD;
        WHEN TrN_TypDokumentu = 314 THEN ''WKA''&#xD;
    ELSE ''(NIEPRZYPISANY)'' END [Dokument Typ],&#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TrN_NumerPelny,0,CHARINDEX(''/'',TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TrN_NumerPelny,CHARINDEX(''/'',TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],   &#xD;
    pod1.Pod_Nazwa1 [Kontrahent Pierwotny Nazwa],   &#xD;
    pod1.Pod_Kod [Kontrahent Pierwotny Kod],    &#xD;
     ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Województwo],&#xD;
     ISNULL(NULLIF(pod1.Pod_Powiat, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Powiat],&#xD;
    ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Miasto], &#xD;
    ISNULL(NULLIF(pod1.Pod_Kraj, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Kraj], &#xD;
    ISNULL(NULLIF(pod1.Pod_NIP, ''''), ''(BRAK)'') [Kontrahent Pierwotny NIP], &#xD;
    ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Pierwotny Grupa], &#xD;
    CASE &#xD;
        WHEN knt1.Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN knt1.Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
    ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Pierwotny Opiekun],&#xD;
    reverse(stuff(reverse(CONVERT(varchar(100),RTRIM(&#xD;
    (CASE knt1.Knt_Rodzaj_Dostawca WHEN 1 THEN ''Dostawca, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Odbiorca WHEN 1 THEN ''Odbiorca, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Konkurencja WHEN 1 THEN ''Konkurencja, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Partner WHEN 1 THEN ''Partner, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Potencjalny WHEN 1 THEN ''Klient potencjalny,'' else '''' END)))), 1, 1, '''')) AS [Kontrahent Pierwotny Rodzaj],&#xD;
    pod5.Pod_Nazwa1 [Kontrahent Nazwa], &#xD;
    pod5.Pod_Kod [Kontrahent Kod], &#xD;
    ISNULL(NULLIF(pod5.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
    ISNULL(NULLIF(pod5.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Kontrahent Powiat], ISNULL(NULLIF(pod5.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Kontrahent Miasto],&#xD;
    ISNULL(NULLIF(pod5.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Kontrahent Kraj],&#xD;
    ISNULL(NULLIF(pod5.Pod_NIP, ''''),''(BRAK)'') [Kontrahent NIP],&#xD;
    ISNULL(NULLIF(pod5.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa],&#xD;
    CASE knt3.Knt_OpiekunTyp&#xD;
        WHEN 3 THEN ISNULL(pod6.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN 8 THEN ISNULL(opk3.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
        ELSE ''(NIEPRZYPISANE)'' &#xD;
    END [Kontrahent Opiekun],&#xD;
    reverse(stuff(reverse(CONVERT(varchar(100),RTRIM(&#xD;
    (CASE knt3.Knt_Rodzaj_Dostawca WHEN 1 THEN ''Dostawca, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Odbiorca WHEN 1 THEN ''Odbiorca, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Konkurencja WHEN 1 THEN ''Konkurencja, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Partner WHEN 1 THEN ''Partner, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Potencjalny WHEN 1 THEN ''Klient potencjalny,'' else '''' END)))), 1, 1, '''')) AS [Kontrahent Rodzaj],&#xD;
    pod7.Pod_Nazwa1 [Odbiorca Nazwa],   &#xD;
    pod7.Pod_Kod [Odbiorca Kod],    &#xD;
    ISNULL(NULLIF(pod7.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Odbiorca Województwo],&#xD;
    ISNULL(NULLIF(pod7.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Odbiorca Powiat], ISNULL(NULLIF(pod7.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(pod7.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Odbiorca Kraj],&#xD;
    ISNULL(NULLIF(pod7.Pod_NIP, ''''),''(BRAK)'') [Odbiorca NIP],&#xD;
    ISNULL(NULLIF(pod7.Pod_Grupa, ''''),''Pozostali'') [Odbiorca Grupa],    &#xD;
    zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
    ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
    ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu],  &#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
    ISNULL(knt5.Knt_Nazwa1, ''(NIEPRZYPISANE)'')  [Produkt Dostawca Nazwa],&#xD;
    ISNULL(knt6.Knt_Nazwa1, ''(NIEPRZYPISANE)'')  [Produkt Producent Nazwa],&#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],     &#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    poz.sciezka [Produkt Pełna Nazwa Grupy], "Produkt Opis" = CAST(Twr_Opis as VARCHAR(1024)), Twr_Jm [Jednostka Miary], &#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
     ISNULL(Mag.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
     ISNULL(MagDoc.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Docelowy Kod],&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
        CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna],&#xD;
      TR.TrE_WartoscNetto/ISNULL(TCount.TRSCount,1.0) [Wartość Netto], TR.TrE_WartoscBrutto/ISNULL(TCount.TRSCount,1.0) [Wartość Brutto], TR.TrE_WartoscNettoWal/ISNULL(TCount.TRSCount,1.0) [Wartość Waluta], ISNULL(Trs_Ilosc,TR.TrE_Ilosc/ISNULL(TCount.TRSCount,1.0)) [Ilość], &#xD;
    (TR.TrE_WartoscNetto - (ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi))/ISNULL(TCount.TRSCount,1.0) [Marża], (ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi)/ISNULL(TCount.TRSCount,1.0) [Koszt Zakupu]&#xD;
        ,CASE WHEN (MONTH(TrN_DataOpe) = MONTH(GETDATE())) AND (YEAR(TrN_DataOpe) = YEAR(GETDATE())) THEN ''TAK'' ELSE ''NIE'' END [Czas Aktualny Miesiąc],&#xD;
    CASE &#xD;
        WHEN (MONTH(TrN_DataOpe) = MONTH(GETDATE())-1) AND (YEAR(TrN_DataOpe) = YEAR(GETDATE())) THEN ''TAK'' &#xD;
        WHEN ((MONTH(TrN_DataOpe) = 12) AND (MONTH(GETDATE()) = 1)) AND (YEAR(TrN_DataOpe) = YEAR(GETDATE()) - 1) THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Aktualny Miesiąc Poprzedni]&#xD;
&#xD;
/*  &#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji]  &#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia]&#xD;
*/&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataOpe)*/ [Data Operacji Tydzień Roku] &#xD;
    ,MONTH(TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TrN_DataOpe) [Data Operacji Kwartał], YEAR(TrN_DataOpe) [Data Operacji Rok]  &#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia Dzień], (datepart(DY, datediff(d, 0, TrN_DataWys) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataWys)*/ [Data Wystawienia Tydzień Roku]&#xD;
    ,MONTH(TrN_DataWys) [Data Wystawienia Miesiąc], DATEPART(quarter, TrN_DataWys) [Data Wystawienia Kwartał], YEAR(TrN_DataWys) [Data Wystawienia Rok]  &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
                                    ,CASE                               &#xD;
        WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
        WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
        WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
        WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
        WHEN TrN_TypDokumentu = 304 THEN 25030&#xD;
        WHEN TrN_TypDokumentu = 318 THEN 25046&#xD;
        WHEN TrN_TypDokumentu = 306 THEN 25022&#xD;
        WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
        WHEN TrN_TypDokumentu = 314 THEN 25078&#xD;
    END [Dokument Numer __PROCID__WZ__], TrN_TrNId [Dokument Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny  Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Kod __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Kontrahent Nazwa __PROCID__], pod5.Pod_PodId [Kontrahent Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod5.Pod_PodId [Kontrahent Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag.Mag_MagId [Magazyn Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Docelowy Kod __PROCID__Magazyny__],  MagDoc.Mag_MagId [Magazyn Docelowy Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Docelowy Kod __DATABASE__]&#xD;
    &#xD;
    '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz+ @atrybutyZas&#xD;
       &#xD;
set @select2 = &#xD;
' FROM cdn.TraNag &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID &#xD;
     LEFT JOIN #tmpSeria ser ON TrN_DDfId = DDf_DDfID&#xD;
     LEFT JOIN CDN.DokDefinicje dd ON TrN_DDfId = dd.DDf_DDfID&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt1 ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny Mag ON (CASE WHEN TrN_TypDokumentu = 318 THEN TrN_MagZrdId ELSE ISNULL(TrE_MagId,TrN_MagZrdId) END) = Mag.Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Magazyny MagDoc ON MagDoc.Mag_MagId = TrN_MagDocId&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
     LEFT JOIN #tmpPozatr PozAtr on PozAtr.TrA_TrEId = TrE_TrEId&#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN ' + @Operatorzy + ' zal ON TrN_OpeZalID = zal.Ope_OpeId&#xD;
     LEFT JOIN ' + @Operatorzy + ' mod ON TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod5 on pod1.Pod_GlID = pod5.Pod_PodId and pod1.Pod_GlKod = pod5.Pod_Kod&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt3 ON pod5.Pod_PodID=knt3.Knt_KntId AND pod5.Pod_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat5 ON knt3.Knt_KatID=kat5.Kat_KatID&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod6 ON knt3.Knt_OpiekunId = pod6.Pod_PodId AND knt3.Knt_OpiekunTyp = pod6.Pod_PodmiotTyp&#xD;
     LEFT JOIN #tmpKonAtr KonAtr1 ON pod5.Pod_PodId = KonAtr1.KnA_PodmiotId AND pod5.Pod_PodmiotTyp = KonAtr1.KnA_PodmiotTyp&#xD;
     LEFT JOIN ' + @Operatorzy + ' opk3 ON knt3.Knt_OpiekunId = opk3.Ope_OpeId AND knt3.Knt_OpiekunTyp = 8 &#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod7 ON TrN_OdbID = pod7.Pod_PodId AND TrN_OdbiorcaTyp = pod7.Pod_PodmiotTyp&#xD;
     LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
     LEFT JOIN CDN.Kontrahenci knt5 ON Twr_KntId = knt5.Knt_KntId&#xD;
     LEFT JOIN CDN.Kontrahenci knt6 ON Twr_PrdId = knt6.Knt_KntId&#xD;
LEFT OUTER JOIN ( &#xD;
            SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj in (312000,312008) AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
            FROM CDN.TraElem TRE&#xD;
            JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
                   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow AND TREREl.TrE_TwrID = TRE.TrE_TwrID&#xD;
                                  WHERE TrR_FaId = TRE.TrE_TrNId  AND ((TRN.TRN_TypDokumentu = 307 AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308,301,306)) OR (TRN.TRN_TypDokumentu &lt;&gt; 307 AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308,301)))&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
    )KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
    LEFT JOIN CDN.TraSElem ON TrS_TreID = TR.TrE_TreId&#xD;
    LEFT JOIN #tmpZasAtr ZasAtr ON Trs_TrSId = ZasAtr.TsC_TrSID&#xD;
    LEFT OUTER JOIN #tmpTrSCount TCount ON TR.TRE_TREID = TREID&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
WHERE&#xD;
TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
AND TrN_Bufor&lt;&gt;-1&#xD;
AND TrE_Aktywny&lt;&gt;0&#xD;
AND TrN_DataOpe BETWEEN convert(datetime,''' + convert(varchar, @DATAOD, 120) + ''', 120)  AND convert(datetime,''' + convert(varchar, @DATADO, 120) + ''', 120)'&#xD;
&#xD;
exec (@select + @select2)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpZasAtr&#xD;
DROP TABLE #tmpTrSCount&#xD;
DROP TABLE #tmpPozatr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM0zwJratE7ZrmpGGBehZ96gzfYuMpQO2yJQQEhkyxmOvslOn8ASdlUU7ZjrS0O0poY/4wXQcWRsf4yJiGWVcYKrWRlBBo3XI7Sm0kOWyo1NDptWs6RP5gkjHVPFIggnp+/ecm6EknzxBylZSRfP3Pc7XA/HmkgjShWnsgGlkO/SChYbzyIMVge9Mygss1/pBTw==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Waluta" caption="Waluta" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Seria" caption="Dokument Seria" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Nazwa" caption="Kontrahent Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kod" caption="Kontrahent Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Województwo" caption="Kontrahent Pierwotny Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Miasto" caption="Kontrahent Pierwotny Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kraj" caption="Kontrahent Pierwotny Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Grupa" caption="Kontrahent Pierwotny Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Opiekun" caption="Kontrahent Pierwotny Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kraj" caption="Kontrahent Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Wprowadzający" caption="Operator Wprowadzający" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Modyfikujący" caption="Operator Modyfikujący" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="### ##0.00" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Marża" caption="Marża" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Koszt Zakupu" caption="Koszt Zakupu" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut KLUCZOWY" caption="Kontrahent Pierwotny Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut KLUCZOWY" caption="Kontrahent Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut PROJEKTY PARKI" caption="Kontrahent Pierwotny Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut PROJEKTY PARKI" caption="Kontrahent Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut STATUS" caption="Kontrahent Pierwotny Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut STATUS" caption="Kontrahent Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut PROJEKTY PARKI (K)" caption="Dokument Atrybut PROJEKTY PARKI (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS (K)" caption="Dokument Atrybut STATUS (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROZMIAR" caption="Produkt Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut PIELĘGNACJA" caption="Pozycja Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut KOLOR" caption="Pozycja Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut DATA WAŻNOŚCI" caption="Pozycja Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut NR SERYJNY" caption="Pozycja Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut ATRYBUTZASOBU" caption="Pozycja Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut ROZMIAR" caption="Pozycja Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Zasoby Atrybut KOLOR" caption="Zasoby Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Zasoby Atrybut DATA WAŻNOŚCI" caption="Zasoby Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Zasoby Atrybut NR SERYJNY" caption="Zasoby Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Zasoby Atrybut ATRYBUTZASOBU" caption="Zasoby Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;Za okres od:&lt;/Label&gt;&#xD;
    &lt;Expression&gt;SELECT DATEADD(month, DATEDIFF(month, 0, GETDATE()), 0)&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2018-09-01&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;do:&lt;/Label&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2018-09-20&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions /&gt;&lt;formatRules /&gt;&lt;dataFields /&gt;&lt;rowFields /&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport Dokumentów Magazynowych z Cechami Dostaw wersja 33.0 (OPTIMA 2024.0.0)&#xD;
&#xD;
Raport zawiera informacje o sprzedaży i zakupach w firmie na podstawie dokumentów magazynowych z uwzględnieniem cech na dostawach. Wartości prezentowane są w walucie systemowej.&#xD;
&#xD;
Analizy oparte są o dokumenty PW, RW, PZ, WZ, MM, PKA, WKA, PWP, RWS. Niebrane pod uwagę są dokumenty anulowane. Do poprawnej analizy należy wybrać typ dokumentu, dla którego ma zostać wyświetlony raport.&#xD;
&#xD;
Raport oparty na tabelach:&#xD;
TraNag - Tabela z nagłówkami dokumentów (WZ, PZ itp.). &#xD;
TraElem - Tabela z elementami dokumentów (WZ, PZ itp.).&#xD;
TrasElemCechy - Cechy dostaw</a:description><a:id>264</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.24 Raport dokumentów magazynowych z cechami dostaw</a:mainLinkName><a:modifiedOn>2025-01-29T16:46:38.977</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts/><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-19T15:39:56.783</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Dokumentów magazynowych z fakturami&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
		 ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.KnA_WartoscTxt,'','',''.'') ELSE ATR.KnA_WartoscTxt END &#xD;
		END  &#xD;
		FROM CDN.KntAtrybuty ATR &#xD;
		JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
		WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Pierwotny Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'     &#xD;
	SET @atrybuty = @atrybuty + N', ISNULL(KonAtr1.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'      &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
		  ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.DAt_WartoscTxt,'','',''.'') ELSE ATR.DAt_WartoscTxt END &#xD;
		END  &#xD;
		FROM CDN.DokAtrybuty ATR &#xD;
		JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
		WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
		 ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
		END &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max), @atrybutyPoz2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TrA_DeAId FROM CDN.TraElemAtr WHERE TrA_TrEId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TrA_TrEId INTO #tmpPozAtr FROM CDN.TraElemAtr&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
SET @atrybutyPoz2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpPozAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpPozAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TrA_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
		 ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TrA_Wartosc,'','',''.'') ELSE ATR.TrA_Wartosc END &#xD;
		END	 &#xD;
		FROM CDN.TraElemAtr ATR &#xD;
		JOIN #tmpPozAtr TM ON ATR.TrA_TrEId = TM.TrA_TrEId&#xD;
		WHERE ATR.TrA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', ISNULL(PozAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
	SET @atrybutyPoz2 = @atrybutyPoz2 + N', ''(NIEPRZYPISANE)'' [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
     WHEN DDf_Numeracja like '@rejestr%' THEN 5&#xD;
	 WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
	 WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
	 WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
	 WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
	TNFS.TrN_NumerPelny [Dokument FA/FZ Numer], TND.TrN_NumerPelny [Dokument PZ Numer],&#xD;
	TN.TrN_NumerPelny [Dokument Numer],&#xD;
	dd.DDf_Symbol [Dokument Symbol],&#xD;
	ISNULL(NULLIF(TN.TrN_Opis,''''),''(BRAK)'') [Dokument Opis],&#xD;
ISNULL(NULLIF(TN.TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
	CASE								&#xD;
		WHEN TN.TrN_TypDokumentu = 312 THEN ''MM''&#xD;
		WHEN TN.TrN_TypDokumentu = 303 THEN ''PW''&#xD;
		WHEN TN.TrN_TypDokumentu = 317 THEN ''PWP''&#xD;
		WHEN TN.TrN_TypDokumentu = 307 THEN ''PZ''&#xD;
		WHEN TN.TrN_TypDokumentu = 304 THEN ''RW''&#xD;
		WHEN TN.TrN_TypDokumentu = 318 THEN ''RWS''&#xD;
		WHEN TN.TrN_TypDokumentu = 306 THEN ''WZ''&#xD;
		WHEN TN.TrN_TypDokumentu = 313 THEN ''PKA''&#xD;
		WHEN TN.TrN_TypDokumentu = 314 THEN ''WKA''&#xD;
	ELSE ''(NIEPRZYPISANY)'' END [Dokument Typ],&#xD;
	CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TN.TrN_NumerPelny,0,CHARINDEX(''/'',TN.TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TN.TrN_NumerPelny,CHARINDEX(''/'',TN.TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],	&#xD;
	pod1.Pod_Nazwa1 [Kontrahent Pierwotny Nazwa],&#xD;
	pod1.Pod_Kod [Kontrahent Pierwotny Kod],	&#xD;
	 ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Województwo],&#xD;
	ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Miasto], &#xD;
	ISNULL(NULLIF(pod1.Pod_Kraj, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Kraj], &#xD;
	ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Pierwotny Grupa], &#xD;
    CASE &#xD;
		WHEN knt1.Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
		WHEN knt1.Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
	ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Pierwotny Opiekun],&#xD;
	pod5.Pod_Nazwa1 [Kontrahent Nazwa], &#xD;
	pod5.Pod_Kod [Kontrahent Kod], &#xD;
	ISNULL(NULLIF(pod5.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Kontrahent Województwo], ISNULL(NULLIF(pod5.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Kontrahent Miasto],&#xD;
	ISNULL(NULLIF(pod5.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Kontrahent Kraj],&#xD;
	ISNULL(NULLIF(pod5.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa],&#xD;
	CASE knt3.Knt_OpiekunTyp&#xD;
		WHEN 3 THEN ISNULL(pod6.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
		WHEN 8 THEN ISNULL(opk3.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
		ELSE ''(NIEPRZYPISANE)'' &#xD;
	END [Kontrahent Opiekun],&#xD;
	pod7.Pod_Nazwa1 [Odbiorca Nazwa], 	&#xD;
	pod7.Pod_Kod [Odbiorca Kod],	&#xD;
	zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
	ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
	ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu],   &#xD;
	Twr_Nazwa [Produkt Nazwa],&#xD;
	CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
	ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca], &#xD;
	CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny], &#xD;
	Twr_Kod [Produkt Kod], &#xD;
	poz.sciezka [Produkt Pełna Nazwa Grupy], "Produkt Opis" = CAST(Twr_Opis as VARCHAR(1024)), Twr_Jm [Jednostka Miary], &#xD;
	Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],	&#xD;
	ISNULL(Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    	CASE&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
		WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
		WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
		ELSE ''(NIEOKREŚLONY)''&#xD;
	END [Produkt Typ], TwC_Wartosc [Cena Domyślna],&#xD;
	CASE WHEN  TSE.TrS_Ilosc IS NULL THEN TR.TrE_WartoscNetto &#xD;
   	ELSE ISNULL(TR.TrE_WartoscNetto/ISNULL(NULLIF(TR.TrE_Ilosc,0),1)*ISNULL(NULLIF(TSE.TrS_Ilosc,0),1), TR.TrE_WartoscNetto)  END AS [Wartość Netto], &#xD;
	CASE WHEN  TSE.TrS_Ilosc IS NULL THEN TR.TrE_WartoscBrutto&#xD;
	ELSE ISNULL(TR.TrE_WartoscBrutto/ISNULL(NULLIF(TR.TrE_Ilosc,0),1)*ISNULL(NULLIF(TSE.TrS_Ilosc,0),1), TR.TrE_WartoscBrutto)  END AS  [Wartość Brutto], &#xD;
	CASE WHEN  TSE.TrS_Ilosc IS NULL THEN TR.TrE_WartoscNettoWal&#xD;
	ELSE ISNULL(TR.TrE_WartoscNettoWal/ISNULL(NULLIF(TR.TrE_Ilosc,0),1)*ISNULL(NULLIF(TSE.TrS_Ilosc,0),1), TR.TrE_WartoscNettoWal)  END AS [Wartość Waluta], &#xD;
	ISNULL(TSE.TrS_Ilosc, TR.TrE_Ilosc) [Ilość], &#xD;
	CASE WHEN  TSE.TrS_Ilosc IS NULL THEN TR.TrE_WartoscNetto - (isNull(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi)&#xD;
    ELSE ISNULL(TR.TrE_WartoscNetto/ISNULL(NULLIF(TR.TrE_Ilosc,0),1)*ISNULL(NULLIF(TSE.TrS_Ilosc,0),1) - TSE.TrS_Wartosc, TR.TrE_WartoscNetto - (isNull(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi))  END AS  [Marża], &#xD;
	(CASE WHEN TN.TrN_Rodzaj IN (302101,302102,302103,305101) THEN -1 ELSE 1 END) * (ISNULL(TSE.TrS_Wartosc, isNull(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi)) [Koszt Zakupu],&#xD;
	CASE WHEN (MONTH(TN.TrN_DataOpe) = MONTH(GETDATE())) AND (YEAR(TN.TrN_DataOpe) = YEAR(GETDATE())) THEN ''TAK'' ELSE ''NIE'' END [Czas Aktualny Miesiąc],&#xD;
	CASE &#xD;
		WHEN (MONTH(TN.TrN_DataOpe) = MONTH(GETDATE())-1) AND (YEAR(TN.TrN_DataOpe) = YEAR(GETDATE())) THEN ''TAK'' &#xD;
		WHEN ((MONTH(TN.TrN_DataOpe) = 12) AND (MONTH(GETDATE()) = 1)) AND (YEAR(TN.TrN_DataOpe) = YEAR(GETDATE()) - 1) THEN ''TAK'' &#xD;
		ELSE ''NIE'' &#xD;
	END [Czas Aktualny Miesiąc Poprzedni],&#xD;
	TEFS.Tre_Ilosc [Dokument FA/FZ Ilość], TED.Tre_Ilosc [Dokument PZ Ilość]&#xD;
/*&#xD;
	----------DATY POINT&#xD;
	,REPLACE(CONVERT(VARCHAR(10), TN.TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji]&#xD;
	,REPLACE(CONVERT(VARCHAR(10), TN.TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia]&#xD;
*/&#xD;
	----------DATY ANALIZY&#xD;
	,REPLACE(CONVERT(VARCHAR(10), TN.TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TN.TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TN.TrN_DataOpe)*/ [Data Operacji Tydzień Roku]&#xD;
    ,MONTH(TN.TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TN.TrN_DataOpe) [Data Operacji Kwartał], YEAR(TN.TrN_DataOpe) [Data Operacji Rok] &#xD;
	,REPLACE(CONVERT(VARCHAR(10), TN.TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia Dzień], (datepart(DY, datediff(d, 0, TN.TrN_DataWys) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TN.TrN_DataWys)*/ [Data Wystawienia Tydzień Roku] &#xD;
    ,MONTH(TN.TrN_DataWys) [Data Wystawienia Miesiąc], DATEPART(quarter, TN.TrN_DataWys) [Data Wystawienia Kwartał], YEAR(TN.TrN_DataWys) [Data Wystawienia Rok] &#xD;
&#xD;
	----------KONTEKSTY&#xD;
							,CASE								&#xD;
		WHEN TN.TrN_TypDokumentu = 312 THEN 25034&#xD;
		WHEN TN.TrN_TypDokumentu = 303 THEN 25032&#xD;
		WHEN TN.TrN_TypDokumentu = 317 THEN 25045&#xD;
		WHEN TN.TrN_TypDokumentu = 307 THEN 25024&#xD;
		WHEN TN.TrN_TypDokumentu = 304 THEN 25030&#xD;
		WHEN TN.TrN_TypDokumentu = 318 THEN 25046&#xD;
		WHEN TN.TrN_TypDokumentu = 306 THEN 25022&#xD;
		WHEN TN.TrN_TypDokumentu = 313 THEN 25079&#xD;
		WHEN TN.TrN_TypDokumentu = 314 THEN 25078&#xD;
	END [Dokument Numer __PROCID__WZ__], TN.TrN_TrNId [Dokument Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Numer __DATABASE__]&#xD;
	,20201 [Kontrahent Pierwotny Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny  Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Nazwa __DATABASE__]&#xD;
	,20201 [Kontrahent Pierwotny Kod __PROCID__Kontrahenci__], pod1.Pod_PodId [Kontrahent Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Kod __DATABASE__]&#xD;
	,20201 [Kontrahent Nazwa __PROCID__], pod5.Pod_PodId [Kontrahent Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Nazwa __DATABASE__]&#xD;
	,20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod5.Pod_PodId [Kontrahent Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Kod __DATABASE__]&#xD;
	,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
	,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
	,29056 [Magazyn Kod __PROCID__Magazyny__],	Mag_MagId [Magazyn Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__] &#xD;
	&#xD;
	'&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
       &#xD;
set @select2 = &#xD;
' FROM cdn.TraNag TN &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TN.TrN_TrNID &#xD;
	 LEFT JOIN #tmpSeria ser ON TN.TrN_DDfId = DDf_DDfID&#xD;
	 LEFT JOIN CDN.DokDefinicje dd ON TN.TrN_DDfId = dd.DDf_DDfID &#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt1 ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
	 LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
	 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny ON (CASE WHEN TN.TrN_TypDokumentu = 318 THEN TN.TrN_MagZrdId ELSE ISNULL(TrE_MagId,TN.TrN_MagZrdId) END) = Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TN.TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TN.TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
	 LEFT JOIN #tmpPozatr PozAtr on PozAtr.TrA_TrEId = TrE_TrEId&#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
	 LEFT JOIN ' + @Operatorzy + ' zal ON TN.TrN_OpeZalID = zal.Ope_OpeId&#xD;
	 LEFT JOIN ' + @Operatorzy + ' mod ON TN.TrN_OpeModID = mod.Ope_OpeId&#xD;
	 LEFT OUTER JOIN cdn.PodmiotyView pod5 on pod1.Pod_GlID = pod5.Pod_PodId and pod1.Pod_GlKod = pod5.Pod_Kod&#xD;
	 LEFT OUTER JOIN CDN.Kontrahenci knt3 ON pod5.Pod_PodID=knt3.Knt_KntId AND pod5.Pod_PodmiotTyp = 1&#xD;
	 LEFT OUTER JOIN CDN.Kategorie kat5 ON knt3.Knt_KatID=kat5.Kat_KatID&#xD;
	 LEFT OUTER JOIN cdn.PodmiotyView pod6 ON knt3.Knt_OpiekunId = pod6.Pod_PodId AND knt3.Knt_OpiekunTyp = pod6.Pod_PodmiotTyp&#xD;
	 LEFT JOIN #tmpKonAtr KonAtr1 ON pod5.Pod_PodId = KonAtr1.KnA_PodmiotId AND pod5.Pod_PodmiotTyp = KonAtr1.KnA_PodmiotTyp&#xD;
	 LEFT JOIN ' + @Operatorzy + ' opk3 ON knt3.Knt_OpiekunId = opk3.Ope_OpeId AND knt3.Knt_OpiekunTyp = 8 &#xD;
	 LEFT OUTER JOIN CDN.PodmiotyView pod7 ON TrN_OdbID = pod7.Pod_PodId AND TrN_OdbiorcaTyp = pod7.Pod_PodmiotTyp&#xD;
	 LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
     LEFT OUTER JOIN ( &#xD;
			SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
			FROM CDN.TraElem TRE&#xD;
			JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
				   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TRN.TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TRN.TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 )&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
	)KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
	LEFT JOIN(&#xD;
		SELECT TRERel.TrE_TrEID [TRELID], TRERel.TrE_TrNID [TRNLID], TE.TrE_TrEID [TID]&#xD;
		FROM CDN.TraNag TF&#xD;
		JOIN CDN.TraElem TE ON TE.TrE_TrNID=TF.TrN_TrNID &#xD;
		JOIN CDN.TraNagRelacje TRR ON TF.TrN_TrNId = TRR.TrR_TrNId AND TRR.TrR_Flaga &lt;&gt; 1 AND TRR.TrR_FaTyp in (301,302,305) &#xD;
		JOIN CDN.TraElem TRERel ON TRERel.TrE_TrNId = TRR.TrR_FaId AND TREREl.TrE_LpPow = TE.TrE_LpPow --AND TRERel.TrE_ZwrId IS NULL&#xD;
		WHERE&#xD;
		TF.TrN_TypDokumentu IN (303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
		AND TF.TrN_Bufor&lt;&gt;-1&#xD;
		AND TE.TrE_Aktywny&lt;&gt;0&#xD;
	) AS TRERel ON TRERel.TID = TR.TrE_TrEID &#xD;
	LEFT JOIN CDN.TraNag TNFS ON TRERel.TRNLID = TNFS.TrN_TrNID&#xD;
	LEFT JOIN CDN.TraElem TEFS ON  TRERel.TRELID = TEFS.Tre_Treid&#xD;
	LEFT JOIN CDN.TraSElem TSE ON TSE.TrS_TrEId=TR.TRE_TreID AND TSE.TrS_MagId = ISNULL(TR.TrE_MagId,TN.TrN_MagZrdId)&#xD;
	LEFT JOIN CDN.TraSElem TDE ON TSE.TrS_TrSIdDost=TDE.TrS_TrSID&#xD;
	LEFT JOIN cdn.TraElem TED ON TDE.TrS_TrEId = TED.TrE_TrEID&#xD;
	LEFT JOIN CDN.TraNag TND ON TED.TrE_TrNId = TND.TrN_TrNID&#xD;
	   LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
&#xD;
WHERE&#xD;
TN.TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
AND TN.TrN_Bufor&lt;&gt;-1&#xD;
AND TR.TrE_Aktywny&lt;&gt;0'&#xD;
&#xD;
exec (@select + @select2)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpPozatr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM0zwJratE7ZrmpGGBehZ96gzfYuMpQO2yJQQEhkyxmOvslOn8ASdlUU7ZjrS0O0poY/4wXQcWRsf4yJiGWVcYKrWRlBBo3XI7Sm0kOWyo1NDptWs6RP5gkjHVPFIggnp+/ecm6EknzxBylZSRfP3Pc7XA/HmkgjShWnsgGlkO/SChYbzyIMVge9Mygss1/pBTw==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument FA/FZ Numer" caption="Dokument FA/FZ Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument PZ Numer" caption="Dokument PZ Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Waluta" caption="Waluta" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Seria" caption="Dokument Seria" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Nazwa" caption="Kontrahent Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kod" caption="Kontrahent Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Województwo" caption="Kontrahent Pierwotny Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Miasto" caption="Kontrahent Pierwotny Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kraj" caption="Kontrahent Pierwotny Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Grupa" caption="Kontrahent Pierwotny Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Opiekun" caption="Kontrahent Pierwotny Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kraj" caption="Kontrahent Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Wprowadzający" caption="Operator Wprowadzający" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Modyfikujący" caption="Operator Modyfikujący" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Marża" caption="Marża" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Koszt Zakupu" caption="Koszt Zakupu" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut KLUCZOWY" caption="Kontrahent Pierwotny Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut KLUCZOWY" caption="Kontrahent Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut PROJEKTY PARKI" caption="Kontrahent Pierwotny Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut PROJEKTY PARKI" caption="Kontrahent Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut STATUS" caption="Kontrahent Pierwotny Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut STATUS" caption="Kontrahent Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut PROJEKTY PARKI (K)" caption="Dokument Atrybut PROJEKTY PARKI (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS (K)" caption="Dokument Atrybut STATUS (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROZMIAR" caption="Produkt Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut PIELĘGNACJA" caption="Pozycja Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut KOLOR" caption="Pozycja Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut DATA WAŻNOŚCI" caption="Pozycja Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut NR SERYJNY" caption="Pozycja Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut ATRYBUTZASOBU" caption="Pozycja Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut ROZMIAR" caption="Pozycja Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAUAAABIAAAABwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0wMl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTAzXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMDRdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0wNV0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMDldBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0xMF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTEyXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMTVdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0xNl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTE3XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMTldBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0yMl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTIzXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMjRdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0yNV0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTI2XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMjldBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0zMF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTMxXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMDFdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0wMl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTAzXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMDVdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0wN10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTA5XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMTBdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0xM10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTE0XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMTVdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0xNl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTE5XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMjBdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0yMV0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTIyXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMjNdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0yNl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTI4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMTAtMjNdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMS0wOS0yM10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDExLTEyLTI4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTItMDEtMjNdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMi0wMS0yNF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEyLTAyLTIwXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTItMDItMjldBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMi0wNC0xN10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEyLTA2LTIxXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTItMDctMzFdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMi0wOC0yMl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEyLTA4LTI3XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTItMTItMTNdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMi0xMi0xOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEzLTAyLTExXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTMtMDItMTJdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMy0wMi0xM10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEzLTAyLTE0XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTMtMDMtMTJdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMy0wNC0wNV0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEzLTA1LTE0XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTMtMDctMjNdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMy0wNy0yNF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEzLTA5LTE4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTQtMDItMjBdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxNC0wMi0yNF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDE0LTAyLTI4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTQtMDQtMjJdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxNC0wNy0wMl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDE1LTA0LTI4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTYtMDMtMjhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxNi0wNC0yOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDE4LTA0LTIzXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTgtMDUtMTBdnQAAAAcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMDJdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTAyXQcCIltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzEvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTAyXQcCIltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaLzEvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTAyXQcCJFtEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaUEsvMS8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMDNdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlovMi8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMDRdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMi8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMDRdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlovMy8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMDVdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMy8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMDVdBwIkW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkFXSy8yLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0wNV0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi80LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0wNV0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi81LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0wOF0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi82LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0wOV0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS80LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0xMF0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi83LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0xMl0HAiZbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltTUUxQaXZvdEJsYW5rXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMTJdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvNS8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMTJdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlovOC8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMTVdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvNi8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMTVdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvNy8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMTVdBwIkW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkFXSy8xLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0xNl0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi85LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0xN10HAiZbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltTUUxQaXZvdEJsYW5rXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMTddBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvOS8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMTldBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTE5XQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzEwLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0xOV0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi8xMC8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMTldBwInW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlpVRS8xLzIwMDgvVUVdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0yMl0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8xMS8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMjJdBwIkW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkFXSy8xLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0yMl0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltQQS8xLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0yM10HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi8xMS8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMjRdBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMTIvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTI0XQcCJ1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaVUUvMi8yMDA4L1VFXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMjVdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTI1XQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzEzLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0yNV0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi8xMi8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMjZdBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMTQvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTI2XQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzE1LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0yNl0HAiRbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQVdLLzIvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTI5XQcCLFtEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBVUUvMDAwMDAxLzIwMDgvVUVdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0yOV0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltQQS8yLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMS0zMF0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8xNi8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDEtMzBdBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlovMTMvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAxLTMxXQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaLzE0LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0wMV0HAiZbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltTUUxQaXZvdEJsYW5rXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMDFdBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMjEvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTAxXQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaLzE1LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0wMl0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi8xNi8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMDNdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTAzXQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzIyLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0wM10HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltQQS8zLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0wNV0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8yMy8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMDVdBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlovMTcvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTA1XQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaLzE4LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0wN10HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8yNC8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMDddBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlovMTkvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTA3XQcCLFtEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaVUUvMDAwMDAzLzIwMDgvVUVdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0wN10HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltQQS80LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0wOV0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8yNS8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMTBdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTEwXQcCK1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0FTRC9GQVdaLzEvMjAxNi8xMF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTEwXQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzQ2LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0xMF0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi8yNS8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMTNdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTEzXQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzE3LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0xM10HAixbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQVVFLzAwMDAwMi8yMDA4L1VFXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMTRdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTE0XQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzI2LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0xNF0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi8yMC8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMTVdBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMjcvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTE1XQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzI4LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0xNV0HAiVbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQURFVC8xLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0xNV0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi8yMS8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMTVdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bUEEvNS8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMTZdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTE2XQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzI5LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0xNl0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8zMC8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMTldBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMzEvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTIwXQcCJltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW1NRTFBpdm90QmxhbmtdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0yMF0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8zMy8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMjBdBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMzQvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTIwXQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzM1LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0yMF0HAixbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWlVFLzAwMDAwNC8yMDA4L1VFXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMjFdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTIxXQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzM2LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0yMV0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8zNy8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMjFdBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlovMjIvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTIyXQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaLzIzLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0yM10HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8zOC8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMjZdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTI2XQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzQwLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0yNl0HAixbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQVVFLzAwMDAwMy8yMDA4L1VFXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMjZdBwIsW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkFVRS8wMDAwMDQvMjAwOC9VRV0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTI4XQcCJltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW1NRTFBpdm90QmxhbmtdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0yOF0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS80My8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMjhdBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvNDUvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTI4XQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzQ3LzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0yOF0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS80OC8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMjhdBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvNDkvMjAwOF0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTAyLTI4XQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzUwLzIwMDhdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAwOC0wMi0yOF0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi8yNC8yMDA4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMDgtMDItMjhdBwIsW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlpVRS8wMDAwMDUvMjAwOC9VRV0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDA4LTEwLTIzXQcCIltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaLzkvMjAxMV0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDExLTA5LTIzXQcCIltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaLzEvMjAxMV0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDExLTA5LTIzXQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaLzEwLzIwMTFdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMS0wOS0yM10HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi8yLzIwMTFdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMS0xMi0yOF0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS83LzIwMTFdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMi0wMS0yM10HAiZbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltTUUxQaXZvdEJsYW5rXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTItMDEtMjNdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlovMS8yMDEyXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTItMDEtMjRdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEyLTAyLTIwXQcCIltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW1BBLzEvMjAxMl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEyLTAyLTI5XQcCJltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW1NRTFBpdm90QmxhbmtdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMi0wMi0yOV0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi8yLzIwMTJdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMi0wNC0xN10HAiZbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltTUUxQaXZvdEJsYW5rXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTItMDQtMTddBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMTMvMjAxMl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEyLTA0LTE3XQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzE0LzIwMTJdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMi0wNC0xN10HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi80LzIwMTJdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMi0wNi0yMV0HAiZbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltTUUxQaXZvdEJsYW5rXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTItMDYtMjFdBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMTgvMjAxMl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEyLTA2LTIxXQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzE5LzIwMTJdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMi0wNy0zMV0HAiZbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltTUUxQaXZvdEJsYW5rXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTItMDgtMjJdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEyLTA4LTI3XQcCJltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW1NRTFBpdm90QmxhbmtdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMi0wOC0yN10HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8yMy8yMDEyXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTItMDgtMjddBwIjW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMjQvMjAxMl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEyLTA4LTI3XQcCIltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaLzYvMjAxMl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEyLTA4LTI3XQcCIltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZaLzcvMjAxMl0HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEyLTEyLTEzXQcCJltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW1NRTFBpdm90QmxhbmtdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMi0xMi0xOF0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8yNS8yMDEyXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTMtMDItMTFdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEzLTAyLTEyXQcCJltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW1NRTFBpdm90QmxhbmtdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMy0wMi0xM10HAiZbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltTUUxQaXZvdEJsYW5rXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTMtMDItMTRdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDEzLTAzLTEyXQcCJltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW1NRTFBpdm90QmxhbmtdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxMy0wNC0wNV0HAiZbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltTUUxQaXZvdEJsYW5rXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTMtMDUtMTRdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlovMS8yMDEzXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTMtMDUtMTRdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlovMi8yMDEzXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTMtMDctMjNdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlovMy8yMDEzXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTMtMDctMjRdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRlovNC8yMDEzXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTMtMDktMThdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDE0LTAyLTIwXQcCJltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW1NRTFBpdm90QmxhbmtdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxNC0wMi0yNF0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8yLzIwMTRdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxNC0wMi0yOF0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8xLzIwMTRdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxNC0wMi0yOF0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8zLzIwMTRdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxNC0wNC0yMl0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS80LzIwMTRdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxNC0wNC0yMl0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS81LzIwMTRdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxNC0wNC0yMl0HAiJbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS82LzIwMTRdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxNC0wNC0yMl0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGWi8yMC8yMDExXQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTQtMDctMDJdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDE0LTA3LTAyXQcCI1tEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzEzLzIwMTRdBwIjW0RhdGEgT3BlcmFjamkgRHppZcWEXS5bMjAxNC0wNy0wMl0HAiNbRG9rdW1lbnQgRkEvRlogTnVtZXJdLltGQS8xNC8yMDE0XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTUtMDQtMjhdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMi8yMDE1XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTYtMDMtMjhdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMS8yMDE2XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTYtMDQtMjhdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMi8yMDE2XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTgtMDQtMjNdBwIiW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bRkEvMS8yMDE4XQcCI1tEYXRhIE9wZXJhY2ppIER6aWXFhF0uWzIwMTgtMDUtMTBdBwImW0Rva3VtZW50IEZBL0ZaIE51bWVyXS5bU1FMUGl2b3RCbGFua10HAiNbRGF0YSBPcGVyYWNqaSBEemllxYRdLlsyMDE4LTA1LTEwXQcCIltEb2t1bWVudCBGQS9GWiBOdW1lcl0uW0ZBLzIvMjAxOF3/////AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="False" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument FA/FZ Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Dokument Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Dzień"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Miesiąc"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Rok"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Wartość Brutto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Wartość Netto" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Wartość Brutto" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Ilość" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Dokument FA/FZ Numer" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Dokument Numer" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Data Operacji Dzień" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Data Operacji Miesiąc" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Rok" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport Dokumentów Magazynowych wersja 33.0 (OPTIMA 2024.0.0)&#xD;
&#xD;
Raport zawiera informacje o sprzedaży i zakupach w firmie na podstawie dokumentów magazynowych. Wartości prezentowane są w walucie systemowej.&#xD;
&#xD;
Analizy oparte są o dokumenty PW, RW, PZ, WZ, MM, PKA, WKA, PWP, RWS. Niebrane pod uwagę są dokumenty anulowane. Do poprawnej analizy należy wybrać typ dokumentu, dla którego ma zostać wyświetlony raport.&#xD;
&#xD;
Raport oparty na tabelach:&#xD;
TraNag - Tabela z nagłówkami dokumentów (WZ, PZ itp.). &#xD;
TraElem - Tabela z elementami dokumentów (WZ, PZ itp.).</a:description><a:id>265</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.25 Raport dokumentów magazynowych z fakturami</a:mainLinkName><a:modifiedOn>2025-01-29T16:52:04.683</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2018-09-25T13:06:16.05</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>     SELECT count(*) as ilosc,PdE_TrEId INTO #TowCnt FROM cdn.ProdElem GROUP BY PdE_TrEId&#xD;
    SELECT count(*) as ilosc,PdE_TrEIdRWS INTO #temprws FROM cdn.ProdElem GROUP BY PdE_TrEIdRWS&#xD;
&#xD;
    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.KnA_WartoscTxt,'','',''.'') ELSE ATR.KnA_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.KntAtrybuty ATR &#xD;
        JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
        WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Pierwotny Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'     &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr1.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'      &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.DAt_WartoscTxt,'','',''.'') ELSE ATR.DAt_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.DokAtrybuty ATR &#xD;
        JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
        WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max), @atrybutyPoz2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TrA_DeAId FROM CDN.TraElemAtr WHERE TrA_TrEId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TrA_TrEId INTO #tmpPozAtr FROM CDN.TraElemAtr&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
SET @atrybutyPoz2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpPozAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpPozAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TrA_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TrA_Wartosc,'','',''.'') ELSE ATR.TrA_Wartosc END &#xD;
        END  &#xD;
        FROM CDN.TraElemAtr ATR &#xD;
        JOIN #tmpPozAtr TM ON ATR.TrA_TrEId = TM.TrA_TrEId&#xD;
        WHERE ATR.TrA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', ISNULL(PozAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyPoz2 = @atrybutyPoz2 + N', ''(NIEPRZYPISANE)'' [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
     WHEN DDf_Numeracja like '@rejestr%' THEN 5&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
--Tabela dla RWS&#xD;
SELECT &#xD;
TrN_TrNID [id],&#xD;
COUNT(Twr_TwrId) [tow],&#xD;
TrE_TrEIdProd [idtre]&#xD;
INTO #towile &#xD;
&#xD;
FROM cdn.TraNag TW&#xD;
JOIN cdn.TraElem TRW ON TRW.TrE_TrNID=TW.TrN_TrNID AND TW.TrN_TypDokumentu = 318&#xD;
LEFT OUTER JOIN CDN.Towary T2 ON TRW.TrE_TwrId=T2.Twr_TwrId&#xD;
GROUP BY TrN_TrNID, TrE_TrEIdProd&#xD;
&#xD;
--Liczba dokuemntów RWS w relacji z PWP&#xD;
SELECT pw.TrN_TrNID [idpw], COUNT(pw.TrN_TrNID) [rwscount]&#xD;
INTO #tmpRwsCount&#xD;
FROM cdn.TraNag pw&#xD;
LEFT JOIN CDN.TraNagRelacje ON pw.TrN_TrNID = TrR_TrNId&#xD;
LEFT JOIN cdn.TraNag rw ON TrR_FaId = rw.TrN_TrNID AND rw.TrN_TypDokumentu = 318 &#xD;
WHERE pw.TrN_TypDokumentu = 317 &#xD;
GROUP BY pw.TrN_TrNID&#xD;
&#xD;
--Wyliczanie Atrybutów Zasobów&#xD;
DECLARE @atrybutyZas varchar(max);&#xD;
DECLARE @atrybutyZas2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in &#xD;
(&#xD;
SELECT DISTINCT TsC_Cecha1_DeAId FROM CDN.TraSElemCechy&#xD;
    join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
    join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
    WHERE TrE_TypDokumentu IN (317,318)&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha2_DeAId FROM CDN.TraSElemCechy&#xD;
    join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
    join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
    WHERE TrE_TypDokumentu IN (317,318)&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha3_DeAId FROM CDN.TraSElemCechy&#xD;
    join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
    join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
    WHERE TrE_TypDokumentu IN (317,318)&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha4_DeAId FROM CDN.TraSElemCechy&#xD;
    join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
    join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
    WHERE TrE_TypDokumentu IN (317,318)&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha5_DeAId FROM CDN.TraSElemCechy&#xD;
    join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
    join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
    WHERE TrE_TypDokumentu IN (317,318)&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha6_DeAId FROM CDN.TraSElemCechy&#xD;
    join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
    join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
    WHERE TrE_TypDokumentu IN (317,318)&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha7_DeAId FROM CDN.TraSElemCechy&#xD;
    join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
    join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
    WHERE TrE_TypDokumentu IN (317,318)&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha8_DeAId FROM CDN.TraSElemCechy&#xD;
    join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
    join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
    WHERE TrE_TypDokumentu IN (317,318)&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha9_DeAId FROM CDN.TraSElemCechy&#xD;
    join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
    join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
    WHERE TrE_TypDokumentu IN (317,318)&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha10_DeAId FROM CDN.TraSElemCechy&#xD;
    join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
    join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
    WHERE TrE_TypDokumentu IN (317,318)&#xD;
)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TsC_TrSID &#xD;
INTO #tmpZasAtr &#xD;
FROM CDN.TraSElemCechy&#xD;
join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
WHERE TrE_TypDokumentu = 317&#xD;
&#xD;
SELECT DISTINCT TsC_TrSID &#xD;
INTO #tmpZasAtrRWS&#xD;
FROM CDN.TraSElemCechy&#xD;
join CDN.TraSElem Trs1 on Trs1.TrS_TrSID = TsC_TrSID&#xD;
join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
WHERE TrE_TypDokumentu = 318&#xD;
&#xD;
SET @atrybutyZas = ''&#xD;
SET @atrybutyZas2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
       IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
       IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
       --cechy dla PWP&#xD;
       SET @sqlA = N'ALTER TABLE #tmpZasAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
       EXEC(@sqlA)    &#xD;
       --cechy dla RWS&#xD;
       SET @sqlA = N'ALTER TABLE #tmpZasAtrRWS ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
       EXEC(@sqlA)   &#xD;
       --cechy dla PWP&#xD;
       SET @sqlA = N'UPDATE #tmpZasAtr&#xD;
             SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = &#xD;
             CASE&#xD;
                    WHEN ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      else  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha1_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha1_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha2_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha2_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha3_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha3_Wartosc END END &#xD;
                    WHEN ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha4_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha4_Wartosc END END &#xD;
                    WHEN ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha5_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha5_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha6_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha6_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha6_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha7_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha7_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha7_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha8_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha8_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha8_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha9_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha9_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha9_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha10_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha10_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha10_Wartosc END END&#xD;
             ELSE ''(NIEPRZYPISANE)'' END&#xD;
             FROM CDN.TraSElemCechy ATR &#xD;
             JOIN #tmpZasAtr TM ON ATR.TsC_TrSID = TM.TsC_TrSID&#xD;
             WHERE ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
       &#xD;
       EXEC(@sqlA)    &#xD;
    --cechy dla RWS&#xD;
           SET @sqlA = N'UPDATE  #tmpZasAtrRWS&#xD;
             SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = &#xD;
             CASE&#xD;
                    WHEN ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      else  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha1_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha1_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha2_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha2_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha3_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha3_Wartosc END END &#xD;
                    WHEN ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha4_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha4_Wartosc END END &#xD;
                    WHEN ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha5_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha5_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha6_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha6_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha6_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha7_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha7_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha7_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha8_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha8_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha8_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha9_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha9_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha9_Wartosc END END&#xD;
                    WHEN ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha10_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                      ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha10_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha10_Wartosc END END&#xD;
             ELSE ''(NIEPRZYPISANE)'' END&#xD;
             FROM CDN.TraSElemCechy ATR &#xD;
             JOIN  #tmpZasAtrRWS TM ON ATR.TsC_TrSID = TM.TsC_TrSID&#xD;
             WHERE ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
       &#xD;
       EXEC(@sqlA)   &#xD;
    --atrbuty dok PWP&#xD;
    SET @atrybutyZas = @atrybutyZas + N', ISNULL(ZasAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Zasoby Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    --atrybuty dok RWS&#xD;
    SET @atrybutyZas2 = @atrybutyZas2 + N', ISNULL(ZasAtrRWS.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Zasoby Składnik Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
&#xD;
       FETCH NEXT FROM atrybut_cursor&#xD;
       INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
SELECT DISTINCT TrE_TrEID TREID,&#xD;
(select count(*) from Cdn.TraSelem TrS2 where trS2.TrS_TrEId = TrE_TrEID) TRSCount&#xD;
 INTO #tmpTrSCount&#xD;
FROM CDN.TraSElem Trs1 &#xD;
join CDN.TraElem on TrE_TrEID = Trs1.TrS_TrEId&#xD;
WHERE TrE_TypDokumentu IN (317,318)&#xD;
&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
  select&#xD;
  BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    RWSNag.TrN_NumerPelny [Dokument RWS],&#xD;
    PWPNAG.TrN_NumerPelny [Dokument Numer],&#xD;
&#xD;
    dd.DDf_Symbol [Dokument Symbol],&#xD;
    ISNULL(NULLIF(PWPNag.TrN_Opis,''''), ''(BRAK)'') [Dokument Opis],&#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(PWPNag.TrN_NumerPelny,0,CHARINDEX(''/'',PWPNag.TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(PWPNag.TrN_NumerPelny,CHARINDEX(''/'',PWPNag.TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],   &#xD;
    pod1.Pod_Nazwa1 [Kontrahent Pierwotny Nazwa],   &#xD;
    pod1.Pod_Kod [Kontrahent Pierwotny Kod],&#xD;
     ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Województwo],&#xD;
     ISNULL(NULLIF(pod1.Pod_Powiat, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Powiat],&#xD;
    ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Miasto], &#xD;
    ISNULL(NULLIF(pod1.Pod_Kraj, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Kraj], &#xD;
    ISNULL(NULLIF(pod1.Pod_NIP, ''''), ''(BRAK)'') [Kontrahent Pierwotny NIP], &#xD;
    ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Pierwotny Grupa], &#xD;
    CASE &#xD;
        WHEN knt1.Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN knt1.Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
    ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Pierwotny Opiekun],&#xD;
    pod5.Pod_Nazwa1 [Kontrahent Nazwa], &#xD;
    pod5.Pod_Kod [Kontrahent Kod], &#xD;
    ISNULL(NULLIF(pod5.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
    ISNULL(NULLIF(pod5.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Kontrahent Powiat], ISNULL(NULLIF(pod5.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Kontrahent Miasto],&#xD;
    ISNULL(NULLIF(pod5.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Kontrahent Kraj],&#xD;
    ISNULL(NULLIF(pod5.Pod_NIP, ''''),''(BRAK)'') [Kontrahent NIP],&#xD;
    ISNULL(NULLIF(pod5.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa],&#xD;
    CASE knt3.Knt_OpiekunTyp&#xD;
        WHEN 3 THEN ISNULL(pod6.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN 8 THEN ISNULL(opk3.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
        ELSE ''(NIEPRZYPISANE)'' &#xD;
    END [Kontrahent Opiekun],&#xD;
    pod7.Pod_Nazwa1 [Odbiorca Nazwa],   &#xD;
    pod7.Pod_Kod [Odbiorca Kod], &#xD;
    ISNULL(NULLIF(pod7.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Odbiorca Województwo],&#xD;
    ISNULL(NULLIF(pod7.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Odbiorca Powiat], ISNULL(NULLIF(pod7.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(pod7.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Odbiorca Kraj],&#xD;
    ISNULL(NULLIF(pod7.Pod_NIP, ''''),''(BRAK)'') [Odbiorca NIP],&#xD;
    ISNULL(NULLIF(pod7.Pod_Grupa, ''''),''Pozostali'') [Odbiorca Grupa],    &#xD;
    zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
    ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
    ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu],   &#xD;
    T.Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE T.TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(T.TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca], &#xD;
    CASE T.Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],   &#xD;
    T.Twr_Kod [Produkt Kod],    &#xD;
    poz.sciezka [Produkt Pełna Nazwa Grupy], "Produkt Opis" = CAST(t.Twr_Opis as VARCHAR(1024)), T.Twr_Jm [Jednostka Miary], &#xD;
    Isnull(convert(varchar(15),T.twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],   &#xD;
     ISNULL(Mag.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
     ISNULL(MagDoc.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Docelowy Kod],&#xD;
     T2.Twr_Kod [Składnik Kod],&#xD;
     T2.Twr_Nazwa [Składnik Nazwa],&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
        CASE&#xD;
        WHEN T.Twr_Typ = 0 AND T.Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN T.Twr_Typ = 1 AND T.Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN T.Twr_Typ = 0 AND T.Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN T.Twr_Typ = 1 AND T.Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna],&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
   CAST(PWPElem.TrE_WartoscNetto/cnt.ilosc / ISNULL(TCount.TRSCount,1.0) / ISNULL(TCountRWS.TRSCount,1.0) AS DECIMAL(19,10)) [Wartość Netto], &#xD;
	 CAST(PWPElem.TrE_WartoscBrutto/cnt.ilosc / ISNULL(TCount.TRSCount,1.0) / ISNULL(TCountRWS.TRSCount,1.0) AS DECIMAL(19,10))[Wartość Brutto], &#xD;
	 CAST(PWPElem.TrE_WartoscNettoWal/cnt.ilosc  / ISNULL(TCount.TRSCount,1.0) / ISNULL(TCountRWS.TRSCount,1.0) AS DECIMAL(19,10))[Wartość Waluta],&#xD;
	 CAST(PWPElem.TrE_Ilosc/cnt.ilosc  / ISNULL(TCount.TRSCount,1.0) / ISNULL(TCountRWS.TRSCount,1.0) AS DECIMAL(19,10))[Ilość], &#xD;
	 CAST( RWSSklad.TrE_WartoscNetto/rws.ilosc  / ISNULL(TCount.TRSCount,1.0) / ISNULL(TCountRWS.TRSCount,1.0)AS DECIMAL(19,10)) [Składnik Wartość Netto], &#xD;
	 CAST(RWSSklad.TrE_WartoscBrutto/rws.ilosc  / ISNULL(TCount.TRSCount,1.0) / ISNULL(TCountRWS.TRSCount,1.0) AS DECIMAL(19,10))[Składnik Wartość Brutto], &#xD;
	 CAST(RWSSklad.TrE_WartoscNettoWal/rws.ilosc  / ISNULL(TCount.TRSCount,1.0) / ISNULL(TCountRWS.TRSCount,1.0)AS DECIMAL(19,10)) [Składnik Wartość Waluta],&#xD;
	 CAST(RWSSklad.TrE_Ilosc/rws.ilosc  / ISNULL(TCount.TRSCount,1.0) / ISNULL(TCountRWS.TRSCount,1.0) AS DECIMAL(19,10))[Składnik Ilość] &#xD;
    /*&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), PWPNag.TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji]&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), PWPNag.TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia]&#xD;
*/&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), PWPNag.TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, PWPNag.TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, PWPNag.TrN_DataOpe)*/ [Data Operacji Tydzień Roku] &#xD;
    ,MONTH(PWPNag.TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, PWPNag.TrN_DataOpe) [Data Operacji Kwartał], YEAR(PWPNag.TrN_DataOpe) [Data Operacji Rok] &#xD;
    ,REPLACE(CONVERT(VARCHAR(10), PWPNag.TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia Dzień], (datepart(DY, datediff(d, 0, PWPNag.TrN_DataWys) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, PWPNag.TrN_DataWys)*/ [Data Wystawienia Tydzień Roku] &#xD;
    ,MONTH(PWPNag.TrN_DataWys) [Data Wystawienia Miesiąc], DATEPART(quarter, PWPNag.TrN_DataWys) [Data Wystawienia Kwartał], YEAR(PWPNag.TrN_DataWys) [Data Wystawienia Rok] &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
    ,CASE WHEN PWPNag.TrN_TypDokumentu = 317 THEN 25045 END [Dokument Numer __PROCID__WZ__], PWPNag.TrN_TrNId [Dokument Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny  Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Kod __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Kontrahent Nazwa __PROCID__], pod5.Pod_PodId [Kontrahent Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod5.Pod_PodId [Kontrahent Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], T.Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], T.Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__],  Mag.Mag_MagId [Magazyn Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Docelowy Kod __PROCID__Magazyny__],  MagDoc.Mag_MagId [Magazyn Docelowy Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Docelowy Kod __DATABASE__]   &#xD;
&#xD;
    '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz + @atrybutyZas + @atrybutyZas2&#xD;
       &#xD;
       &#xD;
set @select2 = &#xD;
'&#xD;
   from  cdn.ProdElem PE&#xD;
   left join cdn.traelem PWPElem on PdE_TrEId = PWPElem.TrE_TrEId&#xD;
   LEFT JOIN cdn.Tranag PWPNag ON PWPElem.TrE_TrNId = PWPNAG.TrN_TrNID&#xD;
   left join cdn.traelem  RWSSklad on pe.PdE_TrEIdRWS = RWSSklad.TrE_TrEID&#xD;
   left join cdn.tranag RWSNag on RWSNag.TrN_TrNID = RWSSklad.tre_trnid&#xD;
  LEFT JOIN #TowCnt cnt ON cnt.PdE_TrEId = PWPElem.TrE_TrEID&#xD;
  LEFT JOIN #temprws rws on RWs.PdE_TrEIdRWS = RWSSklad.TrE_TrEID&#xD;
&#xD;
     LEFT JOIN #tmpSeria ser ON PWPNag.TrN_DDfId = DDf_DDfID&#xD;
     LEFT JOIN CDN.DokDefinicje dd ON PWPNag.TrN_DDfId = dd.DDf_DDfID&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt1 ON PWPElem.TrE_PodID=Knt_KntId AND PWPElem.TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON PWPElem.TrE_PodID= pod1.Pod_PodId AND PWPElem.TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary T ON PWPElem.TrE_TwrId=T.Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = T.Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = T.Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON T.Twr_TwrId = TwC_TwrID AND T.Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny Mag ON (CASE WHEN PWPNag.TrN_TypDokumentu = 318 THEN PWPNag.TrN_MagZrdId ELSE ISNULL(PWPElem.TrE_MagId,PWPNag.TrN_MagZrdId) END) = Mag.Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Magazyny MagDoc ON MagDoc.Mag_MagId = PWPNag.TrN_MagDocId&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON PWPNag.TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON PWPElem.TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON T.Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON PWPNag.TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON PWPElem.TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN ' + @Operatorzy + ' zal ON PWPNag.TrN_OpeZalID = zal.Ope_OpeId&#xD;
     LEFT JOIN ' + @Operatorzy + ' mod ON PWPNag.TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod5 on pod1.Pod_GlID = pod5.Pod_PodId and pod1.Pod_GlKod = pod5.Pod_Kod&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt3 ON pod5.Pod_PodID=knt3.Knt_KntId AND pod5.Pod_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat5 ON knt3.Knt_KatID=kat5.Kat_KatID&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod6 ON knt3.Knt_OpiekunId = pod6.Pod_PodId AND knt3.Knt_OpiekunTyp = pod6.Pod_PodmiotTyp&#xD;
     LEFT JOIN #tmpKonAtr KonAtr1 ON pod5.Pod_PodId = KonAtr1.KnA_PodmiotId AND pod5.Pod_PodmiotTyp = KonAtr1.KnA_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod7 ON PWPNag.TrN_OdbID = pod7.Pod_PodId AND PWPNag.TrN_OdbiorcaTyp = pod7.Pod_PodmiotTyp&#xD;
     LEFT JOIN ' + @Operatorzy + ' opk3 ON knt3.Knt_OpiekunId = opk3.Ope_OpeId AND knt3.Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN CDN.Kontrahenci knt4 ON T.Twr_KntId = knt4.Knt_KntId &#xD;
     LEFT OUTER JOIN CDN.Towary  T2 ON RWSSklad.TrE_TwrId=T2.Twr_TwrId&#xD;
&#xD;
      LEFT JOIN #tmpPozatr PozAtr on PozAtr.TrA_TrEId = PWPElem.TrE_TrEId&#xD;
     LEFT JOIN CDN.TraSElem  PWPTRS ON PWPTRS.TrS_TreID = PWPElem.TrE_TreId&#xD;
     LEFT JOIN #tmpZasAtr ZasAtr ON PWPTRS.Trs_TrSId = ZasAtr.TsC_TrSID&#xD;
     LEFT JOIN CDN.TraSElem  RWSTRS ON  RWSSklad.TrE_TreId=RWSTRS.TrS_TreID &#xD;
     LEFT JOIN #tmpZasAtrRWS ZasAtrRWS ON RWSTRS.Trs_TrSId = ZasAtrRWS.TsC_TrSID&#xD;
    &#xD;
     LEFT OUTER JOIN #tmpTrSCount TCount ON &#xD;
     PWPElem.TrE_TreId = TCount.TREID &#xD;
     LEFT OUTER JOIN #tmpTrSCount TCountRWS ON &#xD;
      RWSSklad.TrE_TreId = TCountRWS.TREID&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
   where  RWSSklad.Tre_TypDokumentu = 318 AND RWSNag.TrN_TypDokumentu = 318&#xD;
  and PWPNag.TrN_Bufor&lt;&gt;-1&#xD;
AND PWPElem.TrE_Aktywny&lt;&gt;0&#xD;
&#xD;
AND PWPNag.TrN_DataDok between convert(datetime,''' + convert(varchar, @DATAOD, 120) + ''', 120) and convert(datetime,''' + convert(varchar, @DATADO, 120) + ''', 120)&#xD;
'&#xD;
&#xD;
exec (@select + @select2)&#xD;
&#xD;
DROP TABLE #tmpTrSCount&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpPozAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #towile&#xD;
DROP TABLE #tmpZasAtr&#xD;
DROP TABLE #tmpZasAtrRWS&#xD;
DROP TABLE #tmpRwsCount&#xD;
drop table #TowCnt&#xD;
DROP TABLE #temprws&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM0zwJratE7ZrmpGGBehZ96gzfYuMpQO2yJQQEhkyxmOvslOn8ASdlUU7ZjrS0O0poY/4wXQcWRsf4yJiGWVcYKrWRlBBo3XI7Sm0kOWyo1NDptWs6RP5gkjHVPFIggnp+/ecm6EknzxBylZSRfP3Pc7XA/HmkgjShWnsgGlkO/SChYbzyIMVge9Mygss1/pBTw==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument RWS" caption="Dokument RWS" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Symbol" caption="Dokument Symbol" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Opis" caption="Dokument Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Seria" caption="Dokument Seria" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Nazwa" caption="Kontrahent Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kod" caption="Kontrahent Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Województwo" caption="Kontrahent Pierwotny Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Powiat" caption="Kontrahent Pierwotny Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Miasto" caption="Kontrahent Pierwotny Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kraj" caption="Kontrahent Pierwotny Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny NIP" caption="Kontrahent Pierwotny NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Grupa" caption="Kontrahent Pierwotny Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Opiekun" caption="Kontrahent Pierwotny Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Powiat" caption="Kontrahent Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kraj" caption="Kontrahent Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent NIP" caption="Kontrahent NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Nazwa" caption="Odbiorca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kod" caption="Odbiorca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Województwo" caption="Odbiorca Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Powiat" caption="Odbiorca Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Miasto" caption="Odbiorca Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kraj" caption="Odbiorca Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca NIP" caption="Odbiorca NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Grupa" caption="Odbiorca Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Wprowadzający" caption="Operator Wprowadzający" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Modyfikujący" caption="Operator Modyfikujący" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Docelowy Kod" caption="Magazyn Docelowy Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Kod" caption="Składnik Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Składnik Nazwa" caption="Składnik Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="n2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="### ##0.00" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Składnik Wartość Netto" caption="Składnik Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Składnik Wartość Brutto" caption="Składnik Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Składnik Wartość Waluta" caption="Składnik Wartość Waluta" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Składnik Ilość" caption="Składnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut KLUCZOWY" caption="Kontrahent Pierwotny Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut KLUCZOWY" caption="Kontrahent Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut PROJEKTY PARKI" caption="Kontrahent Pierwotny Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut PROJEKTY PARKI" caption="Kontrahent Atrybut PROJEKTY PARKI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut STATUS" caption="Kontrahent Pierwotny Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut STATUS" caption="Kontrahent Atrybut STATUS" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut PROJEKTY PARKI (K)" caption="Dokument Atrybut PROJEKTY PARKI (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut STATUS (K)" caption="Dokument Atrybut STATUS (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut PIELĘGNACJA" caption="Produkt Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut DATA WAŻNOŚCI" caption="Produkt Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NR SERYJNY" caption="Produkt Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ATRYBUTZASOBU" caption="Produkt Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut ROZMIAR" caption="Produkt Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut PIELĘGNACJA" caption="Pozycja Atrybut PIELĘGNACJA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut KOLOR" caption="Pozycja Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut DATA WAŻNOŚCI" caption="Pozycja Atrybut DATA WAŻNOŚCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut NR SERYJNY" caption="Pozycja Atrybut NR SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut ATRYBUTZASOBU" caption="Pozycja Atrybut ATRYBUTZASOBU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut ROZMIAR" caption="Pozycja Atrybut ROZMIAR" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;DATAOD&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data wystawienia dokumentu&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT DATEADD(yy, DATEDIFF(yy, 0, GETDATE()), 0) 
&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;DATADO&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data wystawienia dokumentu&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()
&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAcAAAAAAAAAAAAAAAAAAAD/////AgAAAAcCHVtEb2t1bWVudCBOdW1lcl0uW1BXUC8xLzIwMDhdBwIdW0Rva3VtZW50IE51bWVyXS5bUFdQLzIvMjAwOF0AAAAAAAAAAA==</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument RWS"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Dokument Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Składnik Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" horzAlignment="Far" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" horzAlignment="Near" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" horzAlignment="Far" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" horzAlignment="Near" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Składnik Wartość Netto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" horzAlignment="Far" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" horzAlignment="Near" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Składnik Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" horzAlignment="Far" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" horzAlignment="Near" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Wartość Netto" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Ilość" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Składnik Wartość Netto" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Składnik Ilość" index="3" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Dokument RWS" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Dokument Numer" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Produkt Kod" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Składnik Kod" index="3" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje Dokumenty PWP wraz z powiązanymi dokumentami RWS.</a:description><a:id>266</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.26 Dokumenty PWP </a:mainLinkName><a:modifiedOn>2025-04-14T12:38:33.14</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2020-05-15T13:25:50.757</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Dokumentów Magazynowych z korektami&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie wartości korekt&#xD;
&#xD;
SELECT &#xD;
    TR.TrE_TrEID [Id], TR.TrE_Lp [Lp],&#xD;
    Korekty1.WartoscNetto AS [NettoFakor],&#xD;
    Korekty1.WartoscBrutto AS [BruttoFakor],&#xD;
    Korekty1.WartoscNettoWal AS [NettoWalFakor],&#xD;
    Korekty1.Koszt AS [KosztFakor],&#xD;
    Korekty1.Ilosc AS [IloscFakor],&#xD;
    Korekty1.IloscJM AS [IloscJMFakor],&#xD;
    Korekty1.CenaW AS [CenaWFakor],&#xD;
    Korekty1.KursL AS [KursLFakor],&#xD;
    Korekty1.KursM AS [KursMFakor],&#xD;
    Korekty1.Cena0 AS [Cena0Fakor]&#xD;
    into #Fakor&#xD;
        FROM cdn.TraNag &#xD;
        JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID    &#xD;
        LEFT JOIN&#xD;
        (           &#xD;
         SELECT ele.TrE_TrEID, ele.TrE_Lp,&#xD;
SUM(ISNULL(fakorE.TrE_WartoscNetto,0)) AS WartoscNetto,&#xD;
SUM(ISNULL(fakorE.TrE_WartoscBrutto,0)) AS WartoscBrutto,&#xD;
SUM(ISNULL(fakorE.TrE_WartoscNettoWal,0)) AS WartoscNettoWal,&#xD;
SUM(ISNULL(KosztWyliczonyFAKOREle.Koszt,0)) AS Koszt,&#xD;
SUM(ISNULL(fakorE.TrE_Ilosc,0)) AS Ilosc,       &#xD;
SUM(ISNULL(fakorE.TrE_IloscJM,0)) AS IloscJM,&#xD;
SUM(ISNULL(fakorE.TrE_CenaW,0)) AS CenaW,&#xD;
SUM(ISNULL(fakorE.TrE_KursL,0)) AS KursL,&#xD;
SUM(ISNULL(fakorE.TrE_KursM,0)) AS KursM,&#xD;
SUM(ISNULL(fakorE.TrE_Cena0,0)) AS Cena0            &#xD;
         FROM CDN.TraNag dok&#xD;
         JOIN CDN.TraElem ele ON ele.TrE_TrNId = dok.TrN_TrNID &#xD;
                                    AND dok.TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
                                    AND TrN_Bufor&lt;&gt;-1&#xD;
                                    AND TrE_Aktywny&lt;&gt;0&#xD;
                                    AND TrE_UslugaZlozonaId = 0&#xD;
									AND Trn_Anulowany = 0 &#xD;
         --FAKOR&#xD;
         LEFT JOIN CDN.TraElem fakorE ON fakorE.TrE_ZwrId = ele.TrE_TrEID AND fakorE.TrE_Lp = ele.TrE_Lp    AND fakorE.TrE_Aktywny&lt;&gt;0 -- element faktury korekcyjnej&#xD;
        LEFT OUTER JOIN ( &#xD;
            SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
            FROM CDN.TraElem TRE&#xD;
            JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
                   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 ) and NOT (TrR_TrNtyp = 306 and TrR_FaTyp=307) and not (TrR_TrNtyp = 307 and TrR_FaTyp=306)&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
         )KosztWyliczonyFAKOREle  ON KosztWyliczonyFAKOREle.TrE_TrEID = fakorE.TrE_TrEID&#xD;
         &#xD;
        GROUP BY ele.TrE_TrEID, ele.TrE_Lp&#xD;
         ) Korekty1 ON Korekty1.TrE_TrEID = TR.TrE_TrEID AND Korekty1.TrE_Lp = TR.TrE_Lp&#xD;
&#xD;
        SELECT f.id [KorId], f.Lp [KorLp],&#xD;
ISNULL(f.NettoFakor,0) [KorNetto],&#xD;
ISNULL(f.BruttoFakor,0) [KorBrutto],&#xD;
ISNULL(f.NettoWalFakor,0) [KorNettoWal],&#xD;
ISNULL(f.KosztFakor,0) [KorKoszt],&#xD;
ISNULL(f.IloscFakor,0) [KorIlosc],&#xD;
ISNULL(f.IloscJMFakor,0) [KorIloscJM],&#xD;
ISNULL(f.CenaWFakor,0) [KorCenaW],&#xD;
ISNULL(f.KursLFakor,0) [KorKursL],&#xD;
ISNULL(f.KursMFakor,0) [KorKursM],&#xD;
ISNULL(f.Cena0Fakor,0) [KorCena0]&#xD;
into #Kor FROM #fakor f;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.KnA_WartoscTxt,'','',''.'') ELSE ATR.KnA_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.KntAtrybuty ATR &#xD;
        JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
        WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Pierwotny Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'     &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr1.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'      &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.DAt_WartoscTxt,'','',''.'') ELSE ATR.DAt_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.DokAtrybuty ATR &#xD;
        JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
        WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max), @atrybutyPoz2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TrA_DeAId FROM CDN.TraElemAtr WHERE TrA_TrEId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TrA_TrEId INTO #tmpPozAtr FROM CDN.TraElemAtr&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
SET @atrybutyPoz2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpPozAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpPozAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TrA_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TrA_Wartosc,'','',''.'') ELSE ATR.TrA_Wartosc END &#xD;
        END  &#xD;
        FROM CDN.TraElemAtr ATR &#xD;
        JOIN #tmpPozAtr TM ON ATR.TrA_TrEId = TM.TrA_TrEId&#xD;
        WHERE ATR.TrA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', ISNULL(PozAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyPoz2 = @atrybutyPoz2 + N', ''(NIEPRZYPISANE)'' [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
     WHEN DDf_Numeracja like '@rejestr%' THEN 5&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    TrN_NumerPelny [Dokument Numer],&#xD;
    dd.DDf_Symbol [Dokument Symbol],&#xD;
    ISNULL(NULLIF(TrN_Opis,''''),''(BRAK)'') [Dokument Opis],&#xD;
ISNULL(NULLIF(TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
    CASE                                &#xD;
        WHEN TrN_TypDokumentu = 312 THEN ''MM''&#xD;
        WHEN TrN_TypDokumentu = 303 THEN ''PW''&#xD;
        WHEN TrN_TypDokumentu = 317 THEN ''PWP''&#xD;
        WHEN TrN_TypDokumentu = 307 THEN ''PZ''&#xD;
        WHEN TrN_TypDokumentu = 304 THEN ''RW''&#xD;
        WHEN TrN_TypDokumentu = 318 THEN ''RWS''&#xD;
        WHEN TrN_TypDokumentu = 306 THEN ''WZ''&#xD;
        WHEN TrN_TypDokumentu = 313 THEN ''PKA''&#xD;
        WHEN TrN_TypDokumentu = 314 THEN ''WKA''&#xD;
    ELSE ''(NIEPRZYPISANY)'' END [Dokument Typ],&#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TrN_NumerPelny,0,CHARINDEX(''/'',TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TrN_NumerPelny,CHARINDEX(''/'',TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],   &#xD;
    pod1.Pod_Nazwa1 [Kontrahent Pierwotny Nazwa],   &#xD;
    pod1.Pod_Kod [Kontrahent Pierwotny Kod],    &#xD;
     ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Województwo],&#xD;
     ISNULL(NULLIF(pod1.Pod_Powiat, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Powiat],&#xD;
    ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Miasto], &#xD;
    ISNULL(NULLIF(pod1.Pod_Kraj, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Kraj], &#xD;
    ISNULL(NULLIF(pod1.Pod_NIP, ''''), ''(BRAK)'') [Kontrahent Pierwotny NIP], &#xD;
    ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Pierwotny Grupa], &#xD;
    CASE &#xD;
        WHEN knt1.Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN knt1.Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
    ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Pierwotny Opiekun],&#xD;
    reverse(stuff(reverse(CONVERT(varchar(100),RTRIM(&#xD;
    (CASE knt1.Knt_Rodzaj_Dostawca WHEN 1 THEN ''Dostawca, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Odbiorca WHEN 1 THEN ''Odbiorca, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Konkurencja WHEN 1 THEN ''Konkurencja, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Partner WHEN 1 THEN ''Partner, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Potencjalny WHEN 1 THEN ''Klient potencjalny,'' else '''' END)))), 1, 1, '''')) AS [Kontrahent Pierwotny Rodzaj],&#xD;
    pod5.Pod_Nazwa1 [Kontrahent Nazwa],     &#xD;
    pod5.Pod_Kod [Kontrahent Kod], &#xD;
    ISNULL(NULLIF(pod5.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
    ISNULL(NULLIF(pod5.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Kontrahent Powiat], ISNULL(NULLIF(pod5.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Kontrahent Miasto],&#xD;
    ISNULL(NULLIF(pod5.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Kontrahent Kraj],&#xD;
    ISNULL(NULLIF(pod5.Pod_NIP, ''''),''(BRAK)'') [Kontrahent NIP],&#xD;
    ISNULL(NULLIF(pod5.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa],&#xD;
    CASE knt3.Knt_OpiekunTyp&#xD;
        WHEN 3 THEN ISNULL(pod6.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN 8 THEN ISNULL(opk3.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
        ELSE ''(NIEPRZYPISANE)'' &#xD;
    END [Kontrahent Opiekun],&#xD;
    reverse(stuff(reverse(CONVERT(varchar(100),RTRIM(&#xD;
    (CASE knt3.Knt_Rodzaj_Dostawca WHEN 1 THEN ''Dostawca, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Odbiorca WHEN 1 THEN ''Odbiorca, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Konkurencja WHEN 1 THEN ''Konkurencja, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Partner WHEN 1 THEN ''Partner, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Potencjalny WHEN 1 THEN ''Klient potencjalny,'' else '''' END)))), 1, 1, '''')) AS [Kontrahent Rodzaj],&#xD;
    pod7.Pod_Nazwa1 [Odbiorca Nazwa],   &#xD;
    pod7.Pod_Kod [Odbiorca Kod], &#xD;
    ISNULL(NULLIF(pod7.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Odbiorca Województwo],&#xD;
    ISNULL(NULLIF(pod7.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Odbiorca Powiat], ISNULL(NULLIF(pod7.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(pod7.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Odbiorca Kraj],&#xD;
    ISNULL(NULLIF(pod7.Pod_NIP, ''''),''(BRAK)'') [Odbiorca NIP],&#xD;
    ISNULL(NULLIF(pod7.Pod_Grupa, ''''),''Pozostali'') [Odbiorca Grupa],    &#xD;
    zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
    ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
    ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu],  &#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca], &#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],     &#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    poz.sciezka [Produkt Pełna Nazwa Grupy], "Produkt Opis" = CAST(Twr_Opis as VARCHAR(1024)), Twr_Jm [Jednostka Miary], &#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG], &#xD;
     ISNULL(Mag.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
     ISNULL(MagDoc.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Docelowy Kod],&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
        CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna],&#xD;
    TR.TrE_WartoscNetto [Wartość Netto], TR.TrE_WartoscBrutto [Wartość Brutto], TR.TrE_WartoscNettoWal [Wartość Waluta], TR.TrE_Ilosc [Ilość], &#xD;
    TR.TrE_WartoscNetto - (ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi) [Marża], ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi [Koszt Zakupu],  &#xD;
    TR.TrE_WartoscNetto + KorNetto [Wartość Netto Po Korekcie], TR.TrE_WartoscBrutto + KorBrutto [Wartość Brutto  Po Korekcie], TR.TrE_WartoscNettoWal + KorNettoWal [Wartość Waluta  Po Korekcie], TR.TrE_Ilosc + KorIlosc [Ilość Po Korekcie], &#xD;
    TR.TrE_WartoscNetto + KorNetto  - (ISNULL(KosztWyliczony.Koszt ,0) + KorKoszt + TR.TrE_KosztUslugi) [Marża  Po Korekcie], ISNULL(KosztWyliczony.Koszt ,0)  + KorKoszt + TR.TrE_KosztUslugi [Koszt Zakupu Po Korekcie]&#xD;
    &#xD;
    &#xD;
    ,CASE WHEN (MONTH(TrN_DataOpe) = MONTH(GETDATE())) AND (YEAR(TrN_DataOpe) = YEAR(GETDATE())) THEN ''TAK'' ELSE ''NIE'' END [Czas Aktualny Miesiąc],&#xD;
    CASE &#xD;
        WHEN (MONTH(TrN_DataOpe) = MONTH(GETDATE())-1) AND (YEAR(TrN_DataOpe) = YEAR(GETDATE())) THEN ''TAK'' &#xD;
        WHEN ((MONTH(TrN_DataOpe) = 12) AND (MONTH(GETDATE()) = 1)) AND (YEAR(TrN_DataOpe) = YEAR(GETDATE()) - 1) THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Aktualny Miesiąc Poprzedni]&#xD;
&#xD;
/*&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji]&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia]&#xD;
*/&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataOpe)*/ [Data Operacji Tydzień Roku] &#xD;
    ,MONTH(TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TrN_DataOpe) [Data Operacji Kwartał], YEAR(TrN_DataOpe) [Data Operacji Rok] &#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia Dzień], (datepart(DY, datediff(d, 0, TrN_DataWys) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataWys)*/ [Data Wystawienia Tydzień Roku] &#xD;
    ,MONTH(TrN_DataWys) [Data Wystawienia Miesiąc], DATEPART(quarter, TrN_DataWys) [Data Wystawienia Kwartał], YEAR(TrN_DataWys) [Data Wystawienia Rok] &#xD;
&#xD;
    &#xD;
    ----------KONTEKSTY&#xD;
                                        ,CASE                               &#xD;
        WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
        WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
        WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
        WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
        WHEN TrN_TypDokumentu = 304 THEN 25030&#xD;
        WHEN TrN_TypDokumentu = 318 THEN 25046&#xD;
        WHEN TrN_TypDokumentu = 306 THEN 25022&#xD;
        WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
        WHEN TrN_TypDokumentu = 314 THEN 25078&#xD;
    END [Dokument Numer __PROCID__WZ__], TrN_TrNId [Dokument Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny  Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Kod __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Kontrahent Nazwa __PROCID__], pod5.Pod_PodId [Kontrahent Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod5.Pod_PodId [Kontrahent Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag.Mag_MagId [Magazyn Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Docelowy Kod __PROCID__Magazyny__],  MagDoc.Mag_MagId [Magazyn Docelowy Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Docelowy Kod __DATABASE__]&#xD;
    &#xD;
    '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
       &#xD;
set @select2 = &#xD;
' FROM cdn.TraNag &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID &#xD;
     LEFT JOIN #tmpSeria ser ON TrN_DDfId = DDf_DDfID&#xD;
     LEFT JOIN CDN.DokDefinicje dd ON TrN_DDfId = dd.DDf_DDfID&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt1 ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny Mag ON (CASE WHEN TrN_TypDokumentu = 318 THEN TrN_MagZrdId ELSE ISNULL(TrE_MagId,TrN_MagZrdId) END) = Mag.Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Magazyny MagDoc ON MagDoc.Mag_MagId = TrN_MagDocId&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId&#xD;
     LEFT JOIN #tmpPozatr PozAtr on PozAtr.TrA_TrEId = TrE_TrEId  &#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN ' + @Operatorzy + ' zal ON TrN_OpeZalID = zal.Ope_OpeId&#xD;
     LEFT JOIN ' + @Operatorzy + ' mod ON TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod5 on pod1.Pod_GlID = pod5.Pod_PodId and pod1.Pod_GlKod = pod5.Pod_Kod&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt3 ON pod5.Pod_PodID=knt3.Knt_KntId AND pod5.Pod_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat5 ON knt3.Knt_KatID=kat5.Kat_KatID&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod6 ON knt3.Knt_OpiekunId = pod6.Pod_PodId AND knt3.Knt_OpiekunTyp = pod6.Pod_PodmiotTyp&#xD;
     LEFT JOIN #tmpKonAtr KonAtr1 ON pod5.Pod_PodId = KonAtr1.KnA_PodmiotId AND pod5.Pod_PodmiotTyp = KonAtr1.KnA_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod7 ON TrN_OdbID = pod7.Pod_PodId AND TrN_OdbiorcaTyp = pod7.Pod_PodmiotTyp&#xD;
     LEFT JOIN ' + @Operatorzy + ' opk3 ON knt3.Knt_OpiekunId = opk3.Ope_OpeId AND knt3.Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId    &#xD;
    LEFT JOIN #Kor ON KorID = TR.TrE_TrEID AND KorLp = TR.TrE_Lp&#xD;
     LEFT OUTER JOIN ( &#xD;
            SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
            FROM CDN.TraElem TRE&#xD;
            JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
                   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 ) and NOT (TrR_TrNtyp = 306 and TrR_FaTyp=307) and not (TrR_TrNtyp = 307 and TrR_FaTyp=306)&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
    )KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
WHERE&#xD;
TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
AND TrN_Bufor&lt;&gt;-1&#xD;
AND TrE_Aktywny&lt;&gt;0&#xD;
'&#xD;
&#xD;
exec (@select + @select2)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpPozatr&#xD;
DROP TABLE #Kor&#xD;
DROP TABLE #fakor&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM0zwJratE7ZrmpGGBehZ96gzfYuMpQO2yJQQEhkyxmOvslOn8ASdlUU7ZjrS0O0poR0rKhp+HsTNrjFC0TVv8V8azlul9kkmvcyjRRbKiU3A9wHwCuPZuBttbeZDT//y3Y1QgmqrcrSQRnXYE08sdCZdWA0ajEFykCi3NbFmUFHoEkxGmPd59OaXHqxjZbzBma4UhXCqORKU</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Symbol" caption="Dokument Symbol" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Opis" caption="Dokument Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Waluta" caption="Waluta" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Seria" caption="Dokument Seria" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Nazwa" caption="Kontrahent Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kod" caption="Kontrahent Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Województwo" caption="Kontrahent Pierwotny Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Powiat" caption="Kontrahent Pierwotny Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Miasto" caption="Kontrahent Pierwotny Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kraj" caption="Kontrahent Pierwotny Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny NIP" caption="Kontrahent Pierwotny NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Grupa" caption="Kontrahent Pierwotny Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Opiekun" caption="Kontrahent Pierwotny Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Rodzaj" caption="Kontrahent Pierwotny Rodzaj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Powiat" caption="Kontrahent Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kraj" caption="Kontrahent Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent NIP" caption="Kontrahent NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Rodzaj" caption="Kontrahent Rodzaj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Nazwa" caption="Odbiorca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kod" caption="Odbiorca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Województwo" caption="Odbiorca Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Powiat" caption="Odbiorca Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Miasto" caption="Odbiorca Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kraj" caption="Odbiorca Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca NIP" caption="Odbiorca NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Grupa" caption="Odbiorca Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Wprowadzający" caption="Operator Wprowadzający" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Modyfikujący" caption="Operator Modyfikujący" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Docelowy Kod" caption="Magazyn Docelowy Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="### ##0.00" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Marża" caption="Marża" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Koszt Zakupu" caption="Koszt Zakupu" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto Po Korekcie" caption="Wartość Netto Po Korekcie" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto  Po Korekcie" caption="Wartość Brutto  Po Korekcie" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta  Po Korekcie" caption="Wartość Waluta  Po Korekcie" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Po Korekcie" caption="Ilość Po Korekcie" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Marża  Po Korekcie" caption="Marża  Po Korekcie" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Koszt Zakupu Po Korekcie" caption="Koszt Zakupu Po Korekcie" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAMAAAAAAAAA/////wcAAAAHAhNbRG9rdW1lbnQgVHlwXS5bTU1dBwITW0Rva3VtZW50IFR5cF0uW1BXXQcCFFtEb2t1bWVudCBUeXBdLltQV1BdBwITW0Rva3VtZW50IFR5cF0uW1BaXQcCE1tEb2t1bWVudCBUeXBdLltSV10HAhRbRG9rdW1lbnQgVHlwXS5bUldTXQcCE1tEb2t1bWVudCBUeXBdLltXWl0=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Dokument Symbol"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Dokument Typ"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Miesiąc"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Operacji Rok"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" horzAlignment="Far" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" horzAlignment="Near" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto Po Korekcie"&gt;&lt;cells fontName="Segoe UI" fontSize="8" horzAlignment="Far" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" horzAlignment="Near" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Wartość Netto" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Wartość Netto Po Korekcie" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Dokument Numer" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Dokument Typ" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Dokument Symbol" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&lt;excluded&gt;&lt;value uniqueName="PWKOR" /&gt;&lt;value uniqueName="PZKOR" /&gt;&lt;value uniqueName="RWKOR" /&gt;&lt;value uniqueName="WZKOR" /&gt;&lt;/excluded&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Miesiąc" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;filter fieldName="Data Operacji Rok" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje dane z dokumentów magazynowych z uwzględnieniem korekt. Prezentowane są miary przed i po korekcie.&#xD;
&#xD;
UWAGA:&#xD;
Dla poprawnego sumowania należy odznaczyć w filtrze dokumenty korekt.</a:description><a:id>267</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.27 Raport dokumentów magazynowych z korektami</a:mainLinkName><a:modifiedOn>2025-05-30T15:36:28.72</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>8</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2020-09-21T11:53:53.033</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Dokumentów Magazynowych w zakresie dat&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.KnA_WartoscTxt,'','',''.'') ELSE ATR.KnA_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.KntAtrybuty ATR &#xD;
        JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
        WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Pierwotny Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'     &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr1.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'      &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.DAt_WartoscTxt,'','',''.'') ELSE ATR.DAt_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.DokAtrybuty ATR &#xD;
        JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
        WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max), @atrybutyPoz2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TrA_DeAId FROM CDN.TraElemAtr WHERE TrA_TrEId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TrA_TrEId INTO #tmpPozAtr FROM CDN.TraElemAtr&#xD;
	JOIN CDN.TraElem ON TrA_TrEId = TrE_TrEID&#xD;
	JOIN CDN.TraNag ON TrE_TrNId = TrN_TrNID&#xD;
WHERE&#xD;
	TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
	AND TrN_Bufor&lt;&gt;-1&#xD;
	AND TrE_Aktywny&lt;&gt;0&#xD;
	AND TrN_DataOpe BETWEEN @DATAOD AND @DATADO&#xD;
SET @atrybutyPoz = ''&#xD;
SET @atrybutyPoz2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpPozAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpPozAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TrA_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TrA_Wartosc,'','',''.'') ELSE ATR.TrA_Wartosc END &#xD;
        END  &#xD;
        FROM CDN.TraElemAtr ATR &#xD;
        JOIN #tmpPozAtr TM ON ATR.TrA_TrEId = TM.TrA_TrEId&#xD;
        WHERE ATR.TrA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', ISNULL(PozAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyPoz2 = @atrybutyPoz2 + N', ''(NIEPRZYPISANE)'' [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
     WHEN DDf_Numeracja like '@rejestr%' THEN 5&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    TrN_NumerPelny [Dokument Numer],&#xD;
    dd.DDf_Symbol [Dokument Symbol],&#xD;
    ISNULL(NULLIF(TrN_Opis,''''),''(BRAK)'') [Dokument Opis],&#xD;
ISNULL(NULLIF(TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
    CASE                                &#xD;
        WHEN TrN_TypDokumentu = 312 THEN ''MM''&#xD;
        WHEN TrN_TypDokumentu = 303 THEN ''PW''&#xD;
        WHEN TrN_TypDokumentu = 317 THEN ''PWP''&#xD;
        WHEN TrN_TypDokumentu = 307 THEN ''PZ''&#xD;
        WHEN TrN_TypDokumentu = 304 THEN ''RW''&#xD;
        WHEN TrN_TypDokumentu = 318 THEN ''RWS''&#xD;
        WHEN TrN_TypDokumentu = 306 THEN ''WZ''&#xD;
        WHEN TrN_TypDokumentu = 313 THEN ''PKA''&#xD;
        WHEN TrN_TypDokumentu = 314 THEN ''WKA''&#xD;
    ELSE ''(NIEPRZYPISANY)'' END [Dokument Typ],&#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TrN_NumerPelny,0,CHARINDEX(''/'',TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TrN_NumerPelny,CHARINDEX(''/'',TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],   &#xD;
    pod1.Pod_Nazwa1 [Kontrahent Pierwotny Nazwa],   &#xD;
    pod1.Pod_Kod [Kontrahent Pierwotny Kod],    &#xD;
     ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Województwo],&#xD;
     ISNULL(NULLIF(pod1.Pod_Powiat, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Powiat],&#xD;
    ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Miasto], &#xD;
    ISNULL(NULLIF(pod1.Pod_Kraj, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Kraj], &#xD;
    ISNULL(NULLIF(pod1.Pod_NIP, ''''), ''(BRAK)'') [Kontrahent Pierwotny NIP], &#xD;
    ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Pierwotny Grupa], &#xD;
    CASE &#xD;
        WHEN knt1.Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN knt1.Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
    ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Pierwotny Opiekun],&#xD;
    reverse(stuff(reverse(CONVERT(varchar(100),RTRIM(&#xD;
    (CASE knt1.Knt_Rodzaj_Dostawca WHEN 1 THEN ''Dostawca, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Odbiorca WHEN 1 THEN ''Odbiorca, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Konkurencja WHEN 1 THEN ''Konkurencja, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Partner WHEN 1 THEN ''Partner, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Potencjalny WHEN 1 THEN ''Klient potencjalny,'' else '''' END)))), 1, 1, '''')) AS [Kontrahent Pierwotny Rodzaj],&#xD;
    pod5.Pod_Nazwa1 [Kontrahent Nazwa], &#xD;
    pod5.Pod_Kod [Kontrahent Kod], &#xD;
    ISNULL(NULLIF(pod5.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
    ISNULL(NULLIF(pod5.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Kontrahent Powiat], ISNULL(NULLIF(pod5.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Kontrahent Miasto],&#xD;
    ISNULL(NULLIF(pod5.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Kontrahent Kraj],&#xD;
    ISNULL(NULLIF(pod5.Pod_NIP, ''''),''(BRAK)'') [Kontrahent NIP],&#xD;
    ISNULL(NULLIF(pod5.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa],&#xD;
    CASE knt3.Knt_OpiekunTyp&#xD;
        WHEN 3 THEN ISNULL(pod6.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN 8 THEN ISNULL(opk3.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
        ELSE ''(NIEPRZYPISANE)'' &#xD;
    END [Kontrahent Opiekun],&#xD;
    reverse(stuff(reverse(CONVERT(varchar(100),RTRIM(&#xD;
    (CASE knt3.Knt_Rodzaj_Dostawca WHEN 1 THEN ''Dostawca, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Odbiorca WHEN 1 THEN ''Odbiorca, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Konkurencja WHEN 1 THEN ''Konkurencja, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Partner WHEN 1 THEN ''Partner, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Potencjalny WHEN 1 THEN ''Klient potencjalny,'' else '''' END)))), 1, 1, '''')) AS [Kontrahent Rodzaj],&#xD;
    pod7.Pod_Nazwa1 [Odbiorca Nazwa],   &#xD;
    pod7.Pod_Kod [Odbiorca Kod], &#xD;
    ISNULL(NULLIF(pod7.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Odbiorca Województwo],&#xD;
    ISNULL(NULLIF(pod7.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Odbiorca Powiat], ISNULL(NULLIF(pod7.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(pod7.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Odbiorca Kraj],&#xD;
    ISNULL(NULLIF(pod7.Pod_NIP, ''''),''(BRAK)'') [Odbiorca NIP],&#xD;
    ISNULL(NULLIF(pod7.Pod_Grupa, ''''),''Pozostali'') [Odbiorca Grupa],    &#xD;
    zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
    ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
    ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu],   &#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca], &#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],     &#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    poz.sciezka [Produkt Pełna Nazwa Grupy], "Produkt Opis" = CAST(Twr_Opis as VARCHAR(1024)), Twr_Jm [Jednostka Miary], &#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
     ISNULL(Mag.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
     ISNULL(MagDoc.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Docelowy Kod],&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
        CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna],&#xD;
   TR.TrE_WartoscNetto [Wartość Netto], TR.TrE_WartoscBrutto [Wartość Brutto], TR.TrE_WartoscNettoWal [Wartość Waluta], TR.TrE_Ilosc [Ilość], &#xD;
    TR.TrE_WartoscNetto - (ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi) [Marża], ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi [Koszt Zakupu] &#xD;
    /*&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji]&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia]&#xD;
    */&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataOpe)*/ [Data Operacji Tydzień Roku] &#xD;
    ,MONTH(TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TrN_DataOpe) [Data Operacji Kwartał], YEAR(TrN_DataOpe) [Data Operacji Rok] &#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia Dzień], (datepart(DY, datediff(d, 0, TrN_DataWys) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataWys)*/ [Data Wystawienia Tydzień Roku] &#xD;
    ,MONTH(TrN_DataWys) [Data Wystawienia Miesiąc], DATEPART(quarter, TrN_DataWys) [Data Wystawienia Kwartał], YEAR(TrN_DataWys) [Data Wystawienia Rok] &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
                                    ,CASE                               &#xD;
        WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
        WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
        WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
        WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
        WHEN TrN_TypDokumentu = 304 THEN 25030&#xD;
        WHEN TrN_TypDokumentu = 318 THEN 25046&#xD;
        WHEN TrN_TypDokumentu = 306 THEN 25022&#xD;
        WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
        WHEN TrN_TypDokumentu = 314 THEN 25078&#xD;
    END [Dokument Numer __PROCID__WZ__], TrN_TrNId [Dokument Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny  Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Kod __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Kontrahent Nazwa __PROCID__], pod5.Pod_PodId [Kontrahent Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod5.Pod_PodId [Kontrahent Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag.Mag_MagId [Magazyn Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Docelowy Kod __PROCID__Magazyny__],  MagDoc.Mag_MagId [Magazyn Docelowy Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Docelowy Kod __DATABASE__]&#xD;
    &#xD;
    '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
       &#xD;
set @select2 = &#xD;
' FROM cdn.TraNag &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID &#xD;
     LEFT JOIN #tmpSeria ser ON TrN_DDfId = DDf_DDfID&#xD;
     LEFT JOIN CDN.DokDefinicje dd ON TrN_DDfId = dd.DDf_DDfID&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt1 ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny Mag ON (CASE WHEN TrN_TypDokumentu = 318 THEN TrN_MagZrdId ELSE ISNULL(TrE_MagId,TrN_MagZrdId) END) = Mag.Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Magazyny MagDoc ON MagDoc.Mag_MagId = TrN_MagDocId&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId&#xD;
     LEFT JOIN #tmpPozatr PozAtr on PozAtr.TrA_TrEId = TrE_TrEId  &#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN ' + @Operatorzy + ' zal ON TrN_OpeZalID = zal.Ope_OpeId&#xD;
     LEFT JOIN ' + @Operatorzy + ' mod ON TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod5 on pod1.Pod_GlID = pod5.Pod_PodId and pod1.Pod_GlKod = pod5.Pod_Kod&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt3 ON pod5.Pod_PodID=knt3.Knt_KntId AND pod5.Pod_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat5 ON knt3.Knt_KatID=kat5.Kat_KatID&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod6 ON knt3.Knt_OpiekunId = pod6.Pod_PodId AND knt3.Knt_OpiekunTyp = pod6.Pod_PodmiotTyp&#xD;
     LEFT JOIN #tmpKonAtr KonAtr1 ON pod5.Pod_PodId = KonAtr1.KnA_PodmiotId AND pod5.Pod_PodmiotTyp = KonAtr1.KnA_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod7 ON TrN_OdbID = pod7.Pod_PodId AND TrN_OdbiorcaTyp = pod7.Pod_PodmiotTyp&#xD;
     LEFT JOIN ' + @Operatorzy + ' opk3 ON knt3.Knt_OpiekunId = opk3.Ope_OpeId AND knt3.Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
     LEFT OUTER JOIN ( &#xD;
            SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
            FROM CDN.TraElem TRE&#xD;
            JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
                   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 ) and NOT (TrR_TrNtyp = 306 and TrR_FaTyp=307) and not (TrR_TrNtyp = 307 and TrR_FaTyp=306)&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
    )KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
WHERE&#xD;
TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
AND TrN_Bufor&lt;&gt;-1&#xD;
AND TrE_Aktywny&lt;&gt;0&#xD;
AND TrN_DataOpe BETWEEN convert(datetime,''' + convert(varchar, @DATAOD, 120) + ''', 120)  AND convert(datetime,''' + convert(varchar, @DATADO, 120) + ''', 120)'&#xD;
&#xD;
exec (@select + @select2)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpPozatr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM0zwJratE7ZrmpGGBehZ96iG/ZwwXfP7ZFIn0qVz+tUJ94McTCLWrfkkhybIpA9E6eh7GvxyEO0vyiXd2c05BdgsDvTt+1BOi77xy696Ik8keic6sAB6IZYYhVA744HGhFqrlwKk4GJbk/bNYA/BADJ2BB1Wh75sVmewQzZgwS8SpDz5STLChzopdYV0ArDoUQ==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Symbol" caption="Dokument Symbol" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Opis" caption="Dokument Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Waluta" caption="Waluta" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Seria" caption="Dokument Seria" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Nazwa" caption="Kontrahent Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kod" caption="Kontrahent Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Województwo" caption="Kontrahent Pierwotny Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Powiat" caption="Kontrahent Pierwotny Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Miasto" caption="Kontrahent Pierwotny Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kraj" caption="Kontrahent Pierwotny Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny NIP" caption="Kontrahent Pierwotny NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Grupa" caption="Kontrahent Pierwotny Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Opiekun" caption="Kontrahent Pierwotny Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Rodzaj" caption="Kontrahent Pierwotny Rodzaj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Powiat" caption="Kontrahent Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kraj" caption="Kontrahent Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent NIP" caption="Kontrahent NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Rodzaj" caption="Kontrahent Rodzaj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Nazwa" caption="Odbiorca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kod" caption="Odbiorca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Województwo" caption="Odbiorca Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Powiat" caption="Odbiorca Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Miasto" caption="Odbiorca Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kraj" caption="Odbiorca Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca NIP" caption="Odbiorca NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Grupa" caption="Odbiorca Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Wprowadzający" caption="Operator Wprowadzający" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Modyfikujący" caption="Operator Modyfikujący" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Docelowy Kod" caption="Magazyn Docelowy Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="" aggregate="Average" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="### ##0.00" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Marża" caption="Marża" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Koszt Zakupu" caption="Koszt Zakupu" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut ATRYBUT POZYCJA" caption="Pozycja Atrybut ATRYBUT POZYCJA" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;Data od:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data początku analizy:&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GetDate()-30&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;Data do:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data końca analizy&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GetDate()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions /&gt;&lt;formatRules /&gt;&lt;dataFields /&gt;&lt;rowFields /&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport umożliwia standardową analizę dokumentów magazynowych dla określonego podczas uruchamiania zakresu dat dokumentów.</a:description><a:id>268</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.28 Dokumenty magazynowe w zakresie dat</a:mainLinkName><a:modifiedOn>2025-04-14T16:12:36.217</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>7</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2021-05-06T09:55:19.567</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Stanów Magazynowych na Dzień z uwględnieniem receptury&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(40), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(40)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select1 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Liczenie ostatniej daty w bazie&#xD;
SELECT TwI_TwrId [TwI_TId], ISNULL(TwI_MagId,0) [TwI_MId], MAX(TwI_Data) [TwI_OstatniaData] INTO #TwrIlosci&#xD;
FROM CDN.TwrIlosci&#xD;
WHERE TwI_Data &lt;= @DATA&#xD;
GROUP BY TwI_TwrId, TwI_MagId&#xD;
&#xD;
--Liczenie korekty braków&#xD;
SELECT TwI_TwrId [TwI_TId], SUM((CASE WHEN TwI_MagId IS NULL THEN 1 ELSE -1 END)*TwI_Braki) [Braki] INTO #TwrBraki&#xD;
FROM CDN.TwrIlosci&#xD;
JOIN #TwrIlosci TI ON TI.TwI_TId = TwI_TwrId AND TI.TwI_MId=ISNULL(TwI_MagId,0) AND TI.TwI_OstatniaData = TwI_Data&#xD;
GROUP BY TwI_TwrId&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
    AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
    AND TrE_DataOpe = @Data&#xD;
GROUP BY TrE_MagId, TrE_TwrId   &#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select =&#xD;
'SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
&#xD;
twr1.Twr_Kod [Produkt Kod],     &#xD;
twr1.Twr_Nazwa [Produkt Nazwa], &#xD;
CASE twr1.TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(twr1.TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
CASE twr1.Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],    &#xD;
twr1.Twr_JM [Produkt Jednostka Miary], &#xD;
ISNULL(NULLIF(twr1.Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
CAST(twr1.Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
Isnull(convert(varchar(15),twr1.twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
magTwr.Mag_Symbol [Produkt Magazyn Kod],&#xD;
CASE&#xD;
    WHEN twr1.Twr_Typ = 0 AND twr1.Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
    WHEN twr1.Twr_Typ = 1 AND twr1.Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
    WHEN twr1.Twr_Typ = 0 AND twr1.Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
    WHEN twr1.Twr_Typ = 1 AND twr1.Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
    ELSE ''(NIEOKREŚLONY)''&#xD;
END [Produkt Typ],  &#xD;
ISNULL(pdProdukt.Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], &#xD;
ISNULL(mrkProdukt.Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa],&#xD;
ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
ISNULL(twr2.Twr_Kod,twr1.Twr_Kod ) [Składnik Kod],&#xD;
ISNULL(twr2.Twr_Nazwa,twr1.Twr_Nazwa) [Składnik Nazwa],&#xD;
CASE ISNULL(twr2.TWR_SWW, twr1.TWR_SWW) WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE COALESCE(twr2.TWR_SWW,twr1.TWR_SWW,''(NIEPRZYPISANE)'') END [Składnik PKWiU],&#xD;
COALESCE(kntSkl.Knt_Kod,knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Składnik Dostawca],&#xD;
CASE ISNULL(twr2.Twr_NieAktywny, twr1.Twr_NieAktywny) WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Składnik Aktywny],&#xD;
PdS_Jm [Składnik Jednostka Miary],  &#xD;
COALESCE(NULLIF(twr2.Twr_JMZ,''),NULLIF(twr1.Twr_JMZ,''), ''(BRAK)'') [Składnik Jednostka Miary Pomocnicza], &#xD;
ISNULL(CAST(twr2.Twr_Opis as VARCHAR(1024)), CAST(twr1.Twr_Opis as VARCHAR(1024))) [Składnik Opis],&#xD;
ISNULL(convert(varchar(15), ISNULL(twr2.twr_wagakg, twr1.twr_wagakg)), ''(NIEPRZYPISANE)'') [Składnik Waga KG],&#xD;
COALESCE(pdSkladnik.Prd_Kod,pdProdukt.Prd_Kod, ''(NIEPRZYPISANE)'') [Składnik Producent], &#xD;
COALESCE(mrkSkladnik.Mrk_Nazwa,mrkProdukt.Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Składnik Marka],&#xD;
COALESCE(katSkladnik.Kat_KodSzczegol,kat.Kat_KodSzczegol, ''(PUSTA)'') [Składnik Kategoria Szczegółowa],&#xD;
COALESCE(katSkladnik.Kat_KodOgolny,kat.Kat_KodOgolny, ''(PUSTA)'') [Składnik Kategoria Ogólna], &#xD;
--MIARY&#xD;
ISNULL(PdS_Ilosc, 0)  [Receptura Składnik Ilość],&#xD;
COALESCE(twI1.TwI_Ilosc*PdS_Ilosc, twI1.TwI_Ilosc, 0) [Składnik Ilość], &#xD;
ISNULL(twI1.TwI_Ilosc, 0) [Produkt Ilość], &#xD;
COALESCE(twI1.TwI_Rezerwacje*PdS_Ilosc, twI1.TwI_Rezerwacje, 0) [Składnik Rezerwacje], &#xD;
COALESCE(twI1.TwI_Braki*PdS_Ilosc, twI1.TwI_Braki, 0) [Składnik Braki],&#xD;
COALESCE(twI1.TwI_Zamowienia*PdS_Ilosc,twI1.TwI_Zamowienia, 0) [Składnik Zamówienia]&#xD;
&#xD;
----------KONTEKSTY&#xD;
,25003 [Produkt Kod __PROCID__Towary__], twr1.Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
,25003 [Produkt Nazwa __PROCID__], twr1.Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
,29056 [Produkt Magazyn Kod __PROCID__Magazyny__], magTwr.Mag_MagId [Produkt Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Magazyn Kod __DATABASE__]&#xD;
,25003 [Składnik Kod __PROCID__Towary__], ISNULL(twr2.Twr_Kod,twr1.Twr_Kod ) [Składnik Kod __ORGID__],'''+@bazaFirmowa+''' [Składnik Kod __DATABASE__]&#xD;
,25003 [Składnik Nazwa __PROCID__], ISNULL(twr2.Twr_Nazwa,twr1.Twr_Nazwa) [Składnik Nazwa __ORGID__],'''+@bazaFirmowa+''' [Składnik Nazwa __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + '&#xD;
FROM CDN.TwrIlosci twI1&#xD;
    LEFT OUTER JOIN CDN.Magazyny magTwr ON Mag_MagId = TwI_MagId&#xD;
    JOIN CDN.Towary twr1 ON TwI_TwrId = Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci pdProdukt ON pdProdukt.Prd_PrdId = twr1.Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki mrkProdukt ON mrkProdukt.Mrk_MrkId = twr1.Twr_MrkId&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    JOIN #TwrIlosci prd ON prd.TwI_TId = twI1.TwI_TwrId AND prd.TwI_OstatniaData = twI1.TwI_Data AND prd.TwI_MId =  twI1.TwI_MagId&#xD;
    LEFT JOIN CDN.ProdReceptury ON PdR_TwrId = twr1.Twr_TwrId AND PdR_Domyslna = 1&#xD;
    LEFT OUTER JOIN CDN.ProdSkladniki ON twr1.Twr_TwrId = PdS_ProdId AND PdR_PdRId = PdS_PdRId&#xD;
    LEFT JOIN CDN.Towary twr2 ON PdS_TwrId=twr2.Twr_TwrId --AND twr2.Twr_Typ &lt;&gt; 0&#xD;
    LEFT JOIN CDN.Producenci pdSkladnik ON pdSkladnik.Prd_PrdId = twr2.Twr_PrdId&#xD;
    LEFT JOIN CDN.Marki mrkSkladnik ON mrkSkladnik.Mrk_MrkId = twr2.Twr_MrkId&#xD;
    LEFT OUTER JOIN CDN.Kategorie katSkladnik ON twr2.Twr_KatId=katSkladnik.Kat_KatID&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON twr1.Twr_KntId = knt4.Knt_KntId &#xD;
    LEFT JOIN CDN.Kontrahenci kntSkl ON twr2.Twr_KntId = kntSkl.Knt_KntId &#xD;
    LEFT JOIN #tmpTwrGr Poz ON  Poz.gidNumer = ISNULL(twr2.Twr_TwGGIDNumer, twr1.Twr_TwGGIDNumer)&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON  TwrAtr.TwA_TwrId = ISNULL(twr2.Twr_TwGGIDNumer, twr1.Twr_TwGGIDNumer)&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
&#xD;
    '&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' WHERE ISNULL(twI1.TwI_Ilosc, 0) &lt;&gt; 0&#xD;
AND &#xD;
ISNULL(twr2.Twr_Typ,1) &lt;&gt; 0 '&#xD;
&#xD;
SET @select1 = '&#xD;
&#xD;
UNION ALL&#xD;
&#xD;
    SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    twr1.Twr_Kod [Produkt Kod],     &#xD;
    twr1.Twr_Nazwa [Produkt Nazwa], &#xD;
    CASE twr1.TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(twr1.TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
    CASE twr1.Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],    &#xD;
    twr1.Twr_JM [Produkt Jednostka Miary], &#xD;
    ISNULL(NULLIF(twr1.Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
    CAST(twr1.Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    Isnull(convert(varchar(15),twr1.twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    ''(Korekta Braków)'' [Produkt Magazyn Kod],&#xD;
    CASE&#xD;
    WHEN twr1.Twr_Typ = 0 AND twr1.Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
    WHEN twr1.Twr_Typ = 1 AND twr1.Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
    WHEN twr1.Twr_Typ = 0 AND twr1.Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
    WHEN twr1.Twr_Typ = 1 AND twr1.Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
    ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ],  &#xD;
    ISNULL(pdProdukt.Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], &#xD;
    ISNULL(mrkProdukt.Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa],&#xD;
    ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    ISNULL(twr2.Twr_Kod,twr1.Twr_Kod ) [Składnik Kod],&#xD;
    ISNULL(twr2.Twr_Nazwa,twr1.Twr_Nazwa) [Składnik Nazwa],&#xD;
    CASE ISNULL(twr2.TWR_SWW, twr1.TWR_SWW) WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE COALESCE(twr2.TWR_SWW,twr1.TWR_SWW,''(NIEPRZYPISANE)'') END [Składnik PKWiU],&#xD;
    COALESCE(kntSkl.Knt_Kod,knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Składnik Dostawca],&#xD;
    CASE ISNULL(twr2.Twr_NieAktywny, twr1.Twr_NieAktywny) WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Składnik Aktywny],&#xD;
    PdS_Jm [Składnik Jednostka Miary],  &#xD;
    COALESCE(NULLIF(twr2.Twr_JMZ,''),NULLIF(twr1.Twr_JMZ,''), ''(BRAK)'') [Składnik Jednostka Miary Pomocnicza], &#xD;
    ISNULL(CAST(twr2.Twr_Opis as VARCHAR(1024)), CAST(twr1.Twr_Opis as VARCHAR(1024))) [Składnik Opis],&#xD;
    ISNULL(convert(varchar(15), ISNULL(twr2.twr_wagakg, twr1.twr_wagakg)), ''(NIEPRZYPISANE)'') [Składnik Waga KG],&#xD;
    COALESCE(pdSkladnik.Prd_Kod,pdProdukt.Prd_Kod, ''(NIEPRZYPISANE)'') [Składnik Producent], &#xD;
    COALESCE(mrkSkladnik.Mrk_Nazwa,mrkProdukt.Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Składnik Marka],&#xD;
    COALESCE(katSkladnik.Kat_KodSzczegol,kat.Kat_KodSzczegol, ''(PUSTA)'') [Składnik Kategoria Szczegółowa],&#xD;
    COALESCE(katSkladnik.Kat_KodOgolny,kat.Kat_KodOgolny, ''(PUSTA)'') [Składnik Kategoria Ogólna], &#xD;
    --MIARY&#xD;
    ISNULL(PdS_Ilosc, 0)  [Receptrura Składnik Ilość],&#xD;
    NULL [Składnik Ilość], &#xD;
    NULL [Produkt Ilość], &#xD;
    NULL [Składnik Rezerwacje], &#xD;
    COALESCE(brakiSkl.Braki*PdS_Ilosc, brakiPrd.Braki, 0) [Składnik Braki],&#xD;
    NULL [Składnik Zamówienia]&#xD;
&#xD;
    ----------KONTEKSTY&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], twr1.Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], twr1.Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Produkt Magazyn Kod __PROCID__Magazyny__], 1 [Produkt Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Magazyn Kod __DATABASE__]&#xD;
    ,25003 [Składnik Kod __PROCID__Towary__], ISNULL(twr2.Twr_Kod,twr1.Twr_Kod ) [Składnik Kod __ORGID__],'''+@bazaFirmowa+''' [Składnik Kod __DATABASE__]&#xD;
    ,25003 [Składnik Nazwa __PROCID__], ISNULL(twr2.Twr_Nazwa,twr1.Twr_Nazwa) [Składnik Nazwa __ORGID__],'''+@bazaFirmowa+'''[Składnik Nazwa __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + '&#xD;
FROM &#xD;
CDN.Towary twr1 &#xD;
     LEFT JOIN CDN.Producenci pdProdukt ON pdProdukt.Prd_PrdId = twr1.Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki mrkProdukt ON mrkProdukt.Mrk_MrkId = twr1.Twr_MrkId&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    JOIN #TwrBraki brakiPrd ON TwI_TId = Twr_TwrId AND Braki &lt;&gt; 0&#xD;
    LEFT JOIN CDN.ProdReceptury ON PdR_TwrId = twr1.Twr_TwrId AND PdR_Domyslna = 1&#xD;
    LEFT OUTER JOIN CDN.ProdSkladniki ON twr1.Twr_TwrId = PdS_ProdId AND PdR_PdRId = PdS_PdRId&#xD;
    LEFT OUTER JOIN CDN.Towary twr2 ON PdS_TwrId=twr2.Twr_TwrId&#xD;
    LEFT JOIN #TwrBraki brakiSkl ON brakiSkl.TwI_TId = twr2.Twr_TwrId AND brakiSkl.Braki &lt;&gt; 0&#xD;
    LEFT JOIN CDN.Producenci pdSkladnik ON pdSkladnik.Prd_PrdId = twr2.Twr_PrdId&#xD;
    LEFT JOIN CDN.Marki mrkSkladnik ON mrkSkladnik.Mrk_MrkId = twr2.Twr_MrkId&#xD;
    LEFT OUTER JOIN CDN.Kategorie katSkladnik ON twr2.Twr_KatId=katSkladnik.Kat_KatID&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON twr1.Twr_KntId = knt4.Knt_KntId &#xD;
    LEFT JOIN CDN.Kontrahenci kntSkl ON twr2.Twr_KntId = kntSkl.Knt_KntId   &#xD;
    LEFT JOIN #tmpTwrGr Poz ON  Poz.gidNumer = ISNULL(twr2.Twr_TwGGIDNumer, twr1.Twr_TwGGIDNumer)&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON  TwrAtr.TwA_TwrId = ISNULL(twr2.Twr_TwGGIDNumer, twr1.Twr_TwGGIDNumer)   &#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
&#xD;
    '&#xD;
&#xD;
--print(@select)    &#xD;
--print(@select1)&#xD;
EXEC(@select + @select1)&#xD;
&#xD;
DROP TABLE #TwrIlosci&#xD;
DROP TABLE #TwrBraki&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSprzedaz&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM0zwJratE7ZrmpGGBehZ96iG/ZwwXfP7ZFIn0qVz+tUJ9k+egPGZUvZMxnYQ1aL0SHjiU1MEivNK4qEz4DMGc/qZ+cxUmiEKqt10xZJ/Q1ob4Crvc9ppkMEy8ZAtxXcU5C7Ak7ZMlFLPBEgIdQ2B6v56zNvQ99NlnhRBmeUgAD4IBAHuoDtI9EZ7bm+bc4KNbtnP0hCbcCXI</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Magazyn Kod" caption="Produkt Magazyn Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Kod" caption="Składnik Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Składnik Nazwa" caption="Składnik Nazwa" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Składnik PKWiU" caption="Składnik PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Dostawca" caption="Składnik Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Aktywny" caption="Składnik Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Jednostka Miary" caption="Składnik Jednostka Miary" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Składnik Jednostka Miary Pomocnicza" caption="Składnik Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Opis" caption="Składnik Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Waga KG" caption="Składnik Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Producent" caption="Składnik Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Marka" caption="Składnik Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Kategoria Szczegółowa" caption="Składnik Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Kategoria Ogólna" caption="Składnik Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Receptura Składnik Ilość" caption="Receptura Składnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Składnik Ilość" caption="Składnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Ilość" caption="Produkt Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Składnik Rezerwacje" caption="Składnik Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Składnik Braki" caption="Składnik Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Składnik Zamówienia" caption="Składnik Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NUMER SERYJNY" caption="Produkt Atrybut NUMER SERYJNY" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATA&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stan magazynów na dzień:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data, dla które wykonana zostanie analiza.&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAUAAAAbAAAABwIgW1NrxYJhZG5payBLb2RdLltHUkFCSUVfTEnFmkNJRV0HAhxbU2vFgmFkbmlrIEtvZF0uW0dSQUJJRV9PR1JdBwIeW1NrxYJhZG5payBLb2RdLltST1pEUkFCTklBQ1pdBwIbW1NrxYJhZG5payBLb2RdLltSw5PFu0FfUE5dBwIaW1NrxYJhZG5payBLb2RdLltTQURaT05LSV0HAhlbU2vFgmFkbmlrIEtvZF0uW1NFS0FUT1JdBwIZW1NrxYJhZG5payBLb2RdLltTWlBBREVMXQcCH1tTa8WCYWRuaWsgS29kXS5bSUdMQUtJX0NZUFJZU10HAiJbU2vFgmFkbmlrIEtvZF0uW0lHTEFLSV9KQcWBT1dJRUNdBwIbW1NrxYJhZG5payBLb2RdLltKQULFgU9OSUVdBwIaW1NrxYJhZG5payBLb2RdLltLT1JBX1M4MF0HAiRbU2vFgmFkbmlrIEtvZF0uW8WBQcWDQ1VDSCBETyBQScWBWV0HAhhbU2vFgmFkbmlrIEtvZF0uW05BUE9KMV0HAhhbU2vFgmFkbmlrIEtvZF0uW05BUE9KMl0HAh1bU2vFgmFkbmlrIEtvZF0uW05PxbtZQ0VfRUwuXQcCHFtTa8WCYWRuaWsgS29kXS5bT0RLX0xJxZpDSV0HAhhbU2vFgmFkbmlrIEtvZF0uW1BBTEVUQV0HAh5bU2vFgmFkbmlrIEtvZF0uW1BJxYFBX0VMRUtUUl0HAiFbU2vFgmFkbmlrIEtvZF0uW1BJxYFBX1NQQUxJTk9XQV0HAhhbU2vFgmFkbmlrIEtvZF0uW1BST0RfQV0HAhhbU2vFgmFkbmlrIEtvZF0uW1BST0RfQl0HAhpbU2vFgmFkbmlrIEtvZF0uW1NLUlpZTktBXQcCGFtTa8WCYWRuaWsgS29kXS5bU1RPSkFLXQcCFltTa8WCYWRuaWsgS29kXS5bVEVTVF0HAhhbU2vFgmFkbmlrIEtvZF0uW1RFU1RKUF0HAhlbU2vFgmFkbmlrIEtvZF0uW1RVSkVfM0xdBwIaW1NrxYJhZG5payBLb2RdLltaSUVNSUFfNV0kAAAABwIgW1NrxYJhZG5payBLb2RdLltHUkFCSUVfTEnFmkNJRV0HAh9bUHJvZHVrdCBNYWdhenluIEtvZF0uW01BR0FaWU5dBwIgW1NrxYJhZG5payBLb2RdLltHUkFCSUVfTEnFmkNJRV0HAiJbUHJvZHVrdCBNYWdhenluIEtvZF0uW01hZ2F6eW4gS1JdBwIgW1NrxYJhZG5payBLb2RdLltHUkFCSUVfTEnFmkNJRV0HAh5bUHJvZHVrdCBNYWdhenluIEtvZF0uW1Nlcndpc10HAhxbU2vFgmFkbmlrIEtvZF0uW0dSQUJJRV9PR1JdBwIfW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNQUdBWllOXQcCHFtTa8WCYWRuaWsgS29kXS5bR1JBQklFX09HUl0HAiJbUHJvZHVrdCBNYWdhenluIEtvZF0uW01hZ2F6eW4gS1JdBwIeW1NrxYJhZG5payBLb2RdLltST1pEUkFCTklBQ1pdBwIfW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNQUdBWllOXQcCHltTa8WCYWRuaWsgS29kXS5bUk9aRFJBQk5JQUNaXQcCIltQcm9kdWt0IE1hZ2F6eW4gS29kXS5bTWFnYXp5biBLUl0HAhtbU2vFgmFkbmlrIEtvZF0uW1LDk8W7QV9QTl0HAh9bUHJvZHVrdCBNYWdhenluIEtvZF0uW01BR0FaWU5dBwIbW1NrxYJhZG5payBLb2RdLltSw5PFu0FfUE5dBwIiW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNYWdhenluIEtSXQcCGltTa8WCYWRuaWsgS29kXS5bU0FEWk9OS0ldBwIfW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNQUdBWllOXQcCGltTa8WCYWRuaWsgS29kXS5bU0FEWk9OS0ldBwIiW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNYWdhenluIEtSXQcCGVtTa8WCYWRuaWsgS29kXS5bU0VLQVRPUl0HAh9bUHJvZHVrdCBNYWdhenluIEtvZF0uW01BR0FaWU5dBwIZW1NrxYJhZG5payBLb2RdLltTWlBBREVMXQcCH1tQcm9kdWt0IE1hZ2F6eW4gS29kXS5bTUFHQVpZTl0HAh9bU2vFgmFkbmlrIEtvZF0uW0lHTEFLSV9DWVBSWVNdBwIfW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNQUdBWllOXQcCH1tTa8WCYWRuaWsgS29kXS5bSUdMQUtJX0NZUFJZU10HAiJbUHJvZHVrdCBNYWdhenluIEtvZF0uW01hZ2F6eW4gS1JdBwIiW1NrxYJhZG5payBLb2RdLltJR0xBS0lfSkHFgU9XSUVDXQcCH1tQcm9kdWt0IE1hZ2F6eW4gS29kXS5bTUFHQVpZTl0HAhtbU2vFgmFkbmlrIEtvZF0uW0pBQsWBT05JRV0HAh9bUHJvZHVrdCBNYWdhenluIEtvZF0uW01BR0FaWU5dBwIaW1NrxYJhZG5payBLb2RdLltLT1JBX1M4MF0HAh9bUHJvZHVrdCBNYWdhenluIEtvZF0uW01BR0FaWU5dBwIkW1NrxYJhZG5payBLb2RdLlvFgUHFg0NVQ0ggRE8gUEnFgVldBwIfW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNQUdBWllOXQcCGFtTa8WCYWRuaWsgS29kXS5bTkFQT0oxXQcCH1tQcm9kdWt0IE1hZ2F6eW4gS29kXS5bTUFHQVpZTl0HAhhbU2vFgmFkbmlrIEtvZF0uW05BUE9KMV0HAiJbUHJvZHVrdCBNYWdhenluIEtvZF0uW01hZ2F6eW4gS1JdBwIYW1NrxYJhZG5payBLb2RdLltOQVBPSjJdBwIfW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNQUdBWllOXQcCHVtTa8WCYWRuaWsgS29kXS5bTk/Fu1lDRV9FTC5dBwIfW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNQUdBWllOXQcCHFtTa8WCYWRuaWsgS29kXS5bT0RLX0xJxZpDSV0HAh9bUHJvZHVrdCBNYWdhenluIEtvZF0uW01BR0FaWU5dBwIYW1NrxYJhZG5payBLb2RdLltQQUxFVEFdBwIfW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNQUdBWllOXQcCHltTa8WCYWRuaWsgS29kXS5bUEnFgUFfRUxFS1RSXQcCH1tQcm9kdWt0IE1hZ2F6eW4gS29kXS5bTUFHQVpZTl0HAiFbU2vFgmFkbmlrIEtvZF0uW1BJxYFBX1NQQUxJTk9XQV0HAh9bUHJvZHVrdCBNYWdhenluIEtvZF0uW01BR0FaWU5dBwIYW1NrxYJhZG5payBLb2RdLltQUk9EX0FdBwIfW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNQUdBWllOXQcCGFtTa8WCYWRuaWsgS29kXS5bUFJPRF9CXQcCH1tQcm9kdWt0IE1hZ2F6eW4gS29kXS5bTUFHQVpZTl0HAhpbU2vFgmFkbmlrIEtvZF0uW1NLUlpZTktBXQcCH1tQcm9kdWt0IE1hZ2F6eW4gS29kXS5bTUFHQVpZTl0HAhhbU2vFgmFkbmlrIEtvZF0uW1NUT0pBS10HAh9bUHJvZHVrdCBNYWdhenluIEtvZF0uW01BR0FaWU5dBwIWW1NrxYJhZG5payBLb2RdLltURVNUXQcCH1tQcm9kdWt0IE1hZ2F6eW4gS29kXS5bTUFHQVpZTl0HAhhbU2vFgmFkbmlrIEtvZF0uW1RFU1RKUF0HAh9bUHJvZHVrdCBNYWdhenluIEtvZF0uW01BR0FaWU5dBwIZW1NrxYJhZG5payBLb2RdLltUVUpFXzNMXQcCH1tQcm9kdWt0IE1hZ2F6eW4gS29kXS5bTUFHQVpZTl0HAhlbU2vFgmFkbmlrIEtvZF0uW1RVSkVfM0xdBwIiW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNYWdhenluIEtSXQcCGltTa8WCYWRuaWsgS29kXS5bWklFTUlBXzVdBwIfW1Byb2R1a3QgTWFnYXp5biBLb2RdLltNQUdBWllOXf////8AAAAAAAAAAA==</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Baza Firmowa"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Magazyn Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Typ"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Składnik Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Receptura Składnik Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Składnik Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Produkt Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Składnik Rezerwacje"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Składnik Braki"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Składnik Zamówienia"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Receptura Składnik Ilość" index="5" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Składnik Ilość" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Produkt Ilość" index="4" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Składnik Rezerwacje" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Składnik Braki" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Składnik Zamówienia" index="3" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Produkt Kod" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Produkt Magazyn Kod" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Składnik Kod" index="0" expanded="True" sortMode="displayText" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers&gt;&lt;member&gt;[Składnik Kod].[GRABIE_LIŚCIE]&lt;/member&gt;&lt;member&gt;[Składnik Kod].[GRABIE_OGR]&lt;/member&gt;&lt;member&gt;[Składnik Kod].[PIELĘGNACJA]&lt;/member&gt;&lt;member&gt;[Składnik Kod].[ROZDRABNIACZ]&lt;/member&gt;&lt;member&gt;[Składnik Kod].[RÓŻA_PN]&lt;/member&gt;&lt;member&gt;[Składnik Kod].[SADZONKI]&lt;/member&gt;&lt;member&gt;[Składnik Kod].[SEKATOR]&lt;/member&gt;&lt;member&gt;[Składnik Kod].[SZPADEL]&lt;/member&gt;&lt;/orderedMembers&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Baza Firmowa" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;filter fieldName="Produkt Typ" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje ilościowe stany towarów na magazynach na zadany dzień z uwzględnieniem receptury na produktach złożonych. Datę analizy należy podać podczas uruchomienia raportu.&#xD;
Miara "Produkt Ilość" pokazuje ilość produktu prostego/złożonego na magazynie.&#xD;
Miara "Składnik Ilość" prezentuje ilość produktu jako typ "Prosty" oraz ilość wchodzącą w skład produktu złożonego (wyliczoną na podstawie ilości produktu złożonego i receptury).</a:description><a:id>269</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.29 Stan magazynów na dzień z uwzględnieniem receptury</a:mainLinkName><a:modifiedOn>2025-04-14T12:37:18.197</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-04-05T16:30:41.157</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>&#xD;
&#xD;
/*&#xD;
* Raport Dostawy produktów złożonych - różnice w recepturze&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select1 varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
    WHEN DDf_Numeracja like '@rejestr%' THEN 5 &#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select1 = '&#xD;
SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
       TrN_NumerPelny [Dokument Dostawy Numer],&#xD;
       twr1.Twr_Kod [Produkt Kod], &#xD;
       twr1.Twr_Nazwa [Produkt Nazwa],&#xD;
       CASE twr1.TWR_SWW&#xD;
           WHEN '' ''&#xD;
           THEN ''(NIEPRZYPISANE)''&#xD;
           ELSE ISNULL(twr1.TWR_SWW, ''(NIEPRZYPISANE)'')&#xD;
       END [Produkt PKWiU], &#xD;
       ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'') [Produkt Dostawca],&#xD;
       CASE twr1.Twr_NieAktywny&#xD;
           WHEN 0&#xD;
           THEN ''Tak''&#xD;
           ELSE ''Nie''&#xD;
       END [Produkt Aktywny], &#xD;
       twr1.Twr_JM [Produkt Jednostka Miary], &#xD;
       ISNULL(NULLIF(twr1.Twr_JMZ, ''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
       CAST(twr1.Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
       CASE&#xD;
           WHEN twr1.Twr_Typ = 0&#xD;
                AND twr1.Twr_Produkt = 0&#xD;
           THEN ''Usługa Prosta''&#xD;
           WHEN twr1.Twr_Typ = 1&#xD;
                AND twr1.Twr_Produkt = 0&#xD;
           THEN ''Towar Prosty''&#xD;
           WHEN twr1.Twr_Typ = 0&#xD;
                AND twr1.Twr_Produkt = 1&#xD;
           THEN ''Usługa Złożona''&#xD;
           WHEN twr1.Twr_Typ = 1&#xD;
                AND twr1.Twr_Produkt = 1&#xD;
           THEN ''Towar Złożony''&#xD;
           ELSE ''(NIEOKREŚLONY)''&#xD;
       END [Produkt Typ], &#xD;
       TwC_Wartosc [Cena Domyślna], &#xD;
       ISNULL(pdProdukt.Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], &#xD;
       ISNULL(mrkProdukt.Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka], &#xD;
       ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], &#xD;
       ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
       ISNULL(CONVERT(VARCHAR(15), twr1.twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG], &#xD;
       Mag_Symbol [Magazyn Kod],       &#xD;
       ISNULL(knt.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Kod],    &#xD;
       ISNULL(knt.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Nazwa],      &#xD;
       ISNULL(knt3.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Kod],       &#xD;
       ISNULL(knt3.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Nazwa],      &#xD;
       ISNULL(twr2.Twr_Kod, twr1.Twr_Kod) [Składnik Kod],      &#xD;
       ISNULL(twr2.Twr_Nazwa, twr1.Twr_Nazwa) [Składnik Nazwa],        &#xD;
       CASE ISNULL(twr2.TWR_SWW, twr1.TWR_SWW)&#xD;
           WHEN '' ''&#xD;
           THEN ''(NIEPRZYPISANE)''&#xD;
           ELSE COALESCE(twr2.TWR_SWW, twr1.TWR_SWW, ''(NIEPRZYPISANE)'')&#xD;
       END [Składnik PKWiU], &#xD;
       COALESCE(kntSkl.Knt_Kod, knt4.Knt_Kod, ''(NIEPRZYPISANE)'') [Składnik Dostawca],&#xD;
       CASE ISNULL(twr2.Twr_NieAktywny, twr1.Twr_NieAktywny)&#xD;
           WHEN 0&#xD;
           THEN ''Tak''&#xD;
           ELSE ''Nie''&#xD;
       END [Składnik Aktywny], &#xD;
       PdS_Jm [Składnik Jednostka Miary], &#xD;
       COALESCE(NULLIF(twr2.Twr_JMZ, ''''), NULLIF(twr1.Twr_JMZ, ''''), ''(BRAK)'') [Składnik Jednostka Miary Pomocnicza], &#xD;
       ISNULL(CAST(twr2.Twr_Opis as VARCHAR(1024)), CAST(twr1.Twr_Opis as VARCHAR(1024))) [Składnik Opis], &#xD;
       ISNULL(CONVERT(VARCHAR(15), ISNULL(twr2.twr_wagakg, twr1.twr_wagakg)), ''(NIEPRZYPISANE)'') [Składnik Waga KG], &#xD;
       COALESCE(pdSkladnik.Prd_Kod, pdProdukt.Prd_Kod, ''(NIEPRZYPISANE)'') [Składnik Producent], &#xD;
       COALESCE(mrkSkladnik.Mrk_Nazwa, mrkProdukt.Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Składnik Marka], &#xD;
       COALESCE(katSkladnik.Kat_KodSzczegol, kat.Kat_KodSzczegol, ''(PUSTA)'') [Składnik Kategoria Szczegółowa], &#xD;
       COALESCE(katSkladnik.Kat_KodOgolny, kat.Kat_KodOgolny, ''(PUSTA)'') [Składnik Kategoria Ogólna], &#xD;
       pdr_Kod [Receptura Kod], &#xD;
       pdr_Nazwa [Receptura Nazwa],&#xD;
       --MIARY&#xD;
       ISNULL(PdS_Ilosc, 0) [Receptura Składnik Ilość], &#xD;
       NULL [Dostawa Składnik Ilość]&#xD;
/*     &#xD;
       ----------DATY POINT&#xD;
       ,REPLACE(CONVERT(VARCHAR(10), TrN_DataDok, 111), ''/'', ''-'') [Data Wystawienia] &#xD;
  */    &#xD;
       ----------DATY ANALIZY&#xD;
       ,REPLACE(CONVERT(VARCHAR(10), TrN_DataDok, 111), ''/'', ''-'') [Data Wystawienia Dzień] &#xD;
       ,(DATEPART(DY, DATEDIFF(d, 0, TrN_DataDok) / 7 * 7 + 3) + 6) / 7 [Data Wystawienia Tydzień Roku] &#xD;
       ,MONTH(TrN_DataDok) [Data Wystawienia Miesiąc] &#xD;
       ,DATEPART(quarter, TrN_DataDok) [Data Wystawienia Kwartał]&#xD;
       ,YEAR(TrN_DataDok) [Data Wystawienia Rok] &#xD;
&#xD;
       ----------KONTEKSTY&#xD;
        ,CASE&#xD;
           WHEN TrN_TypDokumentu = 312&#xD;
           THEN 25034&#xD;
           WHEN TrN_TypDokumentu = 303&#xD;
           THEN 25032&#xD;
           WHEN TrN_TypDokumentu = 317&#xD;
           THEN 25045&#xD;
           WHEN TrN_TypDokumentu = 307&#xD;
           THEN 25024&#xD;
           WHEN TrN_TypDokumentu = 313&#xD;
           THEN 25079&#xD;
       END [Dokument Dostawy Numer __PROCID__PZ__], TrN_TrNId [Dokument Dostawy Numer __ORGID__], '''+@bazaFirmowa+''' [Dokument Dostawy Numer __DATABASE__]&#xD;
       ,25003 [Produkt Kod __PROCID__Towary__], twr1.Twr_twrId [Produkt Kod __ORGID__], '''+@bazaFirmowa+''' [Produkt Kod __DATABASE__] &#xD;
       ,25003 [Produkt Nazwa __PROCID__], twr1.Twr_twrId [Produkt Nazwa __ORGID__], '''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
       ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__] &#xD;
       ,20201 [Dostawca Pierwotny Kod __PROCID__Kontrahenci__], knt.Knt_KntId [Dostawca Pierwotny Kod __ORGID__], '''+@bazaFirmowa+''' [Dostawca Pierwotny kod __DATABASE__]&#xD;
       ,20201 [Dostawca Pierwotny Nazwa __PROCID__], knt.Knt_KntId [Dostawca Pierwotny Nazwa __ORGID__], '''+@bazaFirmowa+''' [Dostawca Pierwotny Nazwa __DATABASE__]&#xD;
       ,20201 [Dostawca Kod __PROCID__Kontrahenci__], knt3.Knt_KntId [Dostawca Kod __ORGID__], '''+@bazaFirmowa+''' [Dostawca Kod __DATABASE__] &#xD;
       ,20201 [Dostawca Nazwa __PROCID__], knt3.Knt_KntId [Dostawca Nazwa __ORGID__], '''+@bazaFirmowa+''' [Dostawca Nazwa __DATABASE__] &#xD;
       ,25003 [Składnik Kod __PROCID__Towary__], ISNULL(twr2.Twr_Kod, twr1.Twr_Kod) [Składnik Kod __ORGID__], '''+@bazaFirmowa+''' [Składnik Kod __DATABASE__]&#xD;
       ,25003 [Składnik Nazwa __PROCID__], ISNULL(twr2.Twr_Nazwa, twr1.Twr_Nazwa) [Składnik Nazwa __ORGID__], '''+@bazaFirmowa+''' [Składnik Nazwa __DATABASE__]&#xD;
&#xD;
FROM CDN.TraElem trEl&#xD;
     JOIN CDN.TraNag ON TrE_TrNId = TrN_TrNID&#xD;
     JOIN CDN.Towary twr1 ON TrE_TwrId = Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci pdProdukt ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki mrkProdukt ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID&#xD;
                              AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId = kat.Kat_KatID&#xD;
     JOIN CDN.Magazyny magProdukt ON TrE_MagId = Mag_MagId&#xD;
     LEFT JOIN CDN.Kontrahenci knt ON TrN_PodId = KnT_KnTId&#xD;
                                      AND TrN_PodmiotTyp = 1&#xD;
     LEFT JOIN CDN.Kontrahenci knt3 ON knt.Knt_GlID = knt3.Knt_KntId&#xD;
     LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
     JOIN CDN.ProdReceptury recp ON TrE_PdRId = PdR_PdRId&#xD;
     LEFT OUTER JOIN CDN.ProdSkladniki ON twr1.Twr_TwrId = PdS_ProdId&#xD;
                                          AND PdR_PdRId = PdS_PdRId&#xD;
     LEFT OUTER JOIN CDN.Towary twr2 ON PdS_TwrId = twr2.Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci pdSkladnik ON pdSkladnik.Prd_PrdId = twr2.Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki mrkSkladnik ON mrkSkladnik.Mrk_MrkId = twr2.Twr_MrkId&#xD;
     LEFT OUTER JOIN CDN.Kategorie katSkladnik ON twr2.Twr_KatId = katSkladnik.Kat_KatID&#xD;
     LEFT JOIN CDN.Kontrahenci kntSkl ON twr2.Twr_KntId = kntSkl.Knt_KntId&#xD;
     LEFT JOIN #tmpTwrGr Poz ON twr1.Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON twr1.TwR_TwrId  = TwrAtr.TwA_TwrId&#xD;
     LEFT JOIN #tmpSeria ON TrN_DDfId = DDf_DDfID&#xD;
     LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'')&#xD;
&#xD;
WHERE EXISTS&#xD;
(&#xD;
    SELECT TrE_TrNId&#xD;
    FROM [CDN].[TraElem] wew&#xD;
         JOIN [CDN].[ProdElem] prodEl ON prodEl.PdE_TrEId = TrE_TrEID&#xD;
         JOIN CDN.ProdReceptury recp ON TrE_PdRId = PdR_PdRId&#xD;
         LEFT JOIN CDN.ProdSkladniki skl ON Tre_TwrId = PdS_ProdId&#xD;
                                            AND PdS_TwrId = PdE_TwrId&#xD;
                                            AND PdR_PdRId = PdS_PdRId&#xD;
    WHERE(ISNULL(PdE_Ilosc / ISNULL(NULLIF(TrE_Ilosc,0),1), 0) &lt;&gt; ISNULL(PdS_Ilosc / ISNULL(NULLIF(PdR_Ilosc,0),1), 0)&#xD;
          OR PdE_Jm &lt;&gt; PdS_JM)&#xD;
         AND wew.TrE_TrNId = trEl.TrE_TrNId&#xD;
    UNION&#xD;
    SELECT TrE_TrNId&#xD;
    FROM [CDN].[TraElem] wew&#xD;
         JOIN CDN.ProdReceptury recp ON TrE_PdRId = PdR_PdRId&#xD;
         JOIN CDN.ProdSkladniki skl ON Tre_TwrId = PdS_ProdId&#xD;
                                       AND PdR_PdRId = PdS_PdRId&#xD;
         LEFT JOIN [CDN].[ProdElem] prodEl ON prodEl.PdE_TrEId = TrE_TrEID&#xD;
                                              AND PdS_TwrId = PdE_TwrId&#xD;
    WHERE(ISNULL(PdE_Ilosc / ISNULL(NULLIF(TrE_Ilosc,0),1), 0) &lt;&gt; ISNULL(PdS_Ilosc / ISNULL(NULLIF(PdR_Ilosc,0),1), 0)&#xD;
          OR PdE_Jm &lt;&gt; PdS_JM)&#xD;
         AND wew.TrE_TrNId = trEl.TrE_TrNId&#xD;
) AND&#xD;
TrN_DataDok &gt;=''' + CONVERT(VARCHAR,@Data, 112) + '''&#xD;
UNION ALL&#xD;
'&#xD;
SET @select2 = '&#xD;
SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
      TrN_NumerPelny [Dokument Dostawy Numer],&#xD;
       twr1.Twr_Kod [Produkt Kod], &#xD;
       twr1.Twr_Nazwa [Produkt Nazwa],&#xD;
       CASE twr1.TWR_SWW&#xD;
           WHEN '' ''&#xD;
           THEN ''(NIEPRZYPISANE)''&#xD;
           ELSE ISNULL(twr1.TWR_SWW, ''(NIEPRZYPISANE)'')&#xD;
       END [Produkt PKWiU], &#xD;
       ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'') [Produkt Dostawca],&#xD;
       CASE twr1.Twr_NieAktywny&#xD;
           WHEN 0&#xD;
           THEN ''Tak''&#xD;
           ELSE ''Nie''&#xD;
       END [Produkt Aktywny], &#xD;
       twr1.Twr_JM [Produkt Jednostka Miary], &#xD;
       ISNULL(NULLIF(twr1.Twr_JMZ, ''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], &#xD;
       CAST(twr1.Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
       CASE&#xD;
           WHEN twr1.Twr_Typ = 0&#xD;
                AND twr1.Twr_Produkt = 0&#xD;
           THEN ''Usługa Prosta''&#xD;
           WHEN twr1.Twr_Typ = 1&#xD;
                AND twr1.Twr_Produkt = 0&#xD;
           THEN ''Towar Prosty''&#xD;
           WHEN twr1.Twr_Typ = 0&#xD;
                AND twr1.Twr_Produkt = 1&#xD;
           THEN ''Usługa Złożona''&#xD;
           WHEN twr1.Twr_Typ = 1&#xD;
                AND twr1.Twr_Produkt = 1&#xD;
           THEN ''Towar Złożony''&#xD;
           ELSE ''(NIEOKREŚLONY)''&#xD;
       END [Produkt Typ], &#xD;
       TwC_Wartosc [Cena Domyślna], &#xD;
       ISNULL(pdProdukt.Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], &#xD;
       ISNULL(mrkProdukt.Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka], &#xD;
       ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], &#xD;
       ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
       ISNULL(CONVERT(VARCHAR(15), twr1.twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG], &#xD;
       Mag_Symbol [Magazyn Kod], &#xD;
       ISNULL(knt.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Kod],       &#xD;
       ISNULL(knt.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Nazwa],   &#xD;
       ISNULL(knt3.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Kod],        &#xD;
       ISNULL(knt3.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Nazwa],      &#xD;
       ISNULL(twr2.Twr_Kod, twr1.Twr_Kod) [Składnik Kod],     &#xD;
       ISNULL(twr2.Twr_Nazwa, twr1.Twr_Nazwa) [Składnik Nazwa],        &#xD;
       CASE ISNULL(twr2.TWR_SWW, twr1.TWR_SWW)&#xD;
           WHEN '' ''&#xD;
           THEN ''(NIEPRZYPISANE)''&#xD;
           ELSE COALESCE(twr2.TWR_SWW, twr1.TWR_SWW, ''(NIEPRZYPISANE)'')&#xD;
       END [Składnik PKWiU], &#xD;
       COALESCE(kntSkl.Knt_Kod, knt4.Knt_Kod, ''(NIEPRZYPISANE)'') [Składnik Dostawca],&#xD;
       CASE ISNULL(twr2.Twr_NieAktywny, twr1.Twr_NieAktywny)&#xD;
           WHEN 0&#xD;
           THEN ''Tak''&#xD;
           ELSE ''Nie''&#xD;
       END [Składnik Aktywny], &#xD;
       PdE_Jm [Składnik Jednostka Miary], &#xD;
       COALESCE(NULLIF(twr2.Twr_JMZ, ''''), NULLIF(twr1.Twr_JMZ, ''''), ''(BRAK)'') [Składnik Jednostka Miary Pomocnicza], &#xD;
       ISNULL(CAST(twr2.Twr_Opis as VARCHAR(1024)), CAST(twr1.Twr_Opis as VARCHAR(1024))) [Składnik Opis], &#xD;
       ISNULL(CONVERT(VARCHAR(15), ISNULL(twr2.twr_wagakg, twr1.twr_wagakg)), ''(NIEPRZYPISANE)'') [Składnik Waga KG], &#xD;
       COALESCE(pdSkladnik.Prd_Kod, pdProdukt.Prd_Kod, ''(NIEPRZYPISANE)'') [Składnik Producent], &#xD;
       COALESCE(mrkSkladnik.Mrk_Nazwa, mrkProdukt.Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Składnik Marka], &#xD;
       COALESCE(katSkladnik.Kat_KodSzczegol, kat.Kat_KodSzczegol, ''(PUSTA)'') [Składnik Kategoria Szczegółowa], &#xD;
       COALESCE(katSkladnik.Kat_KodOgolny, kat.Kat_KodOgolny, ''(PUSTA)'') [Składnik Kategoria Ogólna], &#xD;
       pdr_Kod [Receptura Kod], &#xD;
       pdr_Nazwa [Receptura Nazwa],&#xD;
       --MIARY&#xD;
       NULL [Receptrura Składnik Ilość], &#xD;
       ISNULL(PdE_Ilosc /ISNULL(NULLIF( TrE_Ilosc,0),1), 0) [Dostawa Składnik Ilość]&#xD;
    /*  &#xD;
      ----------DATY POINT&#xD;
       ,REPLACE(CONVERT(VARCHAR(10), TrN_DataDok, 111), ''/'', ''-'') [Data Wystawienia] &#xD;
      */&#xD;
       ----------DATY ANALIZY&#xD;
       ,REPLACE(CONVERT(VARCHAR(10), TrN_DataDok, 111), ''/'', ''-'') [Data Wystawienia Dzień] &#xD;
       ,(DATEPART(DY, DATEDIFF(d, 0, TrN_DataDok) / 7 * 7 + 3) + 6) / 7 [Data Wystawienia Tydzień Roku]&#xD;
       ,MONTH(TrN_DataDok) [Data Wystawienia Miesiąc] &#xD;
       ,DATEPART(quarter, TrN_DataDok) [Data Wystawienia Kwartał]&#xD;
       ,YEAR(TrN_DataDok) [Data Wystawienia Rok] &#xD;
&#xD;
       ----------KONTEKSTY&#xD;
        ,CASE&#xD;
           WHEN TrN_TypDokumentu = 312&#xD;
           THEN 25034&#xD;
           WHEN TrN_TypDokumentu = 303&#xD;
           THEN 25032&#xD;
           WHEN TrN_TypDokumentu = 317&#xD;
           THEN 25045&#xD;
           WHEN TrN_TypDokumentu = 307&#xD;
           THEN 25024&#xD;
           WHEN TrN_TypDokumentu = 313&#xD;
           THEN 25079&#xD;
       END [Dokument Dostawy Numer __PROCID__PZ__], TrN_TrNId [Dokument Dostawy Numer __ORGID__], '''+@bazaFirmowa+''' [Dokument Dostawy Numer __DATABASE__]&#xD;
       ,25003 [Produkt Kod __PROCID__Towary__], twr1.Twr_twrId [Produkt Kod __ORGID__], '''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
       ,25003 [Produkt Nazwa __PROCID__], twr1.Twr_twrId [Produkt Nazwa __ORGID__], '''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__] &#xD;
       ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
       ,20201 [Dostawca Pierwotny Kod __PROCID__Kontrahenci__], knt.Knt_KntId [Dostawca Pierwotny Kod __ORGID__], '''+@bazaFirmowa+''' [Dostawca Pierwotny kod __DATABASE__] &#xD;
       ,20201 [Dostawca Pierwotny Nazwa __PROCID__], knt.Knt_KntId [Dostawca Pierwotny Nazwa __ORGID__], '''+@bazaFirmowa+''' [Dostawca Pierwotny Nazwa __DATABASE__] &#xD;
       ,20201 [Dostawca Kod __PROCID__Kontrahenci__], knt3.Knt_KntId [Dostawca Kod __ORGID__], '''+@bazaFirmowa+''' [Dostawca Kod __DATABASE__]&#xD;
       ,20201 [Dostawca Nazwa __PROCID__], knt3.Knt_KntId [Dostawca Nazwa __ORGID__], '''+@bazaFirmowa+''' [Dostawca Nazwa __DATABASE__] &#xD;
       ,25003 [Składnik Kod __PROCID__Towary__], ISNULL(twr2.Twr_Kod, twr1.Twr_Kod) [Składnik Kod __ORGID__], '''+@bazaFirmowa+''' [Składnik Kod __DATABASE__] &#xD;
       ,25003 [Składnik Nazwa __PROCID__], ISNULL(twr2.Twr_Nazwa, twr1.Twr_Nazwa) [Składnik Nazwa __ORGID__], '''+@bazaFirmowa+''' [Składnik Nazwa __DATABASE__]&#xD;
&#xD;
FROM CDN.TraElem trEl&#xD;
     JOIN CDN.TraNag ON TrE_TrNId = TrN_TrNID&#xD;
     JOIN CDN.Towary twr1 ON TrE_TwrId = Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci pdProdukt ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki mrkProdukt ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID&#xD;
                              AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId = kat.Kat_KatID&#xD;
     JOIN CDN.Magazyny magProdukt ON TrE_MagId = Mag_MagId&#xD;
     LEFT JOIN CDN.Kontrahenci knt ON TrN_PodId = KnT_KnTId&#xD;
                                      AND TrN_PodmiotTyp = 1&#xD;
     LEFT JOIN CDN.Kontrahenci knt3 ON knt.Knt_GlID = knt3.Knt_KntId&#xD;
     LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
     LEFT JOIN [CDN].[ProdElem] prodEl ON prodEl.PdE_TrEId = TrE_TrEID&#xD;
     JOIN CDN.ProdReceptury recp ON TrE_PdRId = PdR_PdRId&#xD;
     LEFT OUTER JOIN CDN.Towary twr2 ON [PdE_TwrId] = twr2.Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci pdSkladnik ON pdSkladnik.Prd_PrdId = twr2.Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki mrkSkladnik ON mrkSkladnik.Mrk_MrkId = twr2.Twr_MrkId&#xD;
     LEFT OUTER JOIN CDN.Kategorie katSkladnik ON twr2.Twr_KatId = katSkladnik.Kat_KatID&#xD;
     LEFT JOIN CDN.Kontrahenci kntSkl ON twr2.Twr_KntId = kntSkl.Knt_KntId&#xD;
     LEFT JOIN #tmpTwrGr Poz ON twr1.Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON twr1.TwR_TwrId  = TwrAtr.TwA_TwrId&#xD;
     LEFT JOIN #tmpSeria ON TrN_DDfId = DDf_DDfID&#xD;
     LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'')&#xD;
&#xD;
WHERE EXISTS&#xD;
(&#xD;
    SELECT TrE_TrNId&#xD;
    FROM [CDN].[TraElem] wew&#xD;
         JOIN [CDN].[ProdElem] prodEl ON prodEl.PdE_TrEId = TrE_TrEID&#xD;
         JOIN CDN.ProdReceptury recp ON TrE_PdRId = PdR_PdRId&#xD;
         LEFT JOIN CDN.ProdSkladniki skl ON Tre_TwrId = PdS_ProdId&#xD;
                                            AND PdS_TwrId = PdE_TwrId&#xD;
                                            AND PdR_PdRId = PdS_PdRId&#xD;
    WHERE(ISNULL(PdE_Ilosc / ISNULL(NULLIF(TrE_Ilosc,0),1), 0) &lt;&gt; ISNULL(PdS_Ilosc / ISNULL(NULLIF(PdR_Ilosc,0),1), 0)&#xD;
          OR PdE_Jm &lt;&gt; PdS_JM)&#xD;
         AND wew.TrE_TrNId = trEl.TrE_TrNId&#xD;
    UNION&#xD;
    SELECT TrE_TrNId&#xD;
    FROM [CDN].[TraElem] wew&#xD;
         JOIN CDN.ProdReceptury recp ON TrE_PdRId = PdR_PdRId&#xD;
         JOIN CDN.ProdSkladniki skl ON Tre_TwrId = PdS_ProdId&#xD;
                                       AND PdR_PdRId = PdS_PdRId&#xD;
         LEFT JOIN [CDN].[ProdElem] prodEl ON prodEl.PdE_TrEId = TrE_TrEID&#xD;
                                              AND PdS_TwrId = PdE_TwrId&#xD;
    WHERE(ISNULL(PdE_Ilosc / ISNULL(NULLIF(TrE_Ilosc,0),1), 0) &lt;&gt; ISNULL(PdS_Ilosc / ISNULL(NULLIF(PdR_Ilosc,0),1), 0)&#xD;
          OR PdE_Jm &lt;&gt; PdS_JM)&#xD;
         AND wew.TrE_TrNId = trEl.TrE_TrNId&#xD;
) AND&#xD;
TrN_DataDok &gt;=''' + CONVERT(VARCHAR,@Data, 112) + '''&#xD;
'&#xD;
print @select1 &#xD;
print @select2&#xD;
exec (@select1 + @select2)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM0zwJratE7ZrmpGGBehZ96iG/ZwwXfP7ZFIn0qVz+tUJYUqeCr8Pxdj8+upk/NTIN3v9MLjfPmIU+nQ5u+PJf8FQf4EHonltB/N8DJWtwPpYBgTi8H+3FEvyN+L4/XRST6Gi7CffiFzdiVYZnKf7YOwe4CzwSKWfhcV3WUBWxKGjSsug9Z8luBjB9NZgGJzbng==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Dostawy Numer" caption="Dokument Dostawy Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="n2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Pierwotny Kod" caption="Dostawca Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Pierwotny Nazwa" caption="Dostawca Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Kod" caption="Dostawca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Nazwa" caption="Dostawca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Kod" caption="Składnik Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Nazwa" caption="Składnik Nazwa" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Składnik PKWiU" caption="Składnik PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Dostawca" caption="Składnik Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Aktywny" caption="Składnik Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Jednostka Miary" caption="Składnik Jednostka Miary" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Składnik Jednostka Miary Pomocnicza" caption="Składnik Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Opis" caption="Składnik Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Waga KG" caption="Składnik Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Producent" caption="Składnik Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Marka" caption="Składnik Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Kategoria Szczegółowa" caption="Składnik Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Składnik Kategoria Ogólna" caption="Składnik Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Receptura Kod" caption="Receptura Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Receptura Nazwa" caption="Receptura Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Receptura Składnik Ilość" caption="Receptura Składnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Dostawa Składnik Ilość" caption="Dostawa Składnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATA&lt;/Name&gt;&#xD;
    &lt;Label&gt;Data analizy od:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data dokumentu. &lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT DATEADD(month, DATEDIFF(month, 0, GETDATE()), 0) 
&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument Dostawy Numer"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="161" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="104" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Typ"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Składnik Nazwa"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Składnik Jednostka Miary"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Receptura Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Receptura Składnik Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Dostawa Składnik Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Receptura Składnik Ilość" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Dostawa Składnik Ilość" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Dokument Dostawy Numer" index="2" expanded="True" sortMode="default" order="ascending" width="161" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Produkt Kod" index="0" expanded="True" sortMode="default" order="ascending" width="104" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Składnik Nazwa" index="3" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Składnik Jednostka Miary" index="4" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Receptura Kod" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Produkt Typ" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje różnicę między recepturą a faktycznym zużyciem składników receptury dla PWP.</a:description><a:id>270</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.30 Dostawy produktów złożonych - różnice w recepturze</a:mainLinkName><a:modifiedOn>2025-04-14T12:30:46.95</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>8</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2021-05-14T15:58:38.557</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Dokumentów Magazynowych z jednostkami pomocniczymi &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.KnA_WartoscTxt,'','',''.'') ELSE ATR.KnA_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.KntAtrybuty ATR &#xD;
        JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
        WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Pierwotny Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'     &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr1.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'      &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.DAt_WartoscTxt,'','',''.'') ELSE ATR.DAt_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.DokAtrybuty ATR &#xD;
        JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
        WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max), @atrybutyPoz2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TrA_DeAId FROM CDN.TraElemAtr WHERE TrA_TrEId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TrA_TrEId INTO #tmpPozAtr FROM CDN.TraElemAtr&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
SET @atrybutyPoz2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpPozAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpPozAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TrA_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TrA_Wartosc,'','',''.'') ELSE ATR.TrA_Wartosc END &#xD;
        END  &#xD;
        FROM CDN.TraElemAtr ATR &#xD;
        JOIN #tmpPozAtr TM ON ATR.TrA_TrEId = TM.TrA_TrEId&#xD;
        WHERE ATR.TrA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', ISNULL(PozAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyPoz2 = @atrybutyPoz2 + N', ''(NIEPRZYPISANE)'' [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
     WHEN DDf_Numeracja like '@rejestr%' THEN 5&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    TrN_NumerPelny [Dokument Numer],&#xD;
    dd.DDf_Symbol [Dokument Symbol],&#xD;
    ISNULL(NULLIF(TrN_Opis,''''),''(BRAK)'') [Dokument Opis],&#xD;
ISNULL(NULLIF(TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
    CASE                                &#xD;
        WHEN TrN_TypDokumentu = 312 THEN ''MM''&#xD;
        WHEN TrN_TypDokumentu = 303 THEN ''PW''&#xD;
        WHEN TrN_TypDokumentu = 317 THEN ''PWP''&#xD;
        WHEN TrN_TypDokumentu = 307 THEN ''PZ''&#xD;
        WHEN TrN_TypDokumentu = 304 THEN ''RW''&#xD;
        WHEN TrN_TypDokumentu = 318 THEN ''RWS''&#xD;
        WHEN TrN_TypDokumentu = 306 THEN ''WZ''&#xD;
        WHEN TrN_TypDokumentu = 313 THEN ''PKA''&#xD;
        WHEN TrN_TypDokumentu = 314 THEN ''WKA''&#xD;
    ELSE ''(NIEPRZYPISANY)'' END [Dokument Typ],&#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TrN_NumerPelny,0,CHARINDEX(''/'',TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TrN_NumerPelny,CHARINDEX(''/'',TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],   &#xD;
    pod1.Pod_Nazwa1 [Kontrahent Pierwotny Nazwa],   &#xD;
    pod1.Pod_Kod [Kontrahent Pierwotny Kod],    &#xD;
     ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Województwo],&#xD;
     ISNULL(NULLIF(pod1.Pod_Powiat, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Powiat],&#xD;
    ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Miasto], &#xD;
    ISNULL(NULLIF(pod1.Pod_Kraj, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Kraj], &#xD;
    ISNULL(NULLIF(pod1.Pod_NIP, ''''), ''(BRAK)'') [Kontrahent Pierwotny NIP], &#xD;
    ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Pierwotny Grupa], &#xD;
    CASE &#xD;
        WHEN knt1.Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN knt1.Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
    ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Pierwotny Opiekun],&#xD;
    reverse(stuff(reverse(CONVERT(varchar(100),RTRIM(&#xD;
    (CASE knt1.Knt_Rodzaj_Dostawca WHEN 1 THEN ''Dostawca, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Odbiorca WHEN 1 THEN ''Odbiorca, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Konkurencja WHEN 1 THEN ''Konkurencja, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Partner WHEN 1 THEN ''Partner, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Potencjalny WHEN 1 THEN ''Klient potencjalny,'' else '''' END)))), 1, 1, '''')) AS [Kontrahent Pierwotny Rodzaj],&#xD;
    pod5.Pod_Nazwa1 [Kontrahent Nazwa],     &#xD;
    pod5.Pod_Kod [Kontrahent Kod], &#xD;
    ISNULL(NULLIF(pod5.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
    ISNULL(NULLIF(pod5.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Kontrahent Powiat], ISNULL(NULLIF(pod5.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Kontrahent Miasto],&#xD;
    ISNULL(NULLIF(pod5.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Kontrahent Kraj],&#xD;
    ISNULL(NULLIF(pod5.Pod_NIP, ''''),''(BRAK)'') [Kontrahent NIP],&#xD;
    ISNULL(NULLIF(pod5.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa],&#xD;
    CASE knt3.Knt_OpiekunTyp&#xD;
        WHEN 3 THEN ISNULL(pod6.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN 8 THEN ISNULL(opk3.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
        ELSE ''(NIEPRZYPISANE)'' &#xD;
    END [Kontrahent Opiekun],&#xD;
    reverse(stuff(reverse(CONVERT(varchar(100),RTRIM(&#xD;
    (CASE knt3.Knt_Rodzaj_Dostawca WHEN 1 THEN ''Dostawca, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Odbiorca WHEN 1 THEN ''Odbiorca, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Konkurencja WHEN 1 THEN ''Konkurencja, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Partner WHEN 1 THEN ''Partner, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Potencjalny WHEN 1 THEN ''Klient potencjalny,'' else '''' END)))), 1, 1, '''')) AS [Kontrahent Rodzaj],&#xD;
    pod7.Pod_Nazwa1 [Odbiorca Nazwa],   &#xD;
    pod7.Pod_Kod [Odbiorca Kod], &#xD;
    ISNULL(NULLIF(pod7.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Odbiorca Województwo],&#xD;
    ISNULL(NULLIF(pod7.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Odbiorca Powiat], ISNULL(NULLIF(pod7.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(pod7.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Odbiorca Kraj],&#xD;
    ISNULL(NULLIF(pod7.Pod_NIP, ''''),''(BRAK)'') [Odbiorca NIP],&#xD;
    ISNULL(NULLIF(pod7.Pod_Grupa, ''''),''Pozostali'') [Odbiorca Grupa],    &#xD;
    zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
    ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
    ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu],    &#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca], &#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],     &#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    poz.sciezka [Produkt Pełna Nazwa Grupy], "Produkt Opis" = CAST(Twr_Opis as VARCHAR(1024)), Twr_Jm [Jednostka Miary], &#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG], &#xD;
     ISNULL(Mag.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
     ISNULL(MagDoc.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Docelowy Kod],&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
        CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna],&#xD;
    TR.TrE_WartoscNetto [Wartość Netto], TR.TrE_WartoscBrutto [Wartość Brutto], TR.TrE_WartoscNettoWal [Wartość Waluta], TR.TrE_Ilosc [Ilość], &#xD;
    TR.TrE_WartoscNetto - (ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi) [Marża], ISNULL(KosztWyliczony.Koszt ,0) + TR.TrE_KosztUslugi [Koszt Zakupu]&#xD;
    ,ISNULL(NULLIF(jpom1.TwJZ_JM,''''), ''(BRAK)'') [Jednostka Miary Pomocnicza 1]&#xD;
    ,ISNULL(NULLIF(jpom2.TwJZ_JM,''''), ''(BRAK)'') [Jednostka Miary Pomocnicza 2]&#xD;
    ,ISNULL(NULLIF(jpom3.TwJZ_JM,''''), ''(BRAK)'') [Jednostka Miary Pomocnicza 3]&#xD;
    ,ISNULL(NULLIF(jpom4.TwJZ_JM,''''), ''(BRAK)'') [Jednostka Miary Pomocnicza 4]&#xD;
    ,ISNULL(NULLIF(jpom5.TwJZ_JM,''''), ''(BRAK)'') [Jednostka Miary Pomocnicza 5]&#xD;
    ,CAST(TrE_Ilosc/(jpom1.TwJZ_JMPrzelicznikL/jpom1.TwJZ_JMPrzelicznikM) AS Decimal(26,10)) [Ilość Jednostka Pomocnicza 1]&#xD;
    ,CAST(TrE_Ilosc/(jpom2.TwJZ_JMPrzelicznikL/jpom2.TwJZ_JMPrzelicznikM) AS Decimal(26,10)) [Ilość Jednostka Pomocnicza 2]&#xD;
    ,CAST(TrE_Ilosc/(jpom3.TwJZ_JMPrzelicznikL/jpom3.TwJZ_JMPrzelicznikM) AS Decimal(26,10)) [Ilość Jednostka Pomocnicza 3]&#xD;
    ,CAST(TrE_Ilosc/(jpom4.TwJZ_JMPrzelicznikL/jpom4.TwJZ_JMPrzelicznikM) AS Decimal(26,10)) [Ilość Jednostka Pomocnicza 4]&#xD;
    ,CAST(TrE_Ilosc/(jpom5.TwJZ_JMPrzelicznikL/jpom5.TwJZ_JMPrzelicznikM) AS Decimal(26,10)) [Ilość Jednostka Pomocnicza 5],&#xD;
    CASE WHEN (MONTH(TrN_DataOpe) = MONTH(GETDATE())) AND (YEAR(TrN_DataOpe) = YEAR(GETDATE())) THEN ''TAK'' ELSE ''NIE'' END [Czas Aktualny Miesiąc],&#xD;
    CASE &#xD;
        WHEN (MONTH(TrN_DataOpe) = MONTH(GETDATE())-1) AND (YEAR(TrN_DataOpe) = YEAR(GETDATE())) THEN ''TAK'' &#xD;
        WHEN ((MONTH(TrN_DataOpe) = 12) AND (MONTH(GETDATE()) = 1)) AND (YEAR(TrN_DataOpe) = YEAR(GETDATE()) - 1) THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Aktualny Miesiąc Poprzedni]&#xD;
/*&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji]&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia]&#xD;
*/  &#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataOpe)*/ [Data Operacji Tydzień Roku] &#xD;
    ,MONTH(TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TrN_DataOpe) [Data Operacji Kwartał], YEAR(TrN_DataOpe) [Data Operacji Rok] &#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia Dzień], (datepart(DY, datediff(d, 0, TrN_DataWys) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataWys)*/ [Data Wystawienia Tydzień Roku] &#xD;
    ,MONTH(TrN_DataWys) [Data Wystawienia Miesiąc], DATEPART(quarter, TrN_DataWys) [Data Wystawienia Kwartał], YEAR(TrN_DataWys) [Data Wystawienia Rok] &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
                                    ,CASE                               &#xD;
        WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
        WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
        WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
        WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
        WHEN TrN_TypDokumentu = 304 THEN 25030&#xD;
        WHEN TrN_TypDokumentu = 318 THEN 25046&#xD;
        WHEN TrN_TypDokumentu = 306 THEN 25022&#xD;
        WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
        WHEN TrN_TypDokumentu = 314 THEN 25078&#xD;
    END [Dokument Numer __PROCID__WZ__], TrN_TrNId [Dokument Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny  Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Kod __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Kontrahent Nazwa __PROCID__], pod5.Pod_PodId [Kontrahent Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod5.Pod_PodId [Kontrahent Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag.Mag_MagId [Magazyn Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Docelowy Kod __PROCID__Magazyny__],  MagDoc.Mag_MagId [Magazyn Docelowy Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Docelowy Kod __DATABASE__]&#xD;
    &#xD;
    '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
       &#xD;
set @select2 = &#xD;
' FROM cdn.TraNag &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID &#xD;
     LEFT JOIN #tmpSeria ser ON TrN_DDfId = DDf_DDfID&#xD;
     LEFT JOIN CDN.DokDefinicje dd ON TrN_DDfId = dd.DDf_DDfID&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt1 ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny Mag ON (CASE WHEN TrN_TypDokumentu = 318 THEN TrN_MagZrdId ELSE ISNULL(TrE_MagId,TrN_MagZrdId) END) = Mag.Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Magazyny MagDoc ON MagDoc.Mag_MagId = TrN_MagDocId&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId&#xD;
     LEFT JOIN #tmpPozatr PozAtr on PozAtr.TrA_TrEId = TrE_TrEId  &#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN ' + @Operatorzy + ' zal ON TrN_OpeZalID = zal.Ope_OpeId&#xD;
     LEFT JOIN ' + @Operatorzy + ' mod ON TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod5 on pod1.Pod_GlID = pod5.Pod_PodId and pod1.Pod_GlKod = pod5.Pod_Kod&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt3 ON pod5.Pod_PodID=knt3.Knt_KntId AND pod5.Pod_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat5 ON knt3.Knt_KatID=kat5.Kat_KatID&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod6 ON knt3.Knt_OpiekunId = pod6.Pod_PodId AND knt3.Knt_OpiekunTyp = pod6.Pod_PodmiotTyp&#xD;
     LEFT JOIN #tmpKonAtr KonAtr1 ON pod5.Pod_PodId = KonAtr1.KnA_PodmiotId AND pod5.Pod_PodmiotTyp = KonAtr1.KnA_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod7 ON TrN_OdbID = pod7.Pod_PodId AND TrN_OdbiorcaTyp = pod7.Pod_PodmiotTyp&#xD;
     LEFT JOIN ' + @Operatorzy + ' opk3 ON knt3.Knt_OpiekunId = opk3.Ope_OpeId AND knt3.Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
     LEFT OUTER JOIN ( &#xD;
            SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
            FROM CDN.TraElem TRE&#xD;
            JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
                   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 ) and NOT (TrR_TrNtyp = 306 and TrR_FaTyp=307) and not (TrR_TrNtyp = 307 and TrR_FaTyp=306)&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
    )KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
    LEFT JOIN CDN.TwrJmz jpom1 on jpom1.TwJZ_TwrID = Twr_TwrId and jpom1.TwJZ_Lp = 1&#xD;
    LEFT JOIN CDN.TwrJmz jpom2 on jpom2.TwJZ_TwrID = Twr_TwrId and jpom2.TwJZ_Lp = 2&#xD;
    LEFT JOIN CDN.TwrJmz jpom3 on jpom3.TwJZ_TwrID = Twr_TwrId and jpom3.TwJZ_Lp = 3&#xD;
    LEFT JOIN CDN.TwrJmz jpom4 on jpom4.TwJZ_TwrID = Twr_TwrId and jpom4.TwJZ_Lp = 4&#xD;
    LEFT JOIN CDN.TwrJmz jpom5 on jpom5.TwJZ_TwrID = Twr_TwrId and jpom5.TwJZ_Lp = 5&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
WHERE&#xD;
TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
AND TrN_Bufor&lt;&gt;-1&#xD;
AND TrE_Aktywny&lt;&gt;0'&#xD;
&#xD;
exec (@select + @select2)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpPozatr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM0zwJratE7ZrmpGGBehZ96iG/ZwwXfP7ZFIn0qVz+tUJ2VxeUhSDqTTF4USh85u8JiAWjvPvz/D2C1k8K1mt362pM+zzdasIJcAacHNZKwhrKjlk0LNP+h+hc/p8CwJ87daeZaAQDpM2EwOHmR26YL6NeJ4LRj1hfYeIC6CzboMh1N78AwPsZ9KT6xVk9fy1KkVP3IxyA9Xt</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Symbol" caption="Dokument Symbol" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Opis" caption="Dokument Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Waluta" caption="Waluta" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Seria" caption="Dokument Seria" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Nazwa" caption="Kontrahent Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kod" caption="Kontrahent Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Województwo" caption="Kontrahent Pierwotny Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Powiat" caption="Kontrahent Pierwotny Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Miasto" caption="Kontrahent Pierwotny Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kraj" caption="Kontrahent Pierwotny Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny NIP" caption="Kontrahent Pierwotny NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Grupa" caption="Kontrahent Pierwotny Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Opiekun" caption="Kontrahent Pierwotny Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Rodzaj" caption="Kontrahent Pierwotny Rodzaj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Powiat" caption="Kontrahent Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kraj" caption="Kontrahent Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent NIP" caption="Kontrahent NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Rodzaj" caption="Kontrahent Rodzaj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Nazwa" caption="Odbiorca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kod" caption="Odbiorca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Województwo" caption="Odbiorca Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Powiat" caption="Odbiorca Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Miasto" caption="Odbiorca Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kraj" caption="Odbiorca Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca NIP" caption="Odbiorca NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Grupa" caption="Odbiorca Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Wprowadzający" caption="Operator Wprowadzający" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Modyfikujący" caption="Operator Modyfikujący" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Docelowy Kod" caption="Magazyn Docelowy Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Marża" caption="Marża" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Koszt Zakupu" caption="Koszt Zakupu" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Jednostka Miary Pomocnicza 1" caption="Jednostka Miary Pomocnicza 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary Pomocnicza 2" caption="Jednostka Miary Pomocnicza 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary Pomocnicza 3" caption="Jednostka Miary Pomocnicza 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary Pomocnicza 4" caption="Jednostka Miary Pomocnicza 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary Pomocnicza 5" caption="Jednostka Miary Pomocnicza 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza 1" caption="Ilość Jednostka Pomocnicza 1" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza 2" caption="Ilość Jednostka Pomocnicza 2" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza 3" caption="Ilość Jednostka Pomocnicza 3" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza 4" caption="Ilość Jednostka Pomocnicza 4" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza 5" caption="Ilość Jednostka Pomocnicza 5" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="### ##0.00" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut KLUCZOWY" caption="Kontrahent Pierwotny Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut KLUCZOWY" caption="Kontrahent Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut KLUCZOWY (K)" caption="Dokument Atrybut KLUCZOWY (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut BUDŻET FA/FZ" caption="Dokument Atrybut BUDŻET FA/FZ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut BUDŻET PZ/PA" caption="Dokument Atrybut BUDŻET PZ/PA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut DATAWAŻNOSCI" caption="Dokument Atrybut DATAWAŻNOSCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut DATAWAZLICZBADNI" caption="Dokument Atrybut DATAWAZLICZBADNI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NUMER SERYJNY" caption="Produkt Atrybut NUMER SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut KOLOR" caption="Pozycja Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut NUMER SERYJNY" caption="Pozycja Atrybut NUMER SERYJNY" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions /&gt;&lt;formatRules /&gt;&lt;dataFields /&gt;&lt;rowFields /&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport zawiera informacje o sprzedaży i zakupach w firmie na podstawie dokumentów magazynowych. Wartości prezentowane są w walucie systemowej. Ilości prezentowane ją w jednostce podstawowej oraz w pięciu jednostkach pomocniczych.&#xD;
&#xD;
Analizy oparte są o dokumenty PW, RW, PZ, WZ, MM, PKA, WKA, PWP, RWS. Niebrane pod uwagę są dokumenty anulowane. Do poprawnej analizy należy wybrać typ dokumentu, dla którego ma zostać wyświetlony raport.&#xD;
&#xD;
Raport oparty na tabelach:&#xD;
TraNag - Tabela z nagłówkami dokumentów (WZ, PZ itp.). &#xD;
TraElem - Tabela z elementami dokumentów (WZ, PZ itp.).</a:description><a:id>271</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.31 Dokumenty magazynowe z jednostkami pomocniczymi</a:mainLinkName><a:modifiedOn>2025-04-14T12:30:33.973</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-19T15:39:56.783</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Przychodów i rozchodów w podziale na magazyny&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @select3 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.KnA_WartoscTxt,'','',''.'') ELSE ATR.KnA_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.KntAtrybuty ATR &#xD;
        JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
        WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Pierwotny Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'     &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr1.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'      &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.DAt_WartoscTxt,'','',''.'') ELSE ATR.DAt_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.DokAtrybuty ATR &#xD;
        JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
        WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max), @atrybutyPoz2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TrA_DeAId FROM CDN.TraElemAtr WHERE TrA_TrEId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TrA_TrEId INTO #tmpPozAtr FROM CDN.TraElemAtr&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
SET @atrybutyPoz2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpPozAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpPozAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TrA_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TrA_Wartosc,'','',''.'') ELSE ATR.TrA_Wartosc END &#xD;
        END  &#xD;
        FROM CDN.TraElemAtr ATR &#xD;
        JOIN #tmpPozAtr TM ON ATR.TrA_TrEId = TM.TrA_TrEId&#xD;
        WHERE ATR.TrA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', ISNULL(PozAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyPoz2 = @atrybutyPoz2 + N', ''(NIEPRZYPISANE)'' [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
     WHEN DDf_Numeracja like '@rejestr%' THEN 5&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'Declare @Wal VarChar(3); Set @Wal = cdn.Waluta('''')&#xD;
SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
&#xD;
    TrN_NumerPelny [Dokument Numer],&#xD;
    dd.DDf_Symbol [Dokument Symbol],&#xD;
    ISNULL(NULLIF(TrN_Opis,''''),''(BRAK)'') [Dokument Opis],&#xD;
ISNULL(NULLIF(TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
    CASE                                &#xD;
        WHEN TrN_TypDokumentu = 312 THEN ''MM''&#xD;
        WHEN TrN_TypDokumentu = 303 THEN ''PW''&#xD;
        WHEN TrN_TypDokumentu = 317 THEN ''PWP''&#xD;
        WHEN TrN_TypDokumentu = 307 THEN ''PZ''&#xD;
        WHEN TrN_TypDokumentu = 304 THEN ''RW''&#xD;
        WHEN TrN_TypDokumentu = 318 THEN ''RWS''&#xD;
        WHEN TrN_TypDokumentu = 306 THEN ''WZ''&#xD;
        WHEN TrN_TypDokumentu = 313 THEN ''PKA''&#xD;
        WHEN TrN_TypDokumentu = 314 THEN ''WKA''&#xD;
    ELSE ''(NIEPRZYPISANY)'' END [Dokument Typ],&#xD;
&#xD;
        CASE                                &#xD;
        WHEN TrN_TypDokumentu = 312 THEN ''Rozchód''&#xD;
        WHEN TrN_TypDokumentu = 303 THEN ''Przychód''&#xD;
        WHEN TrN_TypDokumentu = 317 THEN ''Przychód''&#xD;
        WHEN TrN_TypDokumentu = 307 THEN ''Przychód''&#xD;
        WHEN TrN_TypDokumentu = 304 THEN ''Rozchód''&#xD;
        WHEN TrN_TypDokumentu = 318 THEN ''Rozchód''&#xD;
        WHEN TrN_TypDokumentu = 306 THEN ''Rozchód''&#xD;
        WHEN TrN_TypDokumentu = 313 THEN ''Przychód''&#xD;
        WHEN TrN_TypDokumentu = 314 THEN ''Rozchód''  &#xD;
    ELSE ''(NIEPRZYPISANY)'' END [Dokument Rodzaj],&#xD;
&#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TrN_NumerPelny,0,CHARINDEX(''/'',TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TrN_NumerPelny,CHARINDEX(''/'',TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],&#xD;
    pod1.Pod_Nazwa1 [Kontrahent Pierwotny Nazwa],&#xD;
    pod1.Pod_Kod [Kontrahent Pierwotny Kod],    &#xD;
     ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Województwo],&#xD;
     ISNULL(NULLIF(pod1.Pod_Powiat, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Powiat],&#xD;
    ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Miasto], &#xD;
    ISNULL(NULLIF(pod1.Pod_Kraj, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Kraj], &#xD;
    ISNULL(NULLIF(pod1.Pod_NIP, ''''), ''(BRAK)'') [Kontrahent Pierwotny NIP], &#xD;
    ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Pierwotny Grupa], &#xD;
    CASE &#xD;
        WHEN knt1.Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN knt1.Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
    ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Pierwotny Opiekun],&#xD;
    reverse(stuff(reverse(CONVERT(varchar(100),RTRIM(&#xD;
    (CASE knt1.Knt_Rodzaj_Dostawca WHEN 1 THEN ''Dostawca, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Odbiorca WHEN 1 THEN ''Odbiorca, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Konkurencja WHEN 1 THEN ''Konkurencja, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Partner WHEN 1 THEN ''Partner, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Potencjalny WHEN 1 THEN ''Klient potencjalny,'' else '''' END)))), 1, 1, '''')) AS [Kontrahent Pierwotny Rodzaj],&#xD;
    pod5.Pod_Nazwa1 [Kontrahent Nazwa],     &#xD;
    pod5.Pod_Kod [Kontrahent Kod], &#xD;
    ISNULL(NULLIF(pod5.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
    ISNULL(NULLIF(pod5.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Kontrahent Powiat], ISNULL(NULLIF(pod5.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Kontrahent Miasto],&#xD;
    ISNULL(NULLIF(pod5.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Kontrahent Kraj],&#xD;
    ISNULL(NULLIF(pod5.Pod_NIP, ''''),''(BRAK)'') [Kontrahent NIP],&#xD;
    ISNULL(NULLIF(pod5.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa],&#xD;
    CASE knt3.Knt_OpiekunTyp&#xD;
        WHEN 3 THEN ISNULL(pod6.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN 8 THEN ISNULL(opk3.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
        ELSE ''(NIEPRZYPISANE)'' &#xD;
    END [Kontrahent Opiekun],&#xD;
    reverse(stuff(reverse(CONVERT(varchar(100),RTRIM(&#xD;
    (CASE knt3.Knt_Rodzaj_Dostawca WHEN 1 THEN ''Dostawca, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Odbiorca WHEN 1 THEN ''Odbiorca, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Konkurencja WHEN 1 THEN ''Konkurencja, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Partner WHEN 1 THEN ''Partner, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Potencjalny WHEN 1 THEN ''Klient potencjalny,'' else '''' END)))), 1, 1, '''')) AS [Kontrahent Rodzaj],&#xD;
    pod7.Pod_Nazwa1 [Odbiorca Nazwa],   &#xD;
    pod7.Pod_Kod [Odbiorca Kod], &#xD;
    ISNULL(NULLIF(pod7.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Odbiorca Województwo],&#xD;
    ISNULL(NULLIF(pod7.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Odbiorca Powiat], ISNULL(NULLIF(pod7.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(pod7.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Odbiorca Kraj],&#xD;
    ISNULL(NULLIF(pod7.Pod_NIP, ''''),''(BRAK)'') [Odbiorca NIP],&#xD;
    ISNULL(NULLIF(pod7.Pod_Grupa, ''''),''Pozostali'') [Odbiorca Grupa],&#xD;
    zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
    ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
    ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu], &#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca], &#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny], &#xD;
    Twr_Kod [Produkt Kod], &#xD;
    poz.sciezka [Produkt Pełna Nazwa Grupy], "Produkt Opis" = CAST(Twr_Opis as VARCHAR(1024)), Twr_Jm [Jednostka Miary], &#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
     ISNULL(Mag.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
     ISNULL(MagDoc.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Docelowy Kod],&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
        CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ],&#xD;
   (CASE WHEN TrN_TypDokumentu IN (312,304,318,306,314) THEN -1 ELSE 1 END)* TR.TrE_WartoscNetto [Wartość Netto], &#xD;
    (CASE WHEN TrN_TypDokumentu IN (312,304,318,306,314) THEN -1 ELSE 1 END)* TR.TrE_WartoscBrutto [Wartość Brutto], &#xD;
    (CASE WHEN TrN_TypDokumentu IN (312,304,318,306,314) THEN -1 ELSE 1 END)* TR.TrE_WartoscNettoWal [Wartość Waluta], &#xD;
    (CASE WHEN TrN_TypDokumentu IN (312,304,318,306,314) THEN -1 ELSE 1 END)* TR.TrE_Ilosc [Ilość]&#xD;
    ,ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Jednostka Miary Pomocnicza]&#xD;
    ,(CASE WHEN TrN_TypDokumentu IN (312,304,318,306,314) THEN -1 ELSE 1 END)* CAST(TR.TrE_Ilosc/(Twr_JMPrzelicznikL*Twr_JMPrzelicznikM) AS Decimal(26,10)) [Ilość Jednostka Pomocnicza]&#xD;
    /*&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji]&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia]&#xD;
    */&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataOpe)*/ [Data Operacji Tydzień Roku]&#xD;
    ,MONTH(TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TrN_DataOpe) [Data Operacji Kwartał], YEAR(TrN_DataOpe) [Data Operacji Rok]&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia Dzień], (datepart(DY, datediff(d, 0, TrN_DataWys) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataWys)*/ [Data Wystawienia Tydzień Roku] &#xD;
    ,MONTH(TrN_DataWys) [Data Wystawienia Miesiąc], DATEPART(quarter, TrN_DataWys) [Data Wystawienia Kwartał], YEAR(TrN_DataWys) [Data Wystawienia Rok]&#xD;
&#xD;
    ----------KONTEKSTY                 &#xD;
    ,CASE                               &#xD;
        WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
        WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
        WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
        WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
        WHEN TrN_TypDokumentu = 304 THEN 25030&#xD;
        WHEN TrN_TypDokumentu = 318 THEN 25046&#xD;
        WHEN TrN_TypDokumentu = 306 THEN 25022&#xD;
        WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
        WHEN TrN_TypDokumentu = 314 THEN 25078 END [Dokument Numer __PROCID__WZ__], TrN_TrNId [Dokument Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny  Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Kod __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Kontrahent Nazwa __PROCID__], pod5.Pod_PodId [Kontrahent Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod5.Pod_PodId [Kontrahent Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag.Mag_MagId [Magazyn Kod __ORGID__],  '''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Docelowy Kod __PROCID__Magazyny__], MagDoc.Mag_MagId [Magazyn Docelowy Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Docelowy Kod __DATABASE__]  &#xD;
&#xD;
    '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
       &#xD;
set @select2 = &#xD;
' FROM cdn.TraNag &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID &#xD;
     LEFT JOIN #tmpSeria ser ON TrN_DDfId = DDf_DDfID&#xD;
     LEFT JOIN CDN.DokDefinicje dd ON TrN_DDfId = dd.DDf_DDfID&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt1 ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny Mag ON (CASE WHEN TrN_TypDokumentu = 318 THEN TrN_MagZrdId ELSE ISNULL(TrE_MagId,TrN_MagZrdId) END) = Mag.Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Magazyny MagDoc ON MagDoc.Mag_MagId = TrN_MagDocId&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId&#xD;
     LEFT JOIN #tmpPozatr PozAtr on PozAtr.TrA_TrEId = TrE_TrEId  &#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN ' + @Operatorzy + ' zal ON TrN_OpeZalID = zal.Ope_OpeId&#xD;
     LEFT JOIN ' + @Operatorzy + ' mod ON TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod5 on pod1.Pod_GlID = pod5.Pod_PodId and pod1.Pod_GlKod = pod5.Pod_Kod&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt3 ON pod5.Pod_PodID=knt3.Knt_KntId AND pod5.Pod_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat5 ON knt3.Knt_KatID=kat5.Kat_KatID&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod6 ON knt3.Knt_OpiekunId = pod6.Pod_PodId AND knt3.Knt_OpiekunTyp = pod6.Pod_PodmiotTyp&#xD;
     LEFT JOIN #tmpKonAtr KonAtr1 ON pod5.Pod_PodId = KonAtr1.KnA_PodmiotId AND pod5.Pod_PodmiotTyp = KonAtr1.KnA_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod7 ON TrN_OdbID = pod7.Pod_PodId AND TrN_OdbiorcaTyp = pod7.Pod_PodmiotTyp&#xD;
     LEFT JOIN ' + @Operatorzy + ' opk3 ON knt3.Knt_OpiekunId = opk3.Ope_OpeId AND knt3.Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
     LEFT OUTER JOIN ( &#xD;
            SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
            FROM CDN.TraElem TRE&#xD;
            JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
                   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 ) and NOT (TrR_TrNtyp = 306 and TrR_FaTyp=307) and not (TrR_TrNtyp = 307 and TrR_FaTyp=306)&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
    )KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
WHERE&#xD;
TrN_TypDokumentu IN ( 303, 304, 306, 307, 312, 313, 314, 317, 318)&#xD;
AND TrN_Bufor&lt;&gt;-1&#xD;
AND TrE_Aktywny&lt;&gt;0&#xD;
&#xD;
UNION ALL &#xD;
-----Dodatkowy union dla duplikacji dokumentów MM i przedstawienia ich zarówno w przychodach, jak i rozchodach&#xD;
&#xD;
SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    TrN_NumerPelny [Dokument Numer],&#xD;
    dd.DDf_Symbol [Dokument Symbol],&#xD;
    ISNULL(NULLIF(TrN_Opis,''''),''(BRAK)'') [Dokument Opis],&#xD;
ISNULL(NULLIF(TrN_Waluta, ''''), @Wal) [Waluta], &#xD;
''MM'' [Dokument Typ],                  &#xD;
''Przychód'' [Dokument Rodzaj],&#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TrN_NumerPelny,0,CHARINDEX(''/'',TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TrN_NumerPelny,CHARINDEX(''/'',TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],&#xD;
    pod1.Pod_Nazwa1 [Kontrahent Pierwotny Nazwa],&#xD;
    pod1.Pod_Kod [Kontrahent Pierwotny Kod],    &#xD;
     ISNULL(NULLIF(pod1.Pod_Wojewodztwo, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Województwo],&#xD;
     ISNULL(NULLIF(pod1.Pod_Powiat, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Powiat],&#xD;
    ISNULL(NULLIF(pod1.Pod_Miasto, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Miasto], &#xD;
    ISNULL(NULLIF(pod1.Pod_Kraj, ''''), ''(NIEPRZYPISANE)'') [Kontrahent Pierwotny Kraj], &#xD;
    ISNULL(NULLIF(pod1.Pod_NIP, ''''), ''(BRAK)'') [Kontrahent Pierwotny NIP], &#xD;
    ISNULL(NULLIF(pod1.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Pierwotny Grupa], &#xD;
    CASE &#xD;
        WHEN knt1.Knt_OpiekunTyp = 3 THEN ISNULL(pod2.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN knt1.Knt_OpiekunTyp = 8 THEN ISNULL(opk.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
    ELSE ''(NIEPRZYPISANE)'' END [Kontrahent Pierwotny Opiekun],&#xD;
    reverse(stuff(reverse(CONVERT(varchar(100),RTRIM(&#xD;
    (CASE knt1.Knt_Rodzaj_Dostawca WHEN 1 THEN ''Dostawca, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Odbiorca WHEN 1 THEN ''Odbiorca, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Konkurencja WHEN 1 THEN ''Konkurencja, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Partner WHEN 1 THEN ''Partner, '' else '''' END) +&#xD;
    (CASE knt1.Knt_Rodzaj_Potencjalny WHEN 1 THEN ''Klient potencjalny,'' else '''' END)))), 1, 1, '''')) AS [Kontrahent Pierwotny Rodzaj],&#xD;
    pod5.Pod_Nazwa1 [Kontrahent Nazwa],     &#xD;
    pod5.Pod_Kod [Kontrahent Kod], &#xD;
    ISNULL(NULLIF(pod5.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Kontrahent Województwo],&#xD;
    ISNULL(NULLIF(pod5.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Kontrahent Powiat], ISNULL(NULLIF(pod5.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Kontrahent Miasto],&#xD;
    ISNULL(NULLIF(pod5.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Kontrahent Kraj],&#xD;
    ISNULL(NULLIF(pod5.Pod_NIP, ''''),''(BRAK)'') [Kontrahent NIP],&#xD;
    ISNULL(NULLIF(pod5.Pod_Grupa, ''''),''Pozostali'') [Kontrahent Grupa],&#xD;
    CASE knt3.Knt_OpiekunTyp&#xD;
        WHEN 3 THEN ISNULL(pod6.Pod_Kod, ''(NIEPRZYPISANE)'')&#xD;
        WHEN 8 THEN ISNULL(opk3.Ope_Kod, ''(NIEPRZYPISANE)'')&#xD;
        ELSE ''(NIEPRZYPISANE)'' &#xD;
    END [Kontrahent Opiekun],&#xD;
    reverse(stuff(reverse(CONVERT(varchar(100),RTRIM(&#xD;
    (CASE knt3.Knt_Rodzaj_Dostawca WHEN 1 THEN ''Dostawca, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Odbiorca WHEN 1 THEN ''Odbiorca, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Konkurencja WHEN 1 THEN ''Konkurencja, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Partner WHEN 1 THEN ''Partner, '' else '''' END) +&#xD;
    (CASE knt3.Knt_Rodzaj_Potencjalny WHEN 1 THEN ''Klient potencjalny,'' else '''' END)))), 1, 1, '''')) AS [Kontrahent Rodzaj],&#xD;
    pod7.Pod_Nazwa1 [Odbiorca Nazwa],   &#xD;
    pod7.Pod_Kod [Odbiorca Kod], &#xD;
    ISNULL(NULLIF(pod7.Pod_Wojewodztwo, ''''),''(NIEPRZYPISANE)'') [Odbiorca Województwo],&#xD;
    ISNULL(NULLIF(pod7.Pod_Powiat, ''''),''(NIEPRZYPISANE)'') [Odbiorca Powiat], ISNULL(NULLIF(pod7.Pod_Miasto, ''''),''(NIEPRZYPISANE)'') [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(pod7.Pod_Kraj, ''''),''(NIEPRZYPISANE)'') [Odbiorca Kraj],&#xD;
    ISNULL(NULLIF(pod7.Pod_NIP, ''''),''(BRAK)'') [Odbiorca NIP],&#xD;
    ISNULL(NULLIF(pod7.Pod_Grupa, ''''),''Pozostali'') [Odbiorca Grupa],&#xD;
    zal.Ope_Kod [Operator Wprowadzający], mod.Ope_Kod [Operator Modyfikujący],&#xD;
    ISNULL(kat1.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Nagłówka], ISNULL(kat2.Kat_KodSzczegol, ''(PUSTA)'') [Kategoria Szczegółowa z Elementu],&#xD;
    ISNULL(kat1.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Nagłówka], ISNULL(kat2.Kat_KodOgolny, ''(PUSTA)'') [Kategoria Ogólna z Elementu], &#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca], &#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny], &#xD;
    Twr_Kod [Produkt Kod], &#xD;
    poz.sciezka [Produkt Pełna Nazwa Grupy], "Produkt Opis" = CAST(Twr_Opis as VARCHAR(1024)), Twr_Jm [Jednostka Miary], &#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
     ISNULL(MagDoc.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Kod],&#xD;
     ISNULL(MagDoc.Mag_Symbol, ''(NIEPRZYPISANE)'') [Magazyn Docelowy Kod],&#xD;
ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
        CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], &#xD;
    TR.TrE_WartoscNetto [Wartość Netto],&#xD;
    TR.TrE_WartoscBrutto [Wartość Brutto],&#xD;
    TR.TrE_WartoscNettoWal [Wartość Waluta],&#xD;
    TR.TrE_Ilosc [Ilość] &#xD;
    ,ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Jednostka Miary Pomocnicza]&#xD;
    ,TR.TrE_Ilosc/(Twr_JMPrzelicznikL*Twr_JMPrzelicznikM) [Ilość Jednostka Pomocnicza]&#xD;
    /*&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji]&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia]&#xD;
    */&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataOpe, 111), ''/'', ''-'') [Data Operacji Dzień], (datepart(DY, datediff(d, 0, TrN_DataOpe) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataOpe)*/ [Data Operacji Tydzień Roku]&#xD;
    ,MONTH(TrN_DataOpe) [Data Operacji Miesiąc], DATEPART(quarter, TrN_DataOpe) [Data Operacji Kwartał], YEAR(TrN_DataOpe) [Data Operacji Rok]&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia Dzień], (datepart(DY, datediff(d, 0, TrN_DataWys) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, TrN_DataWys)*/ [Data Wystawienia Tydzień Roku] &#xD;
    ,MONTH(TrN_DataWys) [Data Wystawienia Miesiąc], DATEPART(quarter, TrN_DataWys) [Data Wystawienia Kwartał], YEAR(TrN_DataWys) [Data Wystawienia Rok]&#xD;
&#xD;
    ----------KONTEKSTY&#xD;
    ,25034 [Dokument Numer __PROCID__WZ__], TrN_TrNId [Dokument Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Nazwa __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny  Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Pierwotny Kod __PROCID__], pod1.Pod_PodId [Kontrahent Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Kontrahent Nazwa __PROCID__], pod5.Pod_PodId [Kontrahent Nazwa __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Nazwa __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], pod5.Pod_PodId [Kontrahent Kod __ORGID__],'''+@bazaFirmowa+''' [Kontrahent Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag.Mag_MagId [Magazyn Kod __ORGID__],  '''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,29056 [Magazyn Docelowy Kod __PROCID__Magazyny__], MagDoc.Mag_MagId [Magazyn Docelowy Kod __ORGID__], '''+@bazaFirmowa+''' [Magazyn Docelowy Kod __DATABASE__]  &#xD;
&#xD;
    '&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
       &#xD;
set @select3 = &#xD;
' FROM cdn.TraNag &#xD;
     JOIN cdn.TraElem TR ON TrE_TrNID=TrN_TrNID &#xD;
     LEFT JOIN #tmpSeria ser ON TrN_DDfId = DDf_DDfID&#xD;
     LEFT JOIN CDN.DokDefinicje dd ON TrN_DDfId = dd.DDf_DDfID&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt1 ON TrE_PodID=Knt_KntId AND TrE_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod1 ON TrE_PodID= pod1.Pod_PodId AND TrE_PodmiotTyp = pod1.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod2 ON Knt_OpiekunId = pod2.Pod_PodId AND Knt_OpiekunTyp = pod2.Pod_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.Towary ON TrE_TwrId=Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
     LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
     LEFT OUTER JOIN CDN.Magazyny Mag ON (CASE WHEN TrN_TypDokumentu = 318 THEN TrN_MagZrdId ELSE ISNULL(TrE_MagId,TrN_MagZrdId) END) = Mag.Mag_MagId &#xD;
     LEFT OUTER JOIN CDN.Magazyny MagDoc ON MagDoc.Mag_MagId = TrN_MagDocId&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat1 ON TrN_KatID=kat1.Kat_KatID&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat2 ON TrE_KatID=kat2.Kat_KatID&#xD;
     LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
     LEFT JOIN #tmpKonAtr KonAtr ON pod1.Pod_PodId = KonAtr.KnA_PodmiotId AND pod1.Pod_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
     LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID  = DokAtr.DAt_TrNId&#xD;
     LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId&#xD;
     LEFT JOIN #tmpPozatr PozAtr on PozAtr.TrA_TrEId = TrE_TrEId  &#xD;
     LEFT JOIN ' + @Operatorzy + ' opk ON Knt_OpiekunId = opk.Ope_OpeId AND Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN ' + @Operatorzy + ' zal ON TrN_OpeZalID = zal.Ope_OpeId&#xD;
     LEFT JOIN ' + @Operatorzy + ' mod ON TrN_OpeModID = mod.Ope_OpeId&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod5 on pod1.Pod_GlID = pod5.Pod_PodId and pod1.Pod_GlKod = pod5.Pod_Kod&#xD;
     LEFT OUTER JOIN CDN.Kontrahenci knt3 ON pod5.Pod_PodID=knt3.Knt_KntId AND pod5.Pod_PodmiotTyp = 1&#xD;
     LEFT OUTER JOIN CDN.Kategorie kat5 ON knt3.Knt_KatID=kat5.Kat_KatID&#xD;
     LEFT OUTER JOIN cdn.PodmiotyView pod6 ON knt3.Knt_OpiekunId = pod6.Pod_PodId AND knt3.Knt_OpiekunTyp = pod6.Pod_PodmiotTyp&#xD;
     LEFT JOIN #tmpKonAtr KonAtr1 ON pod5.Pod_PodId = KonAtr1.KnA_PodmiotId AND pod5.Pod_PodmiotTyp = KonAtr1.KnA_PodmiotTyp&#xD;
     LEFT OUTER JOIN CDN.PodmiotyView pod7 ON TrN_OdbID = pod7.Pod_PodId AND TrN_OdbiorcaTyp = pod7.Pod_PodmiotTyp&#xD;
     LEFT JOIN ' + @Operatorzy + ' opk3 ON knt3.Knt_OpiekunId = opk3.Ope_OpeId AND knt3.Knt_OpiekunTyp = 8 &#xD;
     LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
     LEFT OUTER JOIN ( &#xD;
            SELECT ISNULL(SUM(CASE WHEN TrS_Rodzaj = 312000 AND TrS_Ilosc &lt; 0 AND TrS_ZwrId IS NULL THEN 0&#xD;
                                   WHEN (TrS_Rodzaj = 308000 OR TrS_Rodzaj = 308011) AND TrS_Ilosc &lt; 0 THEN 0&#xD;
                                   ELSE TrS_Wartosc&#xD;
                              END),0) as Koszt,&#xD;
                           TRE.TrE_TrEID&#xD;
            FROM CDN.TraElem TRE&#xD;
            JOIN ( SELECT TrE_TrEId as IdElem, TrE_TrEId as IdZwiaz&#xD;
                   FROM CDN.TraElem&#xD;
                   UNION ALL&#xD;
                   SELECT TRE.TrE_TrEId, TRERel.TrE_TreId&#xD;
                     FROM cdn.TraElem TRE&#xD;
                       JOIN cdn.TraNag TRN ON TRE.TrE_TrNId = TrN_TrNId&#xD;
                       JOIN cdn.TraNagRelacje  ON TrN_TrNId = TrR_FaId AND TrR_Flaga &lt;&gt; 1&#xD;
                       JOIN cdn.TraElem TRERel ON TRERel.Tre_trnid = TrR_TrnId AND TREREl.Tre_lppow= tre.tre_lppow&#xD;
                     WHERE TrR_FaId = TRE.TrE_TrNId  AND TRERel.TrE_TypDokumentu NOT IN ( 318,309,308 ) and NOT (TrR_TrNtyp = 306 and TrR_FaTyp=307) and not (TrR_TrNtyp = 307 and TrR_FaTyp=306)&#xD;
                 ) AS Elem ON TRE.Tre_TrEId = Elem.IdElem&#xD;
            JOIN CDN.TraSElem TRS ON TRS.TrS_TrEId = Elem.IdZwiaz&#xD;
            GROUP BY TRE.TrE_TrEID&#xD;
    )KosztWyliczony  ON KosztWyliczony.TrE_TrEID = TR.TrE_TrEID&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
WHERE&#xD;
TrN_TypDokumentu IN (312)&#xD;
AND TrN_Bufor&lt;&gt;-1&#xD;
AND TrE_Aktywny&lt;&gt;0&#xD;
'&#xD;
&#xD;
exec (@select + @select2 + @select3)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpPozatr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM0zwJratE7ZrmpGGBehZ96iG/ZwwXfP7ZFIn0qVz+tUJztzEE4yYMSoYI5d0tQ3L5oGgM7ZyTqUt95ZsUhznLPGaI6d6f6KTDb9vY+wQZ9uZ1Osv9PWBRjxK7063do1EP3SFXPCnnPfLlapWirHqSc4A8x791GnStC1DFwQ7mHQlsrGFxXfnYiGT4TZT1NeEUw==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Symbol" caption="Dokument Symbol" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Opis" caption="Dokument Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Waluta" caption="Waluta" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Rodzaj" caption="Dokument Rodzaj" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Seria" caption="Dokument Seria" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Nazwa" caption="Kontrahent Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kod" caption="Kontrahent Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Województwo" caption="Kontrahent Pierwotny Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Powiat" caption="Kontrahent Pierwotny Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Miasto" caption="Kontrahent Pierwotny Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Kraj" caption="Kontrahent Pierwotny Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny NIP" caption="Kontrahent Pierwotny NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Grupa" caption="Kontrahent Pierwotny Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Opiekun" caption="Kontrahent Pierwotny Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Rodzaj" caption="Kontrahent Pierwotny Rodzaj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Województwo" caption="Kontrahent Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Powiat" caption="Kontrahent Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Miasto" caption="Kontrahent Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kraj" caption="Kontrahent Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent NIP" caption="Kontrahent NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Grupa" caption="Kontrahent Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Opiekun" caption="Kontrahent Opiekun" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Rodzaj" caption="Kontrahent Rodzaj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Nazwa" caption="Odbiorca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kod" caption="Odbiorca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Województwo" caption="Odbiorca Województwo" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Powiat" caption="Odbiorca Powiat" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Miasto" caption="Odbiorca Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kraj" caption="Odbiorca Kraj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca NIP" caption="Odbiorca NIP" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Grupa" caption="Odbiorca Grupa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Wprowadzający" caption="Operator Wprowadzający" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Modyfikujący" caption="Operator Modyfikujący" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Nagłówka" caption="Kategoria Szczegółowa z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Szczegółowa z Elementu" caption="Kategoria Szczegółowa z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Nagłówka" caption="Kategoria Ogólna z Nagłówka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kategoria Ogólna z Elementu" caption="Kategoria Ogólna z Elementu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Pełna Nazwa Grupy" caption="Produkt Pełna Nazwa Grupy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Jednostka Miary" caption="Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Magazyn Docelowy Kod" caption="Magazyn Docelowy Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Waluta" caption="Wartość Waluta" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Jednostka Miary Pomocnicza" caption="Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Operacji Dzień" caption="Data Operacji Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Tydzień Roku" caption="Data Operacji Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Miesiąc" caption="Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Kwartał" caption="Data Operacji Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Operacji Rok" caption="Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Pierwotny Atrybut KLUCZOWY" caption="Kontrahent Pierwotny Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut KLUCZOWY" caption="Kontrahent Atrybut KLUCZOWY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut KLUCZOWY (K)" caption="Dokument Atrybut KLUCZOWY (K)" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut BUDŻET FA/FZ" caption="Dokument Atrybut BUDŻET FA/FZ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut BUDŻET PZ/PA" caption="Dokument Atrybut BUDŻET PZ/PA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut DATAWAŻNOSCI" caption="Dokument Atrybut DATAWAŻNOSCI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut DATAWAZLICZBADNI" caption="Dokument Atrybut DATAWAZLICZBADNI" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NUMER SERYJNY" caption="Produkt Atrybut NUMER SERYJNY" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut KOLOR" caption="Pozycja Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Pozycja Atrybut NUMER SERYJNY" caption="Pozycja Atrybut NUMER SERYJNY" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAMAAAAHAAAABwITW0Rva3VtZW50IFR5cF0uW01NXQcCE1tEb2t1bWVudCBUeXBdLltQV10HAhRbRG9rdW1lbnQgVHlwXS5bUFdQXQcCE1tEb2t1bWVudCBUeXBdLltQWl0HAhNbRG9rdW1lbnQgVHlwXS5bUlddBwIUW0Rva3VtZW50IFR5cF0uW1JXU10HAhNbRG9rdW1lbnQgVHlwXS5bV1pd/////wAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="False" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Baza Firmowa"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Dokument Typ"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Dokument Rodzaj"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Magazyn Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Waluta"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Wartość Waluta" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Dokument Typ" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Dokument Rodzaj" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Baza Firmowa" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;filter fieldName="Magazyn Kod" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport zawiera informacje o przychodach i rozchodach firmy na podstawie dokumentów magazynowych. Wartości prezentowane są w walucie systemowej.&#xD;
Analizy oparte są o dokumenty PW, RW, PZ, WZ, MM, PKA, WKA, PWP, RWS.&#xD;
Wartości dla dokumentów rozchodowych prezentowane są ze znakiem minus. Dokumenty MM prezentowane są jako przychodowe w kontekście magazynu docelowego oraz jako rozchodowe w kontekście magazynu źródłowego. Wybór magazynu możliwy jest poprzez zafiltrowanie pola Magazyn Kod do odpowiedniej pozycji.</a:description><a:id>272</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.32 Przychody i rozchody w podziale na magazyny</a:mainLinkName><a:modifiedOn>2025-04-14T12:16:10.557</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>1</a:id></a:Context><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2021-09-29T10:45:41.873</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Analiza PZ z wydaniami towaru &#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @select3 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
DECLARE @atrybutyTwr varchar(max), @atrybutyTwr2 varchar(max);&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
SET @atrybutyTwr2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyTwr2 = @atrybutyTwr2 + N', ''(NIEPRZYPISANE)'' [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Połączenie do bazy firmowej&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'&#xD;
SELECT&#xD;
BAZ.Baz_Nazwa [Baza Firmowa]&#xD;
,pz.trn_numerpelny [PZ Numer]&#xD;
,twr_kod [Produkt Kod]&#xD;
,twr_nazwa [Produkt Nazwa]&#xD;
,pzs.trs_ilosc/(case wzile when 0 then 1 else isnull(wzile,1) end) [PZ Ilość]&#xD;
,pzs.trs_wartosc/(case wzile when 0 then 1 else isnull(wzile,1) end) [PZ Wartość]&#xD;
,pzs.TrS_TrSIdDost [Dostawa]&#xD;
,Mag_Symbol [Magazyn Kod]&#xD;
,Mag_Nazwa [Magazyn Nazwa]&#xD;
,wznumer [WZ Numer]&#xD;
,wzilosc [WZ Ilość]&#xD;
,wzwartosc [WZ Wartość],&#xD;
CASE WHEN (MONTH(PZ.TrN_DataOpe) = MONTH(GETDATE())) AND (YEAR(PZ.TrN_DataOpe) = YEAR(GETDATE())) THEN ''TAK'' ELSE ''NIE'' END [WZ Czas Aktualny Miesiąc],&#xD;
    CASE &#xD;
        WHEN (MONTH(PZ.TrN_DataOpe) = MONTH(GETDATE())-1) AND (YEAR(PZ.TrN_DataOpe) = YEAR(GETDATE())) THEN ''TAK'' &#xD;
        WHEN ((MONTH(PZ.TrN_DataOpe) = 12) AND (MONTH(GETDATE()) = 1)) AND (YEAR(PZ.TrN_DataOpe) = YEAR(GETDATE()) - 1) THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [WZ Czas Aktualny Miesiąc Poprzedni]&#xD;
/*&#xD;
----------DATY POINT&#xD;
,CONVERT(VARCHAR(10),wzddok,120) [WZ Data Dokumentu]&#xD;
,CONVERT(VARCHAR(10),wzdope,120) [WZ Data Operacji]&#xD;
,CONVERT(VARCHAR(10),pz.TrN_DataDok,120) [PZ Data Dokumentu]&#xD;
,CONVERT(VARCHAR(10),pz.TrN_DataOpe,120) [PZ Data Operacji]&#xD;
*/&#xD;
----------DATY ANALIZY&#xD;
,YEAR(wzddok) [WZ Data Dokumentu Rok]&#xD;
,MONTH(wzddok) [WZ Data Dokumentu Miesiąc]&#xD;
,CONVERT(VARCHAR(10),wzddok,120) [WZ Data Dokumentu Dzień]&#xD;
,YEAR(wzdope) [WZ Data Operacji Rok]&#xD;
,MONTH(wzdope) [WZ Data Operacji Miesiąc]&#xD;
,CONVERT(VARCHAR(10),wzdope,120) [WZ Data Operacji Dzień]&#xD;
,YEAR(pz.TrN_DataDok) [PZ Data Dokumentu Rok]&#xD;
,MONTH(pz.TrN_DataDok) [PZ Data Dokumentu Miesiąc]&#xD;
,CONVERT(VARCHAR(10),pz.TrN_DataDok,120) [PZ Data Dokumentu Dzień]&#xD;
,YEAR(pz.TrN_DataOpe) [PZ Data Operacji Rok]&#xD;
,MONTH(pz.TrN_DataOpe) [PZ Data Operacji Miesiąc]&#xD;
,CONVERT(VARCHAR(10),pz.TrN_DataOpe,120) [PZ Data Operacji Dzień]&#xD;
,Datediff(dd,pz.TrN_DataOpe,wzdope)+1 [Dni na Magazynie]&#xD;
&#xD;
----------KONTEKSTY&#xD;
,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
,29056 [Magazyn Nazwa __PROCID__Magazyny__], Mag_MagId [Magazyn Nazwa __ORGID__],'''+@bazaFirmowa+''' [Magazyn Nazwa __DATABASE__]&#xD;
,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
'&#xD;
+ @kolumny + @atrybutyTwr + '&#xD;
from cdn.tranag pz --dokumenty PZ&#xD;
left join cdn.traelem pze on pze.tre_trnid = pz.trn_trnid&#xD;
left join cdn.traselem pzs on pzs.trs_treid = pze.tre_treid&#xD;
left join --join do WZ&#xD;
(&#xD;
select wz.trn_numerpelny wznumer, wze.TrE_TwrKod wzkod, wzs.trs_ilosc wzilosc, wzs.trs_wartosc wzwartosc, wzs.TrS_TrSIdDost wzdost, wz.trn_datadok wzddok, wz.trn_dataope wzdope from cdn.tranag wz&#xD;
left join cdn.traelem wze on wze.tre_trnid = wz.trn_trnid&#xD;
left join cdn.traselem wzs on wzs.trs_treid = wze.tre_treid&#xD;
where wz.TrN_TypDokumentu = 306&#xD;
) dost on dost.wzdost = pzs.TrS_TrSIdDost&#xD;
&#xD;
left join --join do ilości WZ spiętych dostawami z PZ&#xD;
(&#xD;
select pz.TrN_TrNID wzid, pze.TrE_TwrId wztwrid, count(wznumer) wzile from cdn.tranag pz&#xD;
left join cdn.traelem pze on pze.tre_trnid = pz.trn_trnid&#xD;
left join cdn.traselem pzs on pzs.trs_treid = pze.tre_treid&#xD;
left join&#xD;
(&#xD;
select wz.trn_numerpelny wznumer, wze.TrE_TwrKod wzkod, wzs.trs_ilosc wzilosc, wzs.trs_wartosc wzwartosc, wzs.TrS_TrSIdDost wzdost from cdn.tranag wz&#xD;
left join cdn.traelem wze on wze.tre_trnid = wz.trn_trnid&#xD;
left join cdn.traselem wzs on wzs.trs_treid = wze.tre_treid&#xD;
where wz.TrN_TypDokumentu = 306&#xD;
) dost on dost.wzdost = pzs.TrS_TrSIdDost&#xD;
group by pz.TrN_TrNID, pze.TrE_TwrId &#xD;
&#xD;
) x on wzid = pz.trn_trnid and wztwrid = pze.TrE_TwrId&#xD;
left join cdn.magazyny on pzs.TrS_MagId = mag_magid&#xD;
left join cdn.towary on Twr_TwrId = pze.tre_twrid&#xD;
&#xD;
LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
where pz.TrN_TypDokumentu = 307 and pz.TrN_ZwrId is null&#xD;
&#xD;
'&#xD;
exec(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+SoK7znksbZM0zwJratE7ZrmpGGBehZ96iG/ZwwXfP7ZFIn0qVz+tUJztzEE4yYMSoYI5d0tQ3L5gXbtgERTtjEXt2s9K9ULxo1SLSuGtSlhuU+sqHiKXXYmEgoGmA1enNJ3LjdJxtLiUMDfssbygaLZnN6aTIvR/HldGflBWYeP0eLPLShchgj2Un76BD28F5ahskTazX3ew==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="PZ Numer" caption="PZ Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="PZ Ilość" caption="PZ Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="PZ Wartość" caption="PZ Wartość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Dostawa" caption="Dostawa" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Magazyn Nazwa" caption="Magazyn Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="WZ Numer" caption="WZ Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="WZ Ilość" caption="WZ Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="WZ Wartość" caption="WZ Wartość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="WZ Data Dokumentu Rok" caption="WZ Data Dokumentu Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="WZ Data Dokumentu Miesiąc" caption="WZ Data Dokumentu Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="WZ Data Dokumentu Dzień" caption="WZ Data Dokumentu Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="WZ Data Operacji Rok" caption="WZ Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="WZ Data Operacji Miesiąc" caption="WZ Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="WZ Data Operacji Dzień" caption="WZ Data Operacji Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="PZ Data Dokumentu Rok" caption="PZ Data Dokumentu Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="PZ Data Dokumentu Miesiąc" caption="PZ Data Dokumentu Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="PZ Data Dokumentu Dzień" caption="PZ Data Dokumentu Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="PZ Data Operacji Rok" caption="PZ Data Operacji Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="PZ Data Operacji Miesiąc" caption="PZ Data Operacji Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="PZ Data Operacji Dzień" caption="PZ Data Operacji Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dni na Magazynie" caption="Dni na Magazynie" type="measure" formatString="n0" aggregate="Max" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut NUMER SERYJNY" caption="Produkt Atrybut NUMER SERYJNY" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAUAAAA7AAAABwIcW1BaIE51bWVyXS5bUFovMS8yMDIwLy9LQVNBXQcCFltQWiBOdW1lcl0uW1BaLzEvMjAyMV0HAhdbUFogTnVtZXJdLltQWi8xMC8yMDIwXQcCF1tQWiBOdW1lcl0uW1BaLzEwLzIwMjFdBwIXW1BaIE51bWVyXS5bUFovMTEvMjAyMF0HAhdbUFogTnVtZXJdLltQWi8xMS8yMDIxXQcCF1tQWiBOdW1lcl0uW1BaLzEyLzIwMjBdBwIXW1BaIE51bWVyXS5bUFovMTIvMjAyMV0HAhdbUFogTnVtZXJdLltQWi8xMy8yMDIwXQcCF1tQWiBOdW1lcl0uW1BaLzEzLzIwMjFdBwIXW1BaIE51bWVyXS5bUFovMTQvMjAyMF0HAhdbUFogTnVtZXJdLltQWi8xNC8yMDIxXQcCF1tQWiBOdW1lcl0uW1BaLzE1LzIwMjBdBwIXW1BaIE51bWVyXS5bUFovMTUvMjAyMV0HAhdbUFogTnVtZXJdLltQWi8xNi8yMDIwXQcCF1tQWiBOdW1lcl0uW1BaLzE2LzIwMjFdBwIXW1BaIE51bWVyXS5bUFovMTcvMjAyMF0HAhdbUFogTnVtZXJdLltQWi8xNy8yMDIxXQcCF1tQWiBOdW1lcl0uW1BaLzE4LzIwMjBdBwIXW1BaIE51bWVyXS5bUFovMTgvMjAyMV0HAhdbUFogTnVtZXJdLltQWi8xOS8yMDIwXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIbW1BaIE51bWVyXS5bUFovMi8yMDIwLy9QS09dBwIWW1BaIE51bWVyXS5bUFovMi8yMDIxXQcCF1tQWiBOdW1lcl0uW1BaLzIwLzIwMjBdBwIXW1BaIE51bWVyXS5bUFovMjAvMjAyMV0HAhdbUFogTnVtZXJdLltQWi8yMS8yMDIwXQcCF1tQWiBOdW1lcl0uW1BaLzIxLzIwMjFdBwIXW1BaIE51bWVyXS5bUFovMjIvMjAyMF0HAhdbUFogTnVtZXJdLltQWi8yMi8yMDIxXQcCF1tQWiBOdW1lcl0uW1BaLzIzLzIwMjBdBwIXW1BaIE51bWVyXS5bUFovMjMvMjAyMV0HAhdbUFogTnVtZXJdLltQWi8yNC8yMDIwXQcCF1tQWiBOdW1lcl0uW1BaLzI0LzIwMjFdBwIXW1BaIE51bWVyXS5bUFovMjUvMjAyMF0HAhdbUFogTnVtZXJdLltQWi8yNS8yMDIxXQcCF1tQWiBOdW1lcl0uW1BaLzI2LzIwMjBdBwIXW1BaIE51bWVyXS5bUFovMjYvMjAyMV0HAhdbUFogTnVtZXJdLltQWi8yNy8yMDIxXQcCF1tQWiBOdW1lcl0uW1BaLzI4LzIwMjFdBwIXW1BaIE51bWVyXS5bUFovMjkvMjAyMV0HAhtbUFogTnVtZXJdLltQWi8zLzIwMjAvL0VVUl0HAhZbUFogTnVtZXJdLltQWi8zLzIwMjFdBwIXW1BaIE51bWVyXS5bUFovMzAvMjAyMV0HAhdbUFogTnVtZXJdLltQWi8zMS8yMDIxXQcCF1tQWiBOdW1lcl0uW1BaLzMyLzIwMjFdBwIXW1BaIE51bWVyXS5bUFovMzMvMjAyMV0HAhZbUFogTnVtZXJdLltQWi80LzIwMjBdBwIWW1BaIE51bWVyXS5bUFovNC8yMDIxXQcCFltQWiBOdW1lcl0uW1BaLzUvMjAyMF0HAhZbUFogTnVtZXJdLltQWi81LzIwMjFdBwIWW1BaIE51bWVyXS5bUFovNi8yMDIwXQcCFltQWiBOdW1lcl0uW1BaLzYvMjAyMV0HAhZbUFogTnVtZXJdLltQWi83LzIwMjBdBwIWW1BaIE51bWVyXS5bUFovNy8yMDIxXQcCFltQWiBOdW1lcl0uW1BaLzgvMjAyMF0HAhZbUFogTnVtZXJdLltQWi84LzIwMjFdBwIWW1BaIE51bWVyXS5bUFovOS8yMDIwXQcCFltQWiBOdW1lcl0uW1BaLzkvMjAyMV0AAAAA/////wAAAACWAAAABwIcW1BaIE51bWVyXS5bUFovMS8yMDIwLy9LQVNBXQcCHVtQcm9kdWt0IEtvZF0uW0lHTEFLSV9DWVBSWVNdBwIcW1BaIE51bWVyXS5bUFovMS8yMDIwLy9LQVNBXQcCIFtQcm9kdWt0IEtvZF0uW0lHTEFLSV9KQcWBT1dJRUNdBwIcW1BaIE51bWVyXS5bUFovMS8yMDIwLy9LQVNBXQcCGVtQcm9kdWt0IEtvZF0uW0pBQsWBT05JRV0HAhxbUFogTnVtZXJdLltQWi8xLzIwMjAvL0tBU0FdBwIZW1Byb2R1a3QgS29kXS5bUsOTxbtBX1BOXQcCHFtQWiBOdW1lcl0uW1BaLzEvMjAyMC8vS0FTQV0HAhdbUHJvZHVrdCBLb2RdLltUVUpFXzNMXQcCFltQWiBOdW1lcl0uW1BaLzEvMjAyMV0HAhdbUHJvZHVrdCBLb2RdLltTRUtBVE9SXQcCF1tQWiBOdW1lcl0uW1BaLzEwLzIwMjBdBwIdW1Byb2R1a3QgS29kXS5bSUdMQUtJX0NZUFJZU10HAhdbUFogTnVtZXJdLltQWi8xMC8yMDIwXQcCIFtQcm9kdWt0IEtvZF0uW0lHTEFLSV9KQcWBT1dJRUNdBwIXW1BaIE51bWVyXS5bUFovMTAvMjAyMF0HAhdbUHJvZHVrdCBLb2RdLltUVUpFXzNMXQcCF1tQWiBOdW1lcl0uW1BaLzEwLzIwMjFdBwIUW1Byb2R1a3QgS29kXS5bVEVTVF0HAhdbUFogTnVtZXJdLltQWi8xMS8yMDIwXQcCGVtQcm9kdWt0IEtvZF0uW1LDk8W7QV9QTl0HAhdbUFogTnVtZXJdLltQWi8xMS8yMDIxXQcCFFtQcm9kdWt0IEtvZF0uW1RFU1RdBwIXW1BaIE51bWVyXS5bUFovMTIvMjAyMF0HAhdbUHJvZHVrdCBLb2RdLltTRUtBVE9SXQcCF1tQWiBOdW1lcl0uW1BaLzEyLzIwMjBdBwIWW1Byb2R1a3QgS29kXS5bU1RPSkFLXQcCF1tQWiBOdW1lcl0uW1BaLzEyLzIwMjFdBwIeW1Byb2R1a3QgS29kXS5bWsWBT8W7T05ZIFRFU1RdBwIXW1BaIE51bWVyXS5bUFovMTMvMjAyMF0HAh1bUHJvZHVrdCBLb2RdLltJR0xBS0lfQ1lQUllTXQcCF1tQWiBOdW1lcl0uW1BaLzEzLzIwMjBdBwIcW1Byb2R1a3QgS29kXS5bUEnFgUFfRUxFS1RSXQcCF1tQWiBOdW1lcl0uW1BaLzEzLzIwMjBdBwIfW1Byb2R1a3QgS29kXS5bUEnFgUFfU1BBTElOT1dBXQcCF1tQWiBOdW1lcl0uW1BaLzEzLzIwMjBdBwIcW1Byb2R1a3QgS29kXS5bUk9aRFJBQk5JQUNaXQcCF1tQWiBOdW1lcl0uW1BaLzEzLzIwMjBdBwIXW1Byb2R1a3QgS29kXS5bVFVKRV8zTF0HAhdbUFogTnVtZXJdLltQWi8xMy8yMDIxXQcCHltQcm9kdWt0IEtvZF0uW0dSQUJJRV9MScWaQ0lFXQcCF1tQWiBOdW1lcl0uW1BaLzEzLzIwMjFdBwIaW1Byb2R1a3QgS29kXS5bR1JBQklFX09HUl0HAhdbUFogTnVtZXJdLltQWi8xNC8yMDIwXQcCGltQcm9kdWt0IEtvZF0uW09ES19MScWaQ0ldBwIXW1BaIE51bWVyXS5bUFovMTQvMjAyMF0HAh9bUHJvZHVrdCBLb2RdLltQScWBQV9TUEFMSU5PV0FdBwIXW1BaIE51bWVyXS5bUFovMTQvMjAyMF0HAhxbUHJvZHVrdCBLb2RdLltST1pEUkFCTklBQ1pdBwIXW1BaIE51bWVyXS5bUFovMTQvMjAyMV0HAhVbUHJvZHVrdCBLb2RdLltURVNUMl0HAhdbUFogTnVtZXJdLltQWi8xNS8yMDIwXQcCHltQcm9kdWt0IEtvZF0uW0dSQUJJRV9MScWaQ0lFXQcCF1tQWiBOdW1lcl0uW1BaLzE1LzIwMjBdBwIXW1Byb2R1a3QgS29kXS5bU0VLQVRPUl0HAhdbUFogTnVtZXJdLltQWi8xNS8yMDIwXQcCF1tQcm9kdWt0IEtvZF0uW1NaUEFERUxdBwIXW1BaIE51bWVyXS5bUFovMTUvMjAyMV0HAhVbUHJvZHVrdCBLb2RdLltURVNUMl0HAhdbUFogTnVtZXJdLltQWi8xNi8yMDIwXQcCHltQcm9kdWt0IEtvZF0uW0dSQUJJRV9MScWaQ0lFXQcCF1tQWiBOdW1lcl0uW1BaLzE2LzIwMjBdBwIaW1Byb2R1a3QgS29kXS5bR1JBQklFX09HUl0HAhdbUFogTnVtZXJdLltQWi8xNi8yMDIwXQcCF1tQcm9kdWt0IEtvZF0uW1NaUEFERUxdBwIXW1BaIE51bWVyXS5bUFovMTYvMjAyMV0HAiBbUHJvZHVrdCBLb2RdLltJR0xBS0lfSkHFgU9XSUVDXQcCF1tQWiBOdW1lcl0uW1BaLzE2LzIwMjFdBwIZW1Byb2R1a3QgS29kXS5bSkFCxYFPTklFXQcCF1tQWiBOdW1lcl0uW1BaLzE3LzIwMjBdBwIdW1Byb2R1a3QgS29kXS5bSUdMQUtJX0NZUFJZU10HAhdbUFogTnVtZXJdLltQWi8xNy8yMDIwXQcCIFtQcm9kdWt0IEtvZF0uW0lHTEFLSV9KQcWBT1dJRUNdBwIXW1BaIE51bWVyXS5bUFovMTcvMjAyMF0HAhdbUHJvZHVrdCBLb2RdLltUVUpFXzNMXQcCF1tQWiBOdW1lcl0uW1BaLzE3LzIwMjFdBwIdW1Byb2R1a3QgS29kXS5bSUdMQUtJX0NZUFJZU10HAhdbUFogTnVtZXJdLltQWi8xOC8yMDIwXQcCG1tQcm9kdWt0IEtvZF0uW05PxbtZQ0VfRUwuXQcCF1tQWiBOdW1lcl0uW1BaLzE4LzIwMjBdBwIaW1Byb2R1a3QgS29kXS5bT0RLX0xJxZpDSV0HAhdbUFogTnVtZXJdLltQWi8xOC8yMDIwXQcCHFtQcm9kdWt0IEtvZF0uW1JPWkRSQUJOSUFDWl0HAhdbUFogTnVtZXJdLltQWi8xOC8yMDIxXQcCGltQcm9kdWt0IEtvZF0uW09ES19MScWaQ0ldBwIXW1BaIE51bWVyXS5bUFovMTgvMjAyMV0HAhxbUHJvZHVrdCBLb2RdLltQScWBQV9FTEVLVFJdBwIXW1BaIE51bWVyXS5bUFovMTgvMjAyMV0HAh9bUHJvZHVrdCBLb2RdLltQScWBQV9TUEFMSU5PV0FdBwIXW1BaIE51bWVyXS5bUFovMTkvMjAyMF0HAh5bUHJvZHVrdCBLb2RdLltHUkFCSUVfTEnFmkNJRV0HAhdbUFogTnVtZXJdLltQWi8xOS8yMDIwXQcCGltQcm9kdWt0IEtvZF0uW0dSQUJJRV9PR1JdBwIXW1BaIE51bWVyXS5bUFovMTkvMjAyMF0HAhhbUHJvZHVrdCBLb2RdLltLT1JBX1M4MF0HAhdbUFogTnVtZXJdLltQWi8xOS8yMDIwXQcCF1tQcm9kdWt0IEtvZF0uW1NFS0FUT1JdBwIXW1BaIE51bWVyXS5bUFovMTkvMjAyMF0HAhZbUHJvZHVrdCBLb2RdLltTVE9KQUtdBwIXW1BaIE51bWVyXS5bUFovMTkvMjAyMF0HAhdbUHJvZHVrdCBLb2RdLltTWlBBREVMXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjBdBwIYW1Byb2R1a3QgS29kXS5bWklFTUlBXzVdBwIXW1BaIE51bWVyXS5bUFovMTkvMjAyMV0HAh5bUHJvZHVrdCBLb2RdLltHUkFCSUVfTEnFmkNJRV0HAhdbUFogTnVtZXJdLltQWi8xOS8yMDIxXQcCGltQcm9kdWt0IEtvZF0uW0dSQUJJRV9PR1JdBwIXW1BaIE51bWVyXS5bUFovMTkvMjAyMV0HAh1bUHJvZHVrdCBLb2RdLltJR0xBS0lfQ1lQUllTXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIgW1Byb2R1a3QgS29kXS5bSUdMQUtJX0pBxYFPV0lFQ10HAhdbUFogTnVtZXJdLltQWi8xOS8yMDIxXQcCGVtQcm9kdWt0IEtvZF0uW0pBQsWBT05JRV0HAhdbUFogTnVtZXJdLltQWi8xOS8yMDIxXQcCGFtQcm9kdWt0IEtvZF0uW0tPUkFfUzgwXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIiW1Byb2R1a3QgS29kXS5bxYFBxYNDVUNIIERPIFBJxYFZXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIbW1Byb2R1a3QgS29kXS5bTk/Fu1lDRV9FTC5dBwIXW1BaIE51bWVyXS5bUFovMTkvMjAyMV0HAhpbUHJvZHVrdCBLb2RdLltPREtfTEnFmkNJXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIWW1Byb2R1a3QgS29kXS5bUEFMRVRBXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIcW1Byb2R1a3QgS29kXS5bUEnFgUFfRUxFS1RSXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIfW1Byb2R1a3QgS29kXS5bUEnFgUFfU1BBTElOT1dBXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIcW1Byb2R1a3QgS29kXS5bUk9aRFJBQk5JQUNaXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIZW1Byb2R1a3QgS29kXS5bUsOTxbtBX1BOXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIYW1Byb2R1a3QgS29kXS5bU0FEWk9OS0ldBwIXW1BaIE51bWVyXS5bUFovMTkvMjAyMV0HAhdbUHJvZHVrdCBLb2RdLltTRUtBVE9SXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIYW1Byb2R1a3QgS29kXS5bU0tSWllOS0FdBwIXW1BaIE51bWVyXS5bUFovMTkvMjAyMV0HAhZbUHJvZHVrdCBLb2RdLltTVE9KQUtdBwIXW1BaIE51bWVyXS5bUFovMTkvMjAyMV0HAhdbUHJvZHVrdCBLb2RdLltTWlBBREVMXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIUW1Byb2R1a3QgS29kXS5bVEVTVF0HAhdbUFogTnVtZXJdLltQWi8xOS8yMDIxXQcCFVtQcm9kdWt0IEtvZF0uW1RFU1QyXQcCF1tQWiBOdW1lcl0uW1BaLzE5LzIwMjFdBwIXW1Byb2R1a3QgS29kXS5bVFVKRV8zTF0HAhdbUFogTnVtZXJdLltQWi8xOS8yMDIxXQcCGltQcm9kdWt0IEtvZF0uW1pFU1RBV19PR1JdBwIXW1BaIE51bWVyXS5bUFovMTkvMjAyMV0HAhhbUHJvZHVrdCBLb2RdLltaSUVNSUFfNV0HAhdbUFogTnVtZXJdLltQWi8xOS8yMDIxXQcCHltQcm9kdWt0IEtvZF0uW1rFgU/Fu09OWSBURVNUXQcCG1tQWiBOdW1lcl0uW1BaLzIvMjAyMC8vUEtPXQcCGFtQcm9kdWt0IEtvZF0uW0tPUkFfUzgwXQcCG1tQWiBOdW1lcl0uW1BaLzIvMjAyMC8vUEtPXQcCFltQcm9kdWt0IEtvZF0uW1NUT0pBS10HAhtbUFogTnVtZXJdLltQWi8yLzIwMjAvL1BLT10HAhhbUHJvZHVrdCBLb2RdLltaSUVNSUFfNV0HAhZbUFogTnVtZXJdLltQWi8yLzIwMjFdBwIYW1Byb2R1a3QgS29kXS5bU0FEWk9OS0ldBwIXW1BaIE51bWVyXS5bUFovMjAvMjAyMF0HAhlbUHJvZHVrdCBLb2RdLltKQULFgU9OSUVdBwIXW1BaIE51bWVyXS5bUFovMjAvMjAyMF0HAhlbUHJvZHVrdCBLb2RdLltSw5PFu0FfUE5dBwIXW1BaIE51bWVyXS5bUFovMjAvMjAyMV0HAiBbUHJvZHVrdCBLb2RdLltJR0xBS0lfSkHFgU9XSUVDXQcCF1tQWiBOdW1lcl0uW1BaLzIxLzIwMjBdBwIeW1Byb2R1a3QgS29kXS5bR1JBQklFX0xJxZpDSUVdBwIXW1BaIE51bWVyXS5bUFovMjEvMjAyMF0HAhpbUHJvZHVrdCBLb2RdLltHUkFCSUVfT0dSXQcCF1tQWiBOdW1lcl0uW1BaLzIxLzIwMjBdBwIdW1Byb2R1a3QgS29kXS5bSUdMQUtJX0NZUFJZU10HAhdbUFogTnVtZXJdLltQWi8yMS8yMDIxXQcCFltQcm9kdWt0IEtvZF0uW1RFU1RKUF0HAhdbUFogTnVtZXJdLltQWi8yMi8yMDIwXQcCHFtQcm9kdWt0IEtvZF0uW1JPWkRSQUJOSUFDWl0HAhdbUFogTnVtZXJdLltQWi8yMi8yMDIwXQcCGVtQcm9kdWt0IEtvZF0uW1LDk8W7QV9QTl0HAhdbUFogTnVtZXJdLltQWi8yMi8yMDIwXQcCF1tQcm9kdWt0IEtvZF0uW1NFS0FUT1JdBwIXW1BaIE51bWVyXS5bUFovMjIvMjAyMV0HAhdbUHJvZHVrdCBLb2RdLltTWlBBREVMXQcCF1tQWiBOdW1lcl0uW1BaLzIzLzIwMjBdBwIdW1Byb2R1a3QgS29kXS5bSUdMQUtJX0NZUFJZU10HAhdbUFogTnVtZXJdLltQWi8yMy8yMDIwXQcCIFtQcm9kdWt0IEtvZF0uW0lHTEFLSV9KQcWBT1dJRUNdBwIXW1BaIE51bWVyXS5bUFovMjMvMjAyMV0HAhZbUHJvZHVrdCBLb2RdLltLV0lBVFldBwIXW1BaIE51bWVyXS5bUFovMjQvMjAyMF0HAhxbUHJvZHVrdCBLb2RdLltQScWBQV9FTEVLVFJdBwIXW1BaIE51bWVyXS5bUFovMjQvMjAyMF0HAh9bUHJvZHVrdCBLb2RdLltQScWBQV9TUEFMSU5PV0FdBwIXW1BaIE51bWVyXS5bUFovMjQvMjAyMV0HAh1bUHJvZHVrdCBLb2RdLltJR0xBS0lfQ1lQUllTXQcCF1tQWiBOdW1lcl0uW1BaLzI0LzIwMjFdBwIgW1Byb2R1a3QgS29kXS5bSUdMQUtJX0pBxYFPV0lFQ10HAhdbUFogTnVtZXJdLltQWi8yNS8yMDIwXQcCHltQcm9kdWt0IEtvZF0uW0dSQUJJRV9MScWaQ0lFXQcCF1tQWiBOdW1lcl0uW1BaLzI1LzIwMjBdBwIaW1Byb2R1a3QgS29kXS5bR1JBQklFX09HUl0HAhdbUFogTnVtZXJdLltQWi8yNS8yMDIxXQcCIltQcm9kdWt0IEtvZF0uW8WBQcWDQ1VDSCBETyBQScWBWV0HAhdbUFogTnVtZXJdLltQWi8yNi8yMDIwXQcCGltQcm9kdWt0IEtvZF0uW09ES19MScWaQ0ldBwIXW1BaIE51bWVyXS5bUFovMjYvMjAyMV0HAhpbUHJvZHVrdCBLb2RdLltHUkFCSUVfT0dSXQcCF1tQWiBOdW1lcl0uW1BaLzI3LzIwMjFdBwIZW1Byb2R1a3QgS29kXS5bSkFCxYFPTklFXQcCF1tQWiBOdW1lcl0uW1BaLzI4LzIwMjFdBwIWW1Byb2R1a3QgS29kXS5bS1dJQVRZXQcCF1tQWiBOdW1lcl0uW1BaLzI5LzIwMjFdBwIYW1Byb2R1a3QgS29kXS5bWklFTUlBXzVdBwIbW1BaIE51bWVyXS5bUFovMy8yMDIwLy9FVVJdBwIeW1Byb2R1a3QgS29kXS5bR1JBQklFX0xJxZpDSUVdBwIbW1BaIE51bWVyXS5bUFovMy8yMDIwLy9FVVJdBwIaW1Byb2R1a3QgS29kXS5bR1JBQklFX09HUl0HAhtbUFogTnVtZXJdLltQWi8zLzIwMjAvL0VVUl0HAhdbUHJvZHVrdCBLb2RdLltTRUtBVE9SXQcCG1tQWiBOdW1lcl0uW1BaLzMvMjAyMC8vRVVSXQcCF1tQcm9kdWt0IEtvZF0uW1NaUEFERUxdBwIWW1BaIE51bWVyXS5bUFovMy8yMDIxXQcCGVtQcm9kdWt0IEtvZF0uW1LDk8W7QV9QTl0HAhZbUFogTnVtZXJdLltQWi8zLzIwMjFdBwIXW1Byb2R1a3QgS29kXS5bU0VLQVRPUl0HAhZbUFogTnVtZXJdLltQWi8zLzIwMjFdBwIaW1Byb2R1a3QgS29kXS5bWkVTVEFXX09HUl0HAhZbUFogTnVtZXJdLltQWi8zLzIwMjFdBwIYW1Byb2R1a3QgS29kXS5bWklFTUlBXzVdBwIXW1BaIE51bWVyXS5bUFovMzAvMjAyMV0HAhZbUHJvZHVrdCBLb2RdLltQUk9EX0FdBwIXW1BaIE51bWVyXS5bUFovMzAvMjAyMV0HAhZbUHJvZHVrdCBLb2RdLltQUk9EX0JdBwIXW1BaIE51bWVyXS5bUFovMzEvMjAyMV0HAhZbUHJvZHVrdCBLb2RdLltOQVBPSjFdBwIXW1BaIE51bWVyXS5bUFovMzEvMjAyMV0HAhZbUHJvZHVrdCBLb2RdLltOQVBPSjJdBwIXW1BaIE51bWVyXS5bUFovMzIvMjAyMV0HAhlbUHJvZHVrdCBLb2RdLltKQULFgU9OSUVdBwIXW1BaIE51bWVyXS5bUFovMzIvMjAyMV0HAhZbUHJvZHVrdCBLb2RdLltLV0lBVFldBwIXW1BaIE51bWVyXS5bUFovMzMvMjAyMV0HAhZbUHJvZHVrdCBLb2RdLltOQVBPSjFdBwIWW1BaIE51bWVyXS5bUFovNC8yMDIwXQcCG1tQcm9kdWt0IEtvZF0uW05PxbtZQ0VfRUwuXQcCFltQWiBOdW1lcl0uW1BaLzQvMjAyMF0HAhpbUHJvZHVrdCBLb2RdLltPREtfTEnFmkNJXQcCFltQWiBOdW1lcl0uW1BaLzQvMjAyMF0HAhxbUHJvZHVrdCBLb2RdLltST1pEUkFCTklBQ1pdBwIWW1BaIE51bWVyXS5bUFovNC8yMDIxXQcCHVtQcm9kdWt0IEtvZF0uW0lHTEFLSV9DWVBSWVNdBwIWW1BaIE51bWVyXS5bUFovNC8yMDIxXQcCIFtQcm9kdWt0IEtvZF0uW0lHTEFLSV9KQcWBT1dJRUNdBwIWW1BaIE51bWVyXS5bUFovNC8yMDIxXQcCGVtQcm9kdWt0IEtvZF0uW0pBQsWBT05JRV0HAhZbUFogTnVtZXJdLltQWi80LzIwMjFdBwIYW1Byb2R1a3QgS29kXS5bS09SQV9TODBdBwIWW1BaIE51bWVyXS5bUFovNC8yMDIxXQcCGVtQcm9kdWt0IEtvZF0uW1LDk8W7QV9QTl0HAhZbUFogTnVtZXJdLltQWi80LzIwMjFdBwIYW1Byb2R1a3QgS29kXS5bU0FEWk9OS0ldBwIWW1BaIE51bWVyXS5bUFovNS8yMDIwXQcCHFtQcm9kdWt0IEtvZF0uW1BJxYFBX0VMRUtUUl0HAhZbUFogTnVtZXJdLltQWi81LzIwMjBdBwIfW1Byb2R1a3QgS29kXS5bUEnFgUFfU1BBTElOT1dBXQcCFltQWiBOdW1lcl0uW1BaLzUvMjAyMV0HAhZbUHJvZHVrdCBLb2RdLltQQUxFVEFdBwIWW1BaIE51bWVyXS5bUFovNi8yMDIwXQcCGFtQcm9kdWt0IEtvZF0uW0tPUkFfUzgwXQcCFltQWiBOdW1lcl0uW1BaLzYvMjAyMF0HAhtbUHJvZHVrdCBLb2RdLltOT8W7WUNFX0VMLl0HAhZbUFogTnVtZXJdLltQWi82LzIwMjBdBwIXW1Byb2R1a3QgS29kXS5bVFVKRV8zTF0HAhZbUFogTnVtZXJdLltQWi82LzIwMjBdBwIYW1Byb2R1a3QgS29kXS5bWklFTUlBXzVdBwIWW1BaIE51bWVyXS5bUFovNi8yMDIxXQcCGVtQcm9kdWt0IEtvZF0uW0pBQsWBT05JRV0HAhZbUFogTnVtZXJdLltQWi83LzIwMjBdBwIYW1Byb2R1a3QgS29kXS5bS09SQV9TODBdBwIWW1BaIE51bWVyXS5bUFovNy8yMDIwXQcCGFtQcm9kdWt0IEtvZF0uW1pJRU1JQV81XQcCFltQWiBOdW1lcl0uW1BaLzcvMjAyMV0HAhdbUHJvZHVrdCBLb2RdLltUVUpFXzNMXQcCFltQWiBOdW1lcl0uW1BaLzgvMjAyMF0HAh5bUHJvZHVrdCBLb2RdLltHUkFCSUVfTEnFmkNJRV0HAhZbUFogTnVtZXJdLltQWi84LzIwMjBdBwIaW1Byb2R1a3QgS29kXS5bR1JBQklFX09HUl0HAhZbUFogTnVtZXJdLltQWi84LzIwMjBdBwIXW1Byb2R1a3QgS29kXS5bU1pQQURFTF0HAhZbUFogTnVtZXJdLltQWi84LzIwMjFdBwIXW1Byb2R1a3QgS29kXS5bVFVKRV8zTF0HAhZbUFogTnVtZXJdLltQWi85LzIwMjBdBwIZW1Byb2R1a3QgS29kXS5bSkFCxYFPTklFXQcCFltQWiBOdW1lcl0uW1BaLzkvMjAyMF0HAhlbUHJvZHVrdCBLb2RdLltSw5PFu0FfUE5dBwIWW1BaIE51bWVyXS5bUFovOS8yMDIwXQcCFltQcm9kdWt0IEtvZF0uW1NUT0pBS10HAhZbUFogTnVtZXJdLltQWi85LzIwMjFdBwIUW1Byb2R1a3QgS29kXS5bVEVTVF0=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Baza Firmowa"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="PZ Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="PZ Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="PZ Wartość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Magazyn Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="WZ Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="WZ Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="WZ Wartość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Dni na Magazynie"&gt;&lt;cells fontName="Segoe UI" fontSize="8" horzAlignment="Far" format="n0" /&gt;&lt;header fontName="Segoe UI" fontSize="8" horzAlignment="Near" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Near" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="PZ Ilość" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="PZ Wartość" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="WZ Ilość" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="WZ Wartość" index="3" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Dni na Magazynie" index="4" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="PZ Numer" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Produkt Kod" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="WZ Numer" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Baza Firmowa" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;filter fieldName="Magazyn Kod" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport umożliwia analizę dokumentów PZ wraz z dokumentami WZ, które ściągają z magazynu towary z założonych przez nie dostaw. Miara "Dni na magazynie" prezentuje liczbę dni między datą operacji z dokumentu PZ, a datą operacji z dokumentu WZ.</a:description><a:id>273</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.33 Analiza PZ z wydaniami towaru</a:mainLinkName><a:modifiedOn>2025-04-14T12:15:10.43</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2022-05-12T10:58:19.16</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Kurierów&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @select3 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr &#xD;
FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.KnA_WartoscTxt,'','',''.'') ELSE ATR.KnA_WartoscTxt END &#xD;
        END    &#xD;
        FROM CDN.KntAtrybuty ATR &#xD;
        JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
        WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']' &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(OdbAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Odbiorca Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.DAt_WartoscTxt,'','',''.'') ELSE ATR.DAt_WartoscTxt END &#xD;
        END&#xD;
        FROM CDN.DokAtrybuty ATR &#xD;
        JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
        WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max), @atrybutyTwr2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
SET @atrybutyTwr2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyTwr2 = @atrybutyTwr2 + N', ''(NIEPRZYPISANE)'' [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max), @atrybutyPoz2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TrA_DeAId FROM CDN.TraElemAtr WHERE TrA_TrEId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TrA_TrEId INTO #tmpPozAtr FROM CDN.TraElemAtr&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
SET @atrybutyPoz2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpPozAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpPozAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TrA_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TrA_Wartosc,'','',''.'') ELSE ATR.TrA_Wartosc END &#xD;
        END  &#xD;
        FROM CDN.TraElemAtr ATR &#xD;
        JOIN #tmpPozAtr TM ON ATR.TrA_TrEId = TM.TrA_TrEId&#xD;
        WHERE ATR.TrA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', ISNULL(PozAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyPoz2 = @atrybutyPoz2 + N', ''(NIEPRZYPISANE)'' [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, &#xD;
  CASE &#xD;
     WHEN DDf_Numeracja like '@rejestr%' THEN 5&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
    END  [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'SELECT&#xD;
    BAZ.Baz_Nazwa AS [Baza Firmowa],&#xD;
    CASE SZL_TypKuriera&#xD;
        WHEN 2 THEN ''DPD''&#xD;
        WHEN 3 THEN ''DHL''&#xD;
        WHEN 4 THEN ''Poczta Polska''&#xD;
        WHEN 5 THEN ''InPost Paczkomaty''&#xD;
        WHEN 6 THEN ''InPost Allegro''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Kurier Nazwa],&#xD;
    SZL_NumerPelny AS [Dokument ZNP Numer],&#xD;
    ISNULL(NULLIF(SZL_Uwagi, ''''), ''(BRAK)'') [Dokument ZNP Uwagi],&#xD;
    CASE&#xD;
        WHEN SZL_Bufor = 0 THEN ''Wysłane''&#xD;
        WHEN SZL_Bufor = 1 THEN ''Niewysłane''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Dokument ZNP Status],&#xD;
    ISNULL(NULLIF(SZL_Status, ''''), ''(BRAK)'') AS [Dokument ZNP Status Przesyłki],&#xD;
    ISNULL(NULLIF(SZL_NumerProtokoluOdbioru, ''''), ''(BRAK)'') AS [Dokument ZNP Nr Protokołu],&#xD;
    ISNULL(NULLIF(SZL_NumerZleceniaOdbioru, ''''), ''(BRAK)'') AS [Dokument ZNP Nr Zlecenia Odbioru],&#xD;
    ISNULL(NULLIF(SZL_ReferencjeTekst, ''''), ''(BRAK)'') AS [Dokument ZNP Referencje],&#xD;
    CASE &#xD;
        WHEN SZL_DokumentyZwrotne = 1 THEN ISNULL(NULLIF(SZL_DokumentyZwrotneTekst, ''''), ''(BRAK)'')&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Dokument ZNP Dokumenty Zwrotne],&#xD;
    SZL_NumerPelny AS [Liczba Dokumentów ZNP],&#xD;
    SAN_Kod AS [Nadawca Kod],&#xD;
    SZL_SANNazwa AS [Nadawca Nazwa],&#xD;
    ''ul. '' + ISNULL(NULLIF(SZL_SANUlica, ''''), ''(BRAK)'') +  '' '' + ISNULL(NULLIF(SZL_SANNrDomu, ''''), ''(BRAK)'') + CASE SZL_SANNrLokalu WHEN '''' THEN '''' ELSE ''/'' + SZL_SANNrLokalu END AS [Nadawca Adres],&#xD;
    ISNULL(NULLIF(SZL_SANMiasto, ''''), ''(BRAK)'') AS [Nadawca Miasto],&#xD;
    ISNULL(NULLIF(SZL_SANKodPocztowy, ''''), ''(BRAK)'') AS [Nadawca Kod Pocztowy],&#xD;
    CASE SZL_OpiekunTyp&#xD;
        WHEN 3 THEN Opiekun.PRI_Kod&#xD;
        WHEN 8 THEN SZL_OpeModKod&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Nadawca Opiekun Kod],&#xD;
    ISNULL(NULLIF(SZL_OpiekunNazwa, ''''), ''(BRAK)'') AS [Nadawca Osoba Kontaktowa],&#xD;
    CASE &#xD;
        WHEN SZL_OdbiorcaTyp = 1 THEN ISNULL(NULLIF(Knt_Kod, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 2 THEN ISNULL(NULLIF(BNa_Akronim, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 3 THEN ISNULL(NULLIF(Odbiorca.PRI_Kod, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 5 THEN ISNULL(NULLIF(Urz_Akronim, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp IS NULL THEN ''(BRAK)''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Obiorca Kod],&#xD;
    ISNULL(NULLIF(SZL_OdbNazwa, ''''), ''(BRAK)'') AS [Odbiorca Nazwa],&#xD;
    ''ul. '' + ISNULL(NULLIF(SZL_OdbUlica, ''''), ''(BRAK)'') +  '' '' + ISNULL(NULLIF(SZL_OdbNrDomu, ''''), ''(BRAK)'') + CASE SZL_OdbNrLokalu WHEN '''' THEN '''' ELSE ''/'' + SZL_OdbNrLokalu END AS [Odbiorca Adres],&#xD;
    ISNULL(NULLIF(SZL_OdbMiasto, ''''), ''(BRAK)'') AS [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(SZL_OdbKodPocztowy, ''''), ''(BRAK)'') AS [Odbiorca Kod Pocztowy],&#xD;
    ISNULL(NULLIF(SZL_Odebral, ''''), ''(BRAK)'') AS [Odbiorca Osoba Kontaktowa],&#xD;
    CASE &#xD;
        WHEN SPA_SPAID IS NULL THEN ''(BRAK)''&#xD;
        ELSE SZL_NumerPelny + ''-'' + CONVERT(VARCHAR, SPA_SPAID)&#xD;
    END AS [Paczka Numer],&#xD;
    CASE &#xD;
        WHEN SZL_TypKuriera = 2 THEN ISNULL(NULLIF(SPA_Zawartosc, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_TypKuriera IN (3, 4) THEN ISNULL(NULLIF(SZL_ZawartoscTekst, ''''), ''(BRAK)'')&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Paczka Zawartość],&#xD;
    ISNULL(NULLIF(SPA_NumerListu, ''''), ''(BRAK)'') AS [Paczka Nr Listu Przewozowego],&#xD;
    CASE &#xD;
        WHEN SZL_TypKuriera IN (2, 3) THEN &#xD;
            CASE &#xD;
                WHEN SPA_SposobPakowaniaKey = 0 THEN ''Standardowa''&#xD;
                WHEN SPA_SposobPakowaniaKey = 1 THEN ''Kopertowa''&#xD;
                WHEN SPA_SposobPakowaniaKey = 2 THEN ''Paletowa''&#xD;
                WHEN SPA_SposobPakowaniaKey IS NULL THEN ''(BRAK)''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 6 THEN &#xD;
            CASE SPA_SposobPakowaniaKey&#xD;
                WHEN 0 THEN ''Paczkomaty 24/7''&#xD;
                WHEN 1 THEN ''miniKurier24''&#xD;
                WHEN 2 THEN ''Kurier24''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 THEN &#xD;
            CASE SPA_SposobPakowaniaKey&#xD;
                WHEN 0 THEN ''Pocztex''&#xD;
                WHEN 1 THEN ''Pocztex Kurier 48''&#xD;
                WHEN 2 THEN ''Usługa paczkowa''&#xD;
                WHEN 3 THEN ''Paczka pocztowa''&#xD;
                WHEN 4 THEN ''Przesyłka polecona''&#xD;
                WHEN 5 THEN ''Przesyłka firmowa polecona''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Paczka Rodzaj],&#xD;
    CASE &#xD;
        WHEN SZL_OpcjePobranie = 1 THEN SZL_OpcjeKwotaPobrania / COUNT(SZL_NumerPelny) OVER(PARTITION BY SZL_NumerPelny)&#xD;
        ELSE NULL&#xD;
    END AS [Paczka Kwota Pobrania],&#xD;
    CASE&#xD;
        WHEN SZL_TypKuriera IN (2, 3, 5, 6) THEN &#xD;
            CASE &#xD;
                WHEN SZL_OpcjeUbezpieczenie = 1 THEN SZL_OpcjeKwotaUbezpieczenia / COUNT(SZL_NumerPelny) OVER(PARTITION BY SZL_NumerPelny)&#xD;
                ELSE NULL&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 THEN NULLIF(SPA_DeklarowanaWartosc, 0)&#xD;
        ELSE NULL&#xD;
    END AS [Paczka Deklarowana Wartość],&#xD;
    CASE&#xD;
        WHEN SZL_TypKuriera IN (2, 3, 5, 6) THEN &#xD;
            CASE &#xD;
                WHEN SZL_OpcjeUbezpieczenie = 1 THEN SZL_OpcjeKwotaUbezpieczenia / COUNT(SZL_NumerPelny) OVER(PARTITION BY SZL_NumerPelny)&#xD;
                ELSE NULL&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 THEN NULLIF(SPA_KwotaUbezpieczenia, 0) &#xD;
        ELSE NULL&#xD;
    END AS [Paczka Kwota Ubezpieczenia],&#xD;
    NULLIF(SPA_Waga, 0) AS [Paczka Waga],&#xD;
    NULLIF(SPA_Wysokosc, 0) AS [Paczka Wysokość],&#xD;
    NULLIF(SPA_Dlugosc, 0) AS [Paczka Długość],&#xD;
    NULLIF(SPA_Szerokosc, 0) AS [Paczka Szerokość],&#xD;
    CASE &#xD;
        WHEN SZL_TypKuriera = 4 AND SPA_SposobPakowaniaKey = 1 THEN &#xD;
            CASE SPA_Gabaryt&#xD;
                WHEN 0 THEN ''XS''&#xD;
                WHEN 1 THEN ''S''&#xD;
                WHEN 2 THEN ''M''&#xD;
                WHEN 3 THEN ''L''&#xD;
                WHEN 4 THEN ''XL''&#xD;
                WHEN 5 THEN ''XXL''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 AND SPA_SposobPakowaniaKey = 3 THEN &#xD;
            CASE SPA_Gabaryt&#xD;
                WHEN 0 THEN ''A''&#xD;
                WHEN 1 THEN ''B''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 AND SPA_SposobPakowaniaKey = 4 THEN &#xD;
            CASE SPA_Gabaryt&#xD;
                WHEN 2 THEN ''S''&#xD;
                WHEN 3 THEN ''M''&#xD;
                WHEN 4 THEN ''L''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera IN (5, 6) THEN &#xD;
            CASE SPA_Gabaryt&#xD;
                WHEN 0 THEN ''A''&#xD;
                WHEN 1 THEN ''B''&#xD;
                WHEN 2 THEN ''C''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Paczka Gabaryt],&#xD;
    SPA_SPAID AS [Liczba Paczek],&#xD;
    ISNULL(NULLIF(SZL_UrzadNadaniaKod, ''''), ''(BRAK)'') AS [Punkt Nadania Kod],&#xD;
    ISNULL(NULLIF(SZL_UrzadNadaniaAdres, ''''), ''(BRAK)'') AS [Punkt Nadania Adres],&#xD;
    ISNULL(NULLIF(SZL_OdbiorWPunkcieId, ''''), ''(BRAK)'') AS [Punkt Odbioru Kod],&#xD;
    ISNULL(NULLIF(SZL_OdbiorWPunkcieAdres, ''''), ''(BRAK)'') AS [Punkt Odbioru Adres],&#xD;
    ''(NIEPRZYPISANY)'' AS [Dokument Numer],&#xD;
    ''(NIEPRZYPISANY)'' AS [Produkt Kod], &#xD;
    ''(NIEPRZYPISANY)'' AS [Produkt Nazwa],&#xD;
    ''(NIEPRZYPISANY)'' AS [Kontrahent Kod],&#xD;
    NULL AS [Sprzedaż Wartość Netto],&#xD;
    NULL AS [Sprzedaż Wartość Brutto],&#xD;
    NULL AS [Sprzedaż Ilość], &#xD;
        CASE WHEN DATEDIFF(day, SZL_DataKurierOD, GETDATE()) = 0 THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Dziś],&#xD;
    CASE WHEN DATEDIFF(day, SZL_DataKurierOD, GETDATE() - 1) = 0 THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Wczoraj],&#xD;
    CASE WHEN ((datepart(DY, datediff(d, 0, SZL_DataKurierOD) / 7 * 7 + 3) + 6) / 7 = (datepart(DY, datediff(d, 0, GETDATE()) / 7 * 7 + 3) + 6) / 7) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) &#xD;
        THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Nadania Aktualny Tydzień],&#xD;
    CASE WHEN (MONTH(SZL_DataKurierOD) = MONTH(GETDATE())) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Aktualny Miesiąc],&#xD;
    CASE &#xD;
        WHEN (MONTH(SZL_DataKurierOD) = MONTH(GETDATE())-1) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) THEN ''TAK'' &#xD;
        WHEN ((MONTH(SZL_DataKurierOD) = 12) AND (MONTH(GETDATE()) = 1)) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE()) - 1) THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Nadania Poprzedni Miesiąc],&#xD;
    zal.Ope_Kod [Operator Wprowadzający],&#xD;
    mod.Ope_Kod [Operator Modyfikujący],&#xD;
&#xD;
    /*&#xD;
    ----------DATY POINT&#xD;
    REPLACE(CONVERT(VARCHAR(10), SZL_DataDok, 111), ''/'', ''-'') [Data Wystawienia],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataWyslania, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataKurierOD, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania],&#xD;
    */&#xD;
&#xD;
    ----------DATY ANALIZY&#xD;
    REPLACE(CONVERT(VARCHAR(10), SZL_DataDok, 111), ''/'', ''-'') [Data Wystawienia Dzień],&#xD;
    (DATEPART(DY, DATEDIFF(d, 0, SZL_DataDok) / 7 * 7 + 3)+6) / 7 [Data Wystawienia Tydzień Roku],&#xD;
    MONTH(SZL_DataDok) [Data Wystawienia Miesiąc],&#xD;
    DATEPART(quarter, SZL_DataDok) [Data Wystawienia Kwartał],&#xD;
    YEAR(SZL_DataDok) [Data Wystawienia Rok],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataWyslania, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Dzień],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, (datepart(DY, datediff(d, 0, SZL_DataWyslania) / 7 * 7 + 3) + 6) / 7)&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Tydzień Roku],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, MONTH(SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Miesiąc],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, DATEPART(quarter, SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Kwartał],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, YEAR(SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Rok],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataKurierOD, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Dzień],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, (datepart(DY, datediff(d, 0, SZL_DataKurierOD) / 7 * 7 + 3) + 6) / 7)&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Tydzień Roku],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, MONTH(SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Miesiąc],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, DATEPART(quarter, SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Kwartał],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, YEAR(SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Rok],&#xD;
    GETDATE() [Data Analizy]&#xD;
    &#xD;
    ----------KONTEKSTY&#xD;
    ,30392 [Dokument Numer __PROCID__Sprzedaz__], NULL [Dokument Numer __ORGID__],''' + @bazaFirmowa + ''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], NULL [Kontrahent Kod __ORGID__],''' + @bazaFirmowa + ''' [Kontrahent Kod __DATABASE__]&#xD;
    ,20201 [Odbiorca Nazwa __PROCID__], Odbiorca.PRI_PriId [Odbiorca Nazwa __ORGID__],''' + @bazaFirmowa + ''' [Odbiorca Nazwa __DATABASE__]&#xD;
    ,20201 [Odbiorca Kod __PROCID__], Odbiorca.PRI_PriId [Odbiorca Kod __ORGID__],''' + @bazaFirmowa + ''' [Odbiorca Kod __DATABASE__]&#xD;
    ,30392 [Produkt Nazwa __PROCID__], NULL [Produkt Nazwa __ORGID__],''' + @bazaFirmowa + ''' [Produkt Nazwa __DATABASE__]&#xD;
    ,30392 [Produkt Kod __PROCID__Towary__], NULL [Produkt Kod __ORGID__],''' + @bazaFirmowa + ''' [Produkt Kod __DATABASE__]'&#xD;
&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
&#xD;
set @select2 = &#xD;
' FROM [CDN].[SenditZleceniePrzesylki] &#xD;
LEFT JOIN [CDN].[SenditPaczki] ON SZL_SZLID = SPA_SZLID &#xD;
LEFT JOIN [CDN].[SenditAdresyNadawcze] ON SZL_SANID = SAN_SANID&#xD;
LEFT JOIN ' + @Operatorzy + ' ON SZL_OpiekunId = Ope_OpeID&#xD;
LEFT JOIN [CDN].[PracIdx] Opiekun ON SZL_OpiekunId = Opiekun.PRI_PriId&#xD;
LEFT JOIN [CDN].[Kontrahenci] ON SZL_OdbID = Knt_KntId AND SZL_OdbiorcaTyp = 1&#xD;
LEFT JOIN [CDN].[BnkNazwy] ON SZL_OdbID = BNa_BNaId AND SZL_OdbiorcaTyp = 2&#xD;
LEFT JOIN [CDN].[PracIdx] Odbiorca ON SZL_OdbID = Odbiorca.PRI_PriId AND SZL_OdbiorcaTyp = 3&#xD;
LEFT JOIN [CDN].[Urzedy] ON SZL_OdbID = Urz_UrzId AND SZL_OdbiorcaTyp = 5&#xD;
LEFT JOIN #tmpTwrGr Poz ON 0 = 1&#xD;
LEFT JOIN #tmpTwrAtr TwrAtr ON 0 = 1&#xD;
LEFT JOIN #tmpPozAtr PozAtr ON 0 = 1&#xD;
LEFT JOIN #tmpKonAtr KonAtr ON 0 = 1&#xD;
LEFT JOIN #tmpKonAtr OdbAtr ON 0 = 1&#xD;
LEFT JOIN #tmpDokAtr DokAtr ON 0 = 1&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
LEFT JOIN ' + @Operatorzy + ' zal ON Knt_OpeZalID = zal.Ope_OpeId&#xD;
LEFT JOIN ' + @Operatorzy + ' mod ON Knt_OpeModID = mod.Ope_OpeId&#xD;
&#xD;
UNION ALL&#xD;
&#xD;
SELECT&#xD;
    BAZ.Baz_Nazwa AS [Baza Firmowa],&#xD;
    CASE SZL_TypKuriera&#xD;
        WHEN 2 THEN ''DPD''&#xD;
        WHEN 3 THEN ''DHL''&#xD;
        WHEN 4 THEN ''Poczta Polska''&#xD;
        WHEN 5 THEN ''InPost Paczkomaty''&#xD;
        WHEN 6 THEN ''InPost Allegro''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Kurier Nazwa],&#xD;
    SZL_NumerPelny AS [Dokument ZNP Numer],&#xD;
    ISNULL(NULLIF(SZL_Uwagi, ''''), ''(BRAK)'') [Dokument ZNP Uwagi],&#xD;
    CASE&#xD;
        WHEN SZL_Bufor = 0 THEN ''Wysłane''&#xD;
        WHEN SZL_Bufor = 1 THEN ''Niewysłane''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Dokument ZNP Status],&#xD;
    ISNULL(NULLIF(SZL_Status, ''''), ''(BRAK)'') AS [Dokument ZNP Status Przesyłki],&#xD;
    ISNULL(NULLIF(SZL_NumerProtokoluOdbioru, ''''), ''(BRAK)'') AS [Dokument ZNP Nr Protokołu],&#xD;
    ISNULL(NULLIF(SZL_NumerZleceniaOdbioru, ''''), ''(BRAK)'') AS [Dokument ZNP Nr Zlecenia Odbioru],&#xD;
    ISNULL(NULLIF(SZL_ReferencjeTekst, ''''), ''(BRAK)'') AS [Dokument ZNP Referencje],&#xD;
    CASE &#xD;
        WHEN SZL_DokumentyZwrotne = 1 THEN ISNULL(NULLIF(SZL_DokumentyZwrotneTekst, ''''), ''(BRAK)'')&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Dokument ZNP Dokumenty Zwrotne],&#xD;
    SZL_NumerPelny AS [Liczba Dokumentów ZNP],&#xD;
    SAN_Kod AS [Nadawca Kod],&#xD;
    SZL_SANNazwa AS [Nadawca Nazwa],&#xD;
    ''ul. '' + ISNULL(NULLIF(SZL_SANUlica, ''''), ''(BRAK)'') +  '' '' + ISNULL(NULLIF(SZL_SANNrDomu, ''''), ''(BRAK)'') + CASE SZL_SANNrLokalu WHEN '''' THEN '''' ELSE ''/'' + SZL_SANNrLokalu END AS [Nadawca Adres],&#xD;
    ISNULL(NULLIF(SZL_SANMiasto, ''''), ''(BRAK)'') AS [Nadawca Miasto],&#xD;
    ISNULL(NULLIF(SZL_SANKodPocztowy, ''''), ''(BRAK)'') AS [Nadawca Kod Pocztowy],&#xD;
    CASE SZL_OpiekunTyp&#xD;
        WHEN 3 THEN Opiekun.PRI_Kod&#xD;
        WHEN 8 THEN SZL_OpeModKod&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Nadawca Opiekun Kod],&#xD;
    ISNULL(NULLIF(SZL_OpiekunNazwa, ''''), ''(BRAK)'') AS [Nadawca Osoba Kontaktowa],&#xD;
    CASE &#xD;
        WHEN SZL_OdbiorcaTyp = 1 THEN ISNULL(NULLIF(Knt1.Knt_Kod, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 2 THEN ISNULL(NULLIF(BNa_Akronim, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 3 THEN ISNULL(NULLIF(Odbiorca.PRI_Kod, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 5 THEN ISNULL(NULLIF(Urz_Akronim, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp IS NULL THEN ''(BRAK)''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Obiorca Kod],&#xD;
    ISNULL(NULLIF(SZL_OdbNazwa, ''''), ''(BRAK)'') AS [Odbiorca Nazwa],&#xD;
    ''ul. '' + ISNULL(NULLIF(SZL_OdbUlica, ''''), ''(BRAK)'') +  '' '' + ISNULL(NULLIF(SZL_OdbNrDomu, ''''), ''(BRAK)'') + CASE SZL_OdbNrLokalu WHEN '''' THEN '''' ELSE ''/'' + SZL_OdbNrLokalu END AS [Odbiorca Adres],&#xD;
    ISNULL(NULLIF(SZL_OdbMiasto, ''''), ''(BRAK)'') AS [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(SZL_OdbKodPocztowy, ''''), ''(BRAK)'') AS [Odbiorca Kod Pocztowy],&#xD;
    ISNULL(NULLIF(SZL_Odebral, ''''), ''(BRAK)'') AS [Odbiorca Osoba Kontaktowa],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Numer],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Zawartość],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Nr Listu Przewozowego],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Rodzaj],&#xD;
    NULL AS [Paczka Kwota Pobrania],&#xD;
    NULL AS [Paczka Deklarowana Wartość],&#xD;
    NULL AS [Paczka Kwota Ubezpieczenia],&#xD;
    NULL AS [Paczka Waga],&#xD;
    NULL AS [Paczka Wysokość],&#xD;
    NULL AS [Paczka Długość],&#xD;
    NULL AS [Paczka Szerokość],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Gabaryt],&#xD;
    NULL AS [Liczba Paczek],&#xD;
    ISNULL(NULLIF(SZL_UrzadNadaniaKod, ''''), ''(BRAK)'') AS [Punkt Nadania Kod],&#xD;
    ISNULL(NULLIF(SZL_UrzadNadaniaAdres, ''''), ''(BRAK)'') AS [Punkt Nadania Adres],&#xD;
    ISNULL(NULLIF(SZL_OdbiorWPunkcieId, ''''), ''(BRAK)'') AS [Punkt Odbioru Kod],&#xD;
    ISNULL(NULLIF(SZL_OdbiorWPunkcieAdres, ''''), ''(BRAK)'') AS [Punkt Odbioru Adres],&#xD;
    ISNULL(NULLIF(TrN_NumerPelny, ''''), ''(BRAK)'') AS [Dokument Numer],&#xD;
    Twr_Kod AS [Produkt Kod], &#xD;
    Twr_Nazwa AS [Produkt Nazwa],&#xD;
    Knt2.Knt_Kod AS [Kontrahent Kod],&#xD;
    TrE_WartoscNetto AS [Sprzedaż Wartość Netto], &#xD;
    TrE_WartoscBrutto AS [Sprzedaż Wartość Brutto], &#xD;
    TrE_Ilosc AS [Sprzedaż Ilość], &#xD;
    CASE WHEN DATEDIFF(day, SZL_DataKurierOD, GETDATE()) = 0 THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Dziś],&#xD;
    CASE WHEN DATEDIFF(day, SZL_DataKurierOD, GETDATE() - 1) = 0 THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Wczoraj],&#xD;
    CASE WHEN ((datepart(DY, datediff(d, 0, SZL_DataKurierOD) / 7 * 7 + 3) + 6) / 7 = (datepart(DY, datediff(d, 0, GETDATE()) / 7 * 7 + 3) + 6) / 7) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) &#xD;
        THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Nadania Aktualny Tydzień],&#xD;
    CASE WHEN (MONTH(SZL_DataKurierOD) = MONTH(GETDATE())) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Aktualny Miesiąc],&#xD;
    CASE &#xD;
        WHEN (MONTH(SZL_DataKurierOD) = MONTH(GETDATE())-1) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) THEN ''TAK'' &#xD;
        WHEN ((MONTH(SZL_DataKurierOD) = 12) AND (MONTH(GETDATE()) = 1)) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE()) - 1) THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Nadania Poprzedni Miesiąc],&#xD;
    zal.Ope_Kod [Operator Wprowadzający], &#xD;
    mod.Ope_Kod [Operator Modyfikujący],&#xD;
&#xD;
    /*&#xD;
    ----------DATY POINT&#xD;
    REPLACE(CONVERT(VARCHAR(10), SZL_DataDok, 111), ''/'', ''-'') [Data Wystawienia],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataWyslania, 111), ''/'', ''-''))&#xD;
    END AS [Data Zgłoszenia],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataKurierOD, 111), ''/'', ''-''))&#xD;
    END AS [Data Nadania],&#xD;
    */&#xD;
&#xD;
    ----------DATY ANALIZY&#xD;
    REPLACE(CONVERT(VARCHAR(10), SZL_DataDok, 111), ''/'', ''-'') [Data Wystawienia Dzień],&#xD;
    (DATEPART(DY, DATEDIFF(d, 0, SZL_DataDok) / 7 * 7 + 3)+6) / 7 [Data Wystawienia Tydzień Roku],&#xD;
    MONTH(SZL_DataDok) [Data Wystawienia Miesiąc],&#xD;
    DATEPART(quarter, SZL_DataDok) [Data Wystawienia Kwartał],&#xD;
    YEAR(SZL_DataDok) [Data Wystawienia Rok],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataWyslania, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Dzień],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, (datepart(DY, datediff(d, 0, SZL_DataWyslania) / 7 * 7 + 3) + 6) / 7)&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Tydzień Roku],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, MONTH(SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Miesiąc],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, DATEPART(quarter, SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Kwartał],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, YEAR(SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Rok],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataKurierOD, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Dzień],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, (datepart(DY, datediff(d, 0, SZL_DataKurierOD) / 7 * 7 + 3) + 6) / 7)&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Tydzień Roku],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, MONTH(SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Miesiąc],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, DATEPART(quarter, SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Kwartał],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, YEAR(SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Rok],&#xD;
    GETDATE() [Data Analizy]&#xD;
    &#xD;
    ----------KONTEKSTY&#xD;
    ,30392 [Dokument Numer __PROCID__Sprzedaz__], TrN_TrNId [Dokument Numer __ORGID__],''' + @bazaFirmowa + ''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], Knt2.Knt_KntId [Kontrahent Kod __ORGID__],''' + @bazaFirmowa + ''' [Kontrahent Kod __DATABASE__]&#xD;
    ,20201 [Odbiorca Nazwa __PROCID__], Odbiorca.PRI_PriId [Odbiorca Nazwa __ORGID__],''' + @bazaFirmowa + ''' [Odbiorca Nazwa __DATABASE__]&#xD;
    ,20201 [Odbiorca Kod __PROCID__], Odbiorca.PRI_PriId [Odbiorca Kod __ORGID__],''' + @bazaFirmowa + ''' [Odbiorca Kod __DATABASE__]&#xD;
    ,30392 [Produkt Nazwa __PROCID__], Twr_TwrId [Produkt Nazwa __ORGID__],''' + @bazaFirmowa + ''' [Produkt Nazwa __DATABASE__]&#xD;
    ,30392 [Produkt Kod __PROCID__Towary__], Twr_TwrId [Produkt Kod __ORGID__],''' + @bazaFirmowa + ''' [Produkt Kod __DATABASE__]'&#xD;
&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
&#xD;
set @select3 = &#xD;
' FROM [CDN].[SenditZleceniePrzesylki] &#xD;
LEFT JOIN [CDN].[SenditAdresyNadawcze] ON SZL_SANID = SAN_SANID&#xD;
LEFT JOIN ' + @Operatorzy + ' ON SZL_OpiekunId = Ope_OpeID&#xD;
LEFT JOIN [CDN].[PracIdx] Opiekun ON SZL_OpiekunId = Opiekun.PRI_PriId&#xD;
LEFT JOIN [CDN].[Kontrahenci] Knt1 ON SZL_OdbID = Knt1.Knt_KntId AND SZL_OdbiorcaTyp = 1&#xD;
LEFT JOIN [CDN].[BnkNazwy] ON SZL_OdbID = BNa_BNaId AND SZL_OdbiorcaTyp = 2&#xD;
LEFT JOIN [CDN].[PracIdx] Odbiorca ON SZL_OdbID = Odbiorca.PRI_PriId AND SZL_OdbiorcaTyp = 3&#xD;
LEFT JOIN [CDN].[Urzedy] ON SZL_OdbID = Urz_UrzId AND SZL_OdbiorcaTyp = 5&#xD;
JOIN [CDN].[TraNag] ON TrN_TypDokumentu = SZL_DokZrodloweTyp AND TrN_TrNID = SZL_DokZrodlowe&#xD;
LEFT JOIN [CDN].[TraElem] ON TrE_TrNID = TrN_TrNID&#xD;
LEFT JOIN [CDN].[Towary] ON TrE_TwrId = Twr_TwrId&#xD;
LEFT JOIN [CDN].[Kontrahenci] Knt2 ON TrN_PodID = Knt2.Knt_KntId AND TrN_PodmiotTyp = 1&#xD;
LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId = TwrAtr.TwA_TwrId &#xD;
LEFT JOIN #tmpPozatr PozAtr ON TrE_TrEId = PozAtr.TrA_TrEId&#xD;
LEFT JOIN #tmpKonAtr KonAtr ON TrN_PodID = KonAtr.KnA_PodmiotId AND TrN_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
LEFT JOIN #tmpKonAtr OdbAtr ON SZL_OdbID = OdbAtr.KnA_PodmiotId AND SZL_OdbiorcaTyp = OdbAtr.KnA_PodmiotTyp&#xD;
LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID = DokAtr.DAt_TrNId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
LEFT JOIN ' + @Operatorzy + ' zal ON SZL_OpeZalID = zal.Ope_OpeId&#xD;
LEFT JOIN ' + @Operatorzy + ' mod ON SZL_OpeModID = mod.Ope_OpeId&#xD;
'&#xD;
&#xD;
print (@select + @select2 + @select3)&#xD;
exec (@select + @select2 + @select3)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpPozAtr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+R9xVUaSNnhw1ovX8kGyRfvi+FPVVwm8BXQToPM2XXd7Cy6m9BIS7z9s1IwAideFbTKXNgYEsZmxH4ZxrA6lmE7QgFLq+a2/6vhE78xSUnvDxbs+BsIWWyvH7fGCLkVDMpKg0ciAgY8sLRCTy+3uvFuGg/3PU/oLZvxA4q7nTV/87QZZOcnSY3BHSM/dy29J4Nb7KMfUpBb2A==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kurier Nazwa" caption="Kurier Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Numer" caption="Dokument ZNP Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument ZNP Uwagi" caption="Dokument ZNP Uwagi" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Status" caption="Dokument ZNP Status" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Status Przesyłki" caption="Dokument ZNP Status Przesyłki" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Nr Protokołu" caption="Dokument ZNP Nr Protokołu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Nr Zlecenia Odbioru" caption="Dokument ZNP Nr Zlecenia Odbioru" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Referencje" caption="Dokument ZNP Referencje" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Dokumenty Zwrotne" caption="Dokument ZNP Dokumenty Zwrotne" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Liczba Dokumentów ZNP" caption="Liczba Dokumentów ZNP" type="measure" formatString="n0" aggregate="DistinctCount" /&gt;&#xD;
    &lt;column name="Nadawca Kod" caption="Nadawca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Nazwa" caption="Nadawca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Adres" caption="Nadawca Adres" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Miasto" caption="Nadawca Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Kod Pocztowy" caption="Nadawca Kod Pocztowy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Opiekun Kod" caption="Nadawca Opiekun Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Osoba Kontaktowa" caption="Nadawca Osoba Kontaktowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Obiorca Kod" caption="Obiorca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Nazwa" caption="Odbiorca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Adres" caption="Odbiorca Adres" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Miasto" caption="Odbiorca Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kod Pocztowy" caption="Odbiorca Kod Pocztowy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Osoba Kontaktowa" caption="Odbiorca Osoba Kontaktowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Paczka Numer" caption="Paczka Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Paczka Zawartość" caption="Paczka Zawartość" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Paczka Nr Listu Przewozowego" caption="Paczka Nr Listu Przewozowego" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Paczka Rodzaj" caption="Paczka Rodzaj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Paczka Kwota Pobrania" caption="Paczka Kwota Pobrania" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Paczka Deklarowana Wartość" caption="Paczka Deklarowana Wartość" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Paczka Kwota Ubezpieczenia" caption="Paczka Kwota Ubezpieczenia" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Paczka Waga" caption="Paczka Waga" type="measure" formatString="0.00 kg" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Paczka Wysokość" caption="Paczka Wysokość" type="measure" formatString="0.00 cm" aggregate="Average" /&gt;&#xD;
    &lt;column name="Paczka Długość" caption="Paczka Długość" type="measure" formatString="0.00 cm" aggregate="Average" /&gt;&#xD;
    &lt;column name="Paczka Szerokość" caption="Paczka Szerokość" type="measure" formatString="0.00 cm" aggregate="Average" /&gt;&#xD;
    &lt;column name="Paczka Gabaryt" caption="Paczka Gabaryt" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Liczba Paczek" caption="Liczba Paczek" type="measure" formatString="n0" aggregate="DistinctCount" /&gt;&#xD;
    &lt;column name="Punkt Nadania Kod" caption="Punkt Nadania Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Punkt Nadania Adres" caption="Punkt Nadania Adres" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Punkt Odbioru Kod" caption="Punkt Odbioru Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Punkt Odbioru Adres" caption="Punkt Odbioru Adres" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Brutto" caption="Sprzedaż Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Dzień" caption="Data Zgłoszenia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Tydzień Roku" caption="Data Zgłoszenia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Miesiąc" caption="Data Zgłoszenia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Kwartał" caption="Data Zgłoszenia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Rok" caption="Data Zgłoszenia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Dzień" caption="Data Nadania Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Tydzień Roku" caption="Data Nadania Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Miesiąc" caption="Data Nadania Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Kwartał" caption="Data Nadania Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Rok" caption="Data Nadania Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut FAKTURA ZA USŁUGI BR" caption="Kontrahent Atrybut FAKTURA ZA USŁUGI BR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Atrybut FAKTURA ZA USŁUGI BR" caption="Odbiorca Atrybut FAKTURA ZA USŁUGI BR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut REGION" caption="Dokument Atrybut REGION" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAcAAAAAAAAAAAAAAAAAAAD/////BQAAAAcCFFtLdXJpZXIgTmF6d2FdLltESExdBwIUW0t1cmllciBOYXp3YV0uW0RQRF0HAh9bS3VyaWVyIE5hendhXS5bSW5Qb3N0IEFsbGVncm9dBwIiW0t1cmllciBOYXp3YV0uW0luUG9zdCBQYWN6a29tYXR5XQcCHltLdXJpZXIgTmF6d2FdLltQb2N6dGEgUG9sc2thXQAAAAAAAAAA</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Kurier Nazwa"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Dokument ZNP Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Dokument ZNP Status"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Liczba Dokumentów ZNP"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n0" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Paczka Nr Listu Przewozowego"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Liczba Paczek"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n0" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Data Nadania Dzień"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Nadania Miesiąc"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Nadania Rok"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Liczba Dokumentów ZNP" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Liczba Paczek" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Kurier Nazwa" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Dokument ZNP Numer" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Paczka Nr Listu Przewozowego" index="3" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Data Nadania Dzień" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Dokument ZNP Status" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;filter fieldName="Data Nadania Miesiąc" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;filter fieldName="Data Nadania Rok" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje informacje o liczbie dokumentów ZNP oraz liczbie zawieranych przez nie paczek na podstawie dokumentów zleceń nadania przesyłki w podziale na kurierów. Umożliwia filtrowanie danych według statusu nadania przesyłki.</a:description><a:id>274</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.34 Dokumenty ZNP wg kurierów</a:mainLinkName><a:modifiedOn>2025-04-14T12:14:48.74</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>35</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>1</a:id></a:Context><a:Context><a:id>2</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2022-05-12T11:18:47.73</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Kurierów&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @select3 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr &#xD;
FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.KnA_WartoscTxt,'','',''.'') ELSE ATR.KnA_WartoscTxt END &#xD;
        END    &#xD;
        FROM CDN.KntAtrybuty ATR &#xD;
        JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
        WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']' &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(OdbAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Odbiorca Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.DAt_WartoscTxt,'','',''.'') ELSE ATR.DAt_WartoscTxt END &#xD;
        END&#xD;
        FROM CDN.DokAtrybuty ATR &#xD;
        JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
        WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max), @atrybutyTwr2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
SET @atrybutyTwr2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyTwr2 = @atrybutyTwr2 + N', ''(NIEPRZYPISANE)'' [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max), @atrybutyPoz2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TrA_DeAId FROM CDN.TraElemAtr WHERE TrA_TrEId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TrA_TrEId INTO #tmpPozAtr FROM CDN.TraElemAtr&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
SET @atrybutyPoz2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpPozAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpPozAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TrA_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TrA_Wartosc,'','',''.'') ELSE ATR.TrA_Wartosc END &#xD;
        END  &#xD;
        FROM CDN.TraElemAtr ATR &#xD;
        JOIN #tmpPozAtr TM ON ATR.TrA_TrEId = TM.TrA_TrEId&#xD;
        WHERE ATR.TrA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', ISNULL(PozAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyPoz2 = @atrybutyPoz2 + N', ''(NIEPRZYPISANE)'' [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, &#xD;
  CASE &#xD;
     WHEN DDf_Numeracja like '@rejestr%' THEN 5&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
    END  [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'SELECT&#xD;
    BAZ.Baz_Nazwa AS [Baza Firmowa],&#xD;
    CASE SZL_TypKuriera&#xD;
        WHEN 2 THEN ''DPD''&#xD;
        WHEN 3 THEN ''DHL''&#xD;
        WHEN 4 THEN ''Poczta Polska''&#xD;
        WHEN 5 THEN ''InPost Paczkomaty''&#xD;
        WHEN 6 THEN ''InPost Allegro''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Kurier Nazwa],&#xD;
    SZL_NumerPelny AS [Dokument ZNP Numer],&#xD;
    ISNULL(NULLIF(SZL_Uwagi, ''''), ''(BRAK)'') [Dokument ZNP Uwagi],&#xD;
    CASE&#xD;
        WHEN SZL_Bufor = 0 THEN ''Wysłane''&#xD;
        WHEN SZL_Bufor = 1 THEN ''Niewysłane''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Dokument ZNP Status],&#xD;
    ISNULL(NULLIF(SZL_Status, ''''), ''(BRAK)'') AS [Dokument ZNP Status Przesyłki],&#xD;
    ISNULL(NULLIF(SZL_NumerProtokoluOdbioru, ''''), ''(BRAK)'') AS [Dokument ZNP Nr Protokołu],&#xD;
    ISNULL(NULLIF(SZL_NumerZleceniaOdbioru, ''''), ''(BRAK)'') AS [Dokument ZNP Nr Zlecenia Odbioru],&#xD;
    ISNULL(NULLIF(SZL_ReferencjeTekst, ''''), ''(BRAK)'') AS [Dokument ZNP Referencje],&#xD;
    CASE &#xD;
        WHEN SZL_DokumentyZwrotne = 1 THEN ISNULL(NULLIF(SZL_DokumentyZwrotneTekst, ''''), ''(BRAK)'')&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Dokument ZNP Dokumenty Zwrotne],&#xD;
    SZL_NumerPelny AS [Liczba Dokumentów ZNP],&#xD;
    SAN_Kod AS [Nadawca Kod],&#xD;
    SZL_SANNazwa AS [Nadawca Nazwa],&#xD;
    ''ul. '' + ISNULL(NULLIF(SZL_SANUlica, ''''), ''(BRAK)'') +  '' '' + ISNULL(NULLIF(SZL_SANNrDomu, ''''), ''(BRAK)'') + CASE SZL_SANNrLokalu WHEN '''' THEN '''' ELSE ''/'' + SZL_SANNrLokalu END AS [Nadawca Adres],&#xD;
    ISNULL(NULLIF(SZL_SANMiasto, ''''), ''(BRAK)'') AS [Nadawca Miasto],&#xD;
    ISNULL(NULLIF(SZL_SANKodPocztowy, ''''), ''(BRAK)'') AS [Nadawca Kod Pocztowy],&#xD;
    CASE SZL_OpiekunTyp&#xD;
        WHEN 3 THEN Opiekun.PRI_Kod&#xD;
        WHEN 8 THEN SZL_OpeModKod&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Nadawca Opiekun Kod],&#xD;
    ISNULL(NULLIF(SZL_OpiekunNazwa, ''''), ''(BRAK)'') AS [Nadawca Osoba Kontaktowa],&#xD;
    CASE &#xD;
        WHEN SZL_OdbiorcaTyp = 1 THEN ISNULL(NULLIF(Knt_Kod, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 2 THEN ISNULL(NULLIF(BNa_Akronim, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 3 THEN ISNULL(NULLIF(Odbiorca.PRI_Kod, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 5 THEN ISNULL(NULLIF(Urz_Akronim, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp IS NULL THEN ''(BRAK)''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Obiorca Kod],&#xD;
    ISNULL(NULLIF(SZL_OdbNazwa, ''''), ''(BRAK)'') AS [Odbiorca Nazwa],&#xD;
    ''ul. '' + ISNULL(NULLIF(SZL_OdbUlica, ''''), ''(BRAK)'') +  '' '' + ISNULL(NULLIF(SZL_OdbNrDomu, ''''), ''(BRAK)'') + CASE SZL_OdbNrLokalu WHEN '''' THEN '''' ELSE ''/'' + SZL_OdbNrLokalu END AS [Odbiorca Adres],&#xD;
    ISNULL(NULLIF(SZL_OdbMiasto, ''''), ''(BRAK)'') AS [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(SZL_OdbKodPocztowy, ''''), ''(BRAK)'') AS [Odbiorca Kod Pocztowy],&#xD;
    ISNULL(NULLIF(SZL_Odebral, ''''), ''(BRAK)'') AS [Odbiorca Osoba Kontaktowa],&#xD;
    CASE &#xD;
        WHEN SPA_SPAID IS NULL THEN ''(BRAK)''&#xD;
        ELSE SZL_NumerPelny + ''-'' + CONVERT(VARCHAR, SPA_SPAID)&#xD;
    END AS [Paczka Numer],&#xD;
    CASE &#xD;
        WHEN SZL_TypKuriera = 2 THEN ISNULL(NULLIF(SPA_Zawartosc, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_TypKuriera IN (3, 4) THEN ISNULL(NULLIF(SZL_ZawartoscTekst, ''''), ''(BRAK)'')&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Paczka Zawartość],&#xD;
    ISNULL(NULLIF(SPA_NumerListu, ''''), ''(BRAK)'') AS [Paczka Nr Listu Przewozowego],&#xD;
    CASE &#xD;
        WHEN SZL_TypKuriera IN (2, 3) THEN &#xD;
            CASE &#xD;
                WHEN SPA_SposobPakowaniaKey = 0 THEN ''Standardowa''&#xD;
                WHEN SPA_SposobPakowaniaKey = 1 THEN ''Kopertowa''&#xD;
                WHEN SPA_SposobPakowaniaKey = 2 THEN ''Paletowa''&#xD;
                WHEN SPA_SposobPakowaniaKey IS NULL THEN ''(BRAK)''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 6 THEN &#xD;
            CASE SPA_SposobPakowaniaKey&#xD;
                WHEN 0 THEN ''Paczkomaty 24/7''&#xD;
                WHEN 1 THEN ''miniKurier24''&#xD;
                WHEN 2 THEN ''Kurier24''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 THEN &#xD;
            CASE SPA_SposobPakowaniaKey&#xD;
                WHEN 0 THEN ''Pocztex''&#xD;
                WHEN 1 THEN ''Pocztex Kurier 48''&#xD;
                WHEN 2 THEN ''Usługa paczkowa''&#xD;
                WHEN 3 THEN ''Paczka pocztowa''&#xD;
                WHEN 4 THEN ''Przesyłka polecona''&#xD;
                WHEN 5 THEN ''Przesyłka firmowa polecona''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Paczka Rodzaj],&#xD;
    CASE &#xD;
        WHEN SZL_OpcjePobranie = 1 THEN SZL_OpcjeKwotaPobrania / COUNT(SZL_NumerPelny) OVER(PARTITION BY SZL_NumerPelny)&#xD;
        ELSE NULL&#xD;
    END AS [Paczka Kwota Pobrania],&#xD;
    CASE&#xD;
        WHEN SZL_TypKuriera IN (2, 3, 5, 6) THEN &#xD;
            CASE &#xD;
                WHEN SZL_OpcjeUbezpieczenie = 1 THEN SZL_OpcjeKwotaUbezpieczenia / COUNT(SZL_NumerPelny) OVER(PARTITION BY SZL_NumerPelny)&#xD;
                ELSE NULL&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 THEN NULLIF(SPA_DeklarowanaWartosc, 0)&#xD;
        ELSE NULL&#xD;
    END AS [Paczka Deklarowana Wartość],&#xD;
    CASE&#xD;
        WHEN SZL_TypKuriera IN (2, 3, 5, 6) THEN &#xD;
            CASE &#xD;
                WHEN SZL_OpcjeUbezpieczenie = 1 THEN SZL_OpcjeKwotaUbezpieczenia / COUNT(SZL_NumerPelny) OVER(PARTITION BY SZL_NumerPelny)&#xD;
                ELSE NULL&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 THEN NULLIF(SPA_KwotaUbezpieczenia, 0) &#xD;
        ELSE NULL&#xD;
    END AS [Paczka Kwota Ubezpieczenia],&#xD;
    NULLIF(SPA_Waga, 0) AS [Paczka Waga],&#xD;
    NULLIF(SPA_Wysokosc, 0) AS [Paczka Wysokość],&#xD;
    NULLIF(SPA_Dlugosc, 0) AS [Paczka Długość],&#xD;
    NULLIF(SPA_Szerokosc, 0) AS [Paczka Szerokość],&#xD;
    CASE &#xD;
        WHEN SZL_TypKuriera = 4 AND SPA_SposobPakowaniaKey = 1 THEN &#xD;
            CASE SPA_Gabaryt&#xD;
                WHEN 0 THEN ''XS''&#xD;
                WHEN 1 THEN ''S''&#xD;
                WHEN 2 THEN ''M''&#xD;
                WHEN 3 THEN ''L''&#xD;
                WHEN 4 THEN ''XL''&#xD;
                WHEN 5 THEN ''XXL''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 AND SPA_SposobPakowaniaKey = 3 THEN &#xD;
            CASE SPA_Gabaryt&#xD;
                WHEN 0 THEN ''A''&#xD;
                WHEN 1 THEN ''B''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 AND SPA_SposobPakowaniaKey = 4 THEN &#xD;
            CASE SPA_Gabaryt&#xD;
                WHEN 2 THEN ''S''&#xD;
                WHEN 3 THEN ''M''&#xD;
                WHEN 4 THEN ''L''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera IN (5, 6) THEN &#xD;
            CASE SPA_Gabaryt&#xD;
                WHEN 0 THEN ''A''&#xD;
                WHEN 1 THEN ''B''&#xD;
                WHEN 2 THEN ''C''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Paczka Gabaryt],&#xD;
    SPA_SPAID AS [Liczba Paczek],&#xD;
    ISNULL(NULLIF(SZL_UrzadNadaniaKod, ''''), ''(BRAK)'') AS [Punkt Nadania Kod],&#xD;
    ISNULL(NULLIF(SZL_UrzadNadaniaAdres, ''''), ''(BRAK)'') AS [Punkt Nadania Adres],&#xD;
    ISNULL(NULLIF(SZL_OdbiorWPunkcieId, ''''), ''(BRAK)'') AS [Punkt Odbioru Kod],&#xD;
    ISNULL(NULLIF(SZL_OdbiorWPunkcieAdres, ''''), ''(BRAK)'') AS [Punkt Odbioru Adres],&#xD;
    ''(NIEPRZYPISANY)'' AS [Dokument Numer],&#xD;
    ''(NIEPRZYPISANY)'' AS [Produkt Kod], &#xD;
    ''(NIEPRZYPISANY)'' AS [Produkt Nazwa],&#xD;
    ''(NIEPRZYPISANY)'' AS [Kontrahent Kod],&#xD;
    NULL AS [Sprzedaż Wartość Netto],&#xD;
    NULL AS [Sprzedaż Wartość Brutto],&#xD;
    NULL AS [Sprzedaż Ilość], &#xD;
        CASE WHEN DATEDIFF(day, SZL_DataKurierOD, GETDATE()) = 0 THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Dziś],&#xD;
    CASE WHEN DATEDIFF(day, SZL_DataKurierOD, GETDATE() - 1) = 0 THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Wczoraj],&#xD;
    CASE WHEN ((datepart(DY, datediff(d, 0, SZL_DataKurierOD) / 7 * 7 + 3) + 6) / 7 = (datepart(DY, datediff(d, 0, GETDATE()) / 7 * 7 + 3) + 6) / 7) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) &#xD;
        THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Nadania Aktualny Tydzień],&#xD;
    CASE WHEN (MONTH(SZL_DataKurierOD) = MONTH(GETDATE())) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Aktualny Miesiąc],&#xD;
    CASE &#xD;
        WHEN (MONTH(SZL_DataKurierOD) = MONTH(GETDATE())-1) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) THEN ''TAK'' &#xD;
        WHEN ((MONTH(SZL_DataKurierOD) = 12) AND (MONTH(GETDATE()) = 1)) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE()) - 1) THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Nadania Poprzedni Miesiąc],&#xD;
    zal.Ope_Kod [Operator Wprowadzający],&#xD;
    mod.Ope_Kod [Operator Modyfikujący],&#xD;
&#xD;
    /*&#xD;
    ----------DATY POINT&#xD;
    REPLACE(CONVERT(VARCHAR(10), SZL_DataDok, 111), ''/'', ''-'') [Data Wystawienia],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataWyslania, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataKurierOD, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania],&#xD;
    */&#xD;
&#xD;
    ----------DATY ANALIZY&#xD;
    REPLACE(CONVERT(VARCHAR(10), SZL_DataDok, 111), ''/'', ''-'') [Data Wystawienia Dzień],&#xD;
    (DATEPART(DY, DATEDIFF(d, 0, SZL_DataDok) / 7 * 7 + 3)+6) / 7 [Data Wystawienia Tydzień Roku],&#xD;
    MONTH(SZL_DataDok) [Data Wystawienia Miesiąc],&#xD;
    DATEPART(quarter, SZL_DataDok) [Data Wystawienia Kwartał],&#xD;
    YEAR(SZL_DataDok) [Data Wystawienia Rok],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataWyslania, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Dzień],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, (datepart(DY, datediff(d, 0, SZL_DataWyslania) / 7 * 7 + 3) + 6) / 7)&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Tydzień Roku],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, MONTH(SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Miesiąc],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, DATEPART(quarter, SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Kwartał],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, YEAR(SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Rok],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataKurierOD, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Dzień],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, (datepart(DY, datediff(d, 0, SZL_DataKurierOD) / 7 * 7 + 3) + 6) / 7)&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Tydzień Roku],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, MONTH(SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Miesiąc],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, DATEPART(quarter, SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Kwartał],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, YEAR(SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Rok],&#xD;
    GETDATE() [Data Analizy]&#xD;
    &#xD;
    ----------KONTEKSTY&#xD;
    ,30392 [Dokument Numer __PROCID__Sprzedaz__], NULL [Dokument Numer __ORGID__],''' + @bazaFirmowa + ''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], NULL [Kontrahent Kod __ORGID__],''' + @bazaFirmowa + ''' [Kontrahent Kod __DATABASE__]&#xD;
    ,20201 [Odbiorca Nazwa __PROCID__], Odbiorca.PRI_PriId [Odbiorca Nazwa __ORGID__],''' + @bazaFirmowa + ''' [Odbiorca Nazwa __DATABASE__]&#xD;
    ,20201 [Odbiorca Kod __PROCID__], Odbiorca.PRI_PriId [Odbiorca Kod __ORGID__],''' + @bazaFirmowa + ''' [Odbiorca Kod __DATABASE__]&#xD;
    ,30392 [Produkt Nazwa __PROCID__], NULL [Produkt Nazwa __ORGID__],''' + @bazaFirmowa + ''' [Produkt Nazwa __DATABASE__]&#xD;
    ,30392 [Produkt Kod __PROCID__Towary__], NULL [Produkt Kod __ORGID__],''' + @bazaFirmowa + ''' [Produkt Kod __DATABASE__]'&#xD;
&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
&#xD;
set @select2 = &#xD;
' FROM [CDN].[SenditZleceniePrzesylki] &#xD;
LEFT JOIN [CDN].[SenditPaczki] ON SZL_SZLID = SPA_SZLID &#xD;
LEFT JOIN [CDN].[SenditAdresyNadawcze] ON SZL_SANID = SAN_SANID&#xD;
LEFT JOIN ' + @Operatorzy + ' ON SZL_OpiekunId = Ope_OpeID&#xD;
LEFT JOIN [CDN].[PracIdx] Opiekun ON SZL_OpiekunId = Opiekun.PRI_PriId&#xD;
LEFT JOIN [CDN].[Kontrahenci] ON SZL_OdbID = Knt_KntId AND SZL_OdbiorcaTyp = 1&#xD;
LEFT JOIN [CDN].[BnkNazwy] ON SZL_OdbID = BNa_BNaId AND SZL_OdbiorcaTyp = 2&#xD;
LEFT JOIN [CDN].[PracIdx] Odbiorca ON SZL_OdbID = Odbiorca.PRI_PriId AND SZL_OdbiorcaTyp = 3&#xD;
LEFT JOIN [CDN].[Urzedy] ON SZL_OdbID = Urz_UrzId AND SZL_OdbiorcaTyp = 5&#xD;
LEFT JOIN #tmpTwrGr Poz ON 0 = 1&#xD;
LEFT JOIN #tmpTwrAtr TwrAtr ON 0 = 1&#xD;
LEFT JOIN #tmpPozAtr PozAtr ON 0 = 1&#xD;
LEFT JOIN #tmpKonAtr KonAtr ON 0 = 1&#xD;
LEFT JOIN #tmpKonAtr OdbAtr ON 0 = 1&#xD;
LEFT JOIN #tmpDokAtr DokAtr ON 0 = 1&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
LEFT JOIN ' + @Operatorzy + ' zal ON Knt_OpeZalID = zal.Ope_OpeId&#xD;
LEFT JOIN ' + @Operatorzy + ' mod ON Knt_OpeModID = mod.Ope_OpeId&#xD;
&#xD;
UNION ALL&#xD;
&#xD;
SELECT&#xD;
    BAZ.Baz_Nazwa AS [Baza Firmowa],&#xD;
    CASE SZL_TypKuriera&#xD;
        WHEN 2 THEN ''DPD''&#xD;
        WHEN 3 THEN ''DHL''&#xD;
        WHEN 4 THEN ''Poczta Polska''&#xD;
        WHEN 5 THEN ''InPost Paczkomaty''&#xD;
        WHEN 6 THEN ''InPost Allegro''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Kurier Nazwa],&#xD;
    SZL_NumerPelny AS [Dokument ZNP Numer],&#xD;
    ISNULL(NULLIF(SZL_Uwagi, ''''), ''(BRAK)'') [Dokument ZNP Uwagi],&#xD;
    CASE&#xD;
        WHEN SZL_Bufor = 0 THEN ''Wysłane''&#xD;
        WHEN SZL_Bufor = 1 THEN ''Niewysłane''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Dokument ZNP Status],&#xD;
    ISNULL(NULLIF(SZL_Status, ''''), ''(BRAK)'') AS [Dokument ZNP Status Przesyłki],&#xD;
    ISNULL(NULLIF(SZL_NumerProtokoluOdbioru, ''''), ''(BRAK)'') AS [Dokument ZNP Nr Protokołu],&#xD;
    ISNULL(NULLIF(SZL_NumerZleceniaOdbioru, ''''), ''(BRAK)'') AS [Dokument ZNP Nr Zlecenia Odbioru],&#xD;
    ISNULL(NULLIF(SZL_ReferencjeTekst, ''''), ''(BRAK)'') AS [Dokument ZNP Referencje],&#xD;
    CASE &#xD;
        WHEN SZL_DokumentyZwrotne = 1 THEN ISNULL(NULLIF(SZL_DokumentyZwrotneTekst, ''''), ''(BRAK)'')&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Dokument ZNP Dokumenty Zwrotne],&#xD;
    SZL_NumerPelny AS [Liczba Dokumentów ZNP],&#xD;
    SAN_Kod AS [Nadawca Kod],&#xD;
    SZL_SANNazwa AS [Nadawca Nazwa],&#xD;
    ''ul. '' + ISNULL(NULLIF(SZL_SANUlica, ''''), ''(BRAK)'') +  '' '' + ISNULL(NULLIF(SZL_SANNrDomu, ''''), ''(BRAK)'') + CASE SZL_SANNrLokalu WHEN '''' THEN '''' ELSE ''/'' + SZL_SANNrLokalu END AS [Nadawca Adres],&#xD;
    ISNULL(NULLIF(SZL_SANMiasto, ''''), ''(BRAK)'') AS [Nadawca Miasto],&#xD;
    ISNULL(NULLIF(SZL_SANKodPocztowy, ''''), ''(BRAK)'') AS [Nadawca Kod Pocztowy],&#xD;
    CASE SZL_OpiekunTyp&#xD;
        WHEN 3 THEN Opiekun.PRI_Kod&#xD;
        WHEN 8 THEN SZL_OpeModKod&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Nadawca Opiekun Kod],&#xD;
    ISNULL(NULLIF(SZL_OpiekunNazwa, ''''), ''(BRAK)'') AS [Nadawca Osoba Kontaktowa],&#xD;
    CASE &#xD;
        WHEN SZL_OdbiorcaTyp = 1 THEN ISNULL(NULLIF(Knt1.Knt_Kod, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 2 THEN ISNULL(NULLIF(BNa_Akronim, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 3 THEN ISNULL(NULLIF(Odbiorca.PRI_Kod, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 5 THEN ISNULL(NULLIF(Urz_Akronim, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp IS NULL THEN ''(BRAK)''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Obiorca Kod],&#xD;
    ISNULL(NULLIF(SZL_OdbNazwa, ''''), ''(BRAK)'') AS [Odbiorca Nazwa],&#xD;
    ''ul. '' + ISNULL(NULLIF(SZL_OdbUlica, ''''), ''(BRAK)'') +  '' '' + ISNULL(NULLIF(SZL_OdbNrDomu, ''''), ''(BRAK)'') + CASE SZL_OdbNrLokalu WHEN '''' THEN '''' ELSE ''/'' + SZL_OdbNrLokalu END AS [Odbiorca Adres],&#xD;
    ISNULL(NULLIF(SZL_OdbMiasto, ''''), ''(BRAK)'') AS [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(SZL_OdbKodPocztowy, ''''), ''(BRAK)'') AS [Odbiorca Kod Pocztowy],&#xD;
    ISNULL(NULLIF(SZL_Odebral, ''''), ''(BRAK)'') AS [Odbiorca Osoba Kontaktowa],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Numer],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Zawartość],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Nr Listu Przewozowego],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Rodzaj],&#xD;
    NULL AS [Paczka Kwota Pobrania],&#xD;
    NULL AS [Paczka Deklarowana Wartość],&#xD;
    NULL AS [Paczka Kwota Ubezpieczenia],&#xD;
    NULL AS [Paczka Waga],&#xD;
    NULL AS [Paczka Wysokość],&#xD;
    NULL AS [Paczka Długość],&#xD;
    NULL AS [Paczka Szerokość],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Gabaryt],&#xD;
    NULL AS [Liczba Paczek],&#xD;
    ISNULL(NULLIF(SZL_UrzadNadaniaKod, ''''), ''(BRAK)'') AS [Punkt Nadania Kod],&#xD;
    ISNULL(NULLIF(SZL_UrzadNadaniaAdres, ''''), ''(BRAK)'') AS [Punkt Nadania Adres],&#xD;
    ISNULL(NULLIF(SZL_OdbiorWPunkcieId, ''''), ''(BRAK)'') AS [Punkt Odbioru Kod],&#xD;
    ISNULL(NULLIF(SZL_OdbiorWPunkcieAdres, ''''), ''(BRAK)'') AS [Punkt Odbioru Adres],&#xD;
    ISNULL(NULLIF(TrN_NumerPelny, ''''), ''(BRAK)'') AS [Dokument Numer],&#xD;
    Twr_Kod AS [Produkt Kod], &#xD;
    Twr_Nazwa AS [Produkt Nazwa],&#xD;
    Knt2.Knt_Kod AS [Kontrahent Kod],&#xD;
    TrE_WartoscNetto AS [Sprzedaż Wartość Netto], &#xD;
    TrE_WartoscBrutto AS [Sprzedaż Wartość Brutto], &#xD;
    TrE_Ilosc AS [Sprzedaż Ilość], &#xD;
    CASE WHEN DATEDIFF(day, SZL_DataKurierOD, GETDATE()) = 0 THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Dziś],&#xD;
    CASE WHEN DATEDIFF(day, SZL_DataKurierOD, GETDATE() - 1) = 0 THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Wczoraj],&#xD;
    CASE WHEN ((datepart(DY, datediff(d, 0, SZL_DataKurierOD) / 7 * 7 + 3) + 6) / 7 = (datepart(DY, datediff(d, 0, GETDATE()) / 7 * 7 + 3) + 6) / 7) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) &#xD;
        THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Nadania Aktualny Tydzień],&#xD;
    CASE WHEN (MONTH(SZL_DataKurierOD) = MONTH(GETDATE())) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Aktualny Miesiąc],&#xD;
    CASE &#xD;
        WHEN (MONTH(SZL_DataKurierOD) = MONTH(GETDATE())-1) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) THEN ''TAK'' &#xD;
        WHEN ((MONTH(SZL_DataKurierOD) = 12) AND (MONTH(GETDATE()) = 1)) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE()) - 1) THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Nadania Poprzedni Miesiąc],&#xD;
    zal.Ope_Kod [Operator Wprowadzający], &#xD;
    mod.Ope_Kod [Operator Modyfikujący],&#xD;
&#xD;
    /*&#xD;
    ----------DATY POINT&#xD;
    REPLACE(CONVERT(VARCHAR(10), SZL_DataDok, 111), ''/'', ''-'') [Data Wystawienia],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataWyslania, 111), ''/'', ''-''))&#xD;
    END AS [Data Zgłoszenia],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataKurierOD, 111), ''/'', ''-''))&#xD;
    END AS [Data Nadania],&#xD;
    */&#xD;
&#xD;
    ----------DATY ANALIZY&#xD;
    REPLACE(CONVERT(VARCHAR(10), SZL_DataDok, 111), ''/'', ''-'') [Data Wystawienia Dzień],&#xD;
    (DATEPART(DY, DATEDIFF(d, 0, SZL_DataDok) / 7 * 7 + 3)+6) / 7 [Data Wystawienia Tydzień Roku],&#xD;
    MONTH(SZL_DataDok) [Data Wystawienia Miesiąc],&#xD;
    DATEPART(quarter, SZL_DataDok) [Data Wystawienia Kwartał],&#xD;
    YEAR(SZL_DataDok) [Data Wystawienia Rok],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataWyslania, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Dzień],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, (datepart(DY, datediff(d, 0, SZL_DataWyslania) / 7 * 7 + 3) + 6) / 7)&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Tydzień Roku],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, MONTH(SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Miesiąc],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, DATEPART(quarter, SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Kwartał],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, YEAR(SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Rok],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataKurierOD, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Dzień],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, (datepart(DY, datediff(d, 0, SZL_DataKurierOD) / 7 * 7 + 3) + 6) / 7)&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Tydzień Roku],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, MONTH(SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Miesiąc],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, DATEPART(quarter, SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Kwartał],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, YEAR(SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Rok],&#xD;
    GETDATE() [Data Analizy]&#xD;
    &#xD;
    ----------KONTEKSTY&#xD;
    ,30392 [Dokument Numer __PROCID__Sprzedaz__], TrN_TrNId [Dokument Numer __ORGID__],''' + @bazaFirmowa + ''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], Knt2.Knt_KntId [Kontrahent Kod __ORGID__],''' + @bazaFirmowa + ''' [Kontrahent Kod __DATABASE__]&#xD;
    ,20201 [Odbiorca Nazwa __PROCID__], Odbiorca.PRI_PriId [Odbiorca Nazwa __ORGID__],''' + @bazaFirmowa + ''' [Odbiorca Nazwa __DATABASE__]&#xD;
    ,20201 [Odbiorca Kod __PROCID__], Odbiorca.PRI_PriId [Odbiorca Kod __ORGID__],''' + @bazaFirmowa + ''' [Odbiorca Kod __DATABASE__]&#xD;
    ,30392 [Produkt Nazwa __PROCID__], Twr_TwrId [Produkt Nazwa __ORGID__],''' + @bazaFirmowa + ''' [Produkt Nazwa __DATABASE__]&#xD;
    ,30392 [Produkt Kod __PROCID__Towary__], Twr_TwrId [Produkt Kod __ORGID__],''' + @bazaFirmowa + ''' [Produkt Kod __DATABASE__]'&#xD;
&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
&#xD;
set @select3 = &#xD;
' FROM [CDN].[SenditZleceniePrzesylki] &#xD;
LEFT JOIN [CDN].[SenditAdresyNadawcze] ON SZL_SANID = SAN_SANID&#xD;
LEFT JOIN ' + @Operatorzy + ' ON SZL_OpiekunId = Ope_OpeID&#xD;
LEFT JOIN [CDN].[PracIdx] Opiekun ON SZL_OpiekunId = Opiekun.PRI_PriId&#xD;
LEFT JOIN [CDN].[Kontrahenci] Knt1 ON SZL_OdbID = Knt1.Knt_KntId AND SZL_OdbiorcaTyp = 1&#xD;
LEFT JOIN [CDN].[BnkNazwy] ON SZL_OdbID = BNa_BNaId AND SZL_OdbiorcaTyp = 2&#xD;
LEFT JOIN [CDN].[PracIdx] Odbiorca ON SZL_OdbID = Odbiorca.PRI_PriId AND SZL_OdbiorcaTyp = 3&#xD;
LEFT JOIN [CDN].[Urzedy] ON SZL_OdbID = Urz_UrzId AND SZL_OdbiorcaTyp = 5&#xD;
JOIN [CDN].[TraNag] ON TrN_TypDokumentu = SZL_DokZrodloweTyp AND TrN_TrNID = SZL_DokZrodlowe&#xD;
LEFT JOIN [CDN].[TraElem] ON TrE_TrNID = TrN_TrNID&#xD;
LEFT JOIN [CDN].[Towary] ON TrE_TwrId = Twr_TwrId&#xD;
LEFT JOIN [CDN].[Kontrahenci] Knt2 ON TrN_PodID = Knt2.Knt_KntId AND TrN_PodmiotTyp = 1&#xD;
LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId = TwrAtr.TwA_TwrId &#xD;
LEFT JOIN #tmpPozatr PozAtr ON TrE_TrEId = PozAtr.TrA_TrEId&#xD;
LEFT JOIN #tmpKonAtr KonAtr ON TrN_PodID = KonAtr.KnA_PodmiotId AND TrN_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
LEFT JOIN #tmpKonAtr OdbAtr ON SZL_OdbID = OdbAtr.KnA_PodmiotId AND SZL_OdbiorcaTyp = OdbAtr.KnA_PodmiotTyp&#xD;
LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID = DokAtr.DAt_TrNId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
LEFT JOIN ' + @Operatorzy + ' zal ON SZL_OpeZalID = zal.Ope_OpeId&#xD;
LEFT JOIN ' + @Operatorzy + ' mod ON SZL_OpeModID = mod.Ope_OpeId&#xD;
'&#xD;
&#xD;
print (@select + @select2 + @select3)&#xD;
exec (@select + @select2 + @select3)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpPozAtr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+QsC2y3GHJhH55HeBqlCrHb9QG1qA3KejTfRyN5xUgW6wwWBUFA3ybCtag2Wjg/A4SVNXZiGvCdNgY8gDj9/YzbEmpfugheHyr0WkN3be986TiU3x/iEcK/0fhk3SWB3uMV1YNDUiYU194O0A4YlM2D9Qu0zW/tgvLTL40SHElAAzfMNH+MSMKZgTfuVMmTK/Izu4khx1Y1uQ==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kurier Nazwa" caption="Kurier Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Numer" caption="Dokument ZNP Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument ZNP Uwagi" caption="Dokument ZNP Uwagi" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Status" caption="Dokument ZNP Status" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Status Przesyłki" caption="Dokument ZNP Status Przesyłki" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Nr Protokołu" caption="Dokument ZNP Nr Protokołu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Nr Zlecenia Odbioru" caption="Dokument ZNP Nr Zlecenia Odbioru" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Referencje" caption="Dokument ZNP Referencje" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Dokumenty Zwrotne" caption="Dokument ZNP Dokumenty Zwrotne" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Liczba Dokumentów ZNP" caption="Liczba Dokumentów ZNP" type="measure" formatString="n0" aggregate="DistinctCount" /&gt;&#xD;
    &lt;column name="Nadawca Kod" caption="Nadawca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Nazwa" caption="Nadawca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Adres" caption="Nadawca Adres" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Miasto" caption="Nadawca Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Kod Pocztowy" caption="Nadawca Kod Pocztowy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Opiekun Kod" caption="Nadawca Opiekun Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Osoba Kontaktowa" caption="Nadawca Osoba Kontaktowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Obiorca Kod" caption="Obiorca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Nazwa" caption="Odbiorca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Adres" caption="Odbiorca Adres" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Miasto" caption="Odbiorca Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kod Pocztowy" caption="Odbiorca Kod Pocztowy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Osoba Kontaktowa" caption="Odbiorca Osoba Kontaktowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Paczka Numer" caption="Paczka Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Paczka Zawartość" caption="Paczka Zawartość" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Paczka Nr Listu Przewozowego" caption="Paczka Nr Listu Przewozowego" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Paczka Rodzaj" caption="Paczka Rodzaj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Paczka Kwota Pobrania" caption="Paczka Kwota Pobrania" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Paczka Deklarowana Wartość" caption="Paczka Deklarowana Wartość" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Paczka Kwota Ubezpieczenia" caption="Paczka Kwota Ubezpieczenia" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Paczka Waga" caption="Paczka Waga" type="measure" formatString="0.00 kg" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Paczka Wysokość" caption="Paczka Wysokość" type="measure" formatString="0.00 cm" aggregate="Average" /&gt;&#xD;
    &lt;column name="Paczka Długość" caption="Paczka Długość" type="measure" formatString="0.00 cm" aggregate="Average" /&gt;&#xD;
    &lt;column name="Paczka Szerokość" caption="Paczka Szerokość" type="measure" formatString="0.00 cm" aggregate="Average" /&gt;&#xD;
    &lt;column name="Paczka Gabaryt" caption="Paczka Gabaryt" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Liczba Paczek" caption="Liczba Paczek" type="measure" formatString="n0" aggregate="DistinctCount" /&gt;&#xD;
    &lt;column name="Punkt Nadania Kod" caption="Punkt Nadania Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Punkt Nadania Adres" caption="Punkt Nadania Adres" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Punkt Odbioru Kod" caption="Punkt Odbioru Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Punkt Odbioru Adres" caption="Punkt Odbioru Adres" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Brutto" caption="Sprzedaż Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Dzień" caption="Data Zgłoszenia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Tydzień Roku" caption="Data Zgłoszenia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Miesiąc" caption="Data Zgłoszenia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Kwartał" caption="Data Zgłoszenia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Rok" caption="Data Zgłoszenia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Dzień" caption="Data Nadania Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Tydzień Roku" caption="Data Nadania Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Miesiąc" caption="Data Nadania Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Kwartał" caption="Data Nadania Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Rok" caption="Data Nadania Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut FAKTURA ZA USŁUGI BR" caption="Kontrahent Atrybut FAKTURA ZA USŁUGI BR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Atrybut FAKTURA ZA USŁUGI BR" caption="Odbiorca Atrybut FAKTURA ZA USŁUGI BR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut REGION" caption="Dokument Atrybut REGION" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAkAAAAJAAAABwIhW0Rva3VtZW50IFpOUCBOdW1lcl0uW1pOUC8xLzIwMjJdBwIiW0Rva3VtZW50IFpOUCBOdW1lcl0uW1pOUC8xMS8yMDIyXQcCIltEb2t1bWVudCBaTlAgTnVtZXJdLltaTlAvMTMvMjAyMl0HAiFbRG9rdW1lbnQgWk5QIE51bWVyXS5bWk5QLzIvMjAyMl0HAiJbRG9rdW1lbnQgWk5QIE51bWVyXS5bWk5QLzIwLzIwMjJdBwIiW0Rva3VtZW50IFpOUCBOdW1lcl0uW1pOUC8yMS8yMDIyXQcCIVtEb2t1bWVudCBaTlAgTnVtZXJdLltaTlAvNC8yMDIyXQcCIVtEb2t1bWVudCBaTlAgTnVtZXJdLltaTlAvNy8yMDIyXQcCIVtEb2t1bWVudCBaTlAgTnVtZXJdLltaTlAvOC8yMDIyXQAAAAAAAAAAAAAAAP////8AAAAADwAAAAcCIVtEb2t1bWVudCBaTlAgTnVtZXJdLltaTlAvMS8yMDIyXQcCHVtQYWN6a2EgTnVtZXJdLltaTlAvMS8yMDIyLTFdBwIhW0Rva3VtZW50IFpOUCBOdW1lcl0uW1pOUC8xLzIwMjJdBwIdW1BhY3prYSBOdW1lcl0uW1pOUC8xLzIwMjItMl0HAiJbRG9rdW1lbnQgWk5QIE51bWVyXS5bWk5QLzExLzIwMjJdBwIfW1BhY3prYSBOdW1lcl0uW1pOUC8xMS8yMDIyLTE0XQcCIltEb2t1bWVudCBaTlAgTnVtZXJdLltaTlAvMTMvMjAyMl0HAh9bUGFjemthIE51bWVyXS5bWk5QLzEzLzIwMjItMjNdBwIhW0Rva3VtZW50IFpOUCBOdW1lcl0uW1pOUC8yLzIwMjJdBwIdW1BhY3prYSBOdW1lcl0uW1pOUC8yLzIwMjItM10HAiFbRG9rdW1lbnQgWk5QIE51bWVyXS5bWk5QLzIvMjAyMl0HAh1bUGFjemthIE51bWVyXS5bWk5QLzIvMjAyMi03XQcCIVtEb2t1bWVudCBaTlAgTnVtZXJdLltaTlAvMi8yMDIyXQcCHVtQYWN6a2EgTnVtZXJdLltaTlAvMi8yMDIyLThdBwIhW0Rva3VtZW50IFpOUCBOdW1lcl0uW1pOUC8yLzIwMjJdBwIdW1BhY3prYSBOdW1lcl0uW1pOUC8yLzIwMjItOV0HAiJbRG9rdW1lbnQgWk5QIE51bWVyXS5bWk5QLzIwLzIwMjJdBwIfW1BhY3prYSBOdW1lcl0uW1pOUC8yMC8yMDIyLTI4XQcCIltEb2t1bWVudCBaTlAgTnVtZXJdLltaTlAvMjAvMjAyMl0HAh9bUGFjemthIE51bWVyXS5bWk5QLzIwLzIwMjItMjldBwIiW0Rva3VtZW50IFpOUCBOdW1lcl0uW1pOUC8yMC8yMDIyXQcCH1tQYWN6a2EgTnVtZXJdLltaTlAvMjAvMjAyMi0zMF0HAiJbRG9rdW1lbnQgWk5QIE51bWVyXS5bWk5QLzIxLzIwMjJdBwIfW1BhY3prYSBOdW1lcl0uW1pOUC8yMS8yMDIyLTMxXQcCIVtEb2t1bWVudCBaTlAgTnVtZXJdLltaTlAvNC8yMDIyXQcCHVtQYWN6a2EgTnVtZXJdLltaTlAvNC8yMDIyLTVdBwIhW0Rva3VtZW50IFpOUCBOdW1lcl0uW1pOUC83LzIwMjJdBwIeW1BhY3prYSBOdW1lcl0uW1pOUC83LzIwMjItMjBdBwIhW0Rva3VtZW50IFpOUCBOdW1lcl0uW1pOUC84LzIwMjJdBwIeW1BhY3prYSBOdW1lcl0uW1pOUC84LzIwMjItMTFdAAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Kurier Nazwa"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Dokument ZNP Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Paczka Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Paczka Zawartość"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Paczka Nr Listu Przewozowego"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Paczka Rodzaj"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Paczka Deklarowana Wartość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Paczka Kwota Ubezpieczenia"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Paczka Waga"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="0.00 kg" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Paczka Gabaryt"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Liczba Paczek"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n0" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Czas Nadania Aktualny Miesiąc"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Paczka Deklarowana Wartość" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Paczka Kwota Ubezpieczenia" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Paczka Waga" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Liczba Paczek" index="3" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Dokument ZNP Numer" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Paczka Numer" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Paczka Zawartość" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Paczka Nr Listu Przewozowego" index="4" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Paczka Gabaryt" index="3" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Kurier Nazwa" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;filter fieldName="Paczka Rodzaj" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;filter fieldName="Czas Nadania Aktualny Miesiąc" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&lt;included&gt;&lt;value uniqueName="TAK" /&gt;&lt;/included&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport zawiera informacje na temat paczek z dokumentów zleceń nadania przesyłki. Prezentuje parametry paczek oraz ich deklarowaną wartość. Domyślne filtrowanie do przesyłek nadanych w aktualnym miesiącu. Wartości prezentowane są w walucie systemowej.</a:description><a:id>275</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.35 Analiza paczek z dokumentów ZNP</a:mainLinkName><a:modifiedOn>2025-04-14T12:14:27.683</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>35</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2022-05-12T11:26:03.573</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Kurierów&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @select3 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr &#xD;
FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.KnA_WartoscTxt,'','',''.'') ELSE ATR.KnA_WartoscTxt END &#xD;
        END    &#xD;
        FROM CDN.KntAtrybuty ATR &#xD;
        JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
        WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']' &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(OdbAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Odbiorca Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Dokumentów&#xD;
DECLARE @atrybutyDok varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT DAt_DeAid FROM CDN.DokAtrybuty WHERE DAt_TrNId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT DAt_TrNId INTO #tmpDokAtr FROM CDN.DokAtrybuty&#xD;
&#xD;
SET @atrybutyDok = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpDokAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpDokAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.DAt_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.DAt_WartoscTxt,'','',''.'') ELSE ATR.DAt_WartoscTxt END &#xD;
        END&#xD;
        FROM CDN.DokAtrybuty ATR &#xD;
        JOIN #tmpDokAtr TM ON ATR.DAt_TrNId = TM.DAt_TrNId &#xD;
        WHERE ATR.DAt_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyDok = @atrybutyDok + N', ISNULL(DokAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Dokument Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max), @atrybutyTwr2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
SET @atrybutyTwr2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END  &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyTwr2 = @atrybutyTwr2 + N', ''(NIEPRZYPISANE)'' [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Pozycji&#xD;
DECLARE @atrybutyPoz varchar(max), @atrybutyPoz2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TrA_DeAId FROM CDN.TraElemAtr WHERE TrA_TrEId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TrA_TrEId INTO #tmpPozAtr FROM CDN.TraElemAtr&#xD;
&#xD;
SET @atrybutyPoz = ''&#xD;
SET @atrybutyPoz2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpPozAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpPozAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TrA_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TrA_Wartosc,'','',''.'') ELSE ATR.TrA_Wartosc END &#xD;
        END  &#xD;
        FROM CDN.TraElemAtr ATR &#xD;
        JOIN #tmpPozAtr TM ON ATR.TrA_TrEId = TM.TrA_TrEId&#xD;
        WHERE ATR.TrA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyPoz = @atrybutyPoz + N', ISNULL(PozAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyPoz2 = @atrybutyPoz2 + N', ''(NIEPRZYPISANE)'' [Pozycja Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Połączenie do tabeli operatorów&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, &#xD;
  CASE &#xD;
     WHEN DDf_Numeracja like '@rejestr%' THEN 5&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
     WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
    END  [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'SELECT&#xD;
    BAZ.Baz_Nazwa AS [Baza Firmowa],&#xD;
    CASE SZL_TypKuriera&#xD;
        WHEN 2 THEN ''DPD''&#xD;
        WHEN 3 THEN ''DHL''&#xD;
        WHEN 4 THEN ''Poczta Polska''&#xD;
        WHEN 5 THEN ''InPost Paczkomaty''&#xD;
        WHEN 6 THEN ''InPost Allegro''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Kurier Nazwa],&#xD;
    SZL_NumerPelny AS [Dokument ZNP Numer],&#xD;
    ISNULL(NULLIF(SZL_Uwagi, ''''), ''(BRAK)'') [Dokument ZNP Uwagi],&#xD;
    CASE&#xD;
        WHEN SZL_Bufor = 0 THEN ''Wysłane''&#xD;
        WHEN SZL_Bufor = 1 THEN ''Niewysłane''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Dokument ZNP Status],&#xD;
    ISNULL(NULLIF(SZL_Status, ''''), ''(BRAK)'') AS [Dokument ZNP Status Przesyłki],&#xD;
    ISNULL(NULLIF(SZL_NumerProtokoluOdbioru, ''''), ''(BRAK)'') AS [Dokument ZNP Nr Protokołu],&#xD;
    ISNULL(NULLIF(SZL_NumerZleceniaOdbioru, ''''), ''(BRAK)'') AS [Dokument ZNP Nr Zlecenia Odbioru],&#xD;
    ISNULL(NULLIF(SZL_ReferencjeTekst, ''''), ''(BRAK)'') AS [Dokument ZNP Referencje],&#xD;
    CASE &#xD;
        WHEN SZL_DokumentyZwrotne = 1 THEN ISNULL(NULLIF(SZL_DokumentyZwrotneTekst, ''''), ''(BRAK)'')&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Dokument ZNP Dokumenty Zwrotne],&#xD;
    SZL_NumerPelny AS [Liczba Dokumentów ZNP],&#xD;
    SAN_Kod AS [Nadawca Kod],&#xD;
    SZL_SANNazwa AS [Nadawca Nazwa],&#xD;
    ''ul. '' + ISNULL(NULLIF(SZL_SANUlica, ''''), ''(BRAK)'') +  '' '' + ISNULL(NULLIF(SZL_SANNrDomu, ''''), ''(BRAK)'') + CASE SZL_SANNrLokalu WHEN '''' THEN '''' ELSE ''/'' + SZL_SANNrLokalu END AS [Nadawca Adres],&#xD;
    ISNULL(NULLIF(SZL_SANMiasto, ''''), ''(BRAK)'') AS [Nadawca Miasto],&#xD;
    ISNULL(NULLIF(SZL_SANKodPocztowy, ''''), ''(BRAK)'') AS [Nadawca Kod Pocztowy],&#xD;
    CASE SZL_OpiekunTyp&#xD;
        WHEN 3 THEN Opiekun.PRI_Kod&#xD;
        WHEN 8 THEN SZL_OpeModKod&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Nadawca Opiekun Kod],&#xD;
    ISNULL(NULLIF(SZL_OpiekunNazwa, ''''), ''(BRAK)'') AS [Nadawca Osoba Kontaktowa],&#xD;
    CASE &#xD;
        WHEN SZL_OdbiorcaTyp = 1 THEN ISNULL(NULLIF(Knt_Kod, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 2 THEN ISNULL(NULLIF(BNa_Akronim, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 3 THEN ISNULL(NULLIF(Odbiorca.PRI_Kod, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 5 THEN ISNULL(NULLIF(Urz_Akronim, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp IS NULL THEN ''(BRAK)''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Obiorca Kod],&#xD;
    ISNULL(NULLIF(SZL_OdbNazwa, ''''), ''(BRAK)'') AS [Odbiorca Nazwa],&#xD;
    ''ul. '' + ISNULL(NULLIF(SZL_OdbUlica, ''''), ''(BRAK)'') +  '' '' + ISNULL(NULLIF(SZL_OdbNrDomu, ''''), ''(BRAK)'') + CASE SZL_OdbNrLokalu WHEN '''' THEN '''' ELSE ''/'' + SZL_OdbNrLokalu END AS [Odbiorca Adres],&#xD;
    ISNULL(NULLIF(SZL_OdbMiasto, ''''), ''(BRAK)'') AS [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(SZL_OdbKodPocztowy, ''''), ''(BRAK)'') AS [Odbiorca Kod Pocztowy],&#xD;
    ISNULL(NULLIF(SZL_Odebral, ''''), ''(BRAK)'') AS [Odbiorca Osoba Kontaktowa],&#xD;
    CASE &#xD;
        WHEN SPA_SPAID IS NULL THEN ''(BRAK)''&#xD;
        ELSE SZL_NumerPelny + ''-'' + CONVERT(VARCHAR, SPA_SPAID)&#xD;
    END AS [Paczka Numer],&#xD;
    CASE &#xD;
        WHEN SZL_TypKuriera = 2 THEN ISNULL(NULLIF(SPA_Zawartosc, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_TypKuriera IN (3, 4) THEN ISNULL(NULLIF(SZL_ZawartoscTekst, ''''), ''(BRAK)'')&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Paczka Zawartość],&#xD;
    ISNULL(NULLIF(SPA_NumerListu, ''''), ''(BRAK)'') AS [Paczka Nr Listu Przewozowego],&#xD;
    CASE &#xD;
        WHEN SZL_TypKuriera IN (2, 3) THEN &#xD;
            CASE &#xD;
                WHEN SPA_SposobPakowaniaKey = 0 THEN ''Standardowa''&#xD;
                WHEN SPA_SposobPakowaniaKey = 1 THEN ''Kopertowa''&#xD;
                WHEN SPA_SposobPakowaniaKey = 2 THEN ''Paletowa''&#xD;
                WHEN SPA_SposobPakowaniaKey IS NULL THEN ''(BRAK)''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 6 THEN &#xD;
            CASE SPA_SposobPakowaniaKey&#xD;
                WHEN 0 THEN ''Paczkomaty 24/7''&#xD;
                WHEN 1 THEN ''miniKurier24''&#xD;
                WHEN 2 THEN ''Kurier24''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 THEN &#xD;
            CASE SPA_SposobPakowaniaKey&#xD;
                WHEN 0 THEN ''Pocztex''&#xD;
                WHEN 1 THEN ''Pocztex Kurier 48''&#xD;
                WHEN 2 THEN ''Usługa paczkowa''&#xD;
                WHEN 3 THEN ''Paczka pocztowa''&#xD;
                WHEN 4 THEN ''Przesyłka polecona''&#xD;
                WHEN 5 THEN ''Przesyłka firmowa polecona''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Paczka Rodzaj],&#xD;
    CASE &#xD;
        WHEN SZL_OpcjePobranie = 1 THEN SZL_OpcjeKwotaPobrania / COUNT(SZL_NumerPelny) OVER(PARTITION BY SZL_NumerPelny)&#xD;
        ELSE NULL&#xD;
    END AS [Paczka Kwota Pobrania],&#xD;
    CASE&#xD;
        WHEN SZL_TypKuriera IN (2, 3, 5, 6) THEN &#xD;
            CASE &#xD;
                WHEN SZL_OpcjeUbezpieczenie = 1 THEN SZL_OpcjeKwotaUbezpieczenia / COUNT(SZL_NumerPelny) OVER(PARTITION BY SZL_NumerPelny)&#xD;
                ELSE NULL&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 THEN NULLIF(SPA_DeklarowanaWartosc, 0)&#xD;
        ELSE NULL&#xD;
    END AS [Paczka Deklarowana Wartość],&#xD;
    CASE&#xD;
        WHEN SZL_TypKuriera IN (2, 3, 5, 6) THEN &#xD;
            CASE &#xD;
                WHEN SZL_OpcjeUbezpieczenie = 1 THEN SZL_OpcjeKwotaUbezpieczenia / COUNT(SZL_NumerPelny) OVER(PARTITION BY SZL_NumerPelny)&#xD;
                ELSE NULL&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 THEN NULLIF(SPA_KwotaUbezpieczenia, 0) &#xD;
        ELSE NULL&#xD;
    END AS [Paczka Kwota Ubezpieczenia],&#xD;
    NULLIF(SPA_Waga, 0) AS [Paczka Waga],&#xD;
    NULLIF(SPA_Wysokosc, 0) AS [Paczka Wysokość],&#xD;
    NULLIF(SPA_Dlugosc, 0) AS [Paczka Długość],&#xD;
    NULLIF(SPA_Szerokosc, 0) AS [Paczka Szerokość],&#xD;
    CASE &#xD;
        WHEN SZL_TypKuriera = 4 AND SPA_SposobPakowaniaKey = 1 THEN &#xD;
            CASE SPA_Gabaryt&#xD;
                WHEN 0 THEN ''XS''&#xD;
                WHEN 1 THEN ''S''&#xD;
                WHEN 2 THEN ''M''&#xD;
                WHEN 3 THEN ''L''&#xD;
                WHEN 4 THEN ''XL''&#xD;
                WHEN 5 THEN ''XXL''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 AND SPA_SposobPakowaniaKey = 3 THEN &#xD;
            CASE SPA_Gabaryt&#xD;
                WHEN 0 THEN ''A''&#xD;
                WHEN 1 THEN ''B''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera = 4 AND SPA_SposobPakowaniaKey = 4 THEN &#xD;
            CASE SPA_Gabaryt&#xD;
                WHEN 2 THEN ''S''&#xD;
                WHEN 3 THEN ''M''&#xD;
                WHEN 4 THEN ''L''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        WHEN SZL_TypKuriera IN (5, 6) THEN &#xD;
            CASE SPA_Gabaryt&#xD;
                WHEN 0 THEN ''A''&#xD;
                WHEN 1 THEN ''B''&#xD;
                WHEN 2 THEN ''C''&#xD;
                ELSE ''(NIEZNANY)''&#xD;
            END&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Paczka Gabaryt],&#xD;
    SPA_SPAID AS [Liczba Paczek],&#xD;
    ISNULL(NULLIF(SZL_UrzadNadaniaKod, ''''), ''(BRAK)'') AS [Punkt Nadania Kod],&#xD;
    ISNULL(NULLIF(SZL_UrzadNadaniaAdres, ''''), ''(BRAK)'') AS [Punkt Nadania Adres],&#xD;
    ISNULL(NULLIF(SZL_OdbiorWPunkcieId, ''''), ''(BRAK)'') AS [Punkt Odbioru Kod],&#xD;
    ISNULL(NULLIF(SZL_OdbiorWPunkcieAdres, ''''), ''(BRAK)'') AS [Punkt Odbioru Adres],&#xD;
    ''(NIEPRZYPISANY)'' AS [Dokument Numer],&#xD;
    ''(NIEPRZYPISANY)'' AS [Produkt Kod], &#xD;
    ''(NIEPRZYPISANY)'' AS [Produkt Nazwa],&#xD;
    ''(NIEPRZYPISANY)'' AS [Kontrahent Kod],&#xD;
    NULL AS [Sprzedaż Wartość Netto],&#xD;
    NULL AS [Sprzedaż Wartość Brutto],&#xD;
    NULL AS [Sprzedaż Ilość], &#xD;
        CASE WHEN DATEDIFF(day, SZL_DataKurierOD, GETDATE()) = 0 THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Dziś],&#xD;
    CASE WHEN DATEDIFF(day, SZL_DataKurierOD, GETDATE() - 1) = 0 THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Wczoraj],&#xD;
    CASE WHEN ((datepart(DY, datediff(d, 0, SZL_DataKurierOD) / 7 * 7 + 3) + 6) / 7 = (datepart(DY, datediff(d, 0, GETDATE()) / 7 * 7 + 3) + 6) / 7) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) &#xD;
        THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Nadania Aktualny Tydzień],&#xD;
    CASE WHEN (MONTH(SZL_DataKurierOD) = MONTH(GETDATE())) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Aktualny Miesiąc],&#xD;
    CASE &#xD;
        WHEN (MONTH(SZL_DataKurierOD) = MONTH(GETDATE())-1) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) THEN ''TAK'' &#xD;
        WHEN ((MONTH(SZL_DataKurierOD) = 12) AND (MONTH(GETDATE()) = 1)) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE()) - 1) THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Nadania Poprzedni Miesiąc],&#xD;
    zal.Ope_Kod [Operator Wprowadzający],&#xD;
    mod.Ope_Kod [Operator Modyfikujący],&#xD;
&#xD;
    /*&#xD;
    ----------DATY POINT&#xD;
    REPLACE(CONVERT(VARCHAR(10), SZL_DataDok, 111), ''/'', ''-'') [Data Wystawienia],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataWyslania, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataKurierOD, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania],&#xD;
    */&#xD;
&#xD;
    ----------DATY ANALIZY&#xD;
    REPLACE(CONVERT(VARCHAR(10), SZL_DataDok, 111), ''/'', ''-'') [Data Wystawienia Dzień],&#xD;
    (DATEPART(DY, DATEDIFF(d, 0, SZL_DataDok) / 7 * 7 + 3)+6) / 7 [Data Wystawienia Tydzień Roku],&#xD;
    MONTH(SZL_DataDok) [Data Wystawienia Miesiąc],&#xD;
    DATEPART(quarter, SZL_DataDok) [Data Wystawienia Kwartał],&#xD;
    YEAR(SZL_DataDok) [Data Wystawienia Rok],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataWyslania, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Dzień],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, (datepart(DY, datediff(d, 0, SZL_DataWyslania) / 7 * 7 + 3) + 6) / 7)&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Tydzień Roku],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, MONTH(SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Miesiąc],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, DATEPART(quarter, SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Kwartał],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, YEAR(SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Rok],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataKurierOD, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Dzień],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, (datepart(DY, datediff(d, 0, SZL_DataKurierOD) / 7 * 7 + 3) + 6) / 7)&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Tydzień Roku],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, MONTH(SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Miesiąc],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, DATEPART(quarter, SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Kwartał],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, YEAR(SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Rok],&#xD;
    GETDATE() [Data Analizy]&#xD;
    &#xD;
    ----------KONTEKSTY&#xD;
    ,30392 [Dokument Numer __PROCID__Sprzedaz__], NULL [Dokument Numer __ORGID__],''' + @bazaFirmowa + ''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], NULL [Kontrahent Kod __ORGID__],''' + @bazaFirmowa + ''' [Kontrahent Kod __DATABASE__]&#xD;
    ,20201 [Odbiorca Nazwa __PROCID__], Odbiorca.PRI_PriId [Odbiorca Nazwa __ORGID__],''' + @bazaFirmowa + ''' [Odbiorca Nazwa __DATABASE__]&#xD;
    ,20201 [Odbiorca Kod __PROCID__], Odbiorca.PRI_PriId [Odbiorca Kod __ORGID__],''' + @bazaFirmowa + ''' [Odbiorca Kod __DATABASE__]&#xD;
    ,30392 [Produkt Nazwa __PROCID__], NULL [Produkt Nazwa __ORGID__],''' + @bazaFirmowa + ''' [Produkt Nazwa __DATABASE__]&#xD;
    ,30392 [Produkt Kod __PROCID__Towary__], NULL [Produkt Kod __ORGID__],''' + @bazaFirmowa + ''' [Produkt Kod __DATABASE__]'&#xD;
&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
&#xD;
set @select2 = &#xD;
' FROM [CDN].[SenditZleceniePrzesylki] &#xD;
LEFT JOIN [CDN].[SenditPaczki] ON SZL_SZLID = SPA_SZLID &#xD;
LEFT JOIN [CDN].[SenditAdresyNadawcze] ON SZL_SANID = SAN_SANID&#xD;
LEFT JOIN ' + @Operatorzy + ' ON SZL_OpiekunId = Ope_OpeID&#xD;
LEFT JOIN [CDN].[PracIdx] Opiekun ON SZL_OpiekunId = Opiekun.PRI_PriId&#xD;
LEFT JOIN [CDN].[Kontrahenci] ON SZL_OdbID = Knt_KntId AND SZL_OdbiorcaTyp = 1&#xD;
LEFT JOIN [CDN].[BnkNazwy] ON SZL_OdbID = BNa_BNaId AND SZL_OdbiorcaTyp = 2&#xD;
LEFT JOIN [CDN].[PracIdx] Odbiorca ON SZL_OdbID = Odbiorca.PRI_PriId AND SZL_OdbiorcaTyp = 3&#xD;
LEFT JOIN [CDN].[Urzedy] ON SZL_OdbID = Urz_UrzId AND SZL_OdbiorcaTyp = 5&#xD;
LEFT JOIN #tmpTwrGr Poz ON 0 = 1&#xD;
LEFT JOIN #tmpTwrAtr TwrAtr ON 0 = 1&#xD;
LEFT JOIN #tmpPozAtr PozAtr ON 0 = 1&#xD;
LEFT JOIN #tmpKonAtr KonAtr ON 0 = 1&#xD;
LEFT JOIN #tmpKonAtr OdbAtr ON 0 = 1&#xD;
LEFT JOIN #tmpDokAtr DokAtr ON 0 = 1&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
LEFT JOIN ' + @Operatorzy + ' zal ON Knt_OpeZalID = zal.Ope_OpeId&#xD;
LEFT JOIN ' + @Operatorzy + ' mod ON Knt_OpeModID = mod.Ope_OpeId&#xD;
&#xD;
UNION ALL&#xD;
&#xD;
SELECT&#xD;
    BAZ.Baz_Nazwa AS [Baza Firmowa],&#xD;
    CASE SZL_TypKuriera&#xD;
        WHEN 2 THEN ''DPD''&#xD;
        WHEN 3 THEN ''DHL''&#xD;
        WHEN 4 THEN ''Poczta Polska''&#xD;
        WHEN 5 THEN ''InPost Paczkomaty''&#xD;
        WHEN 6 THEN ''InPost Allegro''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Kurier Nazwa],&#xD;
    SZL_NumerPelny AS [Dokument ZNP Numer],&#xD;
    ISNULL(NULLIF(SZL_Uwagi, ''''), ''(BRAK)'') [Dokument ZNP Uwagi],&#xD;
    CASE&#xD;
        WHEN SZL_Bufor = 0 THEN ''Wysłane''&#xD;
        WHEN SZL_Bufor = 1 THEN ''Niewysłane''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Dokument ZNP Status],&#xD;
    ISNULL(NULLIF(SZL_Status, ''''), ''(BRAK)'') AS [Dokument ZNP Status Przesyłki],&#xD;
    ISNULL(NULLIF(SZL_NumerProtokoluOdbioru, ''''), ''(BRAK)'') AS [Dokument ZNP Nr Protokołu],&#xD;
    ISNULL(NULLIF(SZL_NumerZleceniaOdbioru, ''''), ''(BRAK)'') AS [Dokument ZNP Nr Zlecenia Odbioru],&#xD;
    ISNULL(NULLIF(SZL_ReferencjeTekst, ''''), ''(BRAK)'') AS [Dokument ZNP Referencje],&#xD;
    CASE &#xD;
        WHEN SZL_DokumentyZwrotne = 1 THEN ISNULL(NULLIF(SZL_DokumentyZwrotneTekst, ''''), ''(BRAK)'')&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Dokument ZNP Dokumenty Zwrotne],&#xD;
    SZL_NumerPelny AS [Liczba Dokumentów ZNP],&#xD;
    SAN_Kod AS [Nadawca Kod],&#xD;
    SZL_SANNazwa AS [Nadawca Nazwa],&#xD;
    ''ul. '' + ISNULL(NULLIF(SZL_SANUlica, ''''), ''(BRAK)'') +  '' '' + ISNULL(NULLIF(SZL_SANNrDomu, ''''), ''(BRAK)'') + CASE SZL_SANNrLokalu WHEN '''' THEN '''' ELSE ''/'' + SZL_SANNrLokalu END AS [Nadawca Adres],&#xD;
    ISNULL(NULLIF(SZL_SANMiasto, ''''), ''(BRAK)'') AS [Nadawca Miasto],&#xD;
    ISNULL(NULLIF(SZL_SANKodPocztowy, ''''), ''(BRAK)'') AS [Nadawca Kod Pocztowy],&#xD;
    CASE SZL_OpiekunTyp&#xD;
        WHEN 3 THEN Opiekun.PRI_Kod&#xD;
        WHEN 8 THEN SZL_OpeModKod&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Nadawca Opiekun Kod],&#xD;
    ISNULL(NULLIF(SZL_OpiekunNazwa, ''''), ''(BRAK)'') AS [Nadawca Osoba Kontaktowa],&#xD;
    CASE &#xD;
        WHEN SZL_OdbiorcaTyp = 1 THEN ISNULL(NULLIF(Knt1.Knt_Kod, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 2 THEN ISNULL(NULLIF(BNa_Akronim, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 3 THEN ISNULL(NULLIF(Odbiorca.PRI_Kod, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp = 5 THEN ISNULL(NULLIF(Urz_Akronim, ''''), ''(BRAK)'')&#xD;
        WHEN SZL_OdbiorcaTyp IS NULL THEN ''(BRAK)''&#xD;
        ELSE ''(NIEZNANY)''&#xD;
    END AS [Obiorca Kod],&#xD;
    ISNULL(NULLIF(SZL_OdbNazwa, ''''), ''(BRAK)'') AS [Odbiorca Nazwa],&#xD;
    ''ul. '' + ISNULL(NULLIF(SZL_OdbUlica, ''''), ''(BRAK)'') +  '' '' + ISNULL(NULLIF(SZL_OdbNrDomu, ''''), ''(BRAK)'') + CASE SZL_OdbNrLokalu WHEN '''' THEN '''' ELSE ''/'' + SZL_OdbNrLokalu END AS [Odbiorca Adres],&#xD;
    ISNULL(NULLIF(SZL_OdbMiasto, ''''), ''(BRAK)'') AS [Odbiorca Miasto],&#xD;
    ISNULL(NULLIF(SZL_OdbKodPocztowy, ''''), ''(BRAK)'') AS [Odbiorca Kod Pocztowy],&#xD;
    ISNULL(NULLIF(SZL_Odebral, ''''), ''(BRAK)'') AS [Odbiorca Osoba Kontaktowa],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Numer],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Zawartość],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Nr Listu Przewozowego],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Rodzaj],&#xD;
    NULL AS [Paczka Kwota Pobrania],&#xD;
    NULL AS [Paczka Deklarowana Wartość],&#xD;
    NULL AS [Paczka Kwota Ubezpieczenia],&#xD;
    NULL AS [Paczka Waga],&#xD;
    NULL AS [Paczka Wysokość],&#xD;
    NULL AS [Paczka Długość],&#xD;
    NULL AS [Paczka Szerokość],&#xD;
    ''(NIEPRZYPISANY)'' AS [Paczka Gabaryt],&#xD;
    NULL AS [Liczba Paczek],&#xD;
    ISNULL(NULLIF(SZL_UrzadNadaniaKod, ''''), ''(BRAK)'') AS [Punkt Nadania Kod],&#xD;
    ISNULL(NULLIF(SZL_UrzadNadaniaAdres, ''''), ''(BRAK)'') AS [Punkt Nadania Adres],&#xD;
    ISNULL(NULLIF(SZL_OdbiorWPunkcieId, ''''), ''(BRAK)'') AS [Punkt Odbioru Kod],&#xD;
    ISNULL(NULLIF(SZL_OdbiorWPunkcieAdres, ''''), ''(BRAK)'') AS [Punkt Odbioru Adres],&#xD;
    ISNULL(NULLIF(TrN_NumerPelny, ''''), ''(BRAK)'') AS [Dokument Numer],&#xD;
    Twr_Kod AS [Produkt Kod], &#xD;
    Twr_Nazwa AS [Produkt Nazwa],&#xD;
    Knt2.Knt_Kod AS [Kontrahent Kod],&#xD;
    TrE_WartoscNetto AS [Sprzedaż Wartość Netto], &#xD;
    TrE_WartoscBrutto AS [Sprzedaż Wartość Brutto], &#xD;
    TrE_Ilosc AS [Sprzedaż Ilość], &#xD;
    CASE WHEN DATEDIFF(day, SZL_DataKurierOD, GETDATE()) = 0 THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Dziś],&#xD;
    CASE WHEN DATEDIFF(day, SZL_DataKurierOD, GETDATE() - 1) = 0 THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Wczoraj],&#xD;
    CASE WHEN ((datepart(DY, datediff(d, 0, SZL_DataKurierOD) / 7 * 7 + 3) + 6) / 7 = (datepart(DY, datediff(d, 0, GETDATE()) / 7 * 7 + 3) + 6) / 7) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) &#xD;
        THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Nadania Aktualny Tydzień],&#xD;
    CASE WHEN (MONTH(SZL_DataKurierOD) = MONTH(GETDATE())) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) THEN ''TAK'' ELSE ''NIE'' END [Czas Nadania Aktualny Miesiąc],&#xD;
    CASE &#xD;
        WHEN (MONTH(SZL_DataKurierOD) = MONTH(GETDATE())-1) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE())) THEN ''TAK'' &#xD;
        WHEN ((MONTH(SZL_DataKurierOD) = 12) AND (MONTH(GETDATE()) = 1)) AND (YEAR(SZL_DataKurierOD) = YEAR(GETDATE()) - 1) THEN ''TAK'' &#xD;
        ELSE ''NIE'' &#xD;
    END [Czas Nadania Poprzedni Miesiąc],&#xD;
    zal.Ope_Kod [Operator Wprowadzający], &#xD;
    mod.Ope_Kod [Operator Modyfikujący],&#xD;
&#xD;
    /*&#xD;
    ----------DATY POINT&#xD;
    REPLACE(CONVERT(VARCHAR(10), SZL_DataDok, 111), ''/'', ''-'') [Data Wystawienia],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataWyslania, 111), ''/'', ''-''))&#xD;
    END AS [Data Zgłoszenia],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataKurierOD, 111), ''/'', ''-''))&#xD;
    END AS [Data Nadania],&#xD;
    */&#xD;
&#xD;
    ----------DATY ANALIZY&#xD;
    REPLACE(CONVERT(VARCHAR(10), SZL_DataDok, 111), ''/'', ''-'') [Data Wystawienia Dzień],&#xD;
    (DATEPART(DY, DATEDIFF(d, 0, SZL_DataDok) / 7 * 7 + 3)+6) / 7 [Data Wystawienia Tydzień Roku],&#xD;
    MONTH(SZL_DataDok) [Data Wystawienia Miesiąc],&#xD;
    DATEPART(quarter, SZL_DataDok) [Data Wystawienia Kwartał],&#xD;
    YEAR(SZL_DataDok) [Data Wystawienia Rok],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataWyslania, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Dzień],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, (datepart(DY, datediff(d, 0, SZL_DataWyslania) / 7 * 7 + 3) + 6) / 7)&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Tydzień Roku],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, MONTH(SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Miesiąc],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, DATEPART(quarter, SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Kwartał],&#xD;
    CASE &#xD;
        WHEN SZL_DataWyslania &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, YEAR(SZL_DataWyslania))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Zgłoszenia Rok],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, REPLACE(CONVERT(VARCHAR(10), SZL_DataKurierOD, 111), ''/'', ''-''))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Dzień],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, (datepart(DY, datediff(d, 0, SZL_DataKurierOD) / 7 * 7 + 3) + 6) / 7)&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Tydzień Roku],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, MONTH(SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Miesiąc],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, DATEPART(quarter, SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Kwartał],&#xD;
    CASE &#xD;
        WHEN SZL_DataKurierOD &gt; ''1900-01-01'' THEN CONVERT(VARCHAR, YEAR(SZL_DataKurierOD))&#xD;
        ELSE ''(BRAK)''&#xD;
    END AS [Data Nadania Rok],&#xD;
    GETDATE() [Data Analizy]&#xD;
    &#xD;
    ----------KONTEKSTY&#xD;
    ,30392 [Dokument Numer __PROCID__Sprzedaz__], TrN_TrNId [Dokument Numer __ORGID__],''' + @bazaFirmowa + ''' [Dokument Numer __DATABASE__]&#xD;
    ,20201 [Kontrahent Kod __PROCID__Kontrahenci__], Knt2.Knt_KntId [Kontrahent Kod __ORGID__],''' + @bazaFirmowa + ''' [Kontrahent Kod __DATABASE__]&#xD;
    ,20201 [Odbiorca Nazwa __PROCID__], Odbiorca.PRI_PriId [Odbiorca Nazwa __ORGID__],''' + @bazaFirmowa + ''' [Odbiorca Nazwa __DATABASE__]&#xD;
    ,20201 [Odbiorca Kod __PROCID__], Odbiorca.PRI_PriId [Odbiorca Kod __ORGID__],''' + @bazaFirmowa + ''' [Odbiorca Kod __DATABASE__]&#xD;
    ,30392 [Produkt Nazwa __PROCID__], Twr_TwrId [Produkt Nazwa __ORGID__],''' + @bazaFirmowa + ''' [Produkt Nazwa __DATABASE__]&#xD;
    ,30392 [Produkt Kod __PROCID__Towary__], Twr_TwrId [Produkt Kod __ORGID__],''' + @bazaFirmowa + ''' [Produkt Kod __DATABASE__]'&#xD;
&#xD;
    + @kolumny + @atrybuty + @atrybutyDok + @atrybutyTwr + @atrybutyPoz&#xD;
&#xD;
set @select3 = &#xD;
' FROM [CDN].[SenditZleceniePrzesylki] &#xD;
LEFT JOIN [CDN].[SenditAdresyNadawcze] ON SZL_SANID = SAN_SANID&#xD;
LEFT JOIN ' + @Operatorzy + ' ON SZL_OpiekunId = Ope_OpeID&#xD;
LEFT JOIN [CDN].[PracIdx] Opiekun ON SZL_OpiekunId = Opiekun.PRI_PriId&#xD;
LEFT JOIN [CDN].[Kontrahenci] Knt1 ON SZL_OdbID = Knt1.Knt_KntId AND SZL_OdbiorcaTyp = 1&#xD;
LEFT JOIN [CDN].[BnkNazwy] ON SZL_OdbID = BNa_BNaId AND SZL_OdbiorcaTyp = 2&#xD;
LEFT JOIN [CDN].[PracIdx] Odbiorca ON SZL_OdbID = Odbiorca.PRI_PriId AND SZL_OdbiorcaTyp = 3&#xD;
LEFT JOIN [CDN].[Urzedy] ON SZL_OdbID = Urz_UrzId AND SZL_OdbiorcaTyp = 5&#xD;
JOIN [CDN].[TraNag] ON TrN_TypDokumentu = SZL_DokZrodloweTyp AND TrN_TrNID = SZL_DokZrodlowe&#xD;
LEFT JOIN [CDN].[TraElem] ON TrE_TrNID = TrN_TrNID&#xD;
LEFT JOIN [CDN].[Towary] ON TrE_TwrId = Twr_TwrId&#xD;
LEFT JOIN [CDN].[Kontrahenci] Knt2 ON TrN_PodID = Knt2.Knt_KntId AND TrN_PodmiotTyp = 1&#xD;
LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
LEFT JOIN #tmpTwrAtr TwrAtr ON TrE_TwrId = TwrAtr.TwA_TwrId &#xD;
LEFT JOIN #tmpPozatr PozAtr ON TrE_TrEId = PozAtr.TrA_TrEId&#xD;
LEFT JOIN #tmpKonAtr KonAtr ON TrN_PodID = KonAtr.KnA_PodmiotId AND TrN_PodmiotTyp = KonAtr.KnA_PodmiotTyp&#xD;
LEFT JOIN #tmpKonAtr OdbAtr ON SZL_OdbID = OdbAtr.KnA_PodmiotId AND SZL_OdbiorcaTyp = OdbAtr.KnA_PodmiotTyp&#xD;
LEFT JOIN #tmpDokAtr DokAtr ON TrN_TrNID = DokAtr.DAt_TrNId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
LEFT JOIN ' + @Operatorzy + ' zal ON SZL_OpeZalID = zal.Ope_OpeId&#xD;
LEFT JOIN ' + @Operatorzy + ' mod ON SZL_OpeModID = mod.Ope_OpeId&#xD;
'&#xD;
&#xD;
print (@select + @select2 + @select3)&#xD;
exec (@select + @select2 + @select3)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpDokAtr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpPozAtr&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+R9xVUaSNnhw1ovX8kGyRfvi+FPVVwm8BXQToPM2XXd7Cy6m9BIS7z9s1IwAideFbTKXNgYEsZmxH4ZxrA6lmE7QgFLq+a2/6vhE78xSUnvDxbs+BsIWWyvH7fGCLkVDMpKg0ciAgY8sLRCTy+3uvFuGg/3PU/oLZvxA4q7nTV/87QZZOcnSY3BHSM/dy29J4Nb7KMfUpBb2A==</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kurier Nazwa" caption="Kurier Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Numer" caption="Dokument ZNP Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument ZNP Uwagi" caption="Dokument ZNP Uwagi" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Status" caption="Dokument ZNP Status" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Status Przesyłki" caption="Dokument ZNP Status Przesyłki" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Nr Protokołu" caption="Dokument ZNP Nr Protokołu" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Nr Zlecenia Odbioru" caption="Dokument ZNP Nr Zlecenia Odbioru" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Referencje" caption="Dokument ZNP Referencje" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument ZNP Dokumenty Zwrotne" caption="Dokument ZNP Dokumenty Zwrotne" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Liczba Dokumentów ZNP" caption="Liczba Dokumentów ZNP" type="measure" formatString="n0" aggregate="DistinctCount" /&gt;&#xD;
    &lt;column name="Nadawca Kod" caption="Nadawca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Nazwa" caption="Nadawca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Adres" caption="Nadawca Adres" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Miasto" caption="Nadawca Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Kod Pocztowy" caption="Nadawca Kod Pocztowy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Opiekun Kod" caption="Nadawca Opiekun Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Nadawca Osoba Kontaktowa" caption="Nadawca Osoba Kontaktowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Obiorca Kod" caption="Obiorca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Nazwa" caption="Odbiorca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Adres" caption="Odbiorca Adres" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Miasto" caption="Odbiorca Miasto" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Kod Pocztowy" caption="Odbiorca Kod Pocztowy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Osoba Kontaktowa" caption="Odbiorca Osoba Kontaktowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Paczka Numer" caption="Paczka Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Paczka Zawartość" caption="Paczka Zawartość" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Paczka Nr Listu Przewozowego" caption="Paczka Nr Listu Przewozowego" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Paczka Rodzaj" caption="Paczka Rodzaj" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Paczka Kwota Pobrania" caption="Paczka Kwota Pobrania" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Paczka Deklarowana Wartość" caption="Paczka Deklarowana Wartość" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Paczka Kwota Ubezpieczenia" caption="Paczka Kwota Ubezpieczenia" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Paczka Waga" caption="Paczka Waga" type="measure" formatString="0.00 kg" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Paczka Wysokość" caption="Paczka Wysokość" type="measure" formatString="0.00 cm" aggregate="Average" /&gt;&#xD;
    &lt;column name="Paczka Długość" caption="Paczka Długość" type="measure" formatString="0.00 cm" aggregate="Average" /&gt;&#xD;
    &lt;column name="Paczka Szerokość" caption="Paczka Szerokość" type="measure" formatString="0.00 cm" aggregate="Average" /&gt;&#xD;
    &lt;column name="Paczka Gabaryt" caption="Paczka Gabaryt" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Liczba Paczek" caption="Liczba Paczek" type="measure" formatString="n0" aggregate="DistinctCount" /&gt;&#xD;
    &lt;column name="Punkt Nadania Kod" caption="Punkt Nadania Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Punkt Nadania Adres" caption="Punkt Nadania Adres" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Punkt Odbioru Kod" caption="Punkt Odbioru Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Punkt Odbioru Adres" caption="Punkt Odbioru Adres" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Brutto" caption="Sprzedaż Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Dzień" caption="Data Zgłoszenia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Tydzień Roku" caption="Data Zgłoszenia Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Miesiąc" caption="Data Zgłoszenia Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Kwartał" caption="Data Zgłoszenia Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Zgłoszenia Rok" caption="Data Zgłoszenia Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Dzień" caption="Data Nadania Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Tydzień Roku" caption="Data Nadania Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Miesiąc" caption="Data Nadania Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Kwartał" caption="Data Nadania Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Nadania Rok" caption="Data Nadania Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Atrybut FAKTURA ZA USŁUGI BR" caption="Kontrahent Atrybut FAKTURA ZA USŁUGI BR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Odbiorca Atrybut FAKTURA ZA USŁUGI BR" caption="Odbiorca Atrybut FAKTURA ZA USŁUGI BR" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Atrybut REGION" caption="Dokument Atrybut REGION" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut KOLOR" caption="Produkt Atrybut KOLOR" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAcAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAA</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&lt;whatifMeasures&gt;&lt;whatifMeasure uniqueName="[Measures].[633ec437-9837-478b-8e39-e78dd6326c96]" caption="Różnica Wartości" formula="Paczka Deklarowana Wartość-Sprzedaż Wartość Brutto" description="Różnica pomiędzy wartością sprzedaży towaru brutto z faktury sprzedaży a zadeklarowaną wartością paczki ze zlecenia nadania przesyłki." summaryType="Sum" /&gt;&lt;/whatifMeasures&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument ZNP Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Paczka Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Paczka Deklarowana Wartość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Dokument Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Sprzedaż Wartość Brutto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Czas Nadania Aktualny Miesiąc"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="[Measures].[633ec437-9837-478b-8e39-e78dd6326c96]"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" horzAlignment="Far" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" horzAlignment="Near" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="False" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules&gt;&lt;formatRule type="Data"&gt;&lt;condition conditionType="Less" value1="-0,001" value2="" fontName="Segoe UI" fontSize="8" color="Red" backColor="LightPink" /&gt;&lt;dataField name="[Measures].[633ec437-9837-478b-8e39-e78dd6326c96]" /&gt;&lt;/formatRule&gt;&lt;/formatRules&gt;&lt;dataFields&gt;&lt;data fieldName="Paczka Deklarowana Wartość" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Sprzedaż Wartość Brutto" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="[Measures].[633ec437-9837-478b-8e39-e78dd6326c96]" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="False" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Object"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Dokument ZNP Numer" index="0" expanded="True" sortMode="displayText" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy dataFieldName="[Measures].[633ec437-9837-478b-8e39-e78dd6326c96]" /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Paczka Numer" index="2" expanded="True" sortMode="displayText" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy dataFieldName="[Measures].[633ec437-9837-478b-8e39-e78dd6326c96]" /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Dokument Numer" index="1" expanded="True" sortMode="displayText" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy dataFieldName="[Measures].[633ec437-9837-478b-8e39-e78dd6326c96]" /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Produkt Kod" index="3" expanded="True" sortMode="displayText" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy dataFieldName="[Measures].[633ec437-9837-478b-8e39-e78dd6326c96]" /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Czas Nadania Aktualny Miesiąc" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&lt;included&gt;&lt;value uniqueName="TAK" /&gt;&lt;/included&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje faktury sprzedaży z powiązanymi dokumentami ZNP pod względem wartości zawartych produktów. Umożliwia kontrolowanie deklarowanej wartości przesyłek. Domyślne filtrowanie do przesyłek nadanych w aktualnym miesiącu. Wartości prezentowane są w walucie systemowej.</a:description><a:id>276</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.36 Faktury sprzedaży z powiązanymi dokumentami ZNP</a:mainLinkName><a:modifiedOn>2025-04-14T12:14:11.117</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport>35</a:predefinedReport><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>1</a:id></a:Context><a:Context><a:id>2</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2024-10-02T09:02:08.827</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Rotacji w zakresie&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END&#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Tworzenie tabeli tymczasowej dat&#xD;
DECLARE @tmpDataOd DATETIME;&#xD;
SET @tmpDataOd = @DataOd&#xD;
CREATE TABLE #TmpDates (Data DATETIME)&#xD;
&#xD;
WHILE @tmpDataOd&lt;=@DataDo&#xD;
BEGIN&#xD;
    INSERT INTO #TmpDates VALUES (@tmpDataOd)&#xD;
    SET @tmpDataOd = @tmpDataOd + 1&#xD;
END                 &#xD;
    &#xD;
CREATE UNIQUE CLUSTERED INDEX bu ON #TmpDates ([Data])&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, TrE_DataOpe, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
    AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
    AND TrE_DataOpe BETWEEN @DataOd AND @DataDo&#xD;
GROUP BY TrE_MagId, TrE_TwrId, TrE_DataOpe  &#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
&#xD;
--Właściwe zapytanie    &#xD;
set @select =&#xD;
'DECLARE @IloscDni INT; SET @IloscDni = DATEDIFF ( D, ''' + convert(varchar, @DataOd) + ''', ''' + convert(varchar, @DataDo) + ''') + 1;&#xD;
SELECT DB_NAME() [Baza Firmowa],&#xD;
CASE WHEN ''' + @ROTACJA + ''' = ''ilość'' THEN 1 ELSE 0 END [Rotacja wariant],&#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca], &#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],&#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(NULLIF(Twr_EAN, ''''), ''(BRAK)'')  [Produkt EAN],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END [Ilość], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TWI.TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
    ISNULL(TWI.TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TWI.TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Rezerwacje Jednostka Pomocnicza], &#xD;
    ISNULL(TWI.TwI_Braki, 0) [Braki], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TWI.TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
    ISNULL(TWI.TwI_Zamowienia, 0) [Zamówienia], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TWI.TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
    CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Wartosc ELSE 0 END [Wartość Netto],&#xD;
    ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto], @IloscDni [Liczba Dni],&#xD;
    NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
    CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END [Ilość Ostatni Dzień],&#xD;
    SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość], NULL [Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców],&#xD;
    CASE WHEN twi3.data = eom.eom THEN TWI.TwI_Ilosc ELSE 0 END [Ilość M],&#xD;
    CASE WHEN twi3.data = eom.eom THEN ISNULL(TWI.TwI_Wartosc, 0) ELSE 0 END [Wartość Netto M],&#xD;
    CASE WHEN twi3.data = eom.eom THEN ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) ELSE 0 END [Wartość Brutto M],&#xD;
    CASE WHEN twi3.data = eow.eow THEN TWI.TwI_Ilosc ELSE 0 END [Ilość T],&#xD;
    CASE WHEN twi3.data = eow.eow THEN ISNULL(TWI.TwI_Wartosc, 0) ELSE 0 END [Wartość Netto T],&#xD;
    CASE WHEN twi3.data = eow.eow THEN ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) ELSE 0 END [Wartość Brutto T]&#xD;
    /*&#xD;
    ----------DATA POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') [Data]&#xD;
*/&#xD;
    ----------DATA ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') [Data Dzień], (datepart(DY, datediff(d, 0, twi3.data) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, twi3.data)*/ [Data Tydzień Roku]&#xD;
    ,MONTH(twi3.data) [Data Miesiąc], DATEPART(quarter, twi3.data) [Data Kwartał], YEAR(twi3.data) [Data Rok] &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Odbiorca Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + '                                     &#xD;
FROM cdn.TwrIlosci TWI&#xD;
    JOIN (&#xD;
        SELECT MAX(TwI_Data) as MaxData, TwI_MagId, TwI_TwrId, Data &#xD;
        FROM CDN.TwrIlosci TWI2&#xD;
        CROSS JOIN #TmpDates &#xD;
        WHERE TWI2.TwI_MagId IS NOT NULL AND TWI2.TwI_Data &lt;= Data&#xD;
        GROUP BY  TWI2.TwI_MagId, TWI2.TwI_TwrId, data &#xD;
    )TWI3 ON TWI3.TwI_TwrId = TWI.TwI_TwrId AND TWI3.TwI_MagId = TWI.TwI_MagId AND TWI3.MaxData = TWI.TwI_Data  &#xD;
    JOIN CDN.Towary ON TWI.TwI_TwrId = Twr_TwrId    &#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    JOIN CDN.Magazyny ON TWI.TwI_MagId = Mag_MagId  &#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TWI.TwI_TwrId  = TwrAtr.TwA_TwrId &#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TWI.TwI_MagId = TrE_MagId AND TWI.TwI_TwrId = TrE_TwrId AND twi3.data = TrE_DataOpe&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
    LEFT JOIN &#xD;
    (select distinct eomonth(data) eom from #TmpDates) eom on eom.eom = twi3.data&#xD;
    LEFT JOIN&#xD;
    (select distinct DATEADD(wk, DATEDIFF(wk, 6, data), 6) eow from #TmpDates) eow on eow.eow = twi3.data&#xD;
WHERE TWI.TwI_MagId IS NOT NULL'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' AND (ISNULL(TwI_Ilosc, 0) &lt;&gt; 0 OR SprzedazWartosc &lt;&gt; 0)&#xD;
&#xD;
union all&#xD;
SELECT DB_NAME() [Baza Firmowa],&#xD;
CASE WHEN ''' + @ROTACJA + ''' = ''ilość'' THEN 1 ELSE 0 END [Rotacja wariant],&#xD;
    Twr_Kod [Produkt Kod], &#xD;
    Twr_Nazwa [Produkt Nazwa], &#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],&#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(NULLIF(Twr_EAN, ''''), ''(BRAK)'')  [Produkt EAN],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    NULL [Ilość], &#xD;
    NULL [Ilość Jednostka Pomocnicza], &#xD;
    NULL [Rezerwacje], &#xD;
    NULL [Rezerwacje Jednostka Pomocnicza], &#xD;
    NULL [Braki], &#xD;
    NULL [Braki Jednostka Pomocnicza], &#xD;
    NULL [Zamówienia], &#xD;
    NULL [Zamówienia Jednostka Pomocnicza],&#xD;
    NULL [Wartość Netto], &#xD;
    NULL [Wartość Brutto], NULL [Liczba Dni],&#xD;
    NULL [Ilość Minimalna],&#xD;
    NULL [Ilość Maksymalna],&#xD;
    NULL [Ilość Ostatni Dzień],&#xD;
    NULL [Sprzedaż Wartość Netto], NULL [Sprzedaż Ilość],&#xD;
     TrE_Ilosc [Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców],&#xD;
        NULL [Ilość M],&#xD;
    NULL [Wartość Netto M],&#xD;
    NULL [Wartość Brutto M],&#xD;
    NULL [Ilość T],&#xD;
    NULL [Wartość Netto T],&#xD;
    NULL [Wartość Brutto T]&#xD;
/*&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120), 111), ''/'', ''-'') [Data]&#xD;
*/&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120), 111), ''/'', ''-'') [Data Dzień], (datepart(DY, datediff(d, 0, convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120))*/ [Data Tydzień Roku] &#xD;
    ,MONTH(convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) [Data Miesiąc], DATEPART(quarter, convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) [Data Kwartał], YEAR(convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) [Data Rok]&#xD;
&#xD;
    ----------KONTEKSTY&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Odbiorca Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + '                                         &#xD;
FROM  (select TrE_TwrId,TrE_MagId,sum(TrE_Ilosc) TrE_Ilosc from cdn.TraNag &#xD;
left join cdn.TraElem on TrN_TrNID = TrE_TrNId&#xD;
where TrN_DataDok &lt;= convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)&#xD;
and TrN_TypDokumentu = 309 and TrN_ZwroconoCalaIlosc &lt;3&#xD;
group by TrE_TwrId,TrE_MagId&#xD;
) a&#xD;
left join cdn.Towary on a.TrE_TwrId = Twr_TwrId&#xD;
left join cdn.Magazyny on Mag_MagId = a.TrE_MagId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON a.TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #TmpDates&#xD;
DROP TABLE #tmpSprzedaz&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RG5e/t8t+X7zv805Ew+SD4q4tb3pMGF8tO7UTyhwSUC/Gd6+iwZB2jzDwJgFJoAzREF9NpiTvD7JPaMMU+LfS6ewgmq9kAP6qcqvE25r7AOePFN3U68zd3f4ZCU/uYVcSX601vEYGiZ7T3be4TMftfLMkcbDZWuSOUcEuJiTAnk9R9Z5uxqTmH</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Rotacja wariant" caption="Rotacja wariant" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt EAN" caption="Produkt EAN" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba Dni" caption="Liczba Dni" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Ostatni Dzień" caption="Ilość Ostatni Dzień" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" caption="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość M" caption="Ilość M" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto M" caption="Wartość Netto M" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto M" caption="Wartość Brutto M" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość T" caption="Ilość T" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto T" caption="Wartość Netto T" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto T" caption="Wartość Brutto T" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Dzień" caption="Data Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Tydzień Roku" caption="Data Tydzień Roku" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Miesiąc" caption="Data Miesiąc" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Kwartał" caption="Data Kwartał" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Rok" caption="Data Rok" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 6" caption="Produkt Grupa Poziom 6" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[4605313f-bbb7-4de0-b2a1-2c996262c0bb]" caption="Rotacja w dniach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;DATAOD&lt;/Label&gt;&#xD;
    &lt;Expression /&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;DATADO&lt;/Label&gt;&#xD;
    &lt;Expression /&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'
&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ROTACJA&lt;/Name&gt;&#xD;
    &lt;Label&gt;ROTACJA&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Sposób obliczania rotacji&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'ilość';'wartość'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'ilość'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;whatifMeasures&gt;&lt;whatifMeasure uniqueName="[Measures].[4605313f-bbb7-4de0-b2a1-2c996262c0bb]" caption="Rotacja w dniach" formula="IIF(Rotacja wariant=1,&amp;#xD;&amp;#xA;IIF(Sprzedaż Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Liczba Dni*Ilość/Sprzedaż Ilość),&amp;#xD;&amp;#xA;IIF(Sprzedaż Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Liczba Dni*Wartość Netto/Sprzedaż Wartość Netto)&amp;#xD;&amp;#xA;)&amp;#xD;&amp;#xA;" description="" summaryType="Sum" /&gt;&lt;/whatifMeasures&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Rotacja wariant"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Liczba Dni"&gt;&lt;cells fontName="Segoe UI" fontSize="8" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Sprzedaż Wartość Netto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Sprzedaż Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="[Measures].[4605313f-bbb7-4de0-b2a1-2c996262c0bb]"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" horzAlignment="Far" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" horzAlignment="Near" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="False" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Rotacja wariant" index="6" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters filetrMask="" isAllChecked="True" showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Ilość" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Wartość Netto" index="5" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Liczba Dni" index="3" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Sprzedaż Wartość Netto" index="4" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Sprzedaż Ilość" index="2" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="[Measures].[4605313f-bbb7-4de0-b2a1-2c996262c0bb]" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="False" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Object"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Produkt Kod" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport rotacji analizuje szczegółowo stany magazynowe i sprzedaż towarów w zadanym okresie, uwzględniając ich strukturę grupową, atrybuty, dostawców, producentów oraz inne właściwości. Umożliwia ocenę dostępności i rotacji produktów w czasie, z podziałem na dni, tygodnie, miesiące i kwartały, wspierając podejmowanie decyzji zakupowych i optymalizację stanów magazynowych.</a:description><a:id>277</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.37 Rotacja w dniach w zakresie</a:mainLinkName><a:modifiedOn>2025-04-14T12:13:10.53</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts/><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2024-10-02T11:20:13.513</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Rotacji w zakresie&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END&#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Tworzenie tabeli tymczasowej dat&#xD;
DECLARE @tmpDataOd DATETIME;&#xD;
SET @tmpDataOd = @DataOd&#xD;
CREATE TABLE #TmpDates (Data DATETIME)&#xD;
&#xD;
WHILE @tmpDataOd&lt;=@DataDo&#xD;
BEGIN&#xD;
    INSERT INTO #TmpDates VALUES (@tmpDataOd)&#xD;
    SET @tmpDataOd = @tmpDataOd + 1&#xD;
END                 &#xD;
    &#xD;
CREATE UNIQUE CLUSTERED INDEX bu ON #TmpDates ([Data])&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, TrE_DataOpe, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
    AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
    AND TrE_DataOpe BETWEEN @DataOd AND @DataDo&#xD;
GROUP BY TrE_MagId, TrE_TwrId, TrE_DataOpe  &#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
&#xD;
--Właściwe zapytanie    &#xD;
set @select =&#xD;
'DECLARE @IloscDni INT; SET @IloscDni = DATEDIFF ( D, ''' + convert(varchar, @DataOd) + ''', ''' + convert(varchar, @DataDo) + ''') + 1;&#xD;
SELECT DB_NAME() [Baza Firmowa],&#xD;
CASE WHEN ''' + @ROTACJA + ''' = ''ilość'' THEN 1 ELSE 0 END [Rotacja wariant],&#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    Twr_Nazwa [Produkt Nazwa],&#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca], &#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],&#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(NULLIF(Twr_EAN, ''''), ''(BRAK)'')  [Produkt EAN],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END [Ilość], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TWI.TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
    ISNULL(TWI.TwI_Rezerwacje, 0) [Rezerwacje], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TWI.TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Rezerwacje Jednostka Pomocnicza], &#xD;
    ISNULL(TWI.TwI_Braki, 0) [Braki], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TWI.TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Braki Jednostka Pomocnicza], &#xD;
    ISNULL(TWI.TwI_Zamowienia, 0) [Zamówienia], &#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TWI.TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Zamówienia Jednostka Pomocnicza],&#xD;
    CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Wartosc ELSE 0 END [Wartość Netto],&#xD;
    ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto], @IloscDni [Liczba Dni],&#xD;
    NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
    CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END [Ilość Ostatni Dzień],&#xD;
    SprzedazWartosc [Sprzedaż Wartość Netto], SprzedazIlosc [Sprzedaż Ilość], NULL [Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców],&#xD;
    CASE WHEN twi3.data = eom.eom THEN TWI.TwI_Ilosc ELSE 0 END [Ilość M],&#xD;
    CASE WHEN twi3.data = eom.eom THEN ISNULL(TWI.TwI_Wartosc, 0) ELSE 0 END [Wartość Netto M],&#xD;
    CASE WHEN twi3.data = eom.eom THEN ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) ELSE 0 END [Wartość Brutto M],&#xD;
    CASE WHEN twi3.data = eow.eow THEN TWI.TwI_Ilosc ELSE 0 END [Ilość T],&#xD;
    CASE WHEN twi3.data = eow.eow THEN ISNULL(TWI.TwI_Wartosc, 0) ELSE 0 END [Wartość Netto T],&#xD;
    CASE WHEN twi3.data = eow.eow THEN ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) ELSE 0 END [Wartość Brutto T]&#xD;
    /*&#xD;
    ----------DATA POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') [Data]&#xD;
*/&#xD;
    ----------DATA ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') [Data Dzień], (datepart(DY, datediff(d, 0, twi3.data) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, twi3.data)*/ [Data Tydzień Roku]&#xD;
    ,MONTH(twi3.data) [Data Miesiąc], DATEPART(quarter, twi3.data) [Data Kwartał], YEAR(twi3.data) [Data Rok] &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Odbiorca Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + '                                     &#xD;
FROM cdn.TwrIlosci TWI&#xD;
    JOIN (&#xD;
        SELECT MAX(TwI_Data) as MaxData, TwI_MagId, TwI_TwrId, Data &#xD;
        FROM CDN.TwrIlosci TWI2&#xD;
        CROSS JOIN #TmpDates &#xD;
        WHERE TWI2.TwI_MagId IS NOT NULL AND TWI2.TwI_Data &lt;= Data&#xD;
        GROUP BY  TWI2.TwI_MagId, TWI2.TwI_TwrId, data &#xD;
    )TWI3 ON TWI3.TwI_TwrId = TWI.TwI_TwrId AND TWI3.TwI_MagId = TWI.TwI_MagId AND TWI3.MaxData = TWI.TwI_Data  &#xD;
    JOIN CDN.Towary ON TWI.TwI_TwrId = Twr_TwrId    &#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    JOIN CDN.Magazyny ON TWI.TwI_MagId = Mag_MagId  &#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TWI.TwI_TwrId  = TwrAtr.TwA_TwrId &#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TWI.TwI_MagId = TrE_MagId AND TWI.TwI_TwrId = TrE_TwrId AND twi3.data = TrE_DataOpe&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
    LEFT JOIN &#xD;
    (select distinct eomonth(data) eom from #TmpDates) eom on eom.eom = twi3.data&#xD;
    LEFT JOIN&#xD;
    (select distinct DATEADD(wk, DATEDIFF(wk, 6, data), 6) eow from #TmpDates) eow on eow.eow = twi3.data&#xD;
WHERE TWI.TwI_MagId IS NOT NULL'&#xD;
&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' AND (ISNULL(TwI_Ilosc, 0) &lt;&gt; 0 OR SprzedazWartosc &lt;&gt; 0)&#xD;
&#xD;
union all&#xD;
SELECT DB_NAME() [Baza Firmowa],&#xD;
CASE WHEN ''' + @ROTACJA + ''' = ''ilość'' THEN 1 ELSE 0 END [Rotacja wariant],&#xD;
    Twr_Kod [Produkt Kod], &#xD;
    Twr_Nazwa [Produkt Nazwa], &#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],&#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(NULLIF(Twr_EAN, ''''), ''(BRAK)'')  [Produkt EAN],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    NULL [Ilość], &#xD;
    NULL [Ilość Jednostka Pomocnicza], &#xD;
    NULL [Rezerwacje], &#xD;
    NULL [Rezerwacje Jednostka Pomocnicza], &#xD;
    NULL [Braki], &#xD;
    NULL [Braki Jednostka Pomocnicza], &#xD;
    NULL [Zamówienia], &#xD;
    NULL [Zamówienia Jednostka Pomocnicza],&#xD;
    NULL [Wartość Netto], &#xD;
    NULL [Wartość Brutto], NULL [Liczba Dni],&#xD;
    NULL [Ilość Minimalna],&#xD;
    NULL [Ilość Maksymalna],&#xD;
    NULL [Ilość Ostatni Dzień],&#xD;
    NULL [Sprzedaż Wartość Netto], NULL [Sprzedaż Ilość],&#xD;
     TrE_Ilosc [Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców],&#xD;
        NULL [Ilość M],&#xD;
    NULL [Wartość Netto M],&#xD;
    NULL [Wartość Brutto M],&#xD;
    NULL [Ilość T],&#xD;
    NULL [Wartość Netto T],&#xD;
    NULL [Wartość Brutto T]&#xD;
/*&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120), 111), ''/'', ''-'') [Data]&#xD;
*/&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120), 111), ''/'', ''-'') [Data Dzień], (datepart(DY, datediff(d, 0, convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120))*/ [Data Tydzień Roku] &#xD;
    ,MONTH(convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) [Data Miesiąc], DATEPART(quarter, convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) [Data Kwartał], YEAR(convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) [Data Rok]&#xD;
&#xD;
    ----------KONTEKSTY&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Odbiorca Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + '                                         &#xD;
FROM  (select TrE_TwrId,TrE_MagId,sum(TrE_Ilosc) TrE_Ilosc from cdn.TraNag &#xD;
left join cdn.TraElem on TrN_TrNID = TrE_TrNId&#xD;
where TrN_DataDok &lt;= convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)&#xD;
and TrN_TypDokumentu = 309 and TrN_ZwroconoCalaIlosc &lt;3&#xD;
group by TrE_TwrId,TrE_MagId&#xD;
) a&#xD;
left join cdn.Towary on a.TrE_TwrId = Twr_TwrId&#xD;
left join cdn.Magazyny on Mag_MagId = a.TrE_MagId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON a.TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #TmpDates&#xD;
DROP TABLE #tmpSprzedaz&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RG5e/t8t+X7zv805Ew+SD4q4tb3pMGF8tO7UTyhwSUC/Gd6+iwZB2jzDwJgFJoAzREF9NpiTvD7JPaMMU+LfS6ewgmq9kAP6qcqvE25r7AOePFN3U68zd3f4ZCU/uYVcSX601vEYGiZ7T3be4TMftfLMkcbDZWuSOUcEuJiTAnk9R9Z5uxqTmH</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Rotacja wariant" caption="Rotacja wariant" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt EAN" caption="Produkt EAN" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba Dni" caption="Liczba Dni" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Ostatni Dzień" caption="Ilość Ostatni Dzień" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" caption="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość M" caption="Ilość M" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto M" caption="Wartość Netto M" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto M" caption="Wartość Brutto M" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość T" caption="Ilość T" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto T" caption="Wartość Netto T" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto T" caption="Wartość Brutto T" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Dzień" caption="Data Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Tydzień Roku" caption="Data Tydzień Roku" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Miesiąc" caption="Data Miesiąc" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Kwartał" caption="Data Kwartał" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Rok" caption="Data Rok" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 6" caption="Produkt Grupa Poziom 6" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[2a49afe4-593a-4dc0-b3e1-49d95ff7bc99]" caption="Rotacja w Razach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;DATAOD&lt;/Label&gt;&#xD;
    &lt;Expression /&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;DATADO&lt;/Label&gt;&#xD;
    &lt;Expression /&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ROTACJA&lt;/Name&gt;&#xD;
    &lt;Label&gt;ROTACJA&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Sposób obliczania rotacji&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'ilość';'wartość'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'ilość'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;whatifMeasures&gt;&lt;whatifMeasure uniqueName="[Measures].[2a49afe4-593a-4dc0-b3e1-49d95ff7bc99]" caption="Rotacja w Razach" formula="IIF(Rotacja wariant=1,&amp;#xD;&amp;#xA;IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Liczba Dni*Sprzedaż Ilość/Ilość),&amp;#xD;&amp;#xA;IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Liczba Dni*Sprzedaż Wartość Netto/Wartość Netto)&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&lt;/whatifMeasures&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Rotacja wariant"&gt;&lt;cells fontName="Segoe UI" fontSize="8" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Liczba Dni"&gt;&lt;cells fontName="Segoe UI" fontSize="8" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Sprzedaż Wartość Netto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Sprzedaż Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="[Measures].[2a49afe4-593a-4dc0-b3e1-49d95ff7bc99]"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" horzAlignment="Far" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" horzAlignment="Near" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="False" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Rotacja wariant" index="0" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Ilość" index="2" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Wartość Netto" index="5" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Liczba Dni" index="3" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Int32"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Sprzedaż Wartość Netto" index="6" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Sprzedaż Ilość" index="4" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="[Measures].[2a49afe4-593a-4dc0-b3e1-49d95ff7bc99]" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="False" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Object"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Produkt Kod" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport analizuje rotację towarów w wybranym przedziale dat, generując dane o stanach magazynowych, sprzedaży, rezerwach i atrybutach produktów. Uwzględnia strukturę grup towarowych oraz szczegółowe informacje o produktach (dostawcy, waga, EAN, kategorie, itp.). Wspiera analizę rotacji zarówno ilościową, jak i wartościową, z podziałem na dni, tygodnie, miesiące i kwartały.</a:description><a:id>278</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.38 Rotacja w razach w zakresie</a:mainLinkName><a:modifiedOn>2025-04-14T12:13:46.85</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2024-10-02T11:29:01.477</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport Analiza opakowań na dzień&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
	SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
		BEGIN&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
			EXEC(@sql)&#xD;
			&#xD;
			SET @sql = N'UPDATE #tmpTwrGr&#xD;
				SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
			EXEC(@sql)&#xD;
		END&#xD;
    ELSE&#xD;
		BEGIN &#xD;
    		SET @sql = N'UPDATE c&#xD;
				SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
					ELSE CAST(p.kod AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
			EXEC(@sql)&#xD;
	&#xD;
			SET @sql = N'UPDATE c&#xD;
				SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
					CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
					ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
				FROM #tmpTwrGr c&#xD;
				LEFT JOIN #tmpTwrGr p&#xD;
				ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
				EXEC(@sql)&#xD;
		END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @select3 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
	set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
	set @i = @i + 1&#xD;
end&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Kontrahentów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @atrybuty varchar(max), @sqlA nvarchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT KnA_DeAid FROM CDN.KntAtrybuty)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT KnA_PodmiotId, KnA_PodmiotTyp INTO #tmpKonAtr FROM CDN.KntAtrybuty&#xD;
&#xD;
SET @atrybuty = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 1 BEGIN SET @atrybut_kod = @atrybut_kod + ' (T)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpKonAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpKonAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.KnA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
		 ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.KnA_WartoscTxt,'','',''.'') ELSE ATR.KnA_WartoscTxt END &#xD;
		 END  &#xD;
		FROM CDN.KntAtrybuty ATR &#xD;
		JOIN #tmpKonAtr TM ON ATR.KnA_PodmiotId = TM.KnA_PodmiotId AND ATR.KnA_PodmiotTyp = TM.KnA_PodmiotTyp&#xD;
		WHERE ATR.KnA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybuty = @atrybuty + N', ISNULL(KonAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Kontrahent Pierwotny Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']' &#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybutyTwr varchar(max), @atrybutyTwr2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
SET @atrybutyTwr2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
	IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
	IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
	SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
	SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
		SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
		 ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
		END	 &#xD;
		FROM CDN.TwrAtrybuty ATR &#xD;
		JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
		WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
	EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
	SET @atrybutyTwr2 = @atrybutyTwr2 + N', ''(NIEPRZYPISANE)'' [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
	FETCH NEXT FROM atrybut_cursor&#xD;
	INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
----Wyliczanie stanu początkowego opakowań&#xD;
select&#xD;
sum((Case when Trn_typdokumentu = 313 then -1 else 1 end) * TrE_Ilosc) [Ilosc],&#xD;
sum((Case when Trn_typdokumentu = 313 then -1 else 1 end) * TrE_WartoscBrutto) [Brutto],&#xD;
sum((Case when Trn_typdokumentu = 313 then -1 else 1 end) * TrE_WartoscNetto) [Netto],&#xD;
TrE_MagId MagId,&#xD;
TrE_TwRID TwRID,&#xD;
TrE_PodID PodID&#xD;
into #tmpstan&#xD;
from cdn.TraNag&#xD;
left join cdn.TraElem on TrN_TrNID=TrE_TrNId&#xD;
where TrN_TypDokumentu IN (314,313) AND TrE_DataDok &lt; convert(datetime,@DataOd, 120) &#xD;
group by TrE_MagId,TrE_PodID,TrE_TwRID&#xD;
&#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select =&#xD;
'SELECT&#xD;
case when TrN_TypDokumentu = 313 then ''PKA'' else ''WKA'' end [Dokument Typ],&#xD;
TrN_NumerPelny [Dokument Numer],&#xD;
REPLACE(CONVERT(VARCHAR(10),  TrE_DataDok, 111), ''/'', ''-'') [Dokument Data],&#xD;
Knt_Nazwa1 [Kontrahent Nazwa],&#xD;
KnT_Kod [Kontrahent Kod],&#xD;
(Case when Trn_typdokumentu = 313 then -1 else 1 end) * TrE_Ilosc [Opakowanie Ilość],&#xD;
(Case when Trn_typdokumentu = 313 then -1 else 1 end) * TrE_WartoscBrutto [Opakowanie Wartość Brutto],&#xD;
(Case when Trn_typdokumentu = 313 then -1 else 1 end) * TrE_WartoscNetto [Opakowanie Wartość Netto],&#xD;
stany.ilosc [Opakowanie Stan Początkowy Ilość],&#xD;
stany.Netto [Opakowanie Stan Początkowy Netto],&#xD;
stany.Brutto [Opakowanie Stan Początkowy Brutto],&#xD;
TrE_TwrNazwa [Produkt Nazwa],&#xD;
TrE_TwrKod [Produkt Kod]&#xD;
&#xD;
 '  + @kolumny + @atrybuty + @atrybutyTwr +'&#xD;
&#xD;
FROM cdn.TraNag&#xD;
LEFT JOIN cdn.TraElem ON TrN_TrNID=TrE_TrNId&#xD;
LEFT JOIN cdn.Towary ON Tre_TwRID = TwR_TwRID&#xD;
LEFT JOIN cdn.Kontrahenci ON Knt_KntId=TrN_PodID&#xD;
LEFT JOIN #tmpKonAtr KonAtr ON Knt_KntId = KonAtr.KnA_PodmiotId&#xD;
LEFT JOIN  #tmpTwrGr poz ON Twr_TwGGIDNumer = poz.gidNumer&#xD;
LEFT JOIN #tmpTwrAtr twratr ON twratr.TwA_TwrId = TwR_TwRId&#xD;
LEFT JOIN #tmpstan stany ON stany.MagId = TrE_MagId AND stany.podid = TrE_PodId AND stany.TwRId = TrE_TwRId&#xD;
&#xD;
WHERE TrN_TypDokumentu IN (314,313) AND TrN_PodmiotTyp = 1 &#xD;
&#xD;
AND TrE_DataDok &lt;= convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) AND TrE_DataDok &gt;= convert(datetime,''' + convert(varchar, @DataOd, 120) + ''', 120)'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpKonAtr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpStan&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RG5e/t8t+X7zv805Ew+SD4q4tb3pMGF8tO7UTyhwSUC/Gd6+iwZB2ji2hPfAjFY4M+tyTN+WFbqesYguIRD4zhi2+XbPG4+IXlBAY1WtwNgyWhhgg2DLjiTmd8QWzd4S48umcSZUrrUqKFUikgGFuKUE6/c5LlVGtOckIiL+1rWVN9YoxYiyqr</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Dokument Typ" caption="Dokument Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Dokument Data" caption="Dokument Data" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Kontrahent Kod" caption="Kontrahent Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Opakowanie Ilość" caption="Opakowanie Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Opakowanie Wartość Brutto" caption="Opakowanie Wartość Brutto" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Opakowanie Wartość Netto" caption="Opakowanie Wartość Netto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Opakowanie Stan Początkowy Ilość" caption="Opakowanie Stan Początkowy Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Opakowanie Stan Początkowy Netto" caption="Opakowanie Stan Początkowy Netto" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Opakowanie Stan Początkowy Brutto" caption="Opakowanie Stan Początkowy Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 6" caption="Produkt Grupa Poziom 6" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[ac8f82bb-b3de-4d0d-a400-721a3692bc70]" caption="Opakowanie Stan Końcowy Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[6f53e1c6-c3f9-4ec1-a855-8516f06c13ca]" caption="Opakowanie Stan Końcowy Wartość Netto" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[7ef7e30f-f6c6-4e5a-a9da-3abbfb790d39]" caption="Opakowanie Stan Końcowy Wartość Brutto" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;DATAOD&lt;/Label&gt;&#xD;
    &lt;Expression /&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;DATADO&lt;/Label&gt;&#xD;
    &lt;Expression /&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAMAAAAAAAAA/////wAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;whatifMeasures&gt;&lt;whatifMeasure uniqueName="[Measures].[ac8f82bb-b3de-4d0d-a400-721a3692bc70]" caption="Opakowanie Stan Końcowy Ilość" formula="Opakowanie Stan Początkowy Brutto + Opakowanie Ilość" description="" summaryType="Sum" /&gt;&lt;whatifMeasure uniqueName="[Measures].[6f53e1c6-c3f9-4ec1-a855-8516f06c13ca]" caption="Opakowanie Stan Końcowy Wartość Netto" formula="Opakowanie Stan Początkowy Netto + Opakowanie Wartość Netto" description="" summaryType="Sum" /&gt;&lt;whatifMeasure uniqueName="[Measures].[7ef7e30f-f6c6-4e5a-a9da-3abbfb790d39]" caption="Opakowanie Stan Końcowy Wartość Brutto" formula="Opakowanie Stan Początkowy Brutto + Opakowanie Wartość Brutto" description="" summaryType="Sum" /&gt;&lt;/whatifMeasures&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Kontrahent Nazwa"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Opakowanie Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Opakowanie Wartość Netto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Opakowanie Stan Początkowy Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Opakowanie Stan Początkowy Netto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Opakowanie Stan Początkowy Brutto"&gt;&lt;cells fontName="Segoe UI" fontSize="8" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="[Measures].[ac8f82bb-b3de-4d0d-a400-721a3692bc70]"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" horzAlignment="Far" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" horzAlignment="Near" width="180" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="False" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;format ref="[Measures].[6f53e1c6-c3f9-4ec1-a855-8516f06c13ca]"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" horzAlignment="Far" format="n2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" horzAlignment="Near" width="219" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="False" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" horzAlignment="Near" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" horzAlignment="Far" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Opakowanie Ilość" index="5" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters filetrMask="" isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Opakowanie Wartość Netto" index="4" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Opakowanie Stan Początkowy Ilość" index="6" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters filetrMask="" isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Opakowanie Stan Początkowy Netto" index="3" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters filetrMask="" isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Opakowanie Stan Początkowy Brutto" index="0" expanded="True" sortMode="default" order="ascending" width="0" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="[Measures].[ac8f82bb-b3de-4d0d-a400-721a3692bc70]" index="2" expanded="True" sortMode="default" order="ascending" width="180" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="False" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Object"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="[Measures].[6f53e1c6-c3f9-4ec1-a855-8516f06c13ca]" index="1" expanded="True" sortMode="default" order="ascending" width="219" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="False" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Object"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Kontrahent Nazwa" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Produkt Kod" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description/><a:id>279</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.39 Analiza opakowań na dzień</a:mainLinkName><a:modifiedOn>2025-02-04T11:27:12.13</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts/><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2023-06-05T14:49:04.747</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>/*&#xD;
* Raport zasobów magazynowych na dzień z atrybutami zasobów&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Wyliczanie Atrybutów Zasobów&#xD;
DECLARE @atrybutyZas varchar(max);&#xD;
DECLARE @atrybutyZas2 varchar(max);&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in &#xD;
(&#xD;
SELECT DISTINCT TsC_Cecha1_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha2_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha3_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha4_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha5_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha6_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha7_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha8_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha9_DeAId FROM CDN.TraSElemCechy&#xD;
UNION ALL&#xD;
SELECT DISTINCT TsC_Cecha10_DeAId FROM CDN.TraSElemCechy&#xD;
)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TsC_TrSID INTO #tmpZasAtr FROM CDN.TraSElemCechy&#xD;
&#xD;
SET @atrybutyZas = ''&#xD;
SET @atrybutyZas2 = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
       IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
       IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
       SET @sqlA = N'ALTER TABLE #tmpZasAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
       SET @sqlA = N'UPDATE #tmpZasAtr&#xD;
             SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = &#xD;
             CASE&#xD;
                WHEN ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha1_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    else  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha1_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha1_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha2_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha2_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha2_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha3_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha3_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha3_Wartosc END END &#xD;
                WHEN ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha4_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha4_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha4_Wartosc END END &#xD;
                WHEN ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha5_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha5_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha5_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha6_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha6_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha6_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha7_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha7_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha7_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha8_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha8_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha8_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha9_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha9_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha9_Wartosc END END&#xD;
                WHEN ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' THEN  case WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TsC_Cecha10_Wartosc),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
                    ELSE  CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TsC_Cecha10_Wartosc,'','',''.'') ELSE ATR.TsC_Cecha10_Wartosc END END&#xD;
             ELSE ''(NIEPRZYPISANE)'' END&#xD;
             FROM CDN.TraSElemCechy ATR &#xD;
             JOIN #tmpZasAtr TM ON ATR.TsC_TrSID = TM.TsC_TrSID&#xD;
             WHERE ATR.TsC_Cecha1_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha2_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha3_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha4_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha5_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha6_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha7_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha8_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha9_DeAId = ' + CAST(@atrybut_id AS nvarchar) + ' OR &#xD;
             ATR.TsC_Cecha10_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
       EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyZas = @atrybutyZas + N', ISNULL(ZasAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Zasoby Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
    SET @atrybutyZas2 = @atrybutyZas2 + N', ''(NIEPRZYPISANE)'' AS [Zasoby Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'&#xD;
&#xD;
       FETCH NEXT FROM atrybut_cursor&#xD;
       INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Tworzenie tabeli z serią dokumentów&#xD;
SELECT DDf_DDfID, CASE &#xD;
    WHEN DDf_Numeracja like '@rejestr%' THEN 5 &#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 1) = '@rejestr' THEN 1&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 2) = '@rejestr' THEN 2&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 3) = '@rejestr' THEN 3&#xD;
    WHEN PARSENAME(REPLACE(REPLACE(REPLACE(substring(ddf_numeracja,CHARINDEX('/',ddf_numeracja,0)+1,50), '@brak/',''), '/@brak',''), '/', '.'), 4) = '@rejestr' THEN 4&#xD;
END [seria]  INTO #tmpSeria FROM CDN.DokDefinicje&#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
--Właściwe zapytanie&#xD;
set @select = &#xD;
'SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    TrN_NumerPelny [Dokument Dostawy Numer], &#xD;
    CASE when isnull(ser.seria,0) = 5 then &#xD;
        substring(TrN_NumerPelny,0,CHARINDEX(''/'',TrN_NumerPelny,0))&#xD;
    ELSE &#xD;
        ISNULL(PARSENAME(REPLACE(substring(TrN_NumerPelny,CHARINDEX(''/'',TrN_NumerPelny,0)+1,50), ''/'', ''.''), ser.seria),''(BRAK)'') &#xD;
    END [Dokument Seria],&#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    Twr_Nazwa [Produkt Nazwa], &#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],     &#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ],&#xD;
    TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Prd_Nazwa [Producent Nazwa],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    ISNULL(knt.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Kod],  &#xD;
    ISNULL(knt.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Pierwotny Nazwa], &#xD;
    ISNULL(knt3.KnT_Kod, ''(NIEPRZYPISANY)'') [Dostawca Kod],   &#xD;
    ISNULL(knt3.Knt_Nazwa1, ''(NIEPRZYPISANY)'') [Dostawca Nazwa], &#xD;
    knt4.Knt_Nazwa1 [Kontrahent Nazwa],&#xD;
    TrE_Ilosc * (ISNULL(NULLIF(sumy.Ilosc, 0), 1.0) / ISNULL(NULLIF(sum(sumy.ilosc) over (partition by TrE_TrEID, MG.Mag_MagId), 0), 1.0)) [Ilość w Dostawie],&#xD;
    sumy.Ilosc AS [Ilość], &#xD;
    DATEDIFF(day,TS.TrS_DataOpe, ''' + CONVERT(VARCHAR,@Data) + ''') [Liczba dni zalegania],&#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),sumy.Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
    NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
    sumy.Wartosc [Wartość Netto], sumy.Wartosc * (1 + Twr_Stawka/100) [Wartość Brutto]&#xD;
/*&#xD;
&#xD;
    ----------DATY POINT&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TS.TrS_DataOpe, 111), ''/'', ''-'') [Data Dostawy]&#xD;
*/&#xD;
&#xD;
    ----------DATY ANALIZY&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TS.TrS_DataOpe, 111), ''/'', ''-'') [Data Dostawy Dzień], (datepart(DY, datediff(d, 0, TS.TrS_DataOpe) / 7 * 7 + 3)+6) / 7 [Data Dostawy Tydzień Roku] &#xD;
    ,MONTH(TS.TrS_DataOpe) [Data Dostawy Miesiąc],  DATEPART(quarter, TS.TrS_DataOpe) [Data Dostawy Kwartał], YEAR(TS.TrS_DataOpe) [Data Dostawy Rok]   &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
                                    ,CASE                               &#xD;
        WHEN TrN_TypDokumentu = 312 THEN 25034&#xD;
        WHEN TrN_TypDokumentu = 303 THEN 25032&#xD;
        WHEN TrN_TypDokumentu = 317 THEN 25045&#xD;
        WHEN TrN_TypDokumentu = 307 THEN 25024&#xD;
        WHEN TrN_TypDokumentu = 313 THEN 25079&#xD;
    END [Dokument Dostawy Numer __PROCID__PZ__], TrN_TrNId [Dokument Dostawy Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Dostawy Numer __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Kod __PROCID__Kontrahenci__], knt.Knt_KntId [Dostawca Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Nazwa __PROCID__], knt.Knt_KntId [Dostawca Pierwotny Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Dostawca Kod __PROCID__Kontrahenci__], knt3.Knt_KntId [Dostawca Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Nazwa __PROCID__], knt3.Knt_KntId [Dostawca Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Nazwa __DATABASE__]&#xD;
    ' + @kolumny + @atrybutyTwr + @atrybutyZas + '&#xD;
FROM (SELECT TrS_TrSIdDost, TrS_MagId&#xD;
            ,SUM(CASE TrS_Typ WHEN 2 THEN -1 ELSE 1 END * TrS_Ilosc)  AS [Ilosc]&#xD;
            ,SUM(CASE TrS_Typ WHEN 2 THEN -1 ELSE 1 END * TrS_Wartosc)  AS [Wartosc]    &#xD;
        FROM CDN.TraSElem                       &#xD;
        WHERE TrS_DataOpe &lt;= ''' + CONVERT(VARCHAR,@Data) + ''' and trs_typ in (1,2)&#xD;
        GROUP BY TrS_TrSIdDost, TrS_MagId        &#xD;
        ) sumy &#xD;
INNER JOIN CDN.TraSElem TS ON sumy.TrS_TrSIdDost = TS.TrS_TrSID&#xD;
INNER JOIN CDN.TraElem TE ON TS.TrS_TrEId = TE.TrE_TrEID&#xD;
INNER JOIN CDN.TraNag TN ON TE.TrE_TrNId = TN.TrN_TrNID&#xD;
INNER JOIN CDN.Towary TK ON TE.TrE_TwrId = TK.Twr_TwrId&#xD;
INNER JOIN CDN.Magazyny MG ON MG.Mag_MagId = sumy.TrS_MagId&#xD;
LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
    LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
LEFT JOIN #tmpSeria ser ON TrN_DDfId = DDf_DDfID&#xD;
    LEFT JOIN CDN.Kontrahenci knt ON TrN_PodId = KnT_KnTId AND TrN_PodmiotTyp = 1&#xD;
    LEFT JOIN CDN.Kontrahenci knt3 ON knt.Knt_GlID=knt3.Knt_KntId&#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwR_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT JOIN #tmpZasAtr ZasAtr ON Trs_TrSId = ZasAtr.TsC_TrSID&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0'&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' where (sumy.Wartosc &gt;0 or sumy.Ilosc &gt; 0)'&#xD;
&#xD;
SET @select = @select + '&#xD;
&#xD;
UNION ALL&#xD;
&#xD;
SELECT&#xD;
    BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    ''(BRAK)'' [Dokument Dostawy Numer], &#xD;
    ''(BRAK)'' [Dokument Seria],&#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    Twr_Nazwa [Produkt Nazwa], &#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],     &#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    CASE&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
        WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ],&#xD;
    TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Prd_Nazwa [Producent Nazwa],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    ''(NIEPRZYPISANY)'' [Dostawca Pierwotny Kod],   &#xD;
    ''(NIEPRZYPISANY)'' [Dostawca Pierwotny Nazwa], &#xD;
    ''(NIEPRZYPISANY)'' [Dostawca Kod],     &#xD;
    ''(NIEPRZYPISANY)'' [Dostawca Nazwa], &#xD;
    knt4.Knt_Nazwa1 [Kontrahent Nazwa],&#xD;
    0 [Ilość w Dostawie],&#xD;
    0 [Ilość], &#xD;
    0 [Liczba dni zalegania],&#xD;
    0 [Ilość Jednostka Pomocnicza], &#xD;
    NULLIF(Twr_IloscMin,0) [Ilość Minimalna], NULLIF(Twr_IloscMax,0) [Ilość Maksymalna],&#xD;
    ISNULL(TwI_Wartosc, 0) [Wartość Netto], ISNULL(TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Wartość Brutto]&#xD;
/*&#xD;
&#xD;
    ----------DATY POINT&#xD;
    ,NULL [Data Dostawy]&#xD;
*/&#xD;
&#xD;
    ----------DATY ANALIZY&#xD;
    ,NULL [Data Dostawy Dzień], NULL [Data Dostawy Tydzień Roku] &#xD;
    ,NULL [Data Dostawy Miesiąc], NULL [Data Dostawy Kwartał], NULL [Data Dostawy Rok]  &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
    ,NULL [Dokument Dostawy Numer __PROCID__PZ__], NULL [Dokument Dostawy Numer __ORGID__],'''+@bazaFirmowa+''' [Dokument Dostawy Numer __DATABASE__]&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Kod __PROCID__Kontrahenci__], NULL [Dostawca Pierwotny Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Pierwotny Nazwa __PROCID__], NULL [Dostawca Pierwotny Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Pierwotny Nazwa __DATABASE__]&#xD;
    ,20201 [Dostawca Kod __PROCID__Kontrahenci__], NULL [Dostawca Kod __ORGID__],'''+@bazaFirmowa+''' [Dostawca Kod __DATABASE__]&#xD;
    ,20201 [Dostawca Nazwa __PROCID__], NULL [Dostawca Nazwa __ORGID__],'''+@bazaFirmowa+''' [Dostawca Nazwa __DATABASE__]&#xD;
    ' + @kolumny + @atrybutyTwr + @atrybutyZas2 + '&#xD;
&#xD;
FROM CDN.TwrIlosci TI&#xD;
    JOIN CDN.Towary TK ON TI.TwI_TwrId = TK.Twr_TwrId&#xD;
    LEFT OUTER JOIN CDN.Magazyny MG ON MG.Mag_MagId = TI.TwI_MagId&#xD;
    LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
    LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId = kat.Kat_KatID&#xD;
    LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON TwR_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
WHERE TwI_TwrId NOT IN (SELECT TrS_TwrId&#xD;
        FROM CDN.TraSElem                       &#xD;
        WHERE TrS_DataOpe &lt;= ''' + CONVERT(VARCHAR,@Data) + ''' and TrS_Typ in (1, 2))&#xD;
AND 1 ='&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' 0' ELSE SET @select = @select + ' 1' &#xD;
&#xD;
exec (@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSeria&#xD;
DROP TABLE #tmpZasAtr&#xD;
&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RG5e/t8t+X7zv805Ew+SD4q4tb3pMGF8tO7UTyhwSUC/Gd6+iwZB2jsd7hyuUyC8Sdgsl2n/BMjJgiNky53VdN6s+A30dZyDERDxjVxsQnjHChMl6Nve0YtI0skB0usVvB/MqySffaOuuZqCzq0pKnvsjpaKhxxPwZ/2+ghwDXEmC4OPJDAAQ9iKNBEB706qqf90ELy4akSOPWmjMA2j25</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Dostawy Numer" caption="Dokument Dostawy Numer" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Seria" caption="Dokument Seria" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="" aggregate="Average" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Producent Nazwa" caption="Producent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Pierwotny Kod" caption="Dostawca Pierwotny Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Pierwotny Nazwa" caption="Dostawca Pierwotny Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Kod" caption="Dostawca Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dostawca Nazwa" caption="Dostawca Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Kontrahent Nazwa" caption="Kontrahent Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość w Dostawie" caption="Ilość w Dostawie" type="measure" formatString="" aggregate="Average" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba dni zalegania" caption="Liczba dni zalegania" type="measure" formatString="n2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="" aggregate="Max" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Dostawy Dzień" caption="Data Dostawy Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Tydzień Roku" caption="Data Dostawy Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Miesiąc" caption="Data Dostawy Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Kwartał" caption="Data Dostawy Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dostawy Rok" caption="Data Dostawy Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut USŁUGA SERWISOWA" caption="Produkt Atrybut USŁUGA SERWISOWA" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATA&lt;/Name&gt;&#xD;
    &lt;Label&gt;DATA&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data dla ktroej zostanie wykonana analiza&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETdATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;ZEROWE&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr okreslający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions /&gt;&lt;formatRules /&gt;&lt;dataFields /&gt;&lt;rowFields /&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje zasoby magazynowe na dzień w podziale na dostawy, w których zostały przyjęte. Raport zawiera atrybuty zasobów.</a:description><a:id>280</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.40 Zasoby magazynowe na dzień z atrybutami zasobów</a:mainLinkName><a:modifiedOn>2025-04-14T12:10:30.9</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2024-06-07T15:28:04.66</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>&#xD;
/*&#xD;
* Raport Stanów Magazynowych i Inwentaryzacji na dzień&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
--Wyliczanie poziomów grup produktów&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
&#xD;
--Wyliczanie Atrybutów Towarów&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
          ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END &#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
&#xD;
--Liczenie ostatniej daty w bazie&#xD;
SELECT TwI_TwrId [TwI_TId], ISNULL(TwI_MagId,0) [TwI_MId], MAX(TwI_Data) [TwI_OstatniaData] INTO #TwrIlosci&#xD;
FROM CDN.TwrIlosci&#xD;
WHERE TwI_Data &lt;= @DATE&#xD;
GROUP BY TwI_TwrId, TwI_MagId&#xD;
&#xD;
--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
    AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
    AND TrE_DataOpe = @DATE&#xD;
GROUP BY TrE_MagId, TrE_TwrId   &#xD;
&#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
&#xD;
set @select = &#xD;
'&#xD;
SELECT BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    ''Stan magazynowy'' AS [Dokument Numer],&#xD;
    ''Stan magazynowy'' AS [Inwentaryzacja Typ],&#xD;
    Twr_Kod [Produkt Kod],  &#xD;
    Twr_Nazwa [Produkt Nazwa], &#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],&#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    CASE&#xD;
        WHEN Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
    --Miary&#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
&#xD;
    ISNULL(TwI_Ilosc, 0)[Stan Magazynowy Ilość],&#xD;
    ISNULL(TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) [Stan Magazynowy Wartość Brutto],&#xD;
    ISNULL(TwI_Wartosc, 0) [Stan Magazynowy Wartość Netto],&#xD;
    0 AS[Inwentaryzacja Ilość],&#xD;
    0 AS[Inwentaryzacja Wartość Brutto],&#xD;
    0 AS [Inwentaryzacja Wartość Netto]&#xD;
&#xD;
    &#xD;
    --Daty analizy&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), ''' + convert(varchar, @DATE, 120) + ''', 111), ''/'', ''-'') [Data Wystawienia Dzień]&#xD;
    ,(datepart(DY, datediff(d, 0, ''' + convert(varchar, @DATE, 120) + ''') / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, trn.TrN_DataWys)*/ [Data Wystawienia Tydzień Roku] &#xD;
    ,MONTH(''' + convert(varchar, @DATE, 120) + ''') [Data Wystawienia Miesiąc], DATEPART(quarter,''' + convert(varchar, @DATE, 120) + ''') [Data Wystawienia Kwartał], YEAR(''' + convert(varchar, @DATE, 120) + ''') [Data Wystawienia Rok]&#xD;
&#xD;
        ----------KONTEKSTY&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
&#xD;
    --Daty Point&#xD;
    /*&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), ''' + convert(varchar, @DATE, 120) + ''', 111), ''/'', ''-'') [Data Wystawienia]&#xD;
    */&#xD;
    ' + @kolumny + @atrybutyTwr + '&#xD;
FROM CDN.TwrIlosci&#xD;
    LEFT OUTER JOIN CDN.Magazyny ON Mag_MagId = TwI_MagId&#xD;
    JOIN CDN.Towary ON TwI_TwrId = Twr_TwrId&#xD;
     LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
     LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
    JOIN #TwrIlosci ON TwI_TId = TwI_TwrId AND TwI_OstatniaData = TwI_Data AND TwI_MId = TwI_MagId&#xD;
    LEFT OUTER JOIN #tmpSprzedaz ON TwI_MagId = TrE_MagId AND TwI_TwrId = TrE_TwrId&#xD;
        LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON Twr_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
&#xD;
    WHERE twr_typ = 1&#xD;
UNION ALL&#xD;
&#xD;
select  BAZ.Baz_Nazwa [Baza Firmowa], &#xD;
    Trn_NumerPelny as [Dokument Numer], &#xD;
    case when TrN_Rodzaj = 311000 then ''Inwentaryzacja niezamknięta''&#xD;
    else ''Inwentaryzacja zakończona'' END AS [Inwentaryzacja Typ],&#xD;
        Twr_Kod [Produkt Kod], &#xD;
    Twr_Nazwa [Produkt Nazwa], &#xD;
    CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END [Produkt PKWiU],&#xD;
    ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  [Produkt Dostawca],&#xD;
    CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END [Produkt Aktywny],&#xD;
    Twr_JM [Produkt Jednostka Miary], ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') [Produkt Jednostka Miary Pomocnicza], CAST(Twr_Opis as VARCHAR(1024)) [Produkt Opis],&#xD;
    Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') [Produkt Waga KG],&#xD;
    Mag_Symbol [Magazyn Kod],&#xD;
    CASE&#xD;
        WHEN Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
        WHEN Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
        ELSE ''(NIEOKREŚLONY)''&#xD;
    END [Produkt Typ], TwC_Wartosc [Cena Domyślna], ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') [Produkt Producent], ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') [Produkt Marka],&#xD;
    ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') [Produkt Kategoria Szczegółowa], ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') [Produkt Kategoria Ogólna], &#xD;
&#xD;
    --Miary&#xD;
    CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TrE_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END [Ilość Jednostka Pomocnicza], &#xD;
&#xD;
    0 as [Stan Magazynowy Ilość],&#xD;
    0 as [Stan Magazynowy Wartość Brutto],&#xD;
    0 as [Stan Magazynowy Wartość Netto],&#xD;
    ISNULL(TrE_Ilosc, 0)  as[Inwentaryzacja Ilość],&#xD;
    ISNULL(TrE_WartoscBrutto, 0 ) AS [Inwentaryzacja Wartość Brutto],&#xD;
    ISNULL(TrE_WartoscNetto, 0) AS [Inwentaryzacja Wartość Netto]&#xD;
&#xD;
    --Daty Analizy&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia Dzień]&#xD;
    ,(datepart(DY, datediff(d, 0, TrN_DataWys) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, trn.TrN_DataWys)*/ [Data Wystawienia Tydzień Roku] &#xD;
    ,MONTH(TrN_DataWys) [Data Wystawienia Miesiąc], DATEPART(quarter, TrN_DataWys) [Data Wystawienia Kwartał], YEAR(TrN_DataWys) [Data Wystawienia Rok]&#xD;
    ----------KONTEKSTY&#xD;
    ,25003 [Produkt Kod __PROCID__Towary__], Twr_twrId [Produkt Kod __ORGID__],'''+@bazaFirmowa+''' [Produkt Kod __DATABASE__]&#xD;
    ,25003 [Produkt Nazwa __PROCID__], Twr_twrId [Produkt Nazwa __ORGID__],'''+@bazaFirmowa+''' [Produkt Nazwa __DATABASE__]&#xD;
    ,29056 [Magazyn Kod __PROCID__Magazyny__], Mag_MagId [Magazyn Kod __ORGID__],'''+@bazaFirmowa+''' [Magazyn Kod __DATABASE__]&#xD;
    --Daty Point&#xD;
    /*&#xD;
    ,REPLACE(CONVERT(VARCHAR(10), trn.TrN_DataWys, 111), ''/'', ''-'') [Data Wystawienia]&#xD;
    */&#xD;
&#xD;
    ' + @kolumny + @atrybutyTwr + '&#xD;
from cdn.tranag &#xD;
left join cdn.TraElem On TrN_TrNID = TrE_TrNId &#xD;
LEFT JOIN cdn.Magazyny ON Mag_MagId = TrN_MagZrdId &#xD;
left join  CDN.Towary ON Tre_TwrId = Twr_TwrId&#xD;
LEFT JOIN CDN.Producenci ON Prd_PrdId = Twr_PrdId&#xD;
 LEFT JOIN CDN.Marki ON Mrk_MrkId = Twr_MrkId&#xD;
    LEFT JOIN CDN.TwrCeny ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
    LEFT OUTER JOIN CDN.Kategorie kat ON Twr_KatId=kat.Kat_KatID&#xD;
    LEFT JOIN CDN.Kontrahenci knt4 ON Twr_KntId = knt4.Knt_KntId&#xD;
        LEFT JOIN #tmpTwrGr Poz ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
    LEFT JOIN #tmpTwrAtr TwrAtr ON Twr_TwrId  = TwrAtr.TwA_TwrId&#xD;
    LEFT JOIN '+ @Bazy +' BAZ ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
where TrN_Rodzaj IN(311000,311001) AND twr_typ = 1&#xD;
    AND TrN_DataWys &lt;= ''' + convert(varchar, @DATE, 120) + '''&#xD;
'&#xD;
&#xD;
print (@select)&#xD;
exec (@select)&#xD;
&#xD;
DROP TABLE #TwrIlosci&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #tmpSprzedaz&#xD;
&#xD;
&#xD;
</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RG5e/t8t+X7zv805Ew+SD4q4tb3pMGF8tO7UTyhwSUC/Gd6+iwZB2jyra+Oe7op8+HEsrNKk/PEr8e3MQwxTfCJ7bJa+fXaVPqVpYiLhvx7Z/X9WBksnU/iT1mPYU64FmYuAu7pQVo8xPEjiH6H+REeQLBAzBcxY4oRyIN57+c8KXDp4kF4Wqe</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Dokument Numer" caption="Dokument Numer" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Inwentaryzacja Typ" caption="Inwentaryzacja Typ" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Stan Magazynowy Ilość" caption="Stan Magazynowy Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Stan Magazynowy Wartość Brutto" caption="Stan Magazynowy Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Stan Magazynowy Wartość Netto" caption="Stan Magazynowy Wartość Netto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Inwentaryzacja Ilość" caption="Inwentaryzacja Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Inwentaryzacja Wartość Brutto" caption="Inwentaryzacja Wartość Brutto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Inwentaryzacja Wartość Netto" caption="Inwentaryzacja Wartość Netto" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Wystawienia Dzień" caption="Data Wystawienia Dzień" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Wystawienia Tydzień Roku" caption="Data Wystawienia Tydzień Roku" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Wystawienia Miesiąc" caption="Data Wystawienia Miesiąc" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Wystawienia Kwartał" caption="Data Wystawienia Kwartał" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Wystawienia Rok" caption="Data Wystawienia Rok" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Dzień&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Dzień na który wyliczane będą stany magazynowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT Getdate()
&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2016-10-12&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAUAAAAAAAAAAAAAAP////9pAAAABwImW1Byb2R1a3QgTmF6d2FdLltCYWxleG1ldGFsIDEyMDB4MjQwMF0HAixbUHJvZHVrdCBOYXp3YV0uW0NlbWVudCBiaWHFgnkgQ0VNIEkgNTIsNSBSXQcCLltQcm9kdWt0IE5hendhXS5bQ2VtZW50IHN6YXJ5IENFTSBJSSA0Miw1IEItU10HAiBbUHJvZHVrdCBOYXp3YV0uW0RFU0tBIENBTMOTV0tBXQcCI1tQcm9kdWt0IE5hendhXS5bRHJ1dCB3acSFemHFgmtvd3ldBwIlW1Byb2R1a3QgTmF6d2FdLltEeXNwZXJiZW50IG9wLiAyMGtnXQcCI1tQcm9kdWt0IE5hendhXS5bRWxlbWVudCBkemlhxYJvd3ldBwIxW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IGR6aWHFgm93eSBwb8WCw7N3a293eQ0KXQcCJVtQcm9kdWt0IE5hendhXS5bRWxlbWVudCBkemlhxYJvd3kNCl0HAihbUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgbmEgZHppYcWCw7N3a2ldBwIlW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IG5hZHByb8W8b3d5XQcCJltQcm9kdWt0IE5hendhXS5bRWxlbWVudCBuYWRwcm/FvG93eSBdBwItW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IG5hZHByb8W8b3d5IHByYXd5DQpdBwInW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IG5hcm/FvG55IGxld3ldBwIoW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IG5hcm/FvG55IHByYXd5XQcCIltQcm9kdWt0IE5hendhXS5bRWxlbWVudCBvZHBhZG93eV0HAi5bUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgcG9kc3Rhd29leSB6IHdwdXN0ZW1dBwIkW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHBvZHN0YXdvd3ldBwItW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHBvZHN0YXdvd3kgc3RhcnRvd3ldBwIuW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHBvZHN0YXdvd3kgc3RhcnRvd3kgXQcCMFtQcm9kdWt0IE5hendhXS5bRWxlbWVudCBwb2RzdGF3b3d5IHdpZcWEY3rEhWN5XQcCJltQcm9kdWt0IE5hendhXS5bRWxlbWVudCBwb2RzdGF3b3d5DQpdBwI7W1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHBvZHN0d293eSB3aWXFhGN6xIVjeS9wb2Rva2llbm55IF0HAiVbUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgcG/FgsOzd2tvd3ldBwIyW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHBvxYLDs3drb3d5IHdpZcWEY3rEhWN5IF0HAidbUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgcG/FgsOzd2tvd3kNCl0HAiVbUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgcHJ6eW9raWVubnldBwImW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHByenlva2llbm55IF0HAi1bUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgcHJ6eW9raWVubnkgMjAwbW0NCl0HAjVbUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgcHJ6eW9raWVubnkgbmFyb8W8bnkgbGV3eQ0KXQcCNltQcm9kdWt0IE5hendhXS5bRWxlbWVudCBwcnp5b2tpZW5ueSBuYXJvxbxueSBwcmF3eQ0KXQcCIltQcm9kdWt0IE5hendhXS5bRWxlbWVudCBzdGFydG93eV0HAi5bUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgc3RhcnRvd3kgcG/FgsOzd2tvd3ldBwIvW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHN0YXJ0b3d5IHBvxYLDs3drb3d5IF0HAixbUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgc3RhcnRvd3kgeiB3cHVzdGVtXQcCJFtQcm9kdWt0IE5hendhXS5bRWxlbWVudCBzdGFydG93eQ0KXQcCOVtQcm9kdWt0IE5hendhXS5bRUxFTUVOVCDFmkNJRU5OWSBTWVNURU1VIDNFIEgwIC0gUEXFgU5ZXQcCOVtQcm9kdWt0IE5hendhXS5bRUxFTUVOVCDFmkNJRU5OWSBTWVNURU1VIDNFIEgxIC0gUEXFgU5ZXQcCOFtQcm9kdWt0IE5hendhXS5bRUxFTUVOVCDFmkNJRU5OWSBTWVNURU1VIDNFIEgxLSBQRcWBTlldBwI7W1Byb2R1a3QgTmF6d2FdLltFTEVNRU5UIMWaQ0lFTk5ZIFNZU1RFTVUgM0UgSDFQMSAtIFBFxYFOWV0HAjxbUHJvZHVrdCBOYXp3YV0uW0VMRU1FTlQgxZpDSUVOTlkgU1lTVEVNVSAzRSBIMiAtIFBPxYHDk1dLQV0HAjpbUHJvZHVrdCBOYXp3YV0uW0VMRU1FTlQgxZpDSUVOTlkgU1lTVEVNVSAzRSBITkwgLSBQRcWBTlldBwI6W1Byb2R1a3QgTmF6d2FdLltFTEVNRU5UIMWaQ0lFTk5ZIFNZU1RFTVUgM0UgSE5QIC0gUEXFgU5ZXQcCKVtQcm9kdWt0IE5hendhXS5bRWxlbWVudCB1enVwZcWCbmlhasSFY3ldBwI1W1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHV6dXBlxYJuaWFqxIVjeSBwb8WCw7N3a293eV0HAjNbUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgdXp1cGXFgm5pYWrEhWN5IHN0cnrEmXBpYV0HAitbUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgdXp1cGXFgm5pYWrEhWN5DQpdBwIpW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHV6dXBlxYJuaWrEhWN5IF0HAjpbUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgd2llxYRjesSFY3kgIHBvxYLDs3drb3d5IDIwMG1tDQpdBwIrW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHdpZcWEY3rEhWN5IDIwMG1tXQcCKltQcm9kdWt0IE5hendhXS5bRWxlbWVudCB3aWXFhGN6xIVjeSBsZXd5XQcCMVtQcm9kdWt0IE5hendhXS5bRWxlbWVudCB3aWXFhGN6xIVjeSBuYWRwcm/FvG93eV0HAjJbUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgd2llxYRjesSFY3kgbmFkcHJvxbxvd3kgXQcCLltQcm9kdWt0IE5hendhXS5bRWxlbWVudCB3aWXFhGN6xIVjeSBuYXJvxbxueV0HAjFbUHJvZHVrdCBOYXp3YV0uW0VsZW1lbnQgd2llxYRjesSFY3kgcG/FgsOzd2tvd3ldBwI5W1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHdpZcWEY3rEhWN5IHBvxYLDs3drb3d5IDIwMG1tDQpdBwIrW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHdpZcWEY3rEhWN5IHByYXd5XQcCL1tQcm9kdWt0IE5hendhXS5bRWxlbWVudCB3aWXFhGN6xIVjeSB6IHdwdXN0ZW1dBwInW1Byb2R1a3QgTmF6d2FdLltFbGVtZW50IHdpZcWEY3rEhWN5DQpdBwIlW1Byb2R1a3QgTmF6d2FdLltFbmVyZ2lhIGVsZWt0cnljem5hXQcCLVtQcm9kdWt0IE5hendhXS5bRm9saWEgaXpvbGFjeWpuYSAwLDIgY3phcm5hXQcCIFtQcm9kdWt0IE5hendhXS5bRm9saWEgc3RyZXRjaCBdBwJBW1Byb2R1a3QgTmF6d2FdLltHaXBzIGJ1ZG93bGFueSBleHRyYSBiaWHFgnkgR0ItRCAocMOzxYJ3b2RueSkNCl0HAjFbUHJvZHVrdCBOYXp3YV0uW0tvbGFubyBrYW5hbGl6YWNqaSBQQ1YtVSAxNjAvNDVdBwIxW1Byb2R1a3QgTmF6d2FdLltLb3JlayBrYW5hbGl6YWNqaSBQQ1YtVSAxMTAga2dtXQcCH1tQcm9kdWt0IE5hendhXS5bS29yZWsgS0dNIDE2MF0HAh9bUHJvZHVrdCBOYXp3YV0uW09sZWluaWFuIHNvZHVdBwIYW1Byb2R1a3QgTmF6d2FdLltQYWxldGFdBwIkW1Byb2R1a3QgTmF6d2FdLltQYWxldGEgamVkbm9yYXpvd2FdBwIjW1Byb2R1a3QgTmF6d2FdLltQYXN0YSBwb8WbbGl6Z293YV0HAjVbUHJvZHVrdCBOYXp3YV0uW1BlcmxpdCBla3NwYW5kb3dhbnkgSUkga2xhc2EgMS0yIG1tXQcCGFtQcm9kdWt0IE5hendhXS5bUGlhc2VrXQcCVVtQcm9kdWt0IE5hendhXS5bUElOIElOU1VMQVRJT04gT0YgVEhFIEZBQ0UgT0YgVEhFIEZPVU5EQVRJT04gUExBQ0UgLSBBTFVUSEVSTU8gMTBNTV0HAidbUHJvZHVrdCBOYXp3YV0uW1DFgnl0YSBpem9sYWN5am5hIFBJUl0HAixbUHJvZHVrdCBOYXp3YV0uW1DFgnl0YSBYUFMgMTAwbW0gQlJJT1RIRVJNXQcCLFtQcm9kdWt0IE5hendhXS5bUG9ka8WCYWRrYSBiZXRvbm93YSA1MHg1MDBdBwI6W1Byb2R1a3QgTmF6d2FdLltQUkVGQUJSSUNBVEVEIExJTlRFTFMgS09OQkVUIDEweDEyeDE4MGNtXQcCJltQcm9kdWt0IE5hendhXS5bUHJldCDFvGVicm93YW55IDEybW1dBwIlW1Byb2R1a3QgTmF6d2FdLltQcmV0IMW8ZWJyb3dhbnkgNm1tXQcCJVtQcm9kdWt0IE5hendhXS5bUHJldCDFvGVicm93YW55IDhtbV0HAidbUHJvZHVrdCBOYXp3YV0uW1ByxJl0IMW8ZWJyb3dhbnkgMTBtbV0HAidbUHJvZHVrdCBOYXp3YV0uW1ByxJl0IMW8ZWJyb3dhbnkgMTZtbV0HAidbUHJvZHVrdCBOYXp3YV0uW1ByxJl0IMW8ZWJyb3dhbnkgMjBtbV0HAilbUHJvZHVrdCBOYXp3YV0uW1Byw7NiYSB0ZWNobm9sb2dpY3puYQ0KXQcCNFtQcm9kdWt0IE5hendhXS5bUmVkdWtjamEga2FuYWxpemFjamkgUENWLVUgMTYwLzExMF0HAhtbUHJvZHVrdCBOYXp3YV0uW1JlcGFyYXRvcl0HAhxbUHJvZHVrdCBOYXp3YV0uW1J1cmEgQXJvdGFdBwI1W1Byb2R1a3QgTmF6d2FdLltSdXJhIGthbmFsaXphY3lqbmEgUENWIDExMC8xMDAwWDMsMl0HAjVbUHJvZHVrdCBOYXp3YV0uW1J1cmEga2FuYWxpemFjeWpuYSBQQ1YgMTEwLzIwMDAvMywyXQcCNltQcm9kdWt0IE5hendhXS5bUnVyYSBrYW5hbGl6YWN5am5hIFBDVi1VIDYwLzEwMDAvNC4wXQcCNltQcm9kdWt0IE5hendhXS5bUnVyYSBrYW5hbGl6YWN5am5hIFBDVi1VIDYwLzIwMDAvNC4wXQcCNVtQcm9kdWt0IE5hendhXS5bUnVyYSBrYW5hbGl6YWN5am5hIFBDVi1VIDYwLzUwMC80LjBdBwIgW1Byb2R1a3QgTmF6d2FdLltSdXJhIFBFIDQwLzMsN10HAiJbUHJvZHVrdCBOYXp3YV0uW1N0ZWFyeW5pYW4gY3lua3VdBwIgW1Byb2R1a3QgTmF6d2FdLltUYXBldMOzd2thIDE1MF0HAo0CW1Byb2R1a3QgTmF6d2FdLltUSUUgQkVBTVMgRk9STVMgS09OQkVUOyBUWVBFIEwgKDI3eDI0eDUwY20pIDY1IHBjcyAoZ3JvdW5kIGZsb29yKSwgY29ybmVyIGJlYW0gZm9ybSBMIChoZWlnaHQgMjdjbSAtIGdyb3VuZCBmbG9vcikgNSBwY3MsIGNvcm5lciBiZWFtIGZvcm0gTCAoaGVpZ2h0IDMxIGNtIC0gMiBmbG9vcikgNSBwY3MsIHR5cGUgQyAoN3gyNHg1MGNtKSAxMCBwY3MgKGdyb3VuZCBmbG9vciksIHR5cGUgVSAoMjR4MzF4NjBjbSkgNzUgcGNzICgyIGZsb29yKV0HAhtbUHJvZHVrdCBOYXp3YV0uW1RyYW5zcG9ydF0HAixbUHJvZHVrdCBOYXp3YV0uW1Ryw7NqbmlrIGthbmFsaXphY2ppIFBDVi1VXQcCK1tQcm9kdWt0IE5hendhXS5bVHl0YW4gxbx5d2ljYSBwb2xpZXN0cm93YV0HAmtbUHJvZHVrdCBOYXp3YV0uW1ZFUlRJQ0FMIExFVkVMTElORyBMQVlFUiBVTkRFUiBTWVNURU0zRUVMRU1FTlRTIENFUkVTSVQgQ1I2NSAoU0VBTElORyBNT1JUQVIpIEJBRyAtIDI1IEtHXQcCJVtQcm9kdWt0IE5hendhXS5bV2Fwbm8gaHlkcmF0eXpvd2FuZV0HAiVbUHJvZHVrdCBOYXp3YV0uW1drcmV0eSBURCAzLDV4NTUgbW1dBwIhW1Byb2R1a3QgTmF6d2FdLltXb2RhIHphcm9ib3dhDQpdBwIXW1Byb2R1a3QgTmF6d2FdLltZQUtYU10HAi9bUHJvZHVrdCBOYXp3YV0uW1phc3V3a2Ega2FuYWxpemFjeWpuYSBQQ1YgMTYwXQAAAAA=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="True" showGrandTotalsForSingleValues="True" showMeasuresOnRows="False"&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Dokument Numer"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Inwentaryzacja Typ"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Nazwa"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Stan Magazynowy Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;format ref="Inwentaryzacja Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;cellGrandTotal fontName="Segoe UI" fontSize="8" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Stan Magazynowy Ilość" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Inwentaryzacja Ilość" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Dokument Numer" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Inwentaryzacja Typ" index="2" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Produkt Nazwa" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields /&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje porównanie w ilościach i wartościach stanów magazynowych i dokumentach inwentaryzacji</a:description><a:id>281</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.41 Raport stanów magazynowych i inwentaryzacji na dzień</a:mainLinkName><a:modifiedOn>2025-04-14T12:09:50.93</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>2</a:id></a:Context><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report><a:Report i:type="a:MdxSqlDevXpressReport"><a:catalogName>katalog</a:catalogName><a:createdOn>2012-03-23T14:41:05.81</a:createdOn><a:cubeName/><a:definitions xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxQuery</b:Key><b:Value><a:binaryData/><a:textData>SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;&#xD;
&#xD;
/* RAPORT_INFO&#xD;
* Stan magazynów wg cen w czasie wartościowo&#xD;
* Wersja raportu: 37.0&#xD;
* Wersja baz OPTIMY: 2025.3000&#xD;
* Wersja aplikacji OPTIMA: 2025.3.0&#xD;
*/&#xD;
&#xD;
/*&#xD;
DECLARE --Parametry Raportu		&#xD;
		 @DATAOD DATE		= '2010-01-01' &#xD;
		,@DATADO DATE		= '2026-12-31'&#xD;
		,@ZEROWE VARCHAR	= 'TAK';&#xD;
		*/&#xD;
BEGIN --Wyliczanie poziomów grup produktów				&#xD;
WITH g(gid, gidTyp, kod, gidNumer, grONumer, poziom, sciezka)&#xD;
AS&#xD;
(&#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, 0 as poziom, convert(nvarchar(1024), '') as sciezka&#xD;
      FROM CDN.TwrGrupy&#xD;
      WHERE TwG_TwGID = 0&#xD;
      &#xD;
      UNION ALL&#xD;
      &#xD;
      SELECT TwG_TwGID, TwG_GIDTyp, TwG_Kod, TwG_GIDNumer, TwG_GrONumer, p.poziom + 1 as poziom, convert(nvarchar(1024), p.sciezka + N'\' + c.TwG_Kod) as sciezka&#xD;
      FROM g p&#xD;
      JOIN CDN.TwrGrupy c&#xD;
      ON c.TwG_GrONumer = p.gidNumer &#xD;
      WHERE c.TwG_TwGID &lt;&gt; 0 AND c.TwG_GIDTyp = -16&#xD;
)     &#xD;
&#xD;
SELECT * INTO #tmpTwrGr FROM g&#xD;
&#xD;
DECLARE @poziom int&#xD;
DECLARE @poziom_max int&#xD;
DECLARE @sql nvarchar(max)&#xD;
SELECT @poziom_max = MAX(poziom) FROM #tmpTwrGr&#xD;
SET @poziom = @poziom_max&#xD;
SET @sql = N''&#xD;
&#xD;
WHILE @poziom &gt;= 0  &#xD;
BEGIN&#xD;
    SET @sql = N'ALTER TABLE #tmpTwrGr ADD Poziom' + CAST(@poziom AS nvarchar) + N' nvarchar(50), ONr' + CAST(@poziom AS nvarchar) + N' nvarchar(50)'&#xD;
    EXEC(@sql)&#xD;
    &#xD;
    IF @poziom = @poziom_max &#xD;
        BEGIN&#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET ONr' + CAST(@poziom AS nvarchar) +  '= grONumer '&#xD;
            EXEC(@sql)&#xD;
            &#xD;
            SET @sql = N'UPDATE #tmpTwrGr&#xD;
                SET Poziom' + CAST(@poziom AS nvarchar) + ' = kod'&#xD;
            EXEC(@sql)&#xD;
        END&#xD;
    ELSE&#xD;
        BEGIN &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.Poziom' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.kod AS nvarchar)&#xD;
                    ELSE CAST(p.kod AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
            EXEC(@sql)&#xD;
    &#xD;
            SET @sql = N'UPDATE c&#xD;
                SET c.ONr' + CAST(@poziom AS nvarchar) + N' = (&#xD;
                    CASE WHEN c.poziom &lt;=' + CAST(@poziom AS nvarchar) + N' THEN CAST(c.grONumer AS nvarchar)&#xD;
                    ELSE CAST(p.grONumer AS nvarchar) END)  &#xD;
                FROM #tmpTwrGr c&#xD;
                LEFT JOIN #tmpTwrGr p&#xD;
                ON c.ONr' + CAST(@poziom + 1 AS nvarchar) + '= p.gidNumer '&#xD;
                EXEC(@sql)&#xD;
        END&#xD;
    SET @poziom = @poziom - 1&#xD;
END     &#xD;
&#xD;
declare @select varchar(max)&#xD;
declare @select2 varchar(max)&#xD;
declare @kolumny varchar(max)&#xD;
declare @i int&#xD;
&#xD;
set @kolumny = ''&#xD;
set @i=0&#xD;
while (@i&lt;=@poziom_max)&#xD;
begin&#xD;
    set @kolumny = @kolumny + ',"Produkt Grupa Poziom ' + LTRIM(@i) + '" = CASE WHEN Poz.Poziom' +LTRIM(@i) + ' IS NULL THEN ''(NIEPRZYPISANE)'' ELSE Poz.Poziom' + LTRIM(@i) + ' END'&#xD;
    set @i = @i + 1&#xD;
end&#xD;
END&#xD;
BEGIN --Wyliczanie Atrybutów Towarów					&#xD;
DECLARE @atrybut_id int, @atrybut_kod nvarchar(50), @atrybut_typ int, @atrybut_format int, @sqlA nvarchar(max), @atrybutyTwr varchar(max);&#xD;
&#xD;
DECLARE @wersja float;&#xD;
SET @wersja = (SELECT CONVERT(float, SYS_Wartosc) FROM CDN.SystemCDN WHERE SYS_ID = 3)&#xD;
&#xD;
SET @sqlA = &#xD;
'DECLARE atrybut_cursor CURSOR FOR&#xD;
SELECT DeA_DeAId, REPLACE(DeA_Kod, '']'', ''_''), DeA_Typ, DeA_Format&#xD;
FROM CDN.DefAtrybuty&#xD;
WHERE DeA_DeAId in (SELECT DISTINCT TwA_DeAid FROM CDN.TwrAtrybuty WHERE TwA_TwrId IS NOT NULL)&#xD;
AND DeA_Format &lt;&gt; 5'&#xD;
IF @wersja &gt;= 2013 SET @sqlA = @sqlA + ' AND DeA_AnalizyBI = 1;'&#xD;
EXEC(@sqlA)&#xD;
&#xD;
OPEN atrybut_cursor;&#xD;
&#xD;
FETCH NEXT FROM atrybut_cursor&#xD;
INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
&#xD;
SELECT DISTINCT TwA_TwrId INTO #tmpTwrAtr FROM CDN.TwrAtrybuty&#xD;
&#xD;
SET @atrybutyTwr = ''&#xD;
&#xD;
WHILE @@FETCH_STATUS = 0&#xD;
BEGIN&#xD;
    IF @atrybut_typ = 2 BEGIN SET @atrybut_kod = @atrybut_kod + ' (K)' END&#xD;
    IF @atrybut_typ = 4 BEGIN SET @atrybut_kod = @atrybut_kod + ' (D)' END&#xD;
    SET @sqlA = N'ALTER TABLE #tmpTwrAtr ADD [' + CAST(@atrybut_kod AS nvarchar(50)) + N'] nvarchar(max)'&#xD;
    EXEC(@sqlA)    &#xD;
    SET @sqlA = N'UPDATE #tmpTwrAtr&#xD;
        SET [' + CAST(@atrybut_kod AS nvarchar(50)) +  '] = CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 4 THEN REPLACE(CONVERT(VARCHAR(10), DateAdd(day,convert(int,ATR.TwA_WartoscTxt),convert(datetime,''28-12-1800'',105)), 111), ''/'', ''-'') &#xD;
         ELSE CASE WHEN ' + convert(varchar,@atrybut_format) + ' = 2  THEN REPLACE(ATR.TwA_WartoscTxt,'','',''.'') ELSE ATR.TwA_WartoscTxt END &#xD;
        END&#xD;
        FROM CDN.TwrAtrybuty ATR &#xD;
        JOIN #tmpTwrAtr TM ON ATR.TwA_TwrId = TM.TwA_TwrId &#xD;
        WHERE ATR.TwA_DeAId = ' + CAST(@atrybut_id AS nvarchar)&#xD;
    EXEC(@sqlA)    &#xD;
    &#xD;
    SET @atrybutyTwr = @atrybutyTwr + N', ISNULL(TwrAtr.[' +  CAST(@atrybut_kod AS nvarchar(50)) + '], ''(NIEPRZYPISANE)'') AS [Produkt Atrybut ' + CAST(@atrybut_kod AS nvarchar(50)) + ']'         &#xD;
    FETCH NEXT FROM atrybut_cursor&#xD;
    INTO @atrybut_id, @atrybut_kod, @atrybut_typ, @atrybut_format;&#xD;
END&#xD;
&#xD;
CLOSE atrybut_cursor;&#xD;
DEALLOCATE atrybut_cursor;&#xD;
END&#xD;
BEGIN --Tworzenie tabeli tymczasowej dat				&#xD;
DECLARE @tmpDataOd DATETIME;&#xD;
SET @tmpDataOd = @DataOd&#xD;
CREATE TABLE #TmpDates (Data DATETIME)&#xD;
&#xD;
WHILE @tmpDataOd&lt;=@DataDo&#xD;
BEGIN&#xD;
    INSERT INTO #TmpDates VALUES (@tmpDataOd)&#xD;
    SET @tmpDataOd = @tmpDataOd + 1&#xD;
END                 &#xD;
    &#xD;
CREATE UNIQUE CLUSTERED INDEX bu ON #TmpDates ([Data])&#xD;
END&#xD;
BEGIN--Tworzenie tabeli tymczasowej z warością sprzedaży&#xD;
SELECT TrE_MagId, TrE_TwrId, TrE_DataOpe, SUM(TrE_WartoscNetto) SprzedazWartosc, SUM(TrE_Ilosc) SprzedazIlosc&#xD;
INTO #tmpSprzedaz &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
    AND TrE_TypDokumentu IN (-1, 302, 305) &#xD;
    AND TrE_DataOpe BETWEEN @DataOd AND @DataDo&#xD;
GROUP BY TrE_MagId, TrE_TwrId, TrE_DataOpe  &#xD;
&#xD;
SELECT TrE_MagId AS MagazynID, TrE_TwrId AS TowarID, Max(TrE_DataOpe) [Data Ostatniego Wydania]&#xD;
INTO #tmpDataWydania &#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
    AND TrE_TypDokumentu IN (-1, 302,304, 305, 314,306,318, 320,321,322 ) &#xD;
GROUP BY TrE_TwrId ,TrE_MagId   &#xD;
&#xD;
SELECT TrE_MagId AS MagazynID, TrE_TwrId AS TowarID, Max(TrE_DataOpe) [Data Ostatniego Przyjęcia]&#xD;
INTO #tmpDataDostawy&#xD;
FROM CDN.TraElem&#xD;
WHERE TrE_Aktywny &lt;&gt; 0 &#xD;
    AND TrE_TypDokumentu IN ( 303,307,312,313,317,350, 301) &#xD;
GROUP BY TrE_TwrId ,TrE_MagId   &#xD;
&#xD;
DECLARE @bazaFirmowa varchar(max);&#xD;
DECLARE @serwerKonf varchar(max);&#xD;
DECLARE @bazaKonf varchar(max);&#xD;
DECLARE @Bazy varchar(max);&#xD;
DECLARE @Operatorzy varchar(max);&#xD;
SET @bazaFirmowa = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1)&#xD;
SET @serwerKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1001)&#xD;
SET @bazaKonf = (SELECT SYS_Wartosc FROM CDN.SystemCDN WHERE SYS_ID = 1002)&#xD;
SET @Bazy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Bazy]' &#xD;
SET @Operatorzy = '[' + @serwerKonf + '].[' + @bazaKonf + '].[CDN].[Operatorzy]' &#xD;
END&#xD;
&#xD;
--Właściwe zapytanie    &#xD;
set @select = '	DECLARE @IloscDni INT;&#xD;
					SET @IloscDni = DATEDIFF ( D, ''' + convert(varchar, @DataOd) + ''', ''' + convert(varchar, @DataDo) + ''') + 1;                    &#xD;
SELECT &#xD;
	 [Baza Firmowa]							= BAZ.Baz_Nazwa &#xD;
	,[Produkt Kod]							= Twr_Kod &#xD;
	,[Produkt Nazwa]						= Twr_Nazwa &#xD;
	,[Produkt PKWiU]						= CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END &#xD;
	,[Produkt Dostawca]						= ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  &#xD;
	,[Produkt Aktywny]						= CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END &#xD;
	,[Produkt Jednostka Miary]				= Twr_JM &#xD;
	,[Produkt Jednostka Miary Pomocnicza]	= ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') &#xD;
	,[Produkt Opis]							= CAST(Twr_Opis as VARCHAR(1024)) &#xD;
	,[Produkt Waga KG]						= Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') &#xD;
	,[Magazyn Kod]							= Mag_Symbol &#xD;
	,[Produkt Typ]							= CASE&#xD;
												WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
												WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
												WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
												WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
												ELSE ''(NIEOKREŚLONY)''&#xD;
												END &#xD;
	,[Cena Domyślna]						= TwC_Wartosc &#xD;
	,[Cena Nazwa]					= Cen.DfC_Nazwa &#xD;
	,[Cena Typ]						= IIF(Cen.DfC_Typ = 1,''Netto'',''Brutto'')&#xD;
	,[Cena Rodzaj]					= IIF(Cen.DfC_Lp  = 1,''Cena zakupu'',''Cena sprzedaży'')&#xD;
	,[Produkt Producent]					= ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') &#xD;
	,[Produkt Marka]						= ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') &#xD;
	,[Produkt EAN]							= ISNULL(NULLIF(Twr_EAN, ''''), ''(BRAK)'')  &#xD;
	,[Produkt Kategoria Szczegółowa]		= ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') &#xD;
	,[Produkt Kategoria Ogólna]				= ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') &#xD;
	,[Ilość]								= ISNULL(TWI.TwI_Ilosc, 0) &#xD;
	,[Ilość Jednostka Pomocnicza]			= CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TWI.TwI_Ilosc*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END &#xD;
	,[Rezerwacje]							= ISNULL(TWI.TwI_Rezerwacje, 0) &#xD;
	,[Rezerwacje Jednostka Pomocnicza]		= CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TWI.TwI_Rezerwacje*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END &#xD;
	,[Braki]								= ISNULL(TWI.TwI_Braki, 0) &#xD;
	,[Braki Jednostka Pomocnicza]			= CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TWI.TwI_Braki*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END &#xD;
	,[Zamówienia]							= ISNULL(TWI.TwI_Zamowienia, 0) &#xD;
	,[Zamówienia Jednostka Pomocnicza]		= CASE WHEN Twr_JMPrzelicznikL &lt;&gt; 0 THEN CONVERT(DECIMAL(20,4),ISNULL(TWI.TwI_Zamowienia*Twr_JMPrzelicznikM/Twr_JMPrzelicznikL, 0)) ELSE 0 END &#xD;
	,[Wartość Netto]						= ISNULL(TWI.TwI_Wartosc, 0) &#xD;
	,[Wartość Brutto]						= ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) &#xD;
	,[Liczba Dni]							=  @IloscDni &#xD;
	,[Ilość Minimalna]						= NULLIF(Twr_IloscMin,0) &#xD;
	,[Ilość Maksymalna]						= NULLIF(Twr_IloscMax,0) &#xD;
	,[Ilość Ostatni Dzień]					= CASE WHEN twi3.data = convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120) THEN TWI.TwI_Ilosc ELSE 0 END &#xD;
	,[Sprzedaż Wartość Netto]				= SprzedazWartosc &#xD;
	,[Sprzedaż Ilość]						=  SprzedazIlosc &#xD;
	,[Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców] = NULL &#xD;
	,[Ilość M]								= CASE WHEN twi3.data = eom.eom THEN TWI.TwI_Ilosc ELSE 0 END&#xD;
	,[Wartość Netto M]						= CASE WHEN twi3.data = eom.eom THEN ISNULL(TWI.TwI_Wartosc, 0) ELSE 0 END &#xD;
	,[Wartość Brutto M]						= CASE WHEN twi3.data = eom.eom THEN ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) ELSE 0 END &#xD;
	, [Ilość T]								= CASE WHEN twi3.data = eow.eow THEN TWI.TwI_Ilosc ELSE 0 END&#xD;
	,[Wartość Netto T]						= CASE WHEN twi3.data = eow.eow THEN ISNULL(TWI.TwI_Wartosc, 0) ELSE 0 END &#xD;
	,[Wartość Brutto T]						= CASE WHEN twi3.data = eow.eow THEN ISNULL(TWI.TwI_Wartosc, 0 ) * (1 + Twr_Stawka/100) ELSE 0 END &#xD;
	,[Data Ostatniego Wydania]&#xD;
	,[Data Ostatniego Przyjęcia]&#xD;
    ,[Operator Wprowadzający]				= zal.Ope_Kod  &#xD;
    ,[Operator Modyfikujący]				= mod.Ope_Kod &#xD;
&#xD;
    /*&#xD;
    ----------DATA POINT&#xD;
    ,[Data] = REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') &#xD;
	*/&#xD;
&#xD;
    ----------DATA ANALIZY&#xD;
    ,[Data Dzień]			= REPLACE(CONVERT(VARCHAR(10), twi3.data, 111), ''/'', ''-'') &#xD;
	,[Data Tydzień Roku]	= (DATEPART(DY, datediff(d, 0, twi3.data) / 7 * 7 + 3)+6) / 7&#xD;
    ,[Data Miesiąc]			= MONTH(twi3.data) &#xD;
	,[Data Kwartał]			= DATEPART(quarter, twi3.data) &#xD;
	,[Data Rok]				= YEAR(twi3.data)  &#xD;
    ,[Data Analizy]			= GETDATE() &#xD;
&#xD;
    ----------KONTEKSTY&#xD;
    ,[Produkt Kod __PROCID__Towary__]	= 25003 &#xD;
	,[Produkt Kod __ORGID__]			= Twr_twrId &#xD;
	,[Odbiorca Kod __DATABASE__]		= '''+@bazaFirmowa+''' &#xD;
    ,[Produkt Nazwa __PROCID__]			= 25003 &#xD;
	,[Produkt Nazwa __ORGID__]			= Twr_twrId &#xD;
	,[Produkt Nazwa __DATABASE__]		= '''+@bazaFirmowa+''' &#xD;
    ,[Magazyn Kod __PROCID__Magazyny__] = 29056 &#xD;
	,[Magazyn Kod __ORGID__]			= Mag_MagId &#xD;
	,[Magazyn Kod __DATABASE__]			= '''+@bazaFirmowa+''' ' &#xD;
	+ @kolumny &#xD;
	+ @atrybutyTwr &#xD;
	+ '		   FROM cdn.TwrIlosci		TWI&#xD;
			   JOIN CDN.Towary					ON TWI.TwI_TwrId = Twr_TwrId    &#xD;
		  LEFT JOIN CDN.Producenci				ON Prd_PrdId = Twr_PrdId&#xD;
		  LEFT JOIN CDN.Marki					ON Mrk_MrkId = Twr_MrkId&#xD;
		  LEFT JOIN CDN.TwrCeny					ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
			   JOIN CDN.DefCeny			Cen		ON Twr_TwCNumer = Cen.DfC_DfCid &#xD;
			   JOIN CDN.Magazyny				ON TWI.TwI_MagId = Mag_MagId  &#xD;
    LEFT OUTER JOIN CDN.Kategorie		kat		ON Twr_KatId=kat.Kat_KatID&#xD;
		  LEFT JOIN CDN.Kontrahenci		knt4	ON Twr_KntId = knt4.Knt_KntId&#xD;
		  LEFT JOIN #tmpDataWydania		dw		ON TWI.TwI_TwrId = dw.TowarID AND TWI.Twi_MagID = dw.MagazynID&#xD;
		  LEFT JOIN #tmpDataDostawy		dd		ON TWI.TwI_TwrId = dd.TowarID AND TWI.Twi_MagID = dd.MagazynID&#xD;
		  LEFT JOIN '+@Bazy+'			BAZ		ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
		  LEFT JOIN '+@Operatorzy+'		zal		ON Twr_OpeZalID = zal.Ope_OpeId&#xD;
		  LEFT JOIN '+@Operatorzy+'		mod		ON Twr_OpeModID = mod.Ope_OpeId&#xD;
		  LEFT JOIN #tmpTwrGr			Poz		ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
		  LEFT JOIN #tmpTwrAtr			TwrAtr	ON TWI.TwI_TwrId  = TwrAtr.TwA_TwrId &#xD;
  			   JOIN (SELECT MAX(TwI_Data) as MaxData, TwI_MagId, TwI_TwrId, Data &#xD;
					    FROM CDN.TwrIlosci TWI2&#xD;
					    CROSS JOIN #TmpDates &#xD;
					    WHERE TWI2.TwI_MagId IS NOT NULL AND TWI2.TwI_Data &lt;= Data&#xD;
					    GROUP BY  TWI2.TwI_MagId, TWI2.TwI_TwrId, data &#xD;
					)TWI3 ON TWI3.TwI_TwrId = TWI.TwI_TwrId AND TWI3.TwI_MagId = TWI.TwI_MagId AND TWI3.MaxData = TWI.TwI_Data  &#xD;
    LEFT OUTER JOIN #tmpSprzedaz				ON TWI.TwI_MagId = TrE_MagId AND TWI.TwI_TwrId = TrE_TwrId AND twi3.data = TrE_DataOpe&#xD;
		  LEFT JOIN (select distinct eomonth(data) eom from #TmpDates) eom on eom.eom = twi3.data&#xD;
		  LEFT JOIN (select distinct DATEADD(wk, DATEDIFF(wk, 6, data), 6) eow from #TmpDates) eow on eow.eow = twi3.data&#xD;
			  WHERE TWI.TwI_MagId IS NOT NULL'&#xD;
IF @ZEROWE = 'NIE' SET @select = @select + ' AND (ISNULL(TwI_Ilosc, 0) &lt;&gt; 0 OR SprzedazWartosc &lt;&gt; 0) &#xD;
UNION ALL&#xD;
	SELECT	 [Baza Firmowa]							= BAZ.Baz_Nazwa &#xD;
			,[Produkt Kod]							= Twr_Kod &#xD;
			,[Produkt Nazwa]						= Twr_Nazwa &#xD;
			,[Produkt PKWiU]						= CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END &#xD;
			,[Produkt Dostawca]						= ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  &#xD;
			,[Produkt Aktywny]						= CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END &#xD;
			,[Produkt Jednostka Miary]				= Twr_JM &#xD;
			,[Produkt Jednostka Miary Pomocnicza]	= ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') &#xD;
			,[Produkt Opis]							= CAST(Twr_Opis as VARCHAR(1024)) &#xD;
			,[Produkt Waga KG]						= Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') &#xD;
			,[Magazyn Kod]							= Mag_Symbol &#xD;
			,[Produkt Typ]							= CASE&#xD;
														WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
														WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
														WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
														WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
														ELSE ''(NIEOKREŚLONY)''&#xD;
														END &#xD;
			,[Cena Domyślna]						= TwC_Wartosc &#xD;
			,[Cena Nazwa]					= Cen.DfC_Nazwa &#xD;
			,[Cena Typ]						= IIF(Cen.DfC_Typ = 1,''Netto'',''Brutto'')&#xD;
			,[Cena Rodzaj]					= IIF(Cen.DfC_Lp  = 1,''Cena zakupu'',''Cena sprzedaży'')&#xD;
			,[Produkt Producent]					= ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') &#xD;
			,[Produkt Marka]						= ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') &#xD;
			,[Produkt EAN]							= ISNULL(NULLIF(Twr_EAN, ''''), ''(BRAK)'')  &#xD;
			,[Produkt Kategoria Szczegółowa]		= ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') &#xD;
			,[Produkt Kategoria Ogólna]			= ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'')  &#xD;
			,[Ilość]							= NULL &#xD;
			,[Ilość Jednostka Pomocnicza]		= NULL &#xD;
			,[Rezerwacje]						= NULL &#xD;
			,[Rezerwacje Jednostka Pomocnicza]	= NULL &#xD;
			,[Braki]							= NULL &#xD;
			,[Braki Jednostka Pomocnicza]		= NULL &#xD;
			,[Zamówienia]						= NULL &#xD;
			,[Zamówienia Jednostka Pomocnicza]	= NULL&#xD;
			,[Wartość Netto]					= NULL &#xD;
			,[Wartość Brutto]					= NULL&#xD;
			,[Liczba Dni]						= NULL&#xD;
			,[Ilość Minimalna]					= NULL&#xD;
			,[Ilość Maksymalna]					= NULL&#xD;
			,[Ilość Ostatni Dzień]				= NULL&#xD;
			,[Sprzedaż Wartość Netto]			= NULL&#xD;
			,[Sprzedaż Ilość]					= NULL&#xD;
			,[Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców] = TrE_Ilosc&#xD;
			,[Ilość M]							= NULL&#xD;
			,[Wartość Netto M]					= NULL&#xD;
			,[Wartość Brutto M]					= NULL&#xD;
			,[Ilość T]							= NULL&#xD;
			,[Wartość Netto T]					= NULL&#xD;
			,[Wartość Brutto T]					= NULL&#xD;
			,[Data Ostatniego Wydania]			= NULL&#xD;
			,[Data Ostatniego Przyjęcia]		= NULL&#xD;
			,[Operator Wprowadzający]			= zal.Ope_Kod &#xD;
			,[Operator Modyfikujący]			= mod.Ope_Kod &#xD;
/*&#xD;
		----------DATY POINT&#xD;
			,[Data] = REPLACE(CONVERT(VARCHAR(10), convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120), 111), ''/'', ''-'') &#xD;
*/&#xD;
&#xD;
		----------DATY ANALIZY&#xD;
			,[Data Dzień]			= REPLACE(CONVERT(VARCHAR(10), convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120), 111), ''/'', ''-'') &#xD;
			,[Data Tydzień Roku]	=  (datepart(DY, datediff(d, 0, convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) / 7 * 7 + 3)+6) / 7 /*DATEPART(isowk, convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120))*/ &#xD;
			,[Data Miesiąc]			= MONTH(convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) &#xD;
			,[Data Kwartał]			= DATEPART(quarter, convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) &#xD;
			,[Data Rok]				= YEAR(convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) &#xD;
			,[Data Analizy]			= GETDATE() &#xD;
    &#xD;
		----------KONTEKSTY&#xD;
			,[Produkt Kod __PROCID__Towary__]	= 25003 &#xD;
			,[Produkt Kod __ORGID__]			= Twr_twrId &#xD;
			,[Odbiorca Kod __DATABASE__]		= '''+@bazaFirmowa+''' &#xD;
			,[Produkt Nazwa __PROCID__]			= 25003 &#xD;
			,[Produkt Nazwa __ORGID__]			=  Twr_twrId &#xD;
			,[Produkt Nazwa __DATABASE__]		= '''+@bazaFirmowa+''' &#xD;
			,[Magazyn Kod __PROCID__Magazyny__] = 29056 &#xD;
			,[Magazyn Kod __ORGID__]			= Mag_MagId &#xD;
			,[Magazyn Kod __DATABASE__]			= '''+@bazaFirmowa+'''  ' &#xD;
			+ @kolumny &#xD;
			+ @atrybutyTwr &#xD;
			+ 'FROM  (select TrE_TwrId,TrE_MagId,sum(TrE_Ilosc) TrE_Ilosc from cdn.TraNag &#xD;
						left join cdn.TraElem on TrN_TrNID = TrE_TrNId&#xD;
						where TrN_DataDok &lt;= convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)&#xD;
						and TrN_TypDokumentu = 309 and TrN_ZwroconoCalaIlosc &lt;3&#xD;
						group by TrE_TwrId,TrE_MagId&#xD;
						) a&#xD;
		  LEFT JOIN cdn.Towary					ON a.TrE_TwrId = Twr_TwrId&#xD;
		  LEFT JOIN cdn.Magazyny				ON Mag_MagId = a.TrE_MagId&#xD;
		  LEFT JOIN CDN.Producenci				ON Prd_PrdId = Twr_PrdId&#xD;
		  LEFT JOIN CDN.Marki					ON Mrk_MrkId = Twr_MrkId&#xD;
		  LEFT JOIN CDN.TwrCeny					ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
			   JOIN CDN.DefCeny			Cen		ON Twr_TwCNumer = Cen.DfC_DfCid &#xD;
    LEFT OUTER JOIN CDN.Kategorie		kat		ON Twr_KatId=kat.Kat_KatID&#xD;
		  LEFT JOIN #tmpTwrGr			Poz		ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
		  LEFT JOIN #tmpTwrAtr			TwrAtr	ON a.TrE_TwrId  = TwrAtr.TwA_TwrId &#xD;
		  LEFT JOIN CDN.Kontrahenci		knt4	ON Twr_KntId = knt4.Knt_KntId&#xD;
		  LEFT JOIN '+@Bazy+'			BAZ		ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
		  LEFT JOIN '+@Operatorzy+'		zal		ON Twr_OpeZalID = zal.Ope_OpeId&#xD;
		  LEFT JOIN '+@Operatorzy+'		mod		ON Twr_OpeModID = mod.Ope_OpeId'&#xD;
IF @ZEROWE = 'TAK' SET @select = @select + ' UNION ALL&#xD;
	SELECT &#xD;
		 [Baza Firmowa]							= BAZ.Baz_Nazwa &#xD;
		,[Produkt Kod]							= Twr_Kod &#xD;
		,[Produkt Nazwa]						= Twr_Nazwa &#xD;
		,[Produkt PKWiU]						= CASE TWR_SWW WHEN '' '' THEN ''(NIEPRZYPISANE)'' ELSE ISNULL(TWR_SWW,''(NIEPRZYPISANE)'') END &#xD;
		,[Produkt Dostawca]						= ISNULL(knt4.Knt_Kod, ''(NIEPRZYPISANE)'')  &#xD;
		,[Produkt Aktywny]						= CASE Twr_NieAktywny WHEN 0 THEN ''Tak'' ELSE ''Nie'' END &#xD;
		,[Produkt Jednostka Miary]				= Twr_JM &#xD;
		,[Produkt Jednostka Miary Pomocnicza]	= ISNULL(NULLIF(Twr_JMZ,''''), ''(BRAK)'') &#xD;
		,[Produkt Opis]							= CAST(Twr_Opis as VARCHAR(1024)) &#xD;
		,[Produkt Waga KG]						= Isnull(convert(varchar(15),twr_wagakg), ''(NIEPRZYPISANE)'') &#xD;
		,[Magazyn Kod]							= NULL &#xD;
		,[Produkt Typ]							= CASE&#xD;
													WHEN Twr_Typ = 0 AND Twr_Produkt = 0 THEN ''Usługa Prosta''&#xD;
													WHEN Twr_Typ = 1 AND Twr_Produkt = 0 THEN ''Towar Prosty''&#xD;
													WHEN Twr_Typ = 0 AND Twr_Produkt = 1 THEN ''Usługa Złożona''&#xD;
													WHEN Twr_Typ = 1 AND Twr_Produkt = 1 THEN ''Towar Złożony''&#xD;
													ELSE ''(NIEOKREŚLONY)''&#xD;
													END &#xD;
		,[Cena Domyślna]						= TwC_Wartosc &#xD;
		,[Cena Nazwa]							= Cen.DfC_Nazwa &#xD;
		,[Cena Typ]								= IIF(Cen.DfC_Typ = 1,''Netto'',''Brutto'')&#xD;
		,[Cena Rodzaj]							= IIF(Cen.DfC_Lp  = 1,''Cena zakupu'',''Cena sprzedaży'')&#xD;
		,[Produkt Producent]						= ISNULL(Prd_Kod, ''(NIEPRZYPISANE)'') &#xD;
		,[Produkt Marka]							= ISNULL(Mrk_Nazwa, ''(NIEPRZYPISANE)'') &#xD;
		,[Produkt EAN]								= ISNULL(NULLIF(Twr_EAN, ''''), ''(BRAK)'')  &#xD;
		,[Produkt Kategoria Szczegółowa]			= ISNULL(kat.Kat_KodSzczegol, ''(PUSTA)'') &#xD;
		,[Produkt Kategoria Ogólna]					= ISNULL(kat.Kat_KodOgolny, ''(PUSTA)'') &#xD;
		,[Ilość]									= 0 &#xD;
		,[Ilość Jednostka Pomocnicza]				= 0 &#xD;
		,[Rezerwacje]								= 0 &#xD;
		,[Rezerwacje Jednostka Pomocnicza]			= 0 &#xD;
		,[Braki]									= 0 &#xD;
		,[Braki Jednostka Pomocnicza]				= 0 &#xD;
		,[Zamówienia]								= 0 &#xD;
		,[Zamówienia Jednostka Pomocnicza]			= 0	 &#xD;
		,[Wartość Netto]							= 0 &#xD;
		,[Wartość Brutto]							= 0 &#xD;
		,[Liczba Dni]								= NULL &#xD;
		,[Ilość Minimalna]							= NULLIF(Twr_IloscMin,0)&#xD;
		,[Ilość Maksymalna]							= NULLIF(Twr_IloscMax,0)&#xD;
		,[Ilość Ostatni Dzień]						= 0 &#xD;
		,[Sprzedaż Wartość Netto]					= NULL &#xD;
		,[Sprzedaż Ilość]							= NULL &#xD;
		,[Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców] = NULL &#xD;
		,[Ilość M]									= NULL &#xD;
		,[Wartość Netto M]							= 0&#xD;
		,[Wartość Brutto M]							= 0&#xD;
		,[Ilość T]									= 0&#xD;
		,[Wartość Netto T]							= 0&#xD;
		,[Wartość Brutto T]							= 0&#xD;
		,[Data Ostatniego Wydania]					= NULL&#xD;
		,[Data Ostatniego Przyjęcia]				= NULL&#xD;
		,[Operator Wprowadzający]					= zal.Ope_Kod &#xD;
		,[Operator Modyfikujący]					= mod.Ope_Kod &#xD;
/*&#xD;
    ----------DATY POINT&#xD;
		,[Data] = REPLACE(CONVERT(VARCHAR(10), convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120), 111), ''/'', ''-'') &#xD;
*/&#xD;
&#xD;
    ----------DATY ANALIZY&#xD;
		,[Data Dzień]		 = REPLACE(CONVERT(VARCHAR(10), convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120), 111), ''/'', ''-'') &#xD;
		,[Data Tydzień Roku] = (datepart(DY, datediff(d, 0, convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) / 7 * 7 + 3)+6) / 7&#xD;
		,[Data Miesiąc]		 = MONTH(convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) &#xD;
		,[Data Kwartał]		 = DATEPART(quarter, convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) &#xD;
		,[Data Rok]			 = YEAR(convert(datetime,''' + convert(varchar, @DataDo, 120) + ''', 120)) &#xD;
		,[Data Analizy]		 = GETDATE() &#xD;
    &#xD;
	----------KONTEKSTY&#xD;
    ,[Produkt Kod __PROCID__Towary__]	= 25003 &#xD;
	,[Produkt Kod __ORGID__]			= Twr_twrId &#xD;
	,[Odbiorca Kod __DATABASE__]		= '''+@bazaFirmowa+''' &#xD;
    ,[Produkt Nazwa __PROCID__]			= 25003 &#xD;
	,[Produkt Nazwa __ORGID__]			= Twr_twrId &#xD;
	,[Produkt Nazwa __DATABASE__]		= '''+@bazaFirmowa+''' &#xD;
    ,[Magazyn Kod __PROCID__Magazyny__] = 29056 &#xD;
	,[Magazyn Kod __ORGID__]			= 1 &#xD;
	,[Magazyn Kod __DATABASE__]			= '''+@bazaFirmowa+''' ' &#xD;
	+ @kolumny &#xD;
	+ @atrybutyTwr &#xD;
	+ '        FROM CDN.Towary&#xD;
		  LEFT JOIN CDN.Producenci			ON Prd_PrdId = Twr_PrdId&#xD;
		  LEFT JOIN CDN.Marki				ON Mrk_MrkId = Twr_MrkId&#xD;
		  LEFT JOIN CDN.TwrCeny				ON Twr_TwrId = TwC_TwrID AND Twr_TwCNumer = TwC_TwCNumer&#xD;
			   JOIN CDN.DefCeny		Cen		ON Twr_TwCNumer = Cen.DfC_DfCid &#xD;
    LEFT OUTER JOIN CDN.Kategorie	kat		ON Twr_KatId=kat.Kat_KatID&#xD;
		  LEFT JOIN CDN.Kontrahenci knt4	ON Twr_KntId = knt4.Knt_KntId&#xD;
		  LEFT JOIN #tmpTwrGr		Poz		ON Twr_TwGGIDNumer = Poz.gidNumer&#xD;
		  LEFT JOIN #tmpTwrAtr		TwrAtr	ON tWR_TwrId  = TwrAtr.TwA_TwrId&#xD;
		  LEFT JOIN '+@Bazy+'		BAZ		ON DB_NAME() = BAZ.Baz_NazwaBazy AND BAZ.Baz_NazwaSerwera = SERVERPROPERTY(''ServerName'') and baz.baz_nieaktywna = 0&#xD;
		  LEFT JOIN '+@Operatorzy+' zal		ON Twr_OpeZalID = zal.Ope_OpeId&#xD;
		  LEFT JOIN '+@Operatorzy+' mod		ON Twr_OpeModID = mod.Ope_OpeId&#xD;
			  WHERE Twr_TwrId NOT IN (SELECT TwI_TwrId  FROM CDN.TwrIlosci)&#xD;
'&#xD;
&#xD;
EXEC(@select)&#xD;
&#xD;
DROP TABLE #tmpTwrGr&#xD;
DROP TABLE #tmpTwrAtr&#xD;
DROP TABLE #TmpDates&#xD;
DROP TABLE #tmpSprzedaz&#xD;
DROP TABLE #tmpDataWydania&#xD;
DROP TABLE #tmpDataDostawy</a:textData><a:timestamp/><a:type>MdxQuery</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>SubCube</b:Key><b:Value><a:binaryData/><a:textData/><a:timestamp/><a:type>SubCube</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxCs</b:Key><b:Value><a:binaryData/><a:textData>b5P4wbiC0+RG5e/t8t+X7zv805Ew+SD4q4tb3pMGF8tO7UTyhwSUC/Gd6+iwZB2jsd7hyuUyC8Sdgsl2n/BMjJgiNky53VdN6s+A30dZyDERDxjVxsQnjHChMl6Nve0YtI0skB0usVvB/MqySffaOuuZqCzq0pKnvsjpaKhxxPwZ/2+ghwDXEmC4OPJDAAQ9iKNBEB706qqf90ELy4akSOPWmjMA2j25</a:textData><a:timestamp/><a:type>MdxCs</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxMetadata</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&#xD;
&lt;metadata&gt;&#xD;
  &lt;columns&gt;&#xD;
    &lt;column name="Baza Firmowa" caption="Baza Firmowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kod" caption="Produkt Kod" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Nazwa" caption="Produkt Nazwa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt PKWiU" caption="Produkt PKWiU" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Dostawca" caption="Produkt Dostawca" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Aktywny" caption="Produkt Aktywny" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary" caption="Produkt Jednostka Miary" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Jednostka Miary Pomocnicza" caption="Produkt Jednostka Miary Pomocnicza" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Opis" caption="Produkt Opis" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Waga KG" caption="Produkt Waga KG" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Magazyn Kod" caption="Magazyn Kod" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Typ" caption="Produkt Typ" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Cena Domyślna" caption="Cena Domyślna" type="measure" formatString="c2" aggregate="Average" /&gt;&#xD;
    &lt;column name="Cena Nazwa" caption="Cena Nazwa" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Cena Typ" caption="Cena Typ" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Cena Rodzaj" caption="Cena Rodzaj" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Produkt Producent" caption="Produkt Producent" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Marka" caption="Produkt Marka" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt EAN" caption="Produkt EAN" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Szczegółowa" caption="Produkt Kategoria Szczegółowa" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Kategoria Ogólna" caption="Produkt Kategoria Ogólna" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Ilość" caption="Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Jednostka Pomocnicza" caption="Ilość Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje" caption="Rezerwacje" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Rezerwacje Jednostka Pomocnicza" caption="Rezerwacje Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki" caption="Braki" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Braki Jednostka Pomocnicza" caption="Braki Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia" caption="Zamówienia" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Zamówienia Jednostka Pomocnicza" caption="Zamówienia Jednostka Pomocnicza" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto" caption="Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto" caption="Wartość Brutto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Liczba Dni" caption="Liczba Dni" type="measure" formatString="n0" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Minimalna" caption="Ilość Minimalna" type="measure" formatString="n2" aggregate="Min" /&gt;&#xD;
    &lt;column name="Ilość Maksymalna" caption="Ilość Maksymalna" type="measure" formatString="n2" aggregate="Max" /&gt;&#xD;
    &lt;column name="Ilość Ostatni Dzień" caption="Ilość Ostatni Dzień" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Wartość Netto" caption="Sprzedaż Wartość Netto" type="measure" formatString="c2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Sprzedaż Ilość" caption="Sprzedaż Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" caption="Ilość Sztuk Aktualnie Otwartych Zamówień u Dostawców" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość M" caption="Ilość M" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto M" caption="Wartość Netto M" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto M" caption="Wartość Brutto M" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Ilość T" caption="Ilość T" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Netto T" caption="Wartość Netto T" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Wartość Brutto T" caption="Wartość Brutto T" type="measure" formatString="" aggregate="Sum" /&gt;&#xD;
    &lt;column name="Data Ostatniego Wydania" caption="Data Ostatniego Wydania" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Ostatniego Przyjęcia" caption="Data Ostatniego Przyjęcia" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Wprowadzający" caption="Operator Wprowadzający" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Operator Modyfikujący" caption="Operator Modyfikujący" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Dzień" caption="Data Dzień" type="attribute" formatString="n2" /&gt;&#xD;
    &lt;column name="Data Tydzień Roku" caption="Data Tydzień Roku" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Miesiąc" caption="Data Miesiąc" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Kwartał" caption="Data Kwartał" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Rok" caption="Data Rok" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Data Analizy" caption="Data Analizy" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 0" caption="Produkt Grupa Poziom 0" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 1" caption="Produkt Grupa Poziom 1" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 2" caption="Produkt Grupa Poziom 2" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 3" caption="Produkt Grupa Poziom 3" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 4" caption="Produkt Grupa Poziom 4" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Grupa Poziom 5" caption="Produkt Grupa Poziom 5" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="Produkt Atrybut USŁUGA SERWISOWA" caption="Produkt Atrybut USŁUGA SERWISOWA" type="attribute" formatString="" /&gt;&#xD;
    &lt;column name="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
    &lt;column name="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" type="measure" formatString="n2" aggregate="Sum" /&gt;&#xD;
  &lt;/columns&gt;&#xD;
&lt;/metadata&gt;</a:textData><a:timestamp/><a:type>MdxMetadata</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>MdxParams</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;ArrayOfMdxQueryParameter xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATAOD&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów od:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data początkowa, od której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE() - 30&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2018-08-19&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;DATADO&lt;/Name&gt;&#xD;
    &lt;Label&gt;Stany magazynów do:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Data końcowa, do której będą wyświetlane stany magazynów&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;SELECT GETDATE()&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Data&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;Data&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;2018-09-18&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
  &lt;MdxQueryParameter&gt;&#xD;
    &lt;Name&gt;ZEROWE&lt;/Name&gt;&#xD;
    &lt;Label&gt;Pokazuj stany zerowe:&lt;/Label&gt;&#xD;
    &lt;ToolTip&gt;Parametr określający czy w raporcie mają być widoczne stany zerowe&lt;/ToolTip&gt;&#xD;
    &lt;Expression&gt;'TAK';'NIE'&lt;/Expression&gt;&#xD;
    &lt;Type&gt;Lista&lt;/Type&gt;&#xD;
    &lt;ParamType&gt;CustomList&lt;/ParamType&gt;&#xD;
    &lt;DateFormat&gt;SQL&lt;/DateFormat&gt;&#xD;
    &lt;MinimumValue&gt;0&lt;/MinimumValue&gt;&#xD;
    &lt;MaximumValue&gt;0&lt;/MaximumValue&gt;&#xD;
    &lt;Precision&gt;0&lt;/Precision&gt;&#xD;
    &lt;Step&gt;0&lt;/Step&gt;&#xD;
    &lt;Multiselect&gt;false&lt;/Multiselect&gt;&#xD;
    &lt;Uppercase&gt;false&lt;/Uppercase&gt;&#xD;
    &lt;DefaultValue&gt;'NIE'&lt;/DefaultValue&gt;&#xD;
    &lt;Redefined&gt;false&lt;/Redefined&gt;&#xD;
  &lt;/MdxQueryParameter&gt;&#xD;
&lt;/ArrayOfMdxQueryParameter&gt;</a:textData><a:timestamp/><a:type>MdxParams</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Chart</b:Key><b:Value><a:binaryData/><a:textData>&lt;?xml version="1.0" encoding="utf-16"?&gt;&#xD;
&lt;chart visible="False" type="Bar" palette="In A Fog" paletteBaseColor="0" style="In A Fog" dataVertical="True" grandTotals="False" subTotals="False" onlySelected="False" showParametersValues="False" rotated="False"&gt;&#xD;
  &lt;appearance color="White" fillMode="Gradient" secondColor="#C6D3EF" gradientMode="TopToBottom" /&gt;&#xD;
  &lt;border borderVisible="False" borderColor="" borderSize="1" /&gt;&#xD;
  &lt;pointLabels visible="False" position="Top" zeroValues="False" shadowVisible="False" shadowColor="#000000" shadowSize="2" lineVisible="True" lineLength="10" lineStyle="Solid" lineThickness="1" lineColor="" overlapping="None" indent="-1"&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="False" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="" borderSize="1" /&gt;&#xD;
    &lt;appearance color="" fillMode="Solid" /&gt;&#xD;
  &lt;/pointLabels&gt;&#xD;
  &lt;legend visible="True" direction="TopToBottom" alignmentVertical="Center" alignmentHorizontal="RightOutside" spacingVertical="0" spacingHorizontal="0" limitsVertical="100" limitsHorizontal="100"&gt;&#xD;
    &lt;appearance color="White" fillMode="Gradient" secondColor="LightGrey" gradientMode="TopToBottom" /&gt;&#xD;
    &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;border borderVisible="True" borderColor="Gray" borderSize="1" /&gt;&#xD;
  &lt;/legend&gt;&#xD;
  &lt;titles&gt;&#xD;
    &lt;title text="Stan magazynów w czasie wartościowo" visible="True" dock="Top" alignment="Center" indent="5"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="18" fontColor="" antialiasing="True" /&gt;&#xD;
    &lt;/title&gt;&#xD;
  &lt;/titles&gt;&#xD;
  &lt;axis&gt;&#xD;
    &lt;axisX visible="True" beginText="" endText="" angle="90" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="[Data Dzień].[2012-04-22]" rangeMax="[Data Dzień].[2012-05-22]" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisX&gt;&#xD;
    &lt;axisY visible="True" beginText="" endText="" angle="0" staggered="False"&gt;&#xD;
      &lt;font fontName="Tahoma" fontSize="8" fontColor="" antialiasing="True" /&gt;&#xD;
      &lt;customLabels /&gt;&#xD;
      &lt;general autoGridSpacing="True" logarithmic="False" logarithmicBase="10" autoRange="True" scrollingAutoRange="True" rangeMin="0" rangeMax="216741,888" zeroLevel="True" margins="True" scrollingMargins="True" format="General" precision="2" alignment="Near" reverse="False" visible="True" /&gt;&#xD;
    &lt;/axisY&gt;&#xD;
  &lt;/axis&gt;&#xD;
  &lt;axisRangeValues /&gt;&#xD;
  &lt;axisScrollingRangeValues /&gt;&#xD;
&lt;/chart&gt;</a:textData><a:timestamp/><a:type>Chart</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:KeyValueOfReportDataTypeReportDataBrNSYbaE><b:Key>Layout</b:Key><b:Value><a:binaryData>AAAAAAUAAAABAAAABwIYW0NlbmEgTmF6d2FdLltodXJ0b3dhIDFdAAAAAP////8BAAAABwIYW0NlbmEgTmF6d2FdLltodXJ0b3dhIDNdBgAAAAcCGFtDZW5hIE5hendhXS5baHVydG93YSAxXQcCIltQcm9kdWt0IEtvZF0uW8WBQcWDQ1VDSCBETyBQScWBWV0HAhhbQ2VuYSBOYXp3YV0uW2h1cnRvd2EgMV0HAhZbUHJvZHVrdCBLb2RdLltQQUxFVEFdBwIYW0NlbmEgTmF6d2FdLltodXJ0b3dhIDFdBwIYW1Byb2R1a3QgS29kXS5bU0FEWk9OS0ldBwIYW0NlbmEgTmF6d2FdLltodXJ0b3dhIDFdBwIYW1Byb2R1a3QgS29kXS5bU0tSWllOS0FdBwIYW0NlbmEgTmF6d2FdLltodXJ0b3dhIDFdBwIUW1Byb2R1a3QgS29kXS5bVEVTVF0HAhhbQ2VuYSBOYXp3YV0uW2h1cnRvd2EgMV0HAiFbUHJvZHVrdCBLb2RdLltVU8WBVUdBIFNFUldJU09XQV0=</a:binaryData><a:textData>&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;&lt;layout version="201107" visible="True" fieldListWidth="280" fieldListVisible="True" fieldListExpanded="True" lazyLoading="False" rowGrandTotal="True" calculationsPanelVisible="True" showEmptyCells="False" showTotalsForSingleValues="False" showGrandTotalsForSingleValues="False" showMeasuresOnRows="False"&gt;&lt;whatifMeasures&gt;&lt;whatifMeasure uniqueName="[Measures].[452b9904-d21e-4bf6-ab5b-281968a025d7]" caption="Wskaźnik Ilość" formula="IIF(Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Ilość/Ilość&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&lt;whatifMeasure uniqueName="[Measures].[9357f616-9b71-4aef-99e9-8e92c080a4bb]" caption="Wskaźnik Wartość" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.9999,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto/Wartość Netto&amp;#xD;&amp;#xA;)" description="" summaryType="Sum" /&gt;&lt;whatifMeasure uniqueName="[Measures].[eb825a47-dc0c-49e5-92d0-58459afd22ff]" caption="Rotacja w Razach" formula="IIF(Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Sprzedaż Wartość Netto*Liczba Dni/Wartość Netto)&amp;#xD;&amp;#xA;" description="" summaryType="Sum" /&gt;&lt;whatifMeasure uniqueName="[Measures].[48297393-873c-490e-9506-55cc4454cba4]" caption="Rotacja w Dniach" formula="IIF(Sprzedaż Wartość Netto = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Wartość Netto/Sprzedaż Wartość Netto)" description="" summaryType="Default" /&gt;&lt;whatifMeasure uniqueName="[Measures].[eff0cd0e-9a7f-40f2-af1e-aafe3b5fbedc]" caption="DOS w Okresie" formula="IIF(Sprzedaż Ilość = 0.0,&amp;#xD;&amp;#xA;999999999.99,&amp;#xD;&amp;#xA;Ilość Ostatni Dzień*Liczba Dni/Sprzedaż Ilość)" description="" summaryType="Default" /&gt;&lt;/whatifMeasures&gt;&lt;sparklines /&gt;&lt;customMeasures /&gt;&lt;formatOptions&gt;&lt;format ref="Produkt Kod"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Cena Domyślna"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="c2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Cena Nazwa"&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Ilość"&gt;&lt;cells fontName="Segoe UI" fontSize="8" format="n2" /&gt;&lt;header fontName="Segoe UI" fontSize="8" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" /&gt;&lt;totals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;cellTotals fontName="Segoe UI" fontSize="8" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Wartość Netto"&gt;&lt;cells fontName="Tahoma" fontSize="8.25" format="c2" /&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Data Dzień"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;format ref="Produkt Grupa Poziom 1"&gt;&lt;header fontName="Tahoma" fontSize="8.25" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" /&gt;&lt;totals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellTotals fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;grandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;cellGrandTotal fontName="Tahoma" fontSize="8.25" bold="True" /&gt;&lt;/format&gt;&lt;/formatOptions&gt;&lt;formatRules /&gt;&lt;dataFields&gt;&lt;data fieldName="Cena Domyślna" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Ilość" index="1" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;data fieldName="Wartość Netto" index="2" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.Decimal"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/data&gt;&lt;/dataFields&gt;&lt;rowFields&gt;&lt;row fieldName="Produkt Kod" index="1" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Cena Nazwa" index="0" expanded="True" sortMode="default" order="ascending" width="150" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="True" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" imageHeight="100" imageWidth="100" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="True" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;row fieldName="Data Dzień" index="2" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True" isLocked="False"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/row&gt;&lt;/rowFields&gt;&lt;columnFields /&gt;&lt;filterFields&gt;&lt;filter fieldName="Produkt Grupa Poziom 1" index="0" expanded="True" sortMode="default" order="ascending" width="100" top="0" topType="TopAbsolute" dataField="" topShowOthers="False" detailCaptionVisible="False" allowDisplayImages="False" summaryDisplayType="Default" filterMultipleChoice="True"&gt;&lt;sortBy /&gt;&lt;orderedMembers /&gt;&lt;filters isAllChecked="False" showBlanks="True" type="System.String"&gt;&lt;excluded /&gt;&lt;/filters&gt;&lt;measuresFilter /&gt;&lt;/filter&gt;&lt;/filterFields&gt;&lt;/layout&gt;</a:textData><a:timestamp/><a:type>Layout</a:type></b:Value></b:KeyValueOfReportDataTypeReportDataBrNSYbaE></a:definitions><a:description>Raport prezentuje wartościowe stany magazynów w zadanym okresie czasu w podziale na zdefiniowane cenniki. &#xD;
Zakres dat analizy należy podać podczas uruchomienia raportu.</a:description><a:id>282</a:id><a:isPredefinedReport>false</a:isPredefinedReport><a:language>pl-PL</a:language><a:mainLinkName>7.42 Stan magazynów wg cen w czasie wartościowo</a:mainLinkName><a:modifiedOn>2025-04-11T13:50:44.72</a:modifiedOn><a:path xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><b:string>II. Raporty Standardowe</b:string><b:string>07. Magazyny</b:string></a:path><a:predefinedReport i:nil="true"/><a:serverName>serwer</a:serverName><a:sourceDbType>Main</a:sourceDbType><a:standardReportHash i:nil="true"/><a:standardReportId i:nil="true"/><a:standardReportVersion i:nil="true"/><a:type>DevXpressMdxSql</a:type><a:useDefaultConnection>true</a:useDefaultConnection><a:useInMemory>true</a:useInMemory><a:viewType i:nil="true"/><a:webServicePort>80</a:webServicePort><a:contexts><a:Context><a:id>9</a:id></a:Context></a:contexts><a:connections/></a:Report></Reports><UsePasswordsEncryption>true</UsePasswordsEncryption></ReportsList>